"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="8c870816-c051-5b89-87de-eff038642ea3")}catch(e){}}();
(()=>{/*! Copyright (c) 2025 Tutteo Ltd. */(self.webpackChunk_flat_flat=self.webpackChunk_flat_flat||[]).push([[64161],{11076:(U,D,t)=>{t.d(D,{A:()=>u});var c=t(485037);const u=c.A},18935:(U,D,t)=>{t.d(D,{A:()=>f});var c=t(701387),u=t(614653),m=t(150892),r=t(316610);const n=function(l,I,a){this.init(l,I,a)};n.NAME="composite.RemoveClassicHarmoniesFrom";const i=n.prototype;i.name=n.NAME,i.init=function(l,I,a){this.scoreData=l,this.cancelStack=a,this.opts=I,this.measure=null},i.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.removeClassicHarmoniesFrom()},i.removeClassicHarmoniesFrom=function(){const l=this.getLimitTimePos(),I=this.getMeasure(),a=c.default.getClassicHarmonies(I),d=a.length;for(let v=d-1;v>=0;v--){const x=a[v];if(u.default.getTimePos(x)>=l)this.removeHarmony(v);else break}},i.getLimitTimePos=function(){const l=this.getMeasure();return(0,r.A)(this.opts,l)},i.removeHarmony=function(l){const I={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,harmonyIdx:l};new m.default(this.scoreData,I,this.cancelStack).perform()},i.getMeasure=function(){return this.measure===null&&(this.measure=this.scoreData.getMeasure(this.opts.partIdx,this.opts.measureIdx)),this.measure};const f=n},25087:(U,D,t)=>{t.d(D,{A:()=>b});var c=t(909748),u=t(999874),m=t(364842),r=t(346797),n=t(515819),i=t(436369);const f=function(P,g,O){this.init(P,g,O)};f.NAME="primitive.RemoveTempoChange";const l=f.prototype;l.name=f.NAME,l.init=function(P,g,O){this.scoreData=P,this.cancelStack=O,this.opts=g,this.removedTempoChange=null,this.tempoChanges=null,this.tempoChangeIdx=null},l.perform=function(){this.removeTempoChange(),this.updateStack()},l.removeTempoChange=function(){const P=this.scoreData.getCommonContent(),g=P.getTempoChanges(this.opts.measureIdx),O=this.getTempoChangeIdx(),w=g.splice(O,1);if(this.removedTempoChange=w[0],r.A.isStart(this.removedTempoChange)){const y=r.A.getTempoChangeUuid(this.removedTempoChange);this.scoreData.getCommonContent().removeTempoChangeAtUuid(y)}P.setTempoChanges(this.opts.measureIdx,g)},l.updateStack=function(){const P=this.scoreData.getNbParts();for(let g=0;g<P;g++){const O={type:this.name,opts:{partIdx:g,measureIdx:this.opts.measureIdx}};this.cancelStack.push(O)}(0,i.A)(this.cancelStack,this.scoreData,this.opts)},l.getTempoChangeIdx=function(){return this.tempoChangeIdx===null&&this.fetchTempoChangeIdx(),this.tempoChangeIdx},l.fetchTempoChangeIdx=function(){if(this.tempoChangeIdx=null,this.getTempoChanges().some(this.checkTempoChange,this),this.tempoChangeIdx===null)throw new m.default("MissingTempoChange")},l.checkTempoChange=function(P,g){const O=r.A.getQuarterPos(P),w=n.default.divisionsToQuarter(this.opts.timePos,this.opts.dpq),y=r.A.getType(P);return O<w?!1:(O===w&&y===this.opts.type&&(this.tempoChangeIdx=g),!0)},l.getTempoChanges=function(){if(this.tempoChanges===null){const P=this.scoreData.getCommonContent();this.tempoChanges=P.getTempoChanges(this.opts.measureIdx)}return this.tempoChanges},l.getMeasure=function(){return this.scoreData.getMeasure(0,this.opts.measureIdx)};const I=f,a=function(P,g,O){this.init(P,g,O)};a.NAME="primitive.RemoveTempoChangeContinue";const d=a.prototype;d.name=a.NAME,d.init=function(P,g,O){this.scoreData=P,this.cancelStack=O,this.opts=g},d.perform=function(){this.removeLeftTempoChange(),this.removeRightTempoChange(),this.updateStack()},d.removeLeftTempoChange=function(){const P=this.scoreData.getCommonContent();if(!P.hasRightTempoChange(this.opts.measureIdx)){const g="There is no right tempo change to remove on the left measure.";throw new m.default("MissingRightContinueTempoChange",g)}P.removeRightTempoChange(this.opts.measureIdx)},d.removeRightTempoChange=function(){const P=this.scoreData.getCommonContent();if(!P.hasLeftTempoChange(this.opts.measureIdx+1)){const g="There is no left tempo change to remove on the left measure.";throw new m.default("MissingLeftContinueTempoChange",g)}P.removeLeftTempoChange(this.opts.measureIdx+1)},d.updateStack=function(){const P=this.scoreData.getNbParts();for(let g=0;g<P;g++){const O={type:this.name,opts:{partIdx:g,measureIdx:this.opts.measureIdx}};this.cancelStack.push(O)}(0,i.A)(this.cancelStack,this.scoreData,this.opts)};const v=a,x=function(P,g,O){this.init(P,g,O)};x.NAME="composite.RemoveTempoChange";const C=x.prototype;C.name=x.NAME,C.init=function(P,g,O){this.scoreData=P,this.cancelStack=O,this.opts=g,this.startMeasureIdx=null,this.startTimePos=null,this.startDpq=null,this.stopMeasureIdx=null,this.stopTimePos=null,this.stopDpq=null},C.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.searchSides(),this.removeStart(),this.removeStop(),this.removeContinues()},C.searchSides=function(){const P=this.getCommonContent(),g=(0,u.A)(P,this.opts.measureIdx,this.opts.timePos,this.opts.dpq);this.startMeasureIdx=g.startMeasureIdx,this.startTimePos=g.startTimePos,this.startDpq=g.startDpq,this.stopMeasureIdx=g.stopMeasureIdx,this.stopTimePos=g.stopTimePos,this.stopDpq=g.stopDpq,this.type=g.type},C.getCommonContent=function(){return this.scoreData.getCommonContent()},C.removeStart=function(){const P={measureIdx:this.startMeasureIdx,timePos:this.startTimePos,dpq:this.startDpq,type:this.type};new I(this.scoreData,P,this.cancelStack).perform()},C.removeStop=function(){const P={measureIdx:this.stopMeasureIdx,timePos:this.stopTimePos,dpq:this.stopDpq,type:c.A.STOP};new I(this.scoreData,P,this.cancelStack).perform()},C.removeContinues=function(){for(let P=this.startMeasureIdx;P<this.stopMeasureIdx;P++)this.removeContinue(P)},C.removeContinue=function(P){const g={measureIdx:P};new v(this.scoreData,g,this.cancelStack).perform()};const b=x},59633:(U,D,t)=>{t.d(D,{A:()=>f});var c=t(701387),u=t(614653),m=t(855424),r=t(316610);const n=function(l,I,a){this.init(l,I,a)};n.NAME="composite.RemoveHarmoniesFrom";const i=n.prototype;i.name=n.NAME,i.init=function(l,I,a){this.scoreData=l,this.cancelStack=a,this.opts=I,this.measure=null},i.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.removeHarmoniesFrom()},i.removeHarmoniesFrom=function(){const l=this.getLimitTimePos(),I=this.getMeasure(),a=c.default.getJazzHarmonies(I),d=a.length;for(let v=d-1;v>=0;v--){const x=a[v];if(u.default.getTimePos(x)>=l)this.removeHarmony(v);else break}},i.getLimitTimePos=function(){const l=this.getMeasure();return(0,r.A)(this.opts,l)},i.removeHarmony=function(l){const I={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,harmonyIdx:l};new m.default(this.scoreData,I,this.cancelStack).perform()},i.getMeasure=function(){return this.measure===null&&(this.measure=this.scoreData.getMeasure(this.opts.partIdx,this.opts.measureIdx)),this.measure};const f=n},80465:(U,D,t)=>{t.d(D,{A:()=>n});var c=t(890439),u=t(248703);const m=function(i,f){const l=r(i,f),I={},d=(0,u.A)(l,I,0);return{mainVoiceIdx:d,voices:[d]}},r=function(i,f){const l=i.getPartVoicesIndexes(f);return c.Ay.fromList(l)},n=m},126362:(U,D,t)=>{t.d(D,{A:()=>m});var c=t(951066);function u(r,n){return`The MIDIUnpitched/MIDIProgram combination ${r}/${n} 
   appears twice in the instruments list.`}class m extends c.A{constructor(n,i){const f=u(n,i);super(f),Object.defineProperty(this,"MIDIUnpitched",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"MIDIProgram",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="DuplicateMIDIInstrumentError",this.MIDIUnpitched=n,this.MIDIProgram=i}}},157679:(U,D,t)=>{t.d(D,{A:()=>u});var c=t(607682);class u extends c.default{constructor(r){super(`There is already a part linked the following UUID ${r}`),Object.defineProperty(this,"partUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="AlreadyHasPartUuidError",this.partUuid=r}}},221029:(U,D,t)=>{t.d(D,{A:()=>m});var c=t(951066);function u(r,n){return`The MIDIUnpitched/MIDIProgram combination ${r}/${n} 
   appears twice in the pitch mapping.`}class m extends c.A{constructor(n,i){const f=u(n,i);super(f),Object.defineProperty(this,"MIDIUnpitched",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"MIDIProgram",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="MIDIUnpitchedProgramUsedTwiceError",this.MIDIUnpitched=n,this.MIDIProgram=i}}},244771:(U,D,t)=>{t.d(D,{A:()=>w});var c=t(737903),u=t(123491),m=t(292681),r=t(832560),n=t(290087);function i(y,N){return y instanceof r.A?(y.scoreData!==null&&(y.scoreData.checkPartIdx(N.partIdx),y.scoreData.checkMeasureIdx(N.measureIdx)),y):(0,n.A)(y,N.partIdx,N.measureIdx)}var f=t(519405),l=t(768498),I=t(754998),a=t(476943),d=t(793317),v=t(343667),x=t(852363);const C=function(y,N,h){this.init(y,N,h)};C.NAME="primitive.ChangeHeadPercu";const b=C.prototype;b.name=C.NAME,b.initMeasureData=d.default,b.init=function(y,N,h){this.initMeasureData(y,N),this.cancelStack=h,this.opts=N},b.perform=function(){let N=this.getVoice().getChord(this.opts.noteIdx);N=a.default.makeArray(N);const p=N.map(u.default.getUnpitched).findIndex(P,this.opts.unpitched),M=N[p],V=this.getUnpitchedInstrumentId(),H=u.default.getHead(M);u.default.setHead(M,this.opts.notehead),u.default.setInstrumentId(M,V),this.updateStack(H)},b.getVoice=function(){return this.measureData.getVoice(this.opts.voiceIdx)},b.getUnpitchedInstrumentId=function(){return(0,v.A)(this.measureData,this.opts.partIdx,this.opts.unpitched,this.opts.notehead)};const P=function(y){const N=this;return m.default.isSameLine(y,N)};b.updateStack=function(y){const N={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,noteIdx:this.opts.noteIdx,voiceIdx:this.opts.voiceIdx,unpitched:m.default.copy(this.opts.unpitched),previousNotehead:y,newNotehead:this.opts.notehead}};this.cancelStack.push(N),(0,x.default)(this.cancelStack,this.measureData,this.opts)};const g=C;class O{constructor(N,h,p){Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:O.NAME}),Object.defineProperty(this,"opts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"measureData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cancelStack",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.measureData=i(N,h),this.cancelStack=p,this.opts=h}perform(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.removeTie(),this.changeHead()}removeTie(){const N=this.getChordHead();if(!u.default.hasTie(N))return;const h={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx,"display-step":m.default.getStep(this.opts.unpitched),"display-octave":m.default.getOctave(this.opts.unpitched)},p=new I.default(this.measureData,h,this.cancelStack);(0,f.default)(p)}changeHead(){const N=(0,c.default)(this.opts);new g(this.measureData,N,this.cancelStack).perform()}getChordHead(){const N=this.measureData.getVoice(this.opts.voiceIdx);return(0,l.A)(N,this.opts.noteIdx,this.opts.unpitched)}}Object.defineProperty(O,"NAME",{enumerable:!0,configurable:!0,writable:!0,value:"composite.ChangeHeadPercu"});const w=O},248703:(U,D,t)=>{t.d(D,{A:()=>u});var c=t(275844);const u=c.A},264843:(U,D,t)=>{t.d(D,{A:()=>u});var c=t(607682);class u extends c.default{constructor(r,n){const i=`Cannot use neither previousUuid or nextUuid with the following values ${r} & ${n}`;super(i),Object.defineProperty(this,"previousUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nextUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadPreviousNextUuidError",this.previousUuid=r,this.nextUuid=n}}},266156:(U,D,t)=>{t.d(D,{A:()=>r});var c=t(292681),u=t(951066);function m(n){return`The unpitched ${c.default.stringify(n)} is used twice in pitch mapping. `}class r extends u.A{constructor(i){const f=m(i);super(f),Object.defineProperty(this,"unpitched",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="UnpitchedUsedTwiceError",this.unpitched=i}}},275646:(U,D,t)=>{t.d(D,{A:()=>n});var c=t(601868),u=t(890439);const m=function(i,f,l){const I=r(i,f),a={};(0,c.A)(I,l,a)},r=function(i,f){const l=i.getPartVoicesIndexes(f);return u.Ay.fromList(l)},n=m},276265:(U,D,t)=>{t.d(D,{A:()=>u});var c=t(657032);const u=c.A},289633:(U,D,t)=>{t.d(D,{A:()=>m});var c=t(951066);function u(r){return`There are multiple midi-programs for the midi-unpitched ${r}.`}class m extends c.A{constructor(n){const i=u(n);super(i),Object.defineProperty(this,"MIDIUnpitched",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="UnpitchedMidiProgramAmbiguityError",this.MIDIUnpitched=n}}},323161:(U,D,t)=>{t.d(D,{A:()=>i});var c=t(951066);function u(f){return`the voiceUuid value [${f}] is invalid.`}class m extends c.A{constructor(l){const I=u(l);super(I),Object.defineProperty(this,"voiceUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="InvalidVoiceUuidError",this.voiceUuid=l}}var r=t(210888);const n={};n.check=function(f){if(!n.isValid(f))throw new m(f)},n.isValid=function(f){return typeof f=="string"&&r.default.isValid(f)};const i=n},324318:(U,D,t)=>{t.d(D,{A:()=>I});var c=t(701387),u=t(519405),m=t(726271);const r=function(a,d,v){this.init(a,d,v)};r.NAME="composite.RemovePartMeasureRepeat";const n=r.prototype;n.name=r.NAME,n.init=function(a,d,v){this.scoreData=a,this.cancelStack=v,this.opts=d},n.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.removePartMeasureRepeat()},n.removePartMeasureRepeat=function(){const a=this.scoreData.getMeasure(this.opts.partIdx,this.opts.measureIdx),d=c.default.getNbStaves(a);for(let v=0;v<d;v++)c.default.hasMeasureRepeat(a,v)&&this.removeMeasureRepeat(v)},n.removeMeasureRepeat=function(a){const d={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:a},v=new m.default(this.scoreData,d,this.cancelStack);(0,u.default)(v)};const i=r,f=function(a,d,v){this.init(a,d,v)};f.NAME="composite.RemoveColumnMeasureRepeat";const l=f.prototype;l.name=f.NAME,l.init=function(a,d,v){this.scoreData=a,this.cancelStack=v,this.opts=d},l.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.removeColumnMeasureRepeat()},l.removeColumnMeasureRepeat=function(){const a=this.scoreData.getNbParts();for(let d=0;d<a;d++)this.removePartMeasureRepeat(d)},l.removePartMeasureRepeat=function(a){const d={partIdx:a,measureIdx:this.opts.measureIdx};new i(this.scoreData,d,this.cancelStack).perform()};const I=f},343667:(U,D,t)=>{t.d(D,{A:()=>n});var c=t(243183),u=t(383279),m=t(414787);const n=function(i,f,l,I){const d=(0,c.A)(i).getPartHeader(f),v=u.default.getUnpitchedMapping(d);return m.A.getInstrumentId(v,l,I)}},404747:(U,D,t)=>{t.d(D,{A:()=>I});var c=t(607682),u=t(292681);class m extends c.default{constructor(d,v){super(r(d,v)),Object.defineProperty(this,"unpitched",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"notehead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="NoUnpitchedError",this.unpitched=d,this.notehead=v}}const r=function(a,d){return`There is no MIDI-unpitched value for the pitch [${u.default.stringify(a)}] and the note head [${d}].`};var n=t(414787),i=t(383279),f=t(243183);const I=function(a,d){a=(0,f.A)(a);const v=a.getPartHeader(d.partIdx),x=i.default.getUnpitchedMapping(v);if(typeof d.notehead!="undefined"){if(!n.A.hasInstrumentId(x,d.unpitched,d.notehead))throw new m(u.default.copy(d.unpitched),d.notehead)}else if(!n.A.hasInstrumentForUnpitched(x,d.unpitched))throw new m(u.default.copy(d.unpitched),d.notehead);let C=d.notehead;typeof C=="undefined"&&(C=n.A.getDefaultMIDIHead(x,d.unpitched))}},426070:(U,D,t)=>{t.d(D,{A:()=>m});var c=t(951066);function u(r){return`The note head [${r}] do not match any head for for the given pitch in the pitch mapping.`}class m extends c.A{constructor(n){const i=u(n);super(i),Object.defineProperty(this,"defaultHead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadPercuDefaultHeadError",this.defaultHead=n}}},436369:(U,D,t)=>{t.d(D,{A:()=>m});var c=t(673817),u=t(813864);function m(r,n,i){if(r instanceof c.A)return;const l=(0,u.A)(n).getMeasureUuid(i.measureIdx);r.push({type:"GlobalMeasureUpdate",noDraw:!0,opts:{measureUuid:l}})}},456075:(U,D,t)=>{t.d(D,{A:()=>u});var c=t(951066);class u extends c.A{constructor(n){const i=m(n);super(i),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"DuplicateStaffUuidError"}),Object.defineProperty(this,"staffUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.staffUuid=n}}const m=function(r){return`The staff uuid [${r}] appears twice in the options.`}},474015:(U,D,t)=>{t.d(D,{A:()=>u});var c=t(951066);class u extends c.A{constructor(n){const i=m(n);super(i),Object.defineProperty(this,"voiceUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="DuplicateVoiceUuidError",this.voiceUuid=n}}const m=function(r){return`The voice uuid [${r}] appears twice in the options.`}},495501:(U,D,t)=>{t.d(D,{A:()=>u});var c=t(951066);class u extends c.A{constructor(n,i){const f=m(n,i);super(f),Object.defineProperty(this,"MIDIUnpitched",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"MIDIProgram",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="NoMIDIUnpitchedProgramError",this.MIDIUnpitched=n,this.MIDIProgram=i}}const m=function(r,n){return`The MIDIUnpitched/MIDIProgram combination ${r}/${n} 
    is not is the part instruments.`}},536680:(U,D,t)=>{t.d(D,{A:()=>l});var c=t(351277),u=t(476943),m=t(123491),r=t(793317),n=t(418621);const i=function(I,a,d){this.init(I,a,d)};i.NAME="composite.RemoveChordLeftSlides";const f=i.prototype;f.name=i.NAME,f.initMeasureData=r.default,f.init=function(I,a,d){this.initMeasureData(I,a),this.opts=a,this.cancelStack=d},f.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.removeChordLeftSlides()},f.removeChordLeftSlides=function(){let a=this.measureData.getVoice(this.opts.voiceIdx).getChord(this.opts.noteIdx);a=u.default.makeArray(a),a.map(m.default.getPitch).forEach(this.removeHeadLeftSlides,this)},f.removeHeadLeftSlides=function(I){const a={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx,pitch:c.default.copyWithoutAlter(I)};new n.A(this.measureData,a,this.cancelStack).perform()};const l=i},576363:(U,D,t)=>{t.d(D,{A:()=>l});var c=t(351277),u=t(476943),m=t(123491),r=t(793317),n=t(825238);const i=function(I,a,d){this.init(I,a,d)};i.NAME="composite.RemoveChordLeftGlissandos";const f=i.prototype;f.name=i.NAME,f.initMeasureData=r.default,f.init=function(I,a,d){this.initMeasureData(I,a),this.opts=a,this.cancelStack=d},f.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.removeChordLeftGlissandos()},f.removeChordLeftGlissandos=function(){let a=this.measureData.getVoice(this.opts.voiceIdx).getChord(this.opts.noteIdx);a=u.default.makeArray(a),a.map(m.default.getPitch).forEach(this.removeHeadLeftGlissandos,this)},f.removeHeadLeftGlissandos=function(I){const a={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx,pitch:c.default.copyWithoutAlter(I)};new n.A(this.measureData,a,this.cancelStack).perform()};const l=i},589037:(U,D,t)=>{t.d(D,{A:()=>m});var c=t(951066);function u(){return"There must be at least one instrument."}class m extends c.A{constructor(){const n=u();super(n),this.name="NoPercuInstrumentsError"}}},592999:(U,D,t)=>{t.d(D,{A:()=>r});var c=t(607682);function u(n){return`There cannot be the same uuid for ${n} insertion and location.`}class m extends c.default{constructor(i,f){const l=u(f);super(l),Object.defineProperty(this,"uuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="UuidInconsistencyError",this.uuid=i,this.entity=f}}Object.defineProperty(m,"MEASURE",{enumerable:!0,configurable:!0,writable:!0,value:"measure"}),Object.defineProperty(m,"PART",{enumerable:!0,configurable:!0,writable:!0,value:"part"});const r=m},596237:(U,D,t)=>{t.d(D,{A:()=>I});var c=t(515819),u=t(346797),m=t(389603),r=t(909748);const n=function(a,d,v){this.init(a,d,v)};n.NAME="composite.RemoveTempoChangesFrom";const i=n.prototype;i.name=n.NAME,i.init=function(a,d,v){this.scoreData=a,this.cancelStack=v,this.opts=d,this.measure=null,this.limitQuarterPos=null},i.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.removeTempoChangesFrom()},i.removeTempoChangesFrom=function(){this.getTempoChangesStarts().forEach(this.removeTempoChange,this),this.getTempoChangesStops().forEach(this.removeTempoChange,this)},i.getTempoChangesStarts=function(){let a=this.getTempoChanges();return a=a.filter(f),a};const f=function(a){const d=u.A.getType(a);return r.A.isStart(d)};i.getTempoChangesStops=function(){let a=this.getTempoChanges();return a=a.filter(l),a};const l=function(a){return u.A.getType(a)===r.A.STOP};i.getTempoChanges=function(){let d=this.scoreData.getCommonContent().getTempoChanges(this.opts.measureIdx);return d=d.filter(this.isBeyoudLimit,this),d},i.isBeyoudLimit=function(a){const d=this.getLimitQuarterPos();return u.A.getQuarterPos(a)>=d},i.getLimitQuarterPos=function(){return this.limitQuarterPos===null&&(this.limitQuarterPos=c.default.divisionsToQuarter(this.opts.timePos,this.opts.dpq)),this.limitQuarterPos},i.removeTempoChange=function(a){const d=u.A.getTimePos(a),v=u.A.getDpq(a),x={measureIdx:this.opts.measureIdx,timePos:d,dpq:v};new m.default(this.scoreData,x,this.cancelStack).perform()};const I=n},601868:(U,D,t)=>{t.d(D,{A:()=>d});var c=t(951066);function u(v){return`The main voice idx [${v}] for the added staff is not in the inserted voices.`}class m extends c.A{constructor(x){const C=u(x);super(C),Object.defineProperty(this,"voiceIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadStaffMainVoiceError",this.voiceIdx=x}}var r=t(902763),n=t(607682);class i extends n.default{constructor(x){super(f(x)),Object.defineProperty(this,"voiceIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="VoiceIdxCollisionError",this.voiceIdx=x}}const f=function(v){return`There is already a voice with the index [${v}].`};var l=t(513318);const I=function(v,x,C){const b=x.voices,P=x.mainVoiceIdx,g={optsVoicesSet:C,currentVoicesSet:v};if(b.forEach(a,g),!b.includes(P))throw new m(P)},a=function(v){l.A.check(v);const x=this;if(typeof x.currentVoicesSet[v]!="undefined")throw new i(v);if(typeof x.optsVoicesSet[v]!="undefined")throw new r.A(v);x.optsVoicesSet[v]=!0},d=I},641815:(U,D,t)=>{t.d(D,{A:()=>m});var c=t(951066);function u(r){return`The MIDIUnpitched [${r}] in pitch mapping is not is the part instruments.`}class m extends c.A{constructor(n){const i=u(n);super(i),Object.defineProperty(this,"MIDIUnpitched",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="NoMIDIUnpitchedError",this.MIDIUnpitched=n}}},655469:(U,D,t)=>{t.d(D,{A:()=>zt});var c=t(518558),u=t(701387),m=t(515819),r=t(74446),n=t(853204),i=t(123491),f=t(726042),l=t(737296),I=t(901095),a=t(734677),d=t(793317);const v=function(e,s,o){this.init(e,s,o)};v.NAME="composite.IncreaseMeasureDuration";const x=v.prototype;x.initMeasureData=d.default,x.name=v.NAME,x.init=function(e,s,o){this.initMeasureData(e,s),this.cancelStack=o,this.opts=s,this.divsPerQuarterCoeff=null,this.divisionsToAdd=null},x.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.calcDivsPerQuarterRatio(),this.increaseDivisionsIfNeeded(),this.addVoicesRests()},x.calcDivsPerQuarterRatio=function(){const e=this.getDivsPerQuarter(),s=m.default.quarterToRequiredDivisions(this.opts.quarterDuration),o=this.measureData.getAnyTime(),R=c.default.getBeatType(o),B=m.default.beatTypeToQuarter(R),Q=m.default.quarterToRequiredDivisions(B);let z=f.default.lcm(e,s);z=f.default.lcm(z,Q),this.divsPerQuarterCoeff=z/e},x.increaseDivisionsIfNeeded=function(){this.needIncreaseDivisions()&&this.increaseDivisions()},x.needIncreaseDivisions=function(){return this.divsPerQuarterCoeff>1},x.increaseDivisions=function(){const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,coeff:this.divsPerQuarterCoeff};new a.A(this.measureData,e,this.cancelStack).perform()},x.addVoicesRests=function(){this.measureData.forEachVoice(this.addVoiceRests,this)},x.addVoiceRests=function(e,s){this.measureData.initTupletCacheWithVoice(s);const o=this.getDivisionsToAdd(),R=e.getNbNotes(),B=this.getStaffIdxForVoice(s),Q={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:s,staffIdx:B,noteIdx:R,insertMode:l.default.REPLACE,duration:o};new I.A(this.measureData,Q,this.cancelStack).perform()},x.getDivisionsToAdd=function(){if(this.divisionsToAdd===null){const e=this.getDivsPerQuarter();this.divisionsToAdd=m.default.quarterToDuration(this.opts.quarterDuration,e)}return this.divisionsToAdd},x.getDivsPerQuarter=function(){return this.measureData.getDivisionsPerQuarterValue()},x.getStaffIdxForVoice=function(e){const s=this.getVoice(e),o=s.getStopNoteIdx(),R=s.getNote(o);return i.default.getStaffIdx(R)},x.getVoice=function(e){return this.measureData.getVoice(e)};const C=v;var b=t(823722);const P=function(e,s,o){this.init(e,s,o)};P.NAME="composite.ReduceMeasureDuration";const g=P.prototype;g.initMeasureData=d.default,g.name=P.NAME,g.init=function(e,s,o){this.initMeasureData(e,s),this.cancelStack=o,this.opts=s,this.divsPerQuarterCoeff=null,this.divisions=null,this.timePos=null,this.divisionsToRemove=null},g.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.calcDivsPerQuarterRatio(),this.increaseDivisionsIfNeeded(),this.createTimePos(),this.removeVoicesRests()},g.calcDivsPerQuarterRatio=function(){const e=this.getDivsPerQuarter(),s=m.default.quarterToRequiredDivisions(this.opts.quarterDuration),o=this.measureData.getAnyTime(),R=c.default.getBeatType(o),B=m.default.beatTypeToQuarter(R),Q=m.default.quarterToRequiredDivisions(B);let z=f.default.lcm(e,s);z=f.default.lcm(z,Q),this.divsPerQuarterCoeff=z/e},g.increaseDivisionsIfNeeded=function(){this.needIncreaseDivisions()&&this.increaseDivisions()},g.needIncreaseDivisions=function(){return this.divsPerQuarterCoeff>1},g.increaseDivisions=function(){const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,coeff:this.divsPerQuarterCoeff};new a.A(this.measureData,e,this.cancelStack).perform()},g.createTimePos=function(){this.divisions=this.measureData.getDivisionsPerQuarterValue();const e=this.getMeasureDuration(),s=this.getDivisionsToRemove();this.timePos=e-s},g.getMeasureDuration=function(){const e=this.measureData.getAnyVoice(),s=e.size();let o=0;for(let R=0;R<s;R++){const B=e.getNote(R),Q=i.default.getDuration(B);o+=Q}return o},g.removeVoicesRests=function(){this.measureData.forEachVoice(this.removeVoiceRests,this)},g.removeVoiceRests=function(e,s){this.measureData.initTupletCacheWithVoice(s);const o=this.getDivisionsToRemove(),R={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:s,noteIdx:0,insertMode:l.default.INSERT,duration:o};new b.A(this.measureData,R,this.cancelStack).perform()},g.getDivisionsToRemove=function(){if(this.divisionsToRemove===null){const e=this.getDivsPerQuarter();this.divisionsToRemove=m.default.quarterToDuration(this.opts.quarterDuration,e)}return this.divisionsToRemove},g.getDivsPerQuarter=function(){return this.measureData.getDivisionsPerQuarterValue()},g.getVoice=function(e){return this.measureData.getVoice(e)};const O=P,w=function(e,s,o){this.init(e,s,o)};w.NAME="composite.UpdateMeasureDuration";const y=w.prototype;y.initMeasureData=d.default,y.name=w.NAME,y.init=function(e,s,o){this.initMeasureData(e,s),this.cancelStack=o,this.opts=s,this.quarterDiff=null},y.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.gatherQuarterDiff(),this.quarterDiff>0?this.increaseDuration():this.quarterDiff<0&&this.reduceDuration()},y.gatherQuarterDiff=function(){const e=this.getTimeQuarter(),s=this.getMeasureQuarter();this.quarterDiff=e-s},y.getTimeQuarter=function(){const e=this.measureData.getAnyTime();return m.default.timeToQuarter(e)},y.getMeasureQuarter=function(){const e=this.getDivsPerQuarter();let s=0;const o=this.getAnyVoice(),R=o.size();for(let Q=0;Q<R;Q++){const z=o.getNote(Q),Jt=i.default.getDuration(z);s+=Jt}return m.default.divisionsToQuarter(s,e)},y.getDivsPerQuarter=function(){return this.measureData.getDivisionsPerQuarterValue()},y.getAnyVoice=function(){return this.measureData.getAnyVoice()},y.increaseDuration=function(){const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,quarterDuration:this.quarterDiff};new C(this.measureData,e,this.cancelStack).perform()},y.reduceDuration=function(){const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,quarterDuration:-this.quarterDiff};new O(this.measureData,e,this.cancelStack).perform()};const N=w;var h=t(954361),p=t(852363);const M=function(e,s,o){this.init(e,s,o)};M.NAME="primitive.SetTimeSignature";const V=M.prototype;V.name=M.NAME,V.initMeasureData=d.default,V.init=function(e,s,o){this.initMeasureData(e,s),this.cancelStack=o,this.opts=s,this.previousTime=null},V.perform=function(){this.savePreviousTime(),this.setTimeSignature(),this.updateStack()},V.savePreviousTime=function(){const e=this.measureData.getAnyTime();this.previousTime=c.default.copy(e)},V.setTimeSignature=function(){const e=this.measureData.getTimes(),s=e.getNbStaves();for(let B=0;B<s;B++){const Q=c.default.copy(this.opts.timeSignature);e.setEntry(Q,B)}const o=e.dumpAttribute(),R=this.measureData.getMeasure();u.default.setTime(R,o)},V.updateStack=function(){const e=c.default.copy(this.previousTime),s=c.default.copy(this.opts.timeSignature),o={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,previousTimeSignature:e,newTimeSignature:s}};this.cancelStack.push(o),(0,p.default)(this.cancelStack,this.measureData,this.opts),this.opts.measureIdx>0&&(0,p.default)(this.cancelStack,this.measureData,{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx-1})};const H=M,X=function(e,s,o){this.init(e,s,o)};X.NAME="composite.SetTimeSignature";const W=X.prototype;W.initMeasureData=d.default,W.name=X.NAME,W.init=function(e,s,o){this.initMeasureData(e,s),this.cancelStack=o,this.opts=s},W.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.formatRests(),this.setTimeSignature(),this.updateMeasureDuration()},W.formatRests=function(){const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx};new h.A(this.measureData,e,this.cancelStack).perform()},W.setTimeSignature=function(){const e=c.default.copy(this.opts.timeSignature),s={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,timeSignature:e};new H(this.measureData,s,this.cancelStack).perform()},W.updateMeasureDuration=function(){const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx};new N(this.measureData,e,this.cancelStack).perform()};const L=X,Z=function(e,s,o){this.init(e,s,o)};Z.NAME="composite.SetTimeSignatureIfNeeded";const $=Z.prototype;$.initMeasureData=d.default,$.name=Z.NAME,$.init=function(e,s,o){this.initMeasureData(e,s),this.cancelStack=o,this.opts=s,this.previousTime=null},$.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.gatherPreviousTime(),this.needSetTime()&&this.setTime()},$.gatherPreviousTime=function(){const e=this.measureData.getAnyTime();this.previousTime=c.default.copy(e)},$.needSetTime=function(){return!c.default.isSame(this.opts.timeSignature,this.previousTime)},$.setTime=function(){const e=c.default.copy(this.opts.timeSignature),s={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,timeSignature:e};new L(this.measureData,s,this.cancelStack).perform()};const S=Z,A=function(e,s,o){this.init(e,s,o)};A.NAME="composite.SetMeasuresRangeTimeSignature";const E=A.prototype;E.name=A.NAME,E.init=function(e,s,o){this.scoreData=e,this.cancelStack=o,this.opts=s},E.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name);for(let e=this.opts.startMeasureIdx;e<=this.opts.stopMeasureIdx;e++)this.setMeasuresColumnTimeSignature(e)},E.setMeasuresColumnTimeSignature=function(e){const s=this.scoreData.getNbParts();for(let o=0;o<s;o++)this.setMeasureTimeSignature(o,e)},E.setMeasureTimeSignature=function(e,s){const o=c.default.copy(this.opts.timeSignature),R={partIdx:e,measureIdx:s,timeSignature:o};new S(this.scoreData,R,this.cancelStack).perform()};const J=A,j=function(e,s,o){this.init(e,s,o)};j.NAME="composite.SetMeasuresRangeDisplayedTime";const T=j.prototype;T.name=j.NAME,T.init=function(e,s,o){this.scoreData=e,this.cancelStack=o,this.opts=s},T.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name);for(let e=this.opts.startMeasureIdx;e<=this.opts.stopMeasureIdx;e++)this.setMeasureDisplayedTime(e)},T.setMeasureDisplayedTime=function(e){const s=c.default.copy(this.opts.displayedTime);this.scoreData.getCommonContent().setDisplayedTime(e,s)};const _=j,k=function(e,s,o){this.init(e,s,o)};k.NAME="composite.SetMeasuresRangeBeatsList";const K=k.prototype;K.name=k.NAME,K.init=function(e,s,o){this.scoreData=e,this.cancelStack=o,this.opts=s},K.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name);for(let e=this.opts.startMeasureIdx;e<=this.opts.stopMeasureIdx;e++)this.setMeasureBeatsList(e),this.updateStack(e)},K.setMeasureBeatsList=function(e){const s=r.default.copy(this.opts.beatsList);this.scoreData.getCommonContent().setBeatsList(e,s)},K.updateStack=function(e){const s=this.scoreData.getNbParts();for(let o=0;o<s;o++)this.cancelStack.push({type:this.name,opts:{partIdx:o,measureIdx:e}}),(0,p.default)(this.cancelStack,this.scoreData,{partIdx:o,measureIdx:e})};const Y=k;class et{constructor(s,o,R){this.name=et.NAME,this.scoreData=s,this.cancelStack=R,this.opts=o}perform(){this.cancelStack=this.cancelStack.createSubstack(this.name);for(let s=this.opts.startMeasureIdx;s<=this.opts.stopMeasureIdx;s++)this.setMeasureRestsInsideBeams(s),this.updateStack(s)}setMeasureRestsInsideBeams(s){const o=this.opts.restsInsideBeams;this.scoreData.getCommonContent().setRestsInsideBeams(s,o)}updateStack(s){const o=this.scoreData.getNbParts();for(let R=0;R<o;R++)this.cancelStack.push({type:this.name,opts:{partIdx:R,measureIdx:s}}),(0,p.default)(this.cancelStack,this.scoreData,{partIdx:R,measureIdx:s})}}Object.defineProperty(et,"NAME",{enumerable:!0,configurable:!0,writable:!0,value:"composite.SetMeasuresRangeRestsInsideBeams"});const Dt=et;var tt=t(324318),gt=t(369672);const rt=function(e,s,o){this.init(e,s,o)};rt.NAME="composite.RemoveMeasureTupletsAfter";const st=rt.prototype;st.initMeasureData=d.default,st.name=rt.NAME,st.init=function(e,s,o){this.initMeasureData(e,s),this.cancelStack=o,this.opts=s},st.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.removeVoicesTuplets()},st.removeVoicesTuplets=function(){this.measureData.forEachVoice(this.removeVoiceTuplets,this)},st.removeVoiceTuplets=function(e,s){const o={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:s,timePos:this.opts.timePos,divisions:this.opts.divisions};new gt.A(this.measureData,o,this.cancelStack).perform()};const xt=rt;var Mt=t(143146);const ct=function(e,s,o){this.init(e,s,o)};ct.NAME="composite.RemoveMeasureNotesAfter";const ot=ct.prototype;ot.initMeasureData=d.default,ot.name=ct.NAME,ot.init=function(e,s,o){this.initMeasureData(e,s),this.cancelStack=o,this.opts=s},ot.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.removeVoicesNotes()},ot.removeVoicesNotes=function(){this.measureData.forEachVoice(this.removeVoiceNotes,this)},ot.removeVoiceNotes=function(e,s){const o={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:s,timePos:this.opts.timePos,divisions:this.opts.divisions};new Mt.A(this.measureData,o,this.cancelStack).perform()};const Tt=ct;var St=t(59633),Pt=t(737202),Et=t(18935),At=t(377706),Ct=t(406765),_t=t(827303),Rt=t(731725),yt=t(928025),Ot=t(701932),Ut=t(777501),Nt=t(557830),kt=t(447770),Lt=t(596237);const ut=function(e,s,o){this.init(e,s,o)};ut.NAME="composite.RemoveMeasureRightContent";const F=ut.prototype;F.initMeasureData=d.default,F.name=ut.NAME,F.init=function(e,s,o){this.initMeasureData(e,s),this.cancelStack=o,this.opts=s,this.divsPerQuarterCoeff=null,this.divisions=null,this.timePos=null,this.divisionsToRemove=null},F.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.calcDivsPerQuarterRatio(),this.increaseDivisionsIfNeeded(),this.createTimePos(),this.removeHarmoniesFrom(),this.removeClassicHarmoniesFrom(),this.removeFiguredBassesFrom(),this.removeWedgesFrom(),this.removePluckedRangesFrom(),this.removeDynamicsFrom(),this.removePizzicatosFrom(),this.removeMutesFrom(),this.removeWordsFrom(),this.removeMiddleClefsFrom(),this.removePedalsFrom(),this.removeTempoChangesFrom(),this.removeOctaveShiftsFrom(),this.removeTupletsAfter(),this.removeNotesAfter()},F.calcDivsPerQuarterRatio=function(){const e=this.getDivsPerQuarter(),s=m.default.quarterToRequiredDivisions(this.opts.quarterDuration),o=this.measureData.getAnyTime(),R=c.default.getBeatType(o),B=m.default.beatTypeToQuarter(R),Q=m.default.quarterToRequiredDivisions(B);let z=f.default.lcm(e,s);z=f.default.lcm(z,Q),this.divsPerQuarterCoeff=z/e},F.increaseDivisionsIfNeeded=function(){this.needIncreaseDivisions()&&this.increaseDivisions()},F.needIncreaseDivisions=function(){return this.divsPerQuarterCoeff>1},F.increaseDivisions=function(){const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,coeff:this.divsPerQuarterCoeff};new a.A(this.measureData,e,this.cancelStack).perform()},F.createTimePos=function(){this.divisions=this.measureData.getDivisionsPerQuarterValue();const e=this.getMeasureDuration(),s=this.getDivisionsToRemove();this.timePos=e-s},F.getMeasureDuration=function(){const e=this.measureData.getAnyVoice(),s=e.size();let o=0;for(let R=0;R<s;R++){const B=e.getNote(R),Q=i.default.getDuration(B);o+=Q}return o},F.removeHarmoniesFrom=function(){const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,timePos:this.timePos,dpq:this.divisions},s=this.measureData.scoreData;new St.A(s,e,this.cancelStack).perform()},F.removeClassicHarmoniesFrom=function(){const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,timePos:this.timePos,dpq:this.divisions},s=this.measureData.scoreData;new Et.A(s,e,this.cancelStack).perform()},F.removeFiguredBassesFrom=function(){const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,timePos:this.timePos,dpq:this.divisions},s=this.measureData.scoreData;new Pt.A(s,e,this.cancelStack).perform()},F.removeWedgesFrom=function(){const e=this.measureData.getNbStaves();for(let s=0;s<e;s++){const o={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:s,timePos:this.timePos,dpq:this.divisions},R=this.measureData.scoreData;new At.A(R,o,this.cancelStack).perform()}},F.removePluckedRangesFrom=function(){const e=this.measureData.getNbStaves();for(let s=0;s<e;s++){const o={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:s,timePos:this.timePos,dpq:this.divisions},R=this.measureData.scoreData;new Ct.A(R,o,this.cancelStack).perform()}},F.removeDynamicsFrom=function(){const e=this.measureData.getNbStaves();for(let s=0;s<e;s++){const o={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:s,timePos:this.timePos,dpq:this.divisions},R=this.measureData.scoreData;new _t.A(R,o,this.cancelStack).perform()}},F.removePizzicatosFrom=function(){const e=this.measureData.getNbStaves();for(let s=0;s<e;s++){const o={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:s,timePos:this.timePos,dpq:this.divisions},R=this.measureData.scoreData;new Rt.A(R,o,this.cancelStack).perform()}},F.removeMutesFrom=function(){const e=this.measureData.getNbStaves();for(let s=0;s<e;s++){const o={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:s,timePos:this.timePos,dpq:this.divisions},R=this.measureData.scoreData;new yt.A(R,o,this.cancelStack).perform()}},F.removeWordsFrom=function(){const e=this.measureData.getNbStaves();for(let s=0;s<e;s++){const o={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:s,timePos:this.timePos,dpq:this.divisions},R=this.measureData.scoreData;new Ot.A(R,o,this.cancelStack).perform()}},F.removeMiddleClefsFrom=function(){const e=this.measureData.getNbStaves();for(let s=0;s<e;s++){const o={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:s,timePos:this.timePos,dpq:this.divisions},R=this.measureData.scoreData;new Ut.A(R,o,this.cancelStack).perform()}},F.removePedalsFrom=function(){const e=this.measureData.getNbStaves();for(let s=0;s<e;s++){const o={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:s,timePos:this.timePos,dpq:this.divisions},R=this.measureData.scoreData;new Nt.A(R,o,this.cancelStack).perform()}},F.removeTempoChangesFrom=function(){const e={measureIdx:this.opts.measureIdx,timePos:this.timePos,dpq:this.divisions},s=this.measureData.scoreData;new Lt.A(s,e,this.cancelStack).perform()},F.removeOctaveShiftsFrom=function(){const e=this.measureData.getNbStaves();for(let s=0;s<e;s++){const o={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:s,timePos:this.timePos,dpq:this.divisions},R=this.measureData.scoreData;new kt.A(R,o,this.cancelStack).perform()}},F.removeTupletsAfter=function(){const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,divisions:this.divisions,timePos:this.timePos};new xt(this.measureData,e,this.cancelStack).perform()},F.removeNotesAfter=function(){const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,divisions:this.divisions,timePos:this.timePos};new Tt(this.measureData,e,this.cancelStack).perform()},F.getDivisionsToRemove=function(){if(this.divisionsToRemove===null){const e=this.getDivsPerQuarter();this.divisionsToRemove=m.default.quarterToDuration(this.opts.quarterDuration,e)}return this.divisionsToRemove},F.getDivsPerQuarter=function(){return this.measureData.getDivisionsPerQuarterValue()},F.getVoice=function(e){return this.measureData.getVoice(e)};const Bt=ut,dt=function(e,s,o){this.init(e,s,o)};dt.NAME="composite.RemoveMeasuresRangeRightContent";const it=dt.prototype;it.name=dt.NAME,it.init=function(e,s,o){this.scoreData=e,this.cancelStack=o,this.opts=s},it.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name);for(let e=this.opts.startMeasureIdx;e<=this.opts.stopMeasureIdx;e++)this.removeMeasureColumnRightContent(e)},it.removeMeasureColumnRightContent=function(e){const s=this.scoreData.getNbParts();for(let o=0;o<s;o++)this.removeMeasureRightContent(o,e)},it.removeMeasureRightContent=function(e,s){const o={partIdx:e,measureIdx:s,quarterDuration:this.opts.quarterDuration};new Bt(this.scoreData,o,this.cancelStack).perform()};const bt=dt;var Vt=t(476943),Ft=t(414208),wt=t(846541),Wt=t(705967),jt=t(704588),Kt=t(487332),Qt=t(805396),at=t(519405);const mt=function(e,s,o){this.init(e,s,o)};mt.NAME="composite.RemoveMeasureVoiceRightConnections";const q=mt.prototype;q.initMeasureData=d.default,q.name=mt.NAME,q.init=function(e,s,o){this.initMeasureData(e,s),this.cancelStack=o,this.opts=s,this.chord=null,this.note=null,this.noteIdx=null},q.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name);const e=this.measureData.getVoice(this.opts.voiceIdx);if(this.noteIdx=e.getNbNotes()-1,e.isRest(this.noteIdx))return;const s=e.getChord(this.noteIdx);this.chord=Vt.default.makeArray(s),this.note=e.getNote(this.noteIdx),this.tryRemoveTie(),this.tryRemoveGlissando(),this.tryRemoveSlide(),this.tryRemoveHammerOnPullOff(),this.tryRemoveTremolo2()},q.tryRemoveTie=function(){if(!this.chord.some(i.default.hasTieStart))return;const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.noteIdx},s=this.measureData.isUnpitched()?wt.default:Ft.default,o=new s(this.measureData,e,this.cancelStack);(0,at.default)(o)},q.tryRemoveGlissando=function(){if(!this.chord.some(i.default.hasGlissandoStart))return;const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.noteIdx},s=new Wt.default(this.measureData,e,this.cancelStack);(0,at.default)(s)},q.tryRemoveSlide=function(){if(!this.chord.some(i.default.hasSlideStart))return;const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.noteIdx},s=new jt.default(this.measureData,e,this.cancelStack);(0,at.default)(s)},q.tryRemoveHammerOnPullOff=function(){if(!this.chord.some(i.default.hasHammerOnPullOffStart))return;const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.noteIdx},s=new Kt.default(this.measureData,e,this.cancelStack);(0,at.default)(s)},q.tryRemoveTremolo2=function(){if(!i.default.hasTremoloStart(this.note))return;const e={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.noteIdx},s=new Qt.default(this.measureData,e,this.cancelStack);(0,at.default)(s)};const Ht=mt,ht=function(e,s,o){this.init(e,s,o)};ht.NAME="composite.RemoveMeasureRightConnections";const nt=ht.prototype;nt.initMeasureData=d.default,nt.name=ht.NAME,nt.init=function(e,s,o){this.initMeasureData(e,s),this.cancelStack=o,this.opts=s},nt.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.measureData.getVoicesIndexes().forEach(this.removeVoiceRightConnections,this)},nt.removeVoiceRightConnections=function(e){const s={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:e};new Ht(this.measureData,s,this.cancelStack).perform()};const Gt=ht,pt=function(e,s,o){this.init(e,s,o)};pt.NAME="composite.RemoveMeasureColumnRightConnections";const lt=pt.prototype;lt.name=pt.NAME,lt.init=function(e,s,o){this.scoreData=e,this.cancelStack=o,this.opts=s},lt.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name);const e=this.scoreData.getNbParts();for(let s=0;s<e;s++)this.removeMeasureRightConnections(s)},lt.removeMeasureRightConnections=function(e){const s={partIdx:e,measureIdx:this.opts.measureIdx};new Gt(this.scoreData,s,this.cancelStack).perform()};const $t=pt,ft=function(e,s,o){this.init(e,s,o)};ft.NAME="composite.RemoveMeasuresRangeRightConnections";const It=ft.prototype;It.name=ft.NAME,It.init=function(e,s,o){this.scoreData=e,this.cancelStack=o,this.opts=s},It.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name);for(let e=this.opts.startMeasureIdx;e<=this.opts.stopMeasureIdx;e++)this.removeMeasureColumnRightContent(e)},It.removeMeasureColumnRightContent=function(e){const s={measureIdx:e};new $t(this.scoreData,s,this.cancelStack).perform()};const Xt=ft,vt=function(e,s,o){this.init(e,s,o)};vt.NAME="composite.SetTimeSegment";const G=vt.prototype;G.name=vt.NAME,G.init=function(e,s,o){this.scoreData=e,this.cancelStack=o,this.opts=s},G.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.removeMeasureRepeats(),this.removeContentIfNeeded(),this.setTimeIfNeeded(),this.setDisplayedTimeIfNeeded(),this.setBeatsListIfNeeded(),this.setRestsInsideBeamsIfNeeded()},G.removeContentIfNeeded=function(){const e=this.scoreData.getMeasure(0,this.opts.startMeasureIdx),s=u.default.getAnyTime(e),o=m.default.timeToQuarter(s),R=m.default.timeToQuarter(this.opts.timeSignature),B=o-R;if(B>0){const Q={startMeasureIdx:this.opts.startMeasureIdx,stopMeasureIdx:this.opts.stopMeasureIdx,quarterDuration:B};new bt(this.scoreData,Q,this.cancelStack).perform()}else if(B<0){const Q={startMeasureIdx:this.opts.startMeasureIdx,stopMeasureIdx:this.opts.stopMeasureIdx};new Xt(this.scoreData,Q,this.cancelStack).perform()}},G.setTimeIfNeeded=function(){this.needSetTime()&&this.setTime()},G.needSetTime=function(){const e=this.scoreData.getMeasure(0,this.opts.startMeasureIdx),s=u.default.getAnyTime(e);return!c.default.isSame(s,this.opts.timeSignature)},G.setTime=function(){const e=c.default.copy(this.opts.timeSignature),s={startMeasureIdx:this.opts.startMeasureIdx,stopMeasureIdx:this.opts.stopMeasureIdx,timeSignature:e};new J(this.scoreData,s,this.cancelStack).perform()},G.setDisplayedTimeIfNeeded=function(){this.needSetDisplayedTime()&&(this.setDisplayedTime(),this.updateOwnTime())},G.needSetDisplayedTime=function(){const s=this.scoreData.getCommonContent().getDisplayedTime(this.opts.startMeasureIdx);return!c.default.isSame(s,this.opts.displayedTime)},G.setDisplayedTime=function(){const e=c.default.copy(this.opts.displayedTime),s={startMeasureIdx:this.opts.startMeasureIdx,stopMeasureIdx:this.opts.stopMeasureIdx,displayedTime:e};new _(this.scoreData,s,this.cancelStack).perform()},G.setBeatsListIfNeeded=function(){this.needSetBeatsList()&&this.setBeatsList()},G.needSetBeatsList=function(){const s=this.scoreData.getCommonContent().getBeatsList(this.opts.startMeasureIdx);return!c.default.isSame(s,this.opts.beatsList)},G.setBeatsList=function(){const e=r.default.copy(this.opts.beatsList),s={startMeasureIdx:this.opts.startMeasureIdx,stopMeasureIdx:this.opts.stopMeasureIdx,beatsList:e};new Y(this.scoreData,s,this.cancelStack).perform()},G.setRestsInsideBeamsIfNeeded=function(){this.needSetRestsInsideBeams()&&this.setRestsInsideBeams()},G.needSetRestsInsideBeams=function(){return this.scoreData.getCommonContent().hasRestsInsideBeams(this.opts.startMeasureIdx)!==this.opts.restsInsideBeams},G.setRestsInsideBeams=function(){const e=this.opts.restsInsideBeams,s={startMeasureIdx:this.opts.startMeasureIdx,stopMeasureIdx:this.opts.stopMeasureIdx,restsInsideBeams:e};new Dt(this.scoreData,s,this.cancelStack).perform()},G.updateOwnTime=function(){const e={startMeasureIdx:this.opts.startMeasureIdx,stopMeasureIdx:this.opts.stopMeasureIdx};new n.A(this.scoreData,e,this.cancelStack).perform()},G.removeMeasureRepeats=function(){this.opts.startMeasureIdx>0&&this.removeStartMeasureRepeats();const e=this.scoreData.getNbMeasures();this.opts.stopMeasureIdx+1<e&&this.removeNextMeasureRepeats()},G.removeStartMeasureRepeats=function(){const e={measureIdx:this.opts.startMeasureIdx};new tt.A(this.scoreData,e,this.cancelStack).perform()},G.removeNextMeasureRepeats=function(){const e={measureIdx:this.opts.stopMeasureIdx+1};new tt.A(this.scoreData,e,this.cancelStack).perform()};const zt=vt},671863:(U,D,t)=>{t.d(D,{A:()=>j});var c=t(476943),u=t(701387),m=t(351277),r=t(123491),n=t(50060),i=t(349386),f=t(737903),l=t(209175),I=t(762691),a=t(793317),d=t(852363);const v=function(T,_,k){this.init(T,_,k)};v.NAME="primitive.AddSingleNote";const x=v.prototype;x.name=v.NAME,x.initMeasureData=a.default,x.init=function(T,_,k){this.initMeasureData(T,_),this.cancelStack=k,this.opts=_},x.perform=function(){const T=this.getVoice(),_=this.createNote(T);T.insertNote(_,this.opts.noteIdx),this.updateStack()},x.getVoice=function(){const T=this.opts.voiceIdx,_=this.opts.noteIdx;return this.measureData.getVoiceOrTupletForInsert(T,_)},x.createNote=function(T){const _=l.default.copy(T.getAbsoluteTimeModif()),k=this.getDuration(),K=m.default.copy(this.opts.pitch),Y={};if(r.default.setStaffIdx(Y,this.opts.staffIdx),r.default.setVoiceIdx(Y,this.opts.voiceIdx),r.default.setDuration(Y,k),r.default.setPitch(Y,K),r.default.setNbDots(Y,this.opts.nbDots),r.default.setTimeModif(Y,_),this.opts.accidental!==null&&r.default.setAccidental(Y,this.opts.accidental),this.cancelStack.hasPayload()){const Dt=this.cancelStack.getPayload();let tt=(0,f.default)(Dt.headCssClassesSet);I.default.setHeadCssClassesSet(Y,tt),tt=(0,f.default)(tt),I.default.setGlobalCssClassesSet(Y,tt)}const et=T.getRangeSpace(0,this.opts.noteIdx);return r.default.setTimePos(Y,et),Y},x.getDuration=function(){const T=this.measureData.getDivisionsPerQuarterValue(),k=this.getVoice().getAbsoluteTimeModif();return(0,i.default)(this.opts,T,k)},x.updateStack=function(){const T={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,noteIdx:this.opts.noteIdx,voiceIdx:this.opts.voiceIdx,staffIdx:this.opts.staffIdx,durationType:this.opts.durationType,nbDots:this.opts.nbDots,pitch:m.default.copy(this.opts.pitch),accidental:this.opts.accidental},_={type:this.name,opts:T};this.cancelStack.push(_),(0,d.default)(this.cancelStack,this.measureData,this.opts)};const C=v;var b=t(414208),P=t(576363),g=t(536680),O=t(30335),w=t(298009),y=t(516e3),N=t(3771),h=t(765350),p=t(272980),M=t(823722),V=t(145170),H=t(645166),X=t(726271),W=t(737296),L=t(534512),Z=t(519405),$=t(379668),S=t(257818);const A=function(T,_,k){this.init(T,_,k)};A.NAME="composite.AddSingleNote";const E=A.prototype;E.name=A.NAME,E.initMeasureData=a.default,E.init=function(T,_,k){this.initMeasureData(T,_),this.cancelStack=k,this.opts=_},E.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.opts.insertMode===W.default.INSERT&&this.opts.noteIdx>0&&this.breakConnection(),this.removeMeasureRepeat(),this.removeMmr(),this.adaptDpqToNoteDuration(),this.adaptDpqToTimeSignature(),this.adaptDpqToTuplet();const T=this.getFormerContent();this.unlockRests(),this.addSingleNote(),this.consumeSpace(),this.updateAccidental(),this.isTabStaff()&&this.setFretAction();const _=this.measureData.getVoice(this.opts.voiceIdx);(0,S.A)(_,this.opts.noteIdx+1),this.opts.keepFormer&&this.restoreFormerContent(T)},E.breakConnection=function(){this.removeTie(),this.measureData.clearTupletCache(this.opts.voiceIdx),this.removeChordLeftGlissandos(),this.removeChordLeftSlides(),this.removeEdgeHammerOnPullOffs()},E.removeTie=function(){let _=this.measureData.getVoice(this.opts.voiceIdx).getChord(this.opts.noteIdx);if(_=c.default.makeArray(_),!_.some(r.default.hasTieStop))return;const k={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx-1},K=new b.default(this.measureData,k,this.cancelStack);(0,Z.default)(K)},E.removeChordLeftSlides=function(){if(!this.measureData.getVoice(this.opts.voiceIdx).isRest(this.opts.noteIdx)){const _={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx};new g.A(this.measureData,_,this.cancelStack).perform()}},E.removeChordLeftGlissandos=function(){if(!this.measureData.getVoice(this.opts.voiceIdx).isRest(this.opts.noteIdx)){const _={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx};new P.A(this.measureData,_,this.cancelStack).perform()}},E.removeEdgeHammerOnPullOffs=function(){const T={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx,pitch:m.default.copy(this.opts.pitch)};new O.default(this.measureData,T,this.cancelStack).performIfPossible()},E.removeMeasureRepeat=function(){const T=this.measureData.getMeasure();if(!u.default.hasMeasureRepeat(T,this.opts.staffIdx))return;const _={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:this.opts.staffIdx},k=this.measureData.getScoreData(),K=new X.default(k,_,this.cancelStack);(0,Z.default)(K)},E.removeMmr=function(){(0,$.A)(this.measureData,this.opts,this.cancelStack)},E.adaptDpqToNoteDuration=function(){const _=this.getVoice().getAbsoluteTimeModif(),k={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,durationType:this.opts.durationType,nbDots:this.opts.nbDots,timeModif:_};new N.A(this.measureData,k,this.cancelStack).perform()},E.adaptDpqToTimeSignature=function(){const T={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx};new h.A(this.measureData,T,this.cancelStack).perform()},E.adaptDpqToTuplet=function(){const T={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx};new p.A(this.measureData,T,this.cancelStack).perform()},E.getFormerContent=function(){const T={};return T.lyrics=this.getLyrics(),T},E.getLyrics=function(){const _=this.getVoice().getNote(this.opts.noteIdx);return r.default.getLyrics(_).map(J)};const J=function(T){const _=n.default.getLevel(T);if(n.default.hasLeftMelisma(T))return{level:_,isMelisma:!0};const k=n.default.getText(T),K=n.default.hasRightConnection(T);return{lyric:k,hasRightConnection:K,level:_}};E.getVoice=function(){const T=this.opts.voiceIdx,_=this.opts.noteIdx;return this.measureData.getVoiceOrTupletForGet(T,_)},E.unlockRests=function(){const T=this.getDuration(),_={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx,insertMode:this.opts.insertMode,duration:T};new V.A(this.measureData,_,this.cancelStack).perform()},E.addSingleNote=function(){const T={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,staffIdx:this.opts.staffIdx,noteIdx:this.opts.noteIdx,durationType:this.opts.durationType,nbDots:this.opts.nbDots,pitch:m.default.copy(this.opts.pitch),accidental:null};new C(this.measureData,T,this.cancelStack).perform()},E.consumeSpace=function(){const T=this.getDuration(),_={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx+1,insertMode:this.opts.insertMode,duration:T};new M.A(this.measureData,_,this.cancelStack).perform()},E.getDuration=function(){const T=this.measureData.getDivisionsPerQuarterValue(),_=this.opts.voiceIdx,k=this.opts.noteIdx,Y=this.measureData.getVoiceOrTupletForGet(_,k).getAbsoluteTimeModif();return(0,i.default)(this.opts,T,Y)},E.updateAccidental=function(){const T={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,staffIdx:this.opts.staffIdx,noteIdx:this.opts.noteIdx,pitch:m.default.copy(this.opts.pitch)};new H.A(this.measureData,T,this.cancelStack).perform()},E.restoreFormerContent=function(T){this.restoreLyrics(T.lyrics)},E.restoreLyrics=function(T){T.forEach(this.restoreLyric,this)},E.restoreLyric=function(T){const _={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx,lyric:T.lyric,hasRightConnection:T.hasRightConnection,level:T.level,isMelisma:T.isMelisma},k=new y.default(this.measureData,_,this.cancelStack);(0,Z.default)(k)},E.isTabStaff=function(){return(0,L.default)(this.measureData,this.opts)},E.setFretAction=function(){const T={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,staffIdx:this.opts.staffIdx,noteIdx:this.opts.noteIdx,pitch:m.default.copy(this.opts.pitch),fretData:this.opts.fretData,sameStringAsPreviousNotes:this.opts.sameStringAsPreviousNotes};new w.default(this.measureData,T,this.cancelStack).performIfPossible()};const j=A},676611:(U,D,t)=>{t.d(D,{A:()=>$});var c=t(737903),u=t(476943),m=t(701387),r=t(123491),n=t(50060),i=t(292681),f=t(209175),l=t(762691),I=t(349386),a=t(343667),d=t(793317),v=t(852363);const x=function(S,A,E){this.init(S,A,E)};x.NAME="primitive.AddSingleNotePercu";const C=x.prototype;C.name=x.NAME,C.initMeasureData=d.default,C.init=function(S,A,E){this.initMeasureData(S,A),this.cancelStack=E,this.opts=A},C.perform=function(){const S=this.getVoice(),A=this.createNote(S);S.insertNote(A,this.opts.noteIdx),this.updateStack()},C.getVoice=function(){const S=this.opts.voiceIdx,A=this.opts.noteIdx;return this.measureData.getVoiceOrTupletForInsert(S,A)},C.createNote=function(S){const A=this.getDuration(),E=f.default.copy(S.getAbsoluteTimeModif()),J=i.default.copy(this.opts.unpitched),j={};r.default.setStaffIdx(j,this.opts.staffIdx),r.default.setVoiceIdx(j,this.opts.voiceIdx),r.default.setDuration(j,A),r.default.setUnpitched(j,J),r.default.setHead(j,this.opts.notehead),r.default.setNbDots(j,this.opts.nbDots),r.default.setTimeModif(j,E);const T=this.getInstrumentId();if(r.default.setInstrumentId(j,T),this.cancelStack.hasPayload()){const k=this.cancelStack.getPayload();let K=(0,c.default)(k.headCssClassesSet);l.default.setHeadCssClassesSet(j,K),K=(0,c.default)(K),l.default.setGlobalCssClassesSet(j,K)}const _=S.getRangeSpace(0,this.opts.noteIdx);return r.default.setTimePos(j,_),j},C.getInstrumentId=function(){return(0,a.A)(this.measureData,this.opts.partIdx,this.opts.unpitched,this.opts.notehead)},C.getDuration=function(){const S=this.measureData.getDivisionsPerQuarterValue(),E=this.getVoice().getAbsoluteTimeModif();return(0,I.default)(this.opts,S,E)},C.updateStack=function(){const S={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,noteIdx:this.opts.noteIdx,voiceIdx:this.opts.voiceIdx,staffIdx:this.opts.staffIdx,durationType:this.opts.durationType,nbDots:this.opts.nbDots,unpitched:i.default.copy(this.opts.unpitched),notehead:this.opts.notehead}};this.cancelStack.push(S),(0,v.default)(this.cancelStack,this.measureData,this.opts)};const b=x;var P=t(823722),g=t(145170),O=t(3771),w=t(765350),y=t(272980),N=t(726271),h=t(846541),p=t(516e3),M=t(519405),V=t(379668),H=t(257818),X=t(737296);const W=function(S,A,E){this.init(S,A,E)};W.NAME="composite.AddSingleNotePercu";const L=W.prototype;L.name=W.NAME,L.initMeasureData=d.default,L.init=function(S,A,E){this.initMeasureData(S,A),this.cancelStack=E,this.opts=A},L.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.opts.insertMode===X.default.INSERT&&this.opts.noteIdx>0&&this.breakConnection(),this.removeMeasureRepeat(),this.removeMmr(),this.adaptDpqToNoteDuration(),this.adaptDpqToTimeSignature(),this.adaptDpqToTuplet();const S=this.getFormerContent();this.unlockRests(),this.consumeRests(),this.addNote();const A=this.measureData.getVoice(this.opts.voiceIdx);(0,H.A)(A,this.opts.noteIdx+1),this.opts.keepFormer&&this.restoreFormerContent(S)},L.breakConnection=function(){this.removeTie()},L.removeTie=function(){let A=this.measureData.getVoice(this.opts.voiceIdx).getChord(this.opts.noteIdx);if(A=u.default.makeArray(A),!A.some(r.default.hasTieStop))return;const E={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx-1},J=new h.default(this.measureData,E,this.cancelStack);(0,M.default)(J)},L.removeMeasureRepeat=function(){const S=this.measureData.getMeasure();if(!m.default.hasMeasureRepeat(S,this.opts.staffIdx))return;const A={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:this.opts.staffIdx},E=this.measureData.getScoreData(),J=new N.default(E,A,this.cancelStack);(0,M.default)(J)},L.removeMmr=function(){(0,V.A)(this.measureData,this.opts,this.cancelStack)},L.adaptDpqToNoteDuration=function(){const A=this.getVoice().getAbsoluteTimeModif(),E={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,durationType:this.opts.durationType,nbDots:this.opts.nbDots,timeModif:A};new O.A(this.measureData,E,this.cancelStack).perform()},L.adaptDpqToTimeSignature=function(){const S={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx};new w.A(this.measureData,S,this.cancelStack).perform()},L.adaptDpqToTuplet=function(){const S={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx};new y.A(this.measureData,S,this.cancelStack).perform()},L.getFormerContent=function(){const S={};return S.lyrics=this.getLyrics(),S},L.getLyrics=function(){const A=this.getVoice().getNote(this.opts.noteIdx);return r.default.getLyrics(A).map(Z)};const Z=function(S){const A=n.default.getLevel(S);if(n.default.hasLeftMelisma(S))return{level:A,isMelisma:!0};const E=n.default.getText(S),J=n.default.hasRightConnection(S);return{lyric:E,hasRightConnection:J,level:A}};L.getVoice=function(){const S=this.opts.voiceIdx,A=this.opts.noteIdx;return this.measureData.getVoiceOrTupletForGet(S,A)},L.unlockRests=function(){const S=this.getDuration(),A={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx,insertMode:this.opts.insertMode,duration:S};new g.A(this.measureData,A,this.cancelStack).perform()},L.consumeRests=function(){const S=this.getDuration(),A=(0,c.default)(this.opts);A.duration=S,new P.A(this.measureData,A,this.cancelStack).perform()},L.getDuration=function(){const S=this.measureData.getDivisionsPerQuarterValue(),A=this.opts.voiceIdx,E=this.opts.noteIdx,j=this.measureData.getVoiceOrTupletForGet(A,E).getAbsoluteTimeModif();return(0,I.default)(this.opts,S,j)},L.addNote=function(){const S=(0,c.default)(this.opts);new b(this.measureData,S,this.cancelStack).perform()},L.restoreFormerContent=function(S){this.restoreLyrics(S.lyrics)},L.restoreLyrics=function(S){S.forEach(this.restoreLyric,this)},L.restoreLyric=function(S){const A={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:this.opts.noteIdx,lyric:S.lyric,hasRightConnection:S.hasRightConnection,level:S.level,isMelisma:S.isMelisma},E=new p.default(this.measureData,A,this.cancelStack);(0,M.default)(E)};const $=W},713360:(U,D,t)=>{t.d(D,{A:()=>u});var c=t(183957);const u=c.A},715152:(U,D,t)=>{t.d(D,{A:()=>f});var c=t(123491),u=t(793317),m=t(364842),r=t(852363);const n=function(l,I,a){this.init(l,I,a)};n.NAME="primitive.AddColorToRest";const i=n.prototype;i.name=n.NAME,i.initMeasureData=u.default,i.init=function(l,I,a){this.initMeasureData(l,I),this.cancelStack=a,this.opts=I},i.perform=function(){const I=this.measureData.getVoice(this.opts.voiceIdx).getNote(this.opts.noteIdx);if(!c.default.isRest(I))throw new m.default("RestExpected");c.default.setColor(I,this.opts.color),this.updateStack()},i.updateStack=function(){const l={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx}};this.cancelStack.push(l),(0,r.default)(this.cancelStack,this.measureData,this.opts)};const f=n},737202:(U,D,t)=>{t.d(D,{A:()=>f});var c=t(701387),u=t(589501),m=t(886723),r=t(316610);const n=function(l,I,a){this.init(l,I,a)};n.NAME="composite.RemoveFiguredBassesFrom";const i=n.prototype;i.name=n.NAME,i.init=function(l,I,a){this.scoreData=l,this.cancelStack=a,this.opts=I,this.measure=null},i.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.removeFiguredBassesFrom()},i.removeFiguredBassesFrom=function(){const l=this.getLimitTimePos(),I=this.getMeasure(),a=c.default.getDpq(I),d=c.default.getFiguredBasses(I).slice(),v=d.length;for(let x=v-1;x>=0;x--){const C=d[x],b=u.A.getTimePos(C);if(b>=l)this.removeFiguredBass(b,a);else break}},i.getLimitTimePos=function(){const l=this.getMeasure();return(0,r.A)(this.opts,l)},i.removeFiguredBass=function(l,I){const a={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,timePos:l,dpq:I};new m.default(this.scoreData,a,this.cancelStack).perform()},i.getMeasure=function(){return this.measure===null&&(this.measure=this.scoreData.getMeasure(this.opts.partIdx,this.opts.measureIdx)),this.measure};const f=n},737344:(U,D,t)=>{t.d(D,{A:()=>n});var c=t(701387),u=t(852363);const m=function(i,f,l){this.init(i,f,l)};m.NAME="primitive.RemoveFiguredBass";const r=m.prototype;r.name=m.NAME,r.init=function(i,f,l){this.scoreData=i,this.cancelStack=l,this.opts=f,this.measure=null},r.perform=function(){this.removeFiguredBass(),this.updateStack()},r.removeFiguredBass=function(){const i=this.getMeasure(),f=c.default.getFiguredBasses(i);f.splice(this.opts.figuredBassIdx,1)[0],c.default.setFiguredBasses(i,f)},r.updateStack=function(){const i={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx}};this.cancelStack.push(i),(0,u.default)(this.cancelStack,this.scoreData,this.opts)},r.getDpq=function(){const i=this.getMeasure();return c.default.getDpq(i)},r.getMeasure=function(){return this.measure===null&&(this.measure=this.scoreData.getMeasure(this.opts.partIdx,this.opts.measureIdx)),this.measure};const n=m},800893:(U,D,t)=>{t.d(D,{A:()=>n});var c=t(852363),u=t(701387);const m=function(i,f,l){this.init(i,f,l)};m.NAME="primitive.RemoveClassicHarmony";const r=m.prototype;r.name=m.NAME,r.init=function(i,f,l){this.scoreData=i,this.cancelStack=l,this.opts=f,this.measure=null},r.perform=function(){this.removeClassicHarmony(),this.updateStack()},r.removeClassicHarmony=function(){const i=this.getMeasure(),f=u.default.getClassicHarmonies(i);f.splice(this.opts.harmonyIdx,1),u.default.setClassicHarmonies(i,f)},r.updateStack=function(){const i={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx}};this.cancelStack.push(i),(0,c.default)(this.cancelStack,this.scoreData,this.opts)},r.getMeasure=function(){return this.measure===null&&(this.measure=this.scoreData.getMeasure(this.opts.partIdx,this.opts.measureIdx)),this.measure};const n=m},853204:(U,D,t)=>{t.d(D,{A:()=>N});var c=t(701387),u=t(518558),m=t(852363);const r=function(h,p,M){this.init(h,p,M)};r.NAME="primitive.AddOwnTimeSignature";const n=r.prototype;n.name=r.NAME,n.init=function(h,p,M){this.scoreData=h,this.cancelStack=M,this.opts=p,this.previousTime=null},n.perform=function(){this.hasPreviousTime()&&this.savePreviousTime(),this.addTime(),this.updateStack()},n.hasPreviousTime=function(){const h=this.getMeasure();return c.default.hasOwnTime(h)},n.savePreviousTime=function(){const h=this.getMeasure(),M=c.default.getWrappedOwnTime(h).getAnyEntry();this.previousTime=u.default.copy(M)},n.addTime=function(){const h=this.getMeasure(),p=c.default.getWrappedOwnTime(h),M=p.getNbStaves();for(let H=0;H<M;H++){const X=u.default.copy(this.opts.timeSignature);p.setEntry(X,H)}const V=p.dumpAttribute();c.default.setOwnTime(h,V)},n.getMeasure=function(){return this.scoreData.getPartContent(this.opts.partIdx).measure[this.opts.measureIdx]},n.updateStack=function(){const h=u.default.copy(this.opts.timeSignature),p={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,previousTimeSignature:this.previousTime,newTimeSignature:h}};this.cancelStack.push(p),(0,m.default)(this.cancelStack,this.scoreData,this.opts),this.opts.measureIdx>0&&(0,m.default)(this.cancelStack,this.scoreData,{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx-1})};const i=r,f=function(h,p,M){this.init(h,p,M)};f.NAME="composite.AddOwnTimeSignatureIfNeeded";const l=f.prototype;l.name=f.NAME,l.init=function(h,p,M){this.scoreData=h,this.cancelStack=M,this.opts=p,this.measure=null},l.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.needAddOwnTime()&&this.addOwnTime()},l.needAddOwnTime=function(){return this.hasOwnTime()?!this.hasSameTime():!0},l.hasOwnTime=function(){const h=this.getMeasure();return c.default.hasOwnTime(h)},l.hasSameTime=function(){const h=this.getMeasure(),M=c.default.getWrappedOwnTime(h).getAnyEntry();return u.default.isSame(M,this.opts.timeSignature)},l.getMeasure=function(){return this.scoreData.getMeasure(this.opts.partIdx,this.opts.measureIdx)},l.addOwnTime=function(){const h=u.default.copy(this.opts.timeSignature),p={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,timeSignature:h};new i(this.scoreData,p,this.cancelStack).perform()};const I=f,a=function(h,p,M){this.init(h,p,M)};a.NAME="primitive.RemoveOwnTimeSignature";const d=a.prototype;d.name=a.NAME,d.init=function(h,p,M){this.scoreData=h,this.cancelStack=M,this.opts=p,this.removedTime=null},d.perform=function(){this.saveRemovedTime(),this.removeTimeSignature(),this.updateStack()},d.saveRemovedTime=function(){const h=this.getMeasure(),M=c.default.getWrappedOwnTime(h).getAnyEntry();this.removedTime=u.default.copy(M)},d.removeTimeSignature=function(){const h=this.getMeasure(),p=[];c.default.setOwnTime(h,p)},d.getMeasure=function(){return this.scoreData.getPartContent(this.opts.partIdx).measure[this.opts.measureIdx]},d.updateStack=function(){const h=u.default.copy(this.removedTime),p={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,removedTimeSignature:h}};this.cancelStack.push(p),(0,m.default)(this.cancelStack,this.scoreData,this.opts),this.opts.measureIdx>0&&(0,m.default)(this.cancelStack,this.scoreData,{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx-1})};const v=a,x=function(h,p,M){this.init(h,p,M)};x.NAME="composite.RemoveOwnTimeSignatureIfNeeded";const C=x.prototype;C.name=x.NAME,C.init=function(h,p,M){this.scoreData=h,this.cancelStack=M,this.opts=p,this.measure=null},C.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.hasOwnTime()&&this.removeOwnTime()},C.hasOwnTime=function(){const h=this.getMeasure();return c.default.hasOwnTime(h)},C.getMeasure=function(){return this.scoreData.getMeasure(this.opts.partIdx,this.opts.measureIdx)},C.removeOwnTime=function(){const h={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx};new v(this.scoreData,h,this.cancelStack).perform()};const b=x,P=function(h,p,M){this.init(h,p,M)};P.NAME="composite.UpdateOwnTimeSignature";const g=P.prototype;g.name=P.NAME,g.init=function(h,p,M){this.scoreData=h,this.cancelStack=M,this.opts=p,this.measures=null},g.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.shouldHaveOwnTime()?this.addOwnTime():this.removeOwnTime()},g.shouldHaveOwnTime=function(){return this.hasPreviousMeasure()?this.isPreviousMeasureTimeDifferent():!0},g.hasPreviousMeasure=function(){return this.opts.measureIdx>0},g.isPreviousMeasureTimeDifferent=function(){const h=this.getCurrentMeasureTime(),p=this.getPreviousMeasureTime();return!u.default.isSame(p,h)},g.getCurrentMeasureTime=function(){return this.getMeasureTime(this.opts.measureIdx)},g.getPreviousMeasureTime=function(){return this.getMeasureTime(this.opts.measureIdx-1)},g.getMeasureTime=function(h){return this.scoreData.getCommonContent().getDisplayedTime(h)},g.getMeasure=function(h){return this.getMeasures(h)[h]},g.getMeasures=function(){return this.measures===null&&(this.measures=this.scoreData.getPartMeasures(this.opts.partIdx)),this.measures},g.addOwnTime=function(){let h=this.getCurrentMeasureTime();h=u.default.copy(h);const p={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,timeSignature:h};new I(this.scoreData,p,this.cancelStack).perform()},g.removeOwnTime=function(){const h={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx};new b(this.scoreData,h,this.cancelStack).perform()};const O=P,w=function(h,p,M){this.init(h,p,M)};w.NAME="composite.UpdateMeasuresRangeOwnTimeSignature";const y=w.prototype;y.name=w.NAME,y.init=function(h,p,M){this.scoreData=h,this.cancelStack=M,this.opts=p},y.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name);for(let h=this.opts.startMeasureIdx;h<=this.opts.stopMeasureIdx;h++)this.updateMeasuresColumnTimeSignature(h);this.hasMeasureAfter()&&this.updateMeasuresColumnTimeSignature(this.opts.stopMeasureIdx+1)},y.hasMeasureAfter=function(){const h=this.getNbMeasures();return this.opts.stopMeasureIdx+1<h},y.getNbMeasures=function(){return this.scoreData.getPartMeasures(0).length},y.updateMeasuresColumnTimeSignature=function(h){const p=this.scoreData.getNbParts();for(let M=0;M<p;M++)this.updateMeasureTimeSignature(M,h)},y.updateMeasureTimeSignature=function(h,p){const M={partIdx:h,measureIdx:p};new O(this.scoreData,M,this.cancelStack).perform()};const N=w},889580:(U,D,t)=>{t.d(D,{A:()=>d});var c=t(737903),u=t(123491),m=t(292681),r=t(209175),n=t(762691),i=t(793317),f=t(343667),l=t(852363);const I=function(v,x,C){this.init(v,x,C)};I.NAME="primitive.AddToChordPercu";const a=I.prototype;a.name=I.NAME,a.initMeasureData=i.default,a.init=function(v,x,C){this.initMeasureData(v,x),this.cancelStack=C,this.opts=x},a.perform=function(){const v=this.getVoice(),x=v.getNote(this.opts.noteIdx),C=this.createNote(x);v.addNoteToChord(C,this.opts.noteIdx),this.updateCommonHistory(),this.updateStack()},a.getVoice=function(){return this.measureData.getVoice(this.opts.voiceIdx)},a.createNote=function(v){const x=u.default.getDuration(v),C=u.default.getNbDots(v);let b=u.default.getTimeModif(v);b=r.default.copy(b);const P=m.default.copy(this.opts.unpitched),g=u.default.getTimePos(v),O={};u.default.setStaffIdx(O,this.opts.staffIdx),u.default.setVoiceIdx(O,this.opts.voiceIdx),u.default.setDuration(O,x),u.default.setUnpitched(O,P),u.default.setTimePos(O,g),u.default.setNbDots(O,C),u.default.setHead(O,this.opts.notehead);const w=this.getInstrumentId();if(u.default.setInstrumentId(O,w),u.default.setTimeModif(O,b),this.cancelStack.hasPayload()){const y=this.cancelStack.getPayload(),N=(0,c.default)(y.headCssClassesSet);n.default.setHeadCssClassesSet(O,N)}return O},a.getInstrumentId=function(){return(0,f.A)(this.measureData,this.opts.partIdx,this.opts.unpitched,this.opts.notehead)},a.updateCommonHistory=function(){if(this.cancelStack.hasPayload()){const x=this.getVoice().getNote(this.opts.noteIdx),C=this.cancelStack.getPayload(),b=(0,c.default)(C.headCssClassesSet);n.default.setGlobalCssClassesSet(x,b)}},a.updateStack=function(){const v={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,noteIdx:this.opts.noteIdx,voiceIdx:this.opts.voiceIdx,staffIdx:this.opts.staffIdx,unpitched:m.default.copy(this.opts.unpitched),notehead:this.opts.notehead}};this.cancelStack.push(v),(0,l.default)(this.cancelStack,this.measureData,this.opts)};const d=I},890985:(U,D,t)=>{t.d(D,{A:()=>N});var c=t(349386),u=t(82028),m=t(737296),r=t(279140),n=t(990937),i=t(32711),f=t(364842),l=t(726042),I=t(209175),a=t(515819),d=t(701387);const v=function(h,p){x(h,p)?C(h,p):w(h,p)},x=function(h,p){return h.hasVoice(p.voiceIdx)},C=function(h,p){p=b(h,p);let M;if(p.insertMode===m.default.REPLACE)M=p.voice.getAvailableSpaceAtIdx(p.noteIdx);else if(p.insertMode===m.default.INSERT){M=p.voice.getAvailableSpaceAtEnd(p.noteIdx);const V=p.voice.getSpaceFromIdx(p.noteIdx);M<V&&(p.timeDiff=0)}else throw new f.default("Unexpected");if(M*=p.internalCoeff,M-=p.timeDiff,M=Math.max(M,0),M<p.requiredSpace)throw new r.default(p.requiredSpace,M,p.dpq,p.timeModif)},b=function(h,p){let M;if(P(p))M=g(h,p);else if(y(p))M=O(h,p);else throw new f.default("Unexpected");return M.insertMode=p.insertMode,M},P=function(h){return typeof h.noteIdx=="number"},g=function(h,p){const M=h.getVoiceOrTupletForGet(p.voiceIdx,p.noteIdx),V=M.getAbsoluteTimeModif(),H=h.getDpqValue(),X=(0,c.default)(p,H,V);return{voice:M,timeModif:V,dpq:H,noteIdx:p.noteIdx,requiredSpace:X,internalCoeff:1,timeDiff:0}},O=function(h,p){const M=h.getDpqValue(),V=l.default.lcm(M,p.divisions),H=p.timePos*V/p.divisions,X=V/M,W=h.getVoice(p.voiceIdx),L=(0,u.default)(W,X,H),Z=W.getRangeSpace(0,L)*X,$=H-Z;if($>0&&!W.isRest(L))throw new n.A(H,V,n.A.INSERT);const S=h.getVoiceOrTupletForGet(p.voiceIdx,L),A=S.getAbsoluteTimeModif();if($>0&&!I.default.isSame(p.timeModif,A))throw new i.A(p.timeModif);const E=(0,c.default)(p,V,A);return{voice:S,timeModif:A,dpq:V,noteIdx:L,requiredSpace:E,internalCoeff:X,timeDiff:$}},w=function(h,p){if(p.insertMode!==m.default.REPLACE&&p.insertMode!==m.default.INSERT)throw new f.default("Unexpected");if(!y(p))throw new f.default("Unexpected");const M=a.default.divisionsToQuarter(p.timePos,p.divisions);if(!a.default.isValidQuarter(M))throw new f.default("Unexpected","Invalid position");const V=a.default.durationOptsToQuarter(p),H=h.getMeasure(),W=d.default.getQuarterDuration(H)-M;if(V>W){const L=a.default.quarterDurationToRequiredDpq(W),Z=a.default.quarterDurationToRequiredDpq(V),$=l.default.lcm(L,Z),S=a.default.quarterToDivisions(W,$),A=a.default.quarterToDivisions(V,$);throw new r.default(A,S,$,I.default.createDefault())}},y=function(h){return typeof h.timePos=="number"&&typeof h.divisions=="number"},N=v},902763:(U,D,t)=>{t.d(D,{A:()=>u});var c=t(951066);class u extends c.A{constructor(n){const i=m(n);super(i),Object.defineProperty(this,"voiceIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="DuplicateVoiceIdxError",this.voiceIdx=n}}const m=function(r){return`The voice idx [${r}] appears twice in the options.`}},940134:(U,D,t)=>{t.d(D,{A:()=>m});var c=t(951066);function u(){return"There must be at least one valid pitch mapping."}class m extends c.A{constructor(){const n=u();super(n),this.name="NoPitchMappingError"}}},954361:(U,D,t)=>{t.d(D,{A:()=>l});var c=t(288572),u=t(519405),m=t(793317),r=t(123491);const n=function(I,a,d){this.init(I,a,d)};n.NAME="composite.FormatMeasureRests";const i=n.prototype;i.name=n.NAME,i.initMeasureData=m.default,i.init=function(I,a,d){this.initMeasureData(I,a),this.cancelStack=d,this.opts=a},i.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.formatVoicesRests()},i.formatVoicesRests=function(){this.measureData.forEachVoice(this.formatVoiceRests,this)},i.formatVoiceRests=function(I,a){if(f(I)){const d={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:a,noteIdx:0},v=new c.default(this.measureData,d,this.cancelStack);(0,u.default)(v)}};const f=function(I){if(!I.isRest(0))return!1;const d=I.getNote(0);return!(r.default.hasTupletStart(d)||r.default.needRestLock(d))},l=n},999874:(U,D,t)=>{t.d(D,{A:()=>u});var c=t(180289);const u=c.A}}]);})();


//# debugId=8c870816-c051-5b89-87de-eff038642ea3
