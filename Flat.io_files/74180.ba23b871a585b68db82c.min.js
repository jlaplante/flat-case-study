
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="32a9387c-73db-5ea2-ae14-df53eac6175f")}catch(e){}}();
(()=>{/*! Copyright (c) 2025 Tutteo Ltd. */(self.webpackChunk_flat_flat=self.webpackChunk_flat_flat||[]).push([[74180],{16602:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>es});var b=y(364842),N=y(732799),U=y(199077),M=y(331751),B=y(123868),u=y(454921),a=y(615898),g=y(726042),S=y(737903),D=y(249394),z=y(100040),V=y(790850),L=y(801370),h=y(98710);const v=function(t,e,n){this.init(t,e,n)},w=v.prototype;w.init=function(t,e,n){this.scoreData=t,this.drawingContext=e,this.opts=n},w.setScoreData=function(t){this.scoreData=t},w.setDrawingContext=function(t){this.drawingContext=t},w.getMinimalAvailableWidth=function(){const t=this.getSideAvailableWidth(a.A.TYPE_ODD),e=this.getSideAvailableWidth(a.A.TYPE_EVEN);return Math.min(t,e)},w.getAvailableWidth=function(t){const e=this.getPageNumber(t),n=p(e);return this.getSideAvailableWidth(n)},w.getPageNumber=function(t){return this.opts.pageNumberingStart!==null?t+this.opts.pageNumberingStart:this.opts.hasCover?t+2:t+1};const p=function(t){return g.default.isEven(t)?a.A.TYPE_EVEN:a.A.TYPE_ODD};w.getSideAvailableWidth=function(t){const n=this.scoreData.getPageUsableSize(t).width;return this.tenthsToLocal(n)},w.getAvailableHeight=function(){const e=this.scoreData.getPageUsableSize(a.A.TYPE_EVEN).height;return this.tenthsToLocal(e)},w.tenthsToLocal=function(t){const e=this.drawingContext.getSpaceSize();return t/10*e};const m=v;var P=y(269352);const W=function(){this.init()};W.cssClass="pageHeader";const s=W.prototype;s.cssClass=W.cssClass,s.init=function(){this.parent=null,this.group=null,this.pageNumber=null,this.logo=null,this.firstPage=null},s.setParent=function(t){this.parent=t},s.setPageNumber=function(t){this.isRendered()&&t.setParent(this.group),this.pageNumber=t},s.hidePageNumber=function(){this.pageNumber.hide()},s.showPageNumber=function(){this.pageNumber.show()},s.setLogo=function(t){this.isRendered()&&t.setParent(this.group),this.logo=t},s.setFirstPage=function(t){this.isRendered()&&t.setParent(this.group),this.firstPage=t},s.setPosition=function(t){this.yPos=t},s.format=function(){this.firstPage!==null&&this.firstPage.format()},s.draw=function(){this.isRendered()||this.render(),this.drawContent(),this.bindToParent()},s.isRendered=function(){return this.group!==null},s.render=function(){this.group=new P.A("g"),this.group.attr("class",this.cssClass),this.firstPage!==null&&this.firstPage.setParent(this.group),this.pageNumber!==null&&this.pageNumber.setParent(this.group),this.logo!==null&&this.logo.setParent(this.group)},s.drawContent=function(){this.pageNumber!==null&&this.pageNumber.draw(),this.logo!==null&&this.logo.draw(),this.firstPage!==null&&this.firstPage.draw()},s.bindToParent=function(){this.parent.append(this.group)},s.unbind=function(){this.group.removeFromParent()},s.getHeight=function(){const t=[];return this.pageNumber!==null&&t.push(this.pageNumber.getHeight()),this.logo!==null&&t.push(this.logo.getHeight()),this.firstPage!==null&&t.push(this.firstPage.getHeight()),t.reduce(g.default.max2)};const i=W,c=function(){this.init()};c.cssClass="firstPageHeader";const d=c.prototype;d.cssClass=c.cssClass,d.init=function(){this.parent=null,this.group=null,this.titleLines=null,this.subtitleLines=null,this.subtitle=null,this.creators=null,this.kodaly=null},d.setParent=function(t){this.parent=t},d.setCreators=function(t){this.isRendered()&&t.setParent(this.group),this.creators=t},d.setTitleLines=function(t){this.isRendered()&&t.forEach(e=>e.setParent(this.group)),this.titleLines=t},d.setSubtitleLines=function(t){this.isRendered()&&t.forEach(e=>e.setParent(this.group)),this.subtitleLines=t},d.setKodaly=function(t){this.isRendered()&&t.setParent(this.group),this.kodaly=t},d.format=function(){let t=0,e=0,n=0;this.titleLines!==null&&(e=this.titleLines[0].getFontSize(),this.titleLines.forEach((x,E)=>{E===0&&(t=e),x.setPosition(t),t+=x.getHeight()})),this.subtitleLines!==null?(n=this.subtitleLines[0].getFontSize(),this.subtitleLines.forEach(x=>{x.setPosition(t),t+=x.getHeight()}),t+=n):t+=e,this.creators!==null&&(this.creators.format(),this.creators.setPosition(t),t+=this.creators.getHeight()),this.kodaly!==null&&this.kodaly.setPosition(t)},d.draw=function(){this.isRendered()||this.render(),this.drawContent(),this.bindToParent()},d.isRendered=function(){return this.group!==null},d.render=function(){this.group=new P.A("g"),this.group.attr("class",this.cssClass),this.titleLines!==null&&this.titleLines.forEach(t=>t.setParent(this.group)),this.subtitleLines!==null&&this.subtitleLines.forEach(t=>t.setParent(this.group)),this.creators!==null&&this.creators.setParent(this.group),this.kodaly!==null&&this.kodaly.setParent(this.group)},d.drawContent=function(){this.titleLines!==null&&this.titleLines.forEach(t=>t.draw()),this.subtitleLines!==null&&this.subtitleLines.forEach(t=>t.draw()),this.creators!==null&&this.creators.draw(),this.kodaly!==null&&this.kodaly.draw()},d.bindToParent=function(){this.parent.append(this.group)},d.getHeight=function(){let t=0,e=0;return this.titleLines!==null&&(e=this.titleLines[0].getFontSize(),t+=e,t+=this.titleLines.map(n=>n.getHeight()).reduce(g.default.add,0)),this.subtitleLines!==null?t+=this.subtitleLines[0].getFontSize()+this.subtitleLines.map(n=>n.getHeight()).reduce(g.default.add,0):t+=e,this.creators!==null&&(t+=this.creators.getHeight()),this.kodaly!==null&&(t+=this.kodaly.getHeight()),t};const F=c;var $=y(100673);const q=function(){this.init()};q.cssClass="centeredText";const J=q.prototype;J.cssClass=q.cssClass,J.init=function(){this.parent=null,this.text=null,this.drawingContext=null,this.posY=null,this.fontSize=null,this.textString=null,this.width=null,this.height=null,this.fontFamily=null,this.fontStyle=null,this.fontWeight=null,this.fill=null},J.setDrawingContext=function(t){this.drawingContext=t},J.setCssClass=function(t){this.cssClass=t},J.setWidth=function(t){this.width=t},J.setFontSize=function(t){this.fontSize=t},J.setFontFamily=function(t){this.fontFamily=t},J.setFontWeight=function(t){this.fontWeight=t},J.setFontStyle=function(t){this.fontStyle=t},J.setFill=function(t){this.fill=t},J.setPosition=function(t){this.posY=t},J.setParent=function(t){this.parent=t,this.isRendered()&&this.text.setParent(t)},J.setTextString=function(t){this.textString=t},J.draw=function(){this.renderIfNeeded(),this.text.draw()},J.renderIfNeeded=function(){this.isRendered()||this.render()},J.isRendered=function(){return this.text!==null},J.render=function(){const t={"text-anchor":"middle",text:this.textString};this.fontFamily!==null&&(t["font-family"]=this.fontFamily),this.fontWeight!==null&&(t["font-weight"]=this.fontWeight),this.fontStyle!==null&&(t["font-style"]=this.fontStyle),this.fill!==null&&(t.fill=this.fill);const e=new $.A(t);e.setFontSize(this.fontSize),e.setDrawingContext(this.drawingContext),e.render(),e.setCssClass(this.cssClass),this.parent!==null&&e.setParent(this.parent);const n=this.width/2,x=this.posY+this.fontSize;e.setPosition(n,x),this.text=e},J.getHeight=function(){return this.fontSize*1.5},J.getFontSize=function(){return this.fontSize};const T=q,H=function(){this.init()};H.cssClass="creators";const R=H.prototype;R.cssClass=H.cssClass,R.init=function(){this.parent=null,this.group=null,this.composer=null,this.lyricist=null,this.arranger=null,this.posY=null},R.setParent=function(t){this.parent=t},R.setComposer=function(t){this.isRendered()&&t.setParent(this.group),this.composer=t},R.setLyricist=function(t){this.isRendered()&&t.setParent(this.group),this.lyricist=t},R.setArranger=function(t){this.isRendered()&&t.setParent(this.group),this.arranger=t},R.setPosition=function(t){this.posY=t},R.format=function(){let t=0;this.composer!==null&&(this.composer.setPosition(t),t+=this.composer.getHeight()),this.lyricist!==null&&this.lyricist.setPosition(0),this.arranger!==null&&(this.arranger.setPosition(t),t+=this.arranger.getHeight())},R.draw=function(){this.isRendered()||this.render(),this.drawContent(),this.move(),this.bindToParent()},R.isRendered=function(){return this.group!==null},R.render=function(){this.group=new P.A("g"),this.group.attr("class",this.cssClass),this.lyricist!==null&&this.lyricist.setParent(this.group),this.composer!==null&&this.composer.setParent(this.group),this.arranger!==null&&this.arranger.setParent(this.group)},R.drawContent=function(){this.composer!==null&&this.composer.draw(),this.lyricist!==null&&this.lyricist.draw(),this.arranger!==null&&this.arranger.draw()},R.move=function(){this.group.attr("transform",`translate(0, ${this.posY})`)},R.bindToParent=function(){this.parent.append(this.group)},R.getHeight=function(){let t=0,e=0;return this.composer!==null&&(e+=this.composer.getHeight()),this.lyricist!==null&&(t+=this.lyricist.getHeight()),this.arranger!==null&&(e+=this.arranger.getHeight()),Math.max(t,e)};const k=H,vt=function(){this.init()};vt.cssClass="rightText";const ot=vt.prototype;ot.cssClass=vt.cssClass,ot.init=function(){this.parent=null,this.text=null,this.drawingContext=null,this.posY=null,this.fontSize=null,this.fontFamily=null,this.fontStyle=null,this.fontWeight=null,this.textString=null,this.width=null},ot.setFontSize=function(t){this.fontSize=t},ot.setPosition=function(t){this.posY=t},ot.setWidth=function(t){this.width=t},ot.setFontFamily=function(t){this.fontFamily=t},ot.setFontStyle=function(t){this.fontStyle=t},ot.setFontWeight=function(t){this.fontWeight=t},ot.setDrawingContext=function(t){this.drawingContext=t},ot.setParent=function(t){this.parent=t,this.isRendered()&&this.text.setParent(t)},ot.setCssClass=function(t){this.cssClass=t},ot.setTextString=function(t){this.textString=t},ot.draw=function(){this.renderIfNeeded(),this.text.draw()},ot.renderIfNeeded=function(){this.isRendered()||this.render()},ot.isRendered=function(){return this.text!==null},ot.render=function(){const t={"text-anchor":"end",text:this.textString};this.fontFamily!==null&&(t["font-family"]=this.fontFamily),this.fontWeight!==null&&(t["font-weight"]=this.fontWeight),this.fontStyle!==null&&(t["font-style"]=this.fontStyle);const e=new $.A(t);e.setDrawingContext(this.drawingContext),e.setFontSize(this.fontSize),e.render(),e.setCssClass(this.cssClass),this.parent!==null&&e.setParent(this.parent);const n=this.posY+this.fontSize;e.setPosition(this.width,n),this.text=e},ot.getHeight=function(){return this.fontSize*1.5};const Tt=vt,Ct=function(){this.init()};Ct.cssClass="leftText";const dt=Ct.prototype;dt.cssClass=Ct.cssClass,dt.init=function(){this.parent=null,this.text=null,this.drawingContext=null,this.posY=null,this.fontSize=null,this.fontFamily=null,this.fontStyle=null,this.fontWeight=null,this.textString=null},dt.setDrawingContext=function(t){this.drawingContext=t},dt.setCssClass=function(t){this.cssClass=t},dt.setFontFamily=function(t){this.fontFamily=t},dt.setFontStyle=function(t){this.fontStyle=t},dt.setFontWeight=function(t){this.fontWeight=t},dt.setFontSize=function(t){this.fontSize=t},dt.setPosition=function(t){this.posY=t},dt.setParent=function(t){this.parent=t,this.isRendered()&&this.text.setParent(t)},dt.setTextString=function(t){this.textString=t},dt.draw=function(){this.renderIfNeeded(),this.text.draw()},dt.renderIfNeeded=function(){this.isRendered()||this.render()},dt.isRendered=function(){return this.text!==null},dt.render=function(){const t={text:this.textString};this.fontFamily!==null&&(t["font-family"]=this.fontFamily),this.fontWeight!==null&&(t["font-weight"]=this.fontWeight),this.fontStyle!==null&&(t["font-style"]=this.fontStyle);const e=new $.A(t);e.setFontSize(this.fontSize),e.setDrawingContext(this.drawingContext),e.render(),e.setCssClass(this.cssClass),this.parent!==null&&e.setParent(this.parent);const n=this.posY+this.fontSize;e.setPosition(0,n),this.text=e},dt.getHeight=function(){return this.fontSize*1.5};const Dt=Ct,xt=function(){this.init()};xt.cssClass="pageNumber";const gt=xt.prototype;gt.cssClass=xt.cssClass,gt.init=function(){this.parent=null,this.text=null,this.drawingContext=null,this.fontSize=null,this.width=null,this.number=null,this.drawn=!1},gt.setDrawingContext=function(t){this.drawingContext=t},gt.setWidth=function(t){this.width=t},gt.setFontSize=function(t){this.fontSize=t},gt.setParent=function(t){this.parent=t,this.isRendered()&&this.text.setParent(t)},gt.setNumber=function(t){this.number=t},gt.draw=function(){this.renderIfNeeded(),this.text.draw(),this.drawn=!0},gt.renderIfNeeded=function(){this.isRendered()||this.render()},gt.isRendered=function(){return this.text!==null},gt.render=function(){let t,e;g.default.isEven(this.number)?(t="start",e=0):(t="end",e=this.width);const n=this.number.toString(),x=this.drawingContext.getPageNumberFontFamily(),E=this.drawingContext.getMeasureNumberFontStyle(),G=this.drawingContext.getMeasureNumberFontWeight(),Q={"text-anchor":t,"font-family":x,"font-style":E,"font-weight":G,text:n},j=new $.A(Q);j.setDrawingContext(this.drawingContext),j.setFontSize(this.fontSize),j.render(),this.parent!==null&&j.setParent(this.parent),j.setCssClass(this.cssClass);const K=this.fontSize;j.setPosition(e,K),this.text=j},gt.getHeight=function(){return this.fontSize*1.5},gt.show=function(){this.isRendered()&&!this.drawn&&(this.text.draw(),this.drawn=!0)},gt.hide=function(){this.drawn&&(this.text.hide(),this.drawn=!1)};const Ot=xt,Ut=2,wt=1,zt="#2F3446",At=function(t,e){this.init(t,e)};At.cssClass="pageNumber";const mt=At.prototype;mt.cssClass=At.cssClass,mt.init=function(t,e){this.parent=null,this.group=null,this.logoFont=t,this.drawingContext=null,this.width=null,this.pageNumber=null,this.pageIdx=e,this.glyph=null},mt.setDrawingContext=function(t){this.drawingContext=t},mt.setWidth=function(t){this.width=t},mt.setParent=function(t){this.parent=t},mt.setNumber=function(t){this.pageNumber=t},mt.draw=function(){this.renderIfNeeded()},mt.renderIfNeeded=function(){this.isRendered()||this.render()},mt.isRendered=function(){return this.group!==null},mt.render=function(){const t=this.getGlyph();this.group=new P.A("g"),this.group.attr("class",this.cssClass),this.path=this.group.append("path"),this.path.attr("d",t.render()),this.path.style("fill",zt);const e=t.getHeight();let n;g.default.isEven(this.pageNumber)?n=this.width-t.getWidth():n=0,this.group.attr("transform",`translate(${n}, ${e})`),this.parent.append(this.group)},mt.getHeight=function(){return this.getGlyph().getHeight()},mt.getGlyph=function(){if(this.glyph===null){const t=this.pageIdx>0?wt:Ut;this.glyph=this.logoFont.getScaledGlyph("small-flat-logo",t)}return this.glyph};const kt=At;var Lt=y(390253);const Et={SUBTITLE_FONTSIZE:14,FOOTER_BRANDING_FONTSIZE:7};var It=y(351277);const Gt="S.S.P.",Yt="R.S.P.",$t={C:"d",D:"r",E:"m",F:"f",G:"s",A:"l",B:"t"},Rt={"-2":"bb","-1":"b",0:"",1:"#",2:"##"};class Vt{constructor({sourcePitch:e,recommendedPitch:n,pitches:x}){this.sourcePitch=e,this.recommendedPitch=n,this.pitches=x,this.drawingContext=null,this.parent=null,this.width=null,this.posY=null,this.group=null,this.leftItems=[],this.rightItems=[],this.height=null}setWidth(e){this.width=e}setDrawingContext(e){this.drawingContext=e}setParent(e){this.parent=e}setPosition(e){this.posY=e}draw(){this.render(),this.move(),this.bindToParent()}render(){this.group===null&&(this.group=new P.A("g"),this.renderSourcePitch(),this.renderRecommendedPitch(),this.renderPitches(),this.format())}renderSourcePitch(){const e=It.default.getStep(this.sourcePitch),n=It.default.getAlter(this.sourcePitch),x=Rt[n],E=`${Gt}: ${e}${x}`;this.createLeftText(E)}renderRecommendedPitch(){const e=It.default.getStep(this.recommendedPitch),n=It.default.getAlter(this.recommendedPitch),x=Rt[n],E=`${Yt}: ${e}${x}`;this.createLeftText(E)}createLeftText(e){const n=this.createText(e);n.text.setXPos(0),this.leftItems.push(n)}renderPitches(){const n=this.pitches.map(Kt).join(" ");this.createRightText(n)}createRightText(e){const n=this.createText(e);n.text.setXPos(this.width),n.text.options["text-anchor"]="end",this.rightItems.push(n)}createText(e){const n=new $.A({text:e});n.setParent(this.group);const x=this.drawingContext.getKodalyHeaderFontSize(),E=this.drawingContext.getKodalyHeaderFontFamily();return n.options["font-family"]=E,n.setDrawingContext(this.drawingContext),n.setFontSize(x),{text:n,height:x}}format(){const e=this.leftItems.reduce(Nt,0),n=this.rightItems.reduce(Nt,0);this.height=Math.max(e,n)}move(){this.group.attr("transform",`translate(0 ${this.posY})`)}bindToParent(){this.parent.append(this.group)}getHeight(){return this.group===null&&this.render(),this.height}}function Kt(t){const e=It.default.getStep(t),n=$t[e];return t.isLast?`(${n})`:n}function Nt(t,e){const n=t+e.height*2/3;return e.text.setYPos(n),e.text.render(),e.text.draw(),t+e.height}function Ft(t,e,n,x){const E=[];do{const{line:G,rest:Q}=Xt(t,e,n,x);E.push(G),t=Q}while(t!==null);return E}function Xt(t,e,n,x){if(t=t.trim(),n.getComputedTextLength(t,[x.fontFamily],x.fontSize,x)<e)return{line:t,rest:null};let G=jt(t);if(G.length===1)return{line:t,rest:null};G=G.slice(1);let[Q]=G;G.some(tt=>{const rt=t.slice(0,tt).trim();if(n.getComputedTextLength(rt,[x.fontFamily],x.fontSize,x)>e)return!0;Q=tt});const j=t.slice(0,Q).trim(),K=t.slice(Q).trim();return{line:j,rest:K}}function jt(t){const e=[];let n=!0;return Array.from(t).forEach((x,E)=>{Mt(x)?n=!0:(n&&e.push(E),n=!1)}),e}function Mt(t){return t.trim()===""}const se="#2F3446",Wt=function(t,e,n,x){this.init(t,e,n,x)},ct=Wt.prototype;ct.init=function(t,e,n,x){this.scoreData=t,this.drawingContext=e,this.opts=n,this.pageMetrics=x,this.pagesHeaders={}},ct.hasPageHeader=function(){return!0},ct.getPageHeader=function(t){return typeof this.pagesHeaders[t]=="undefined"&&this.createPageHeader(t),this.pagesHeaders[t]},ct.createPageHeader=function(t){const e=new i;if(t===0&&this.hasHeader()){const x=this.getFirstPageHeader(t);e.setFirstPage(x)}else if(t>0&&this.hasBranding()){const x=this.getOtherPageHeader(t);e.setFirstPage(x)}if(this.hasLogo()){const x=this.getLogo(t);e.setLogo(x)}const n=this.getPageNumber(t);e.setPageNumber(n),this.pagesHeaders[t]=e},ct.hasLogo=function(){return typeof this.opts.logoFont!="undefined"},ct.hasHeader=function(){return!this.opts.noHeader},ct.getFirstPageHeader=function(t){const e=new F,n=this.getTitleLines(t);e.setTitleLines(n);const x=this.getSubtitleLines();if(x.length>0&&e.setSubtitleLines(x),this.hasCreators()){const E=this.getCreators(t);e.setCreators(E)}if(this.hasKodaly()){const E=this.getKodaly();e.setKodaly(E)}return e},ct.getOtherPageHeader=function(t){const e=new F;if(this.hasBranding()){const n=this.createBrandingText(t);e.setSubtitleLines([n])}return e},ct.hasBranding=function(){return typeof this.opts.headerBrandingText!="undefined"},ct.getLogo=function(t){const e=this.getPageNumberValue(t),n=new kt(this.opts.logoFont,t),x=this.getWidth(t);return n.setWidth(x),n.setDrawingContext(this.drawingContext),n.setNumber(e),n},ct.getTitleLines=function(t){const e=this.getWidth(t),n=this.drawingContext.getTitleFontSize(),x=this.drawingContext.getTitleFontFamily(),E=this.drawingContext.getTitleFontStyle(),G=this.drawingContext.getTitleFontWeight();let Q;return this.scoreData.hasTitle()?Q=this.scoreData.getTitle():Q="No title provided",Ft(Q,e,this.drawingContext,{fontSize:n,fontFamily:x,fontStyle:E,fontWeight:G}).map(tt=>{const rt=new T;return rt.setFontFamily(x),rt.setFontStyle(E),rt.setFontWeight(G),rt.setFontSize(n),rt.setCssClass("title"),rt.setWidth(e),rt.setDrawingContext(this.drawingContext),rt.setTextString(tt),rt})},ct.getSubtitleLines=function(t){const e=this.getWidth(t),n=this.drawingContext.getSubtitleFontSize(),x=this.drawingContext.getSubtitleFontFamily(),E=this.drawingContext.getSubtitleFontStyle(),G=this.drawingContext.getSubtitleFontWeight();let Q=[];if(this.scoreData.hasSubtitle()){const K=this.scoreData.getSubtitle();Q=Ft(K,e,this.drawingContext,{fontSize:n,fontFamily:x,fontStyle:E,fontWeight:G})}const j=Q.map(K=>{const tt=this.getWidth(t),rt=new T;return rt.setFontFamily(x),rt.setFontStyle(E),rt.setFontWeight(G),rt.setFontSize(n),rt.setCssClass("subtitle"),rt.setWidth(tt),rt.setDrawingContext(this.drawingContext),rt.setTextString(K),rt});if(this.hasBranding()){const K=this.createBrandingText(t);j.push(K)}return j},ct.hasKodaly=function(){return this.scoreData.hasKodaly()},ct.getKodaly=function(t){const e=this.scoreData.extractKodalyData(),n=this.getWidth(t),x=new Vt(e);return x.setWidth(n),x.setDrawingContext(this.drawingContext),x},ct.createBrandingText=function(t){const e=this.getWidth(t),n=new T,x=this.pointsToPixels(Et.SUBTITLE_FONTSIZE),E=this.drawingContext.getSubtitleFontFamily(),G=this.drawingContext.getSubtitleFontWeight(),Q=this.drawingContext.getSubtitleFontStyle();n.setFontFamily(E),n.setFontSize(x),n.setFontWeight(G),n.setFontStyle(Q),n.setCssClass("subtitle"),n.setWidth(e),n.setDrawingContext(this.drawingContext),n.setFill(se);const j=this.opts.headerBrandingText;return n.setTextString(j),n},ct.hasCreators=function(){return this.scoreData.hasComposer()||this.scoreData.hasLyricist()||this.scoreData.hasArranger()},ct.getCreators=function(t){const e=new k;if(this.scoreData.hasComposer()){const n=this.createComposer(t);e.setComposer(n)}if(this.scoreData.hasLyricist()){const n=this.createLyricist();e.setLyricist(n)}if(this.scoreData.hasArranger()){const n=this.createArranger(t);e.setArranger(n)}return e},ct.createComposer=function(t){const e=new Tt,n=this.getWidth(t);e.setWidth(n);const x=this.drawingContext.getComposerFontSize(),E=this.drawingContext.getComposerFontFamily(),G=this.drawingContext.getComposerFontStyle(),Q=this.drawingContext.getComposerFontWeight();e.setFontFamily(E),e.setFontStyle(G),e.setFontWeight(Q),e.setFontSize(x),e.setCssClass("composer"),e.setDrawingContext(this.drawingContext);const j=this.scoreData.getComposerStr();return e.setTextString(j),e},ct.createLyricist=function(){const t=new Dt,e=this.drawingContext.getLyricistFontSize(),n=this.drawingContext.getLyricistFontFamily(),x=this.drawingContext.getLyricistFontStyle(),E=this.drawingContext.getLyricistFontWeight();t.setFontFamily(n),t.setFontStyle(x),t.setFontWeight(E),t.setFontSize(e),t.setCssClass("lyricist"),t.setDrawingContext(this.drawingContext);const G=this.scoreData.getLyricistStr();return t.setTextString(G),t},ct.createArranger=function(t){const e=new Tt,n=this.getWidth(t);e.setWidth(n);const x=this.drawingContext.getArrangerFontSize(),E=this.drawingContext.getArrangerFontFamily(),G=this.drawingContext.getArrangerFontStyle(),Q=this.drawingContext.getArrangerFontWeight();e.setFontFamily(E),e.setFontStyle(G),e.setFontWeight(Q),e.setFontSize(x),e.setCssClass("arranger"),e.setDrawingContext(this.drawingContext);const j=this.scoreData.getArrangerStr();return e.setTextString(j),e},ct.getPageNumber=function(t){const e=this.getPageNumberValue(t),n=new Ot,x=this.getWidth(t);n.setWidth(x);const E=this.drawingContext.getPageNumberFontSize();return n.setFontSize(E),n.setDrawingContext(this.drawingContext),n.setNumber(e),n},ct.getWidth=function(t){return this.pageMetrics.getAvailableWidth(t)},ct.getPageNumberValue=function(t){return this.opts.pageNumberingStart!==null?t+this.opts.pageNumberingStart:this.opts.hasCover?t+2:t+1},ct.pointsToPixels=function(t){const e=Lt.A.pointsToMms(t);return this.scoreData.scaleToTenths(e)/10*this.drawingContext.getSpaceSize()};const Ht=Wt,Pt=function(){this.init()};Pt.cssClass="pageFooter";const lt=Pt.prototype;lt.cssClass=Pt.cssClass,lt.init=function(){this.parent=null,this.group=null,this.rightsLines=[],this.logo=null,this.brandingText=null,this.posY=null},lt.setParent=function(t){this.parent=t},lt.addRightsLine=function(t){this.isRendered()&&t.setParent(this.group),this.rightsLines.push(t)},lt.setLogo=function(t){this.isRendered()&&t.setParent(this.group),this.logo=t},lt.setBrandingText=function(t){this.isRendered()&&t.setParent(this.group),this.brandingText=t},lt.setPosition=function(t){this.posY=t},lt.format=function(){let t=0;this.rightsLines.forEach(e=>{e.setPosition(t),t+=e.getHeight()}),this.brandingText!==null&&(this.brandingText.setPosition(t),t+=this.brandingText.getHeight()),this.logo!==null&&this.logo.setPosition(t)},lt.draw=function(){this.isRendered()||this.render(),this.drawContent(),this.move(),this.bindToParent()},lt.isRendered=function(){return this.group!==null},lt.render=function(){this.group=new P.A("g"),this.group.attr("class",this.cssClass),this.rightsLines.forEach(t=>{t.setParent(this.group)}),this.brandingText!==null&&this.brandingText.setParent(this.group),this.logo!==null&&this.logo.setParent(this.group)},lt.drawContent=function(){this.rightsLines.forEach(Jt),this.brandingText!==null&&this.brandingText.draw(),this.logo!==null&&this.logo.draw()};function Jt(t){t.draw()}lt.move=function(){this.group.attr("transform",`translate(0, ${this.posY})`)},lt.bindToParent=function(){this.parent.append(this.group)},lt.getHeight=function(){const t=[];return t.push(this.getRightsHeight()),this.brandingText!==null&&t.push(this.brandingText.getHeight()),this.logo!==null&&t.push(this.logo.getHeight()),t.reduce(g.default.add,0)},lt.getRightsHeight=function(){return this.rightsLines.reduce(ie,0)};function ie(t,e){return e.getHeight()+t}const ne=Pt,Qt="coda",bt=function(){this.init()};bt.cssClass="logo";const pt=bt.prototype;pt.cssClass=bt.cssClass,pt.init=function(){this.parent=null,this.path=null,this.drawingContext=null,this.posY=null,this.glyph=null,this.width=null},pt.setWidth=function(t){this.width=t},pt.setPosition=function(t){this.posY=t},pt.setDrawingContext=function(t){this.drawingContext=t},pt.setParent=function(t){this.parent=t},pt.draw=function(){this.renderIfNeeded(),this.move(),this.bindToParent()},pt.renderIfNeeded=function(){this.isRendered()||this.render()},pt.isRendered=function(){return this.path!==null},pt.render=function(){const e=this.getGlyph().render(),n=new P.A("path");n.attr("class",this.cssClass),n.attr("d",e),this.path=n},pt.move=function(){const t=this.glyph.getWidth(),e=this.glyph.getBBoxNE().y,n=this.width/2-t/2,x=this.posY-e;this.path.attr("transform",`translate(${n}, ${x})`)},pt.bindToParent=function(){this.parent.append(this.path)},pt.getHeight=function(){return this.getGlyph().getHeight()},pt.getGlyph=function(){return this.glyph===null&&(this.glyph=this.drawingContext.getGlyph(Qt)),this.glyph};const f=bt,I=function(t,e,n,x){this.init(t,e,n,x)},A=I.prototype;A.init=function(t,e,n,x){this.scoreData=t,this.drawingContext=e,this.opts=n,this.pageMetrics=x},A.hasPageFooter=function(){return this.hasRights()||this.hasLogo()||this.hasBranding()},A.getPageFooter=function(t){const e=new ne;if(this.hasRights()&&this.hasFooter()&&this.createRightsLines(t).forEach(e.addRightsLine,e),this.hasLogo()){const n=this.createLogo(t);e.setLogo(n)}if(this.hasBranding()){const n=this.createBrandingText(t);e.setBrandingText(n)}return e},A.hasRights=function(){return this.scoreData.hasRights()},A.hasFooter=function(){return!this.opts.noFooter},A.hasBranding=function(){return typeof this.opts.footerBrandingText!="undefined"},A.createRightsLines=function(t){const e=this.getWidth(t),n=this.drawingContext.getCopyrightsFontSize(),x=this.drawingContext.getCopyrightsFontFamily(),E=this.drawingContext.getCopyrightsFontStyle(),G=this.drawingContext.getCopyrightsFontWeight();return this.scoreData.getRightsEntries().map(K=>{const tt=new T;return tt.setFontFamily(x),tt.setFontSize(n),tt.setFontStyle(E),tt.setFontWeight(G),tt.setCssClass("rights"),tt.setWidth(e),tt.setDrawingContext(this.drawingContext),tt.setTextString(K),tt})},A.createBrandingText=function(t){const e=this.getWidth(t),n=new T,x=this.pointsToPixels(Et.FOOTER_BRANDING_FONTSIZE),E=this.drawingContext.getCopyrightsFontFamily();n.setFontFamily(E),n.setFontSize(x),n.setCssClass("rights"),n.setWidth(e),n.setDrawingContext(this.drawingContext);const G=this.opts.footerBrandingText;return n.setTextString(G),n},A.hasLogo=function(){return this.opts.hasLogo},A.createLogo=function(t){const e=new f,n=this.getWidth(t);return e.setWidth(n),e.setDrawingContext(this.drawingContext),e},A.pointsToPixels=function(t){const e=Lt.A.pointsToMms(t);return this.scoreData.scaleToTenths(e)/10*this.drawingContext.getSpaceSize()},A.getWidth=function(t){return this.pageMetrics.getAvailableWidth(t)};const X=I;var ut=y(367279),ft=y(658140),_t=y(804541),Zt=y(760210),re=y(860984),qt=y(701933),oe=y(225723),ae=(t,e,n)=>new Promise((x,E)=>{var G=K=>{try{j(n.next(K))}catch(tt){E(tt)}},Q=K=>{try{j(n.throw(K))}catch(tt){E(tt)}},j=K=>K.done?x(K.value):Promise.resolve(K.value).then(G,Q);j((n=n.apply(t,e)).next())});const yt=function(t,e,n,x){this.init(t,e,n,x)},at=yt.prototype;at.init=function(t,e,n,x){this.measuresSliceProvider=t,this.drawingContext=e,this.metrics=n,this.systemBreakPolicy=x,this.shardIdx=0,this.cachedShards=[],this.systemsToSplit=null},at.setShardIdx=function(t){this.shardIdx=t},at.hasRemaining=function(){return this.cachedShards.length>0||this.measuresSliceProvider.hasRemaining()},at.indexOf=function(t){return this.cachedShards.indexOf(t)},at.insert=function(t,e){this.cachedShards.splice(e,0,t)},at.getShard=function(){return ae(this,null,function*(){this.cachedShards.length===0&&(yield this.loadNextSliceShards());const t=this.cachedShards.shift();return t.needUpdateFormatting&&this.formatShard(t),t})},at.updateCachedShardIdxFrom=function(t,e){let n=t-e;n=Math.max(n,0);const x=this.getNbCachedShards();for(;n<x;n++){const E=this.getCachedShard(n),G=n+e;E.setIdx(G)}},at.getCachedShard=function(t){return this.checkShardIdx(t),this.cachedShards[t]},at.removeCachedShard=function(t){this.checkShardIdx(t),this.cachedShards.splice(t,1)},at.checkShardIdx=function(t){const e=this.getNbCachedShards();if(!g.default.isInteger(t)||t<0||t>=e){const n=`Bad cached shard index [${t}]`;throw new b.default("BadShardIdx",n)}},at.getNbCachedShards=function(){return this.cachedShards.length},at.loadNextSliceShards=function(){return ae(this,null,function*(){const t=yield this.measuresSliceProvider.getSlice();for(t.reloadAllCrossMeasures(),t.dispatchHorizontalFormattingForVerticalComputation(),t.dropVerticalFormatting(),this.systemsToSplit=t.getDisplayedSystems().slice(),(0,oe.A)(this.systemsToSplit),this.systemsToSplit.forEach(e=>e.transferHeaderExternalSpace()),this.currentShard=null;this.systemsToSplit.length>0;){const e=this.systemsToSplit.shift();this.addSystemToShard(e)}this.systemsToSplit=null,this.cachedShards.length>1&&this.addBreaks(),this.cachedShards.forEach(ht,t),this.cachedShards.forEach(e=>e.updateChildrenBindings())})},at.formatShard=function(t){t.linkGroupBracket(),t.updateGroupBracketsOffsets();const e=this.metrics.availableWidth,n=!this.measuresSliceProvider.hasRemaining();(0,re.A)(t,e,n),t.dispatchVerticalFormatting(),t.needUpdateFormatting=!1},at.addSystemToShard=function(t){this.currentShard===null&&this.createShard();const e=this.getSystemLocation();if(t.setLocation(e),!this.currentShard.canFit(t)){if(t.hasGroup()&&!t.hasGroupStart()&&!this.currentShard.hasOnlyOneGroup()){const n=this.currentShard.popLastGroupSystems();n.push(t),t=n.shift(),this.systemsToSplit.unshift(...n)}this.createShard()}this.currentShard.pushSystem(t)},at.getSystemLocation=function(){return this.currentShard.getNbSystems()>0?qt.A.OTHER:this.cachedShards.length===1?qt.A.FIRST_OF_SLICE:qt.A.FIRST_OF_SHARD},at.createShard=function(){this.currentShard=new Zt.A,this.currentShard.setDrawingContext(this.drawingContext),this.currentShard.setSystemBreakPolicy(this.systemBreakPolicy),this.currentShard.setMetrics(this.metrics),this.currentShard.height=0;const t=this.shardIdx===0;this.currentShard.setIsFirst(t),this.currentShard.setIdx(this.shardIdx),this.metrics.hasSingleStaff||this.currentShard.createVerticalLine(),this.cachedShards.push(this.currentShard),this.shardIdx++},at.addBreaks=function(){this.cachedShards.forEach(ce)};const ce=function(t){t.setBreakBefore(!0),t.setBreakAfter(!0)},ht=function(t){this.addShard(t)};at.handBackShard=function(t){this.cachedShards.unshift(t)},at.handBackShards=function(t){Array.prototype.unshift.apply(this.cachedShards,t)},at.clearCache=function(){this.cachedShards=[]};const de=yt;var le=y(827494),fe=y(472838),te=(t,e,n)=>new Promise((x,E)=>{var G=K=>{try{j(n.next(K))}catch(tt){E(tt)}},Q=K=>{try{j(n.throw(K))}catch(tt){E(tt)}},j=K=>K.done?x(K.value):Promise.resolve(K.value).then(G,Q);j((n=n.apply(t,e)).next())});const r=function(t){this.init(t)},o=r.prototype;o.init=function({shardProvider:t,drawingContext:e,metrics:n,pageOpts:x,pagesContainer:E,shardsContainer:G}){this.shardProvider=t,this.drawingContext=e,this.metrics=n,this.pagesContainer=E,this.shardsContainer=G,this.displayOpts=x,this.pageIdx=0},o.setPageIdx=function(t){this.pageIdx=t},o.hasRemaining=function(){return this.shardProvider.hasRemaining()},o.getPageContent=function(){return te(this,null,function*(){const t=this.createPageContent();return yield this.fillPageContent(t),this.pageIdx++,t.updateChildrenBindings(),t})},o.fillPageContent=function(t){return te(this,null,function*(){for(;this.shardProvider.hasRemaining();){const n=yield this.getShard();if(t.canPushShard(n))t.pushShard(n),this.shardsContainer.push(n);else{this.shardProvider.handBackShard(n);break}}const e=this.isLast();t.setIsLast(e)})},o.getShard=function(){return te(this,null,function*(){return this.drawingContext.isAsynchronous()&&(yield(0,fe.default)()),yield this.shardProvider.getShard()})},o.createPageContent=function(){const t=new le.A;t.setDrawingContext(this.drawingContext);const e=this.pageIdx===0;return t.setIsFirst(e),t.setMetrics(this.metrics),t.setIdx(this.pageIdx),t.setDisplayOpts(this.displayOpts),this.pagesContainer.push(t),t},o.isLast=function(){return!this.shardProvider.hasRemaining()};const l=r,C=function(){this.init()};C.NAME="pageIntraMargin";const _=C.prototype;_.name=C.NAME,_.init=function(){this.width=null,this.height=null,this.header=null,this.content=null,this.footer=null,this.group=null,this.parent=null,this.svgRoot=null,this.drawn=!1},_.setWidth=function(t){this.width=t},_.setHeight=function(t){this.height=t},_.setHeader=function(t){this.header=t},_.setContent=function(t){this.content=t},_.setFooter=function(t){this.footer=t},_.setParent=function(t){this.parent=t},_.hasParent=function(){return this.parent!==null},_.setSvgRoot=function(t){this.svgRoot=t},_.hidePageNumber=function(){this.header.hidePageNumber()},_.showPageNumber=function(){this.header.showPageNumber()},_.format=function(){if(this.header!==null&&this.header.format(),this.footer!==null){const t=this.height-this.footer.getHeight();this.footer.setPosition(t),this.footer.format()}},_.swapHeader=function(t){this.header!==null&&this.isRendered()&&(this.header.unbind(),this.header.setParent(null),this.header=null),this.header=t,this.isRendered()&&(this.header.setParent(this.group),this.header.isRendered()?t.bindToParent():t.draw())},_.drawContentRec=function(){this.isRendered()||(this.render(),this.content.bindToParent(),this.drawContent()),this.formatVertically(),this.content.drawContentRec()},_.formatVertically=function(){let t=0;this.header!==null&&(t+=this.header.getHeight()),this.content.setPosition(t),this.content.move()},_.renderIfNeeded=function(){this.isRendered()||this.render()},_.isRendered=function(){return this.group!==null},_.render=function(){this.group=new P.A("g"),this.group.attr("class",this.name),this.header!==null&&this.header.setParent(this.group),this.footer!==null&&this.footer.setParent(this.group),this.content.setParent(this.group)},_.drawContent=function(){this.header!==null&&this.header.draw(),this.footer!==null&&this.footer.draw()},_.bindToParent=function(){this.drawn||(this.parent.append(this.group),this.drawn=!0)},_.unbind=function(){this.drawn&&(this.group.removeFromParent(),this.drawn=!1)},_.resetGeometries=function(){this.content.resetGeometries()},_.getGeometries=function(){return this.content.getGeometries()},_.getStructure=function(){return this.content.getStructure()},_.getAvailableContentHeight=function(){let t=this.height;return this.header!==null&&(t-=this.header.getHeight()),this.footer!==null&&(t-=this.footer.getHeight()),t},_.hasSvgRoot=function(){return this.svgRoot!==null},_.getSvgRoot=function(){return this.svgRoot},_.getParent=function(){return this.parent};const Z=C;var it=(t,e,n)=>new Promise((x,E)=>{var G=K=>{try{j(n.next(K))}catch(tt){E(tt)}},Q=K=>{try{j(n.throw(K))}catch(tt){E(tt)}},j=K=>K.done?x(K.value):Promise.resolve(K.value).then(G,Q);j((n=n.apply(t,e)).next())});const nt=function(t,e,n,x){this.init(t,e,n,x)},et=nt.prototype;et.init=function(t,e,n,x){this.pageContentProvider=t,this.headerProvider=e,this.footerProvider=n,this.pageMetrics=x,this.pageIdx=0},et.hasRemaining=function(){return this.pageContentProvider.hasRemaining()},et.getPage=function(){return it(this,null,function*(){const t=new Z,e=this.getWidth();t.setWidth(e);const n=this.pageMetrics.getAvailableHeight();if(t.setHeight(n),this.headerProvider.hasPageHeader()){const E=this.headerProvider.getPageHeader(this.pageIdx);t.setHeader(E)}if(this.footerProvider.hasPageFooter(this.pageIdx)){const E=this.footerProvider.getPageFooter();t.setFooter(E)}const x=yield this.pageContentProvider.getPageContent();return t.setContent(x),this.pageIdx++,t.format(),t})},et.getWidth=function(){return this.pageMetrics.getAvailableWidth(this.pageIdx)},et.setPageIdx=function(t){this.pageIdx=t};const St=nt;var ue=y(593566);const ge=function(t,e,n,x){const E=pe(t,e,n),G=me(t,e,n),Q=n.getMinimalAvailableWidth(),j=Fe(x),K=_e(x),tt=x.hasSingleStaff();return{firstShardAvailableHeight:E,otherShardsAvailableHeight:G,availableWidth:Q,firstSliceHeaderWidth:j,otherSlicesHeaderWidth:K,hasSingleStaff:tt}},pe=function(t,e,n){return xe(t,e,n,0)},me=function(t,e,n){return xe(t,e,n,1)},xe=function(t,e,n,x){const G=t.getPageHeader(x).getHeight(),j=e.getPageFooter(x).getHeight();return n.getAvailableHeight()-(G+j)},Fe=function(t){return Ie(t,!0)},_e=function(t){return Ie(t,!1)},Ie=function(t,e){const n=t.getAllSystems(e);return t.insertGroups(n),(0,oe.A)(n),(0,ue.A)(n,t.drawingContext),n.filter(G=>G.hasGroupStart()).forEach(G=>{G.getGroupBracket().refreshGroupBracketOffset()}),n.forEach(Te),n.map(De).reduce(g.default.max2)},Te=function(t){const e=t.content.getNominalInnerHeight();t.header.setNominalHeight(e)},De=function(t){return t.getHeaderWidth()},Le=ge;var Re=y(604824);const Pe=function(){this.init()},ve=Pe.prototype;ve.init=function(){},ve.build=function({scoreData:t,scoreDataCache:e,containers:n,drawingContext:x,pageOpts:E,measureNumberingPolicy:G,startMeasureIdx:Q}){const j=new m(t,x,E),K=new Ht(t,x,E,j),tt=new X(t,x,E,j),rt=new h.A(E),Bt=new ut.A({scoreDataCache:e,measureRenderer:rt,drawingContext:x,startMeasureIdx:Q,measureNumberingPolicy:G}),he=new ft.A(e,x,E),ye=Le(K,tt,j,he),we=new Re.A(E.systemBreakConfig,E.hasPickup),Ae=new _t.A({measureProvider:Bt,systemProvider:he,drawingContext:x,metrics:ye,systemBreakPolicy:we,measuresSlicesContainer:n.measuresSlices,measureColumnsContainer:n.measureColumns}),be=new de(Ae,x,ye,we),Ee=new l({shardProvider:be,drawingContext:x,metrics:ye,pageOpts:E,pagesContainer:n.pages,shardsContainer:n.shards}),ss=new St(Ee,K,tt,j);return this.headerProvider=K,this.measureProvider=Bt,this.sliceProvider=Ae,this.shardProvider=be,this.measureProvider=Bt,this.contentProvider=Ee,ss};const Ne=Pe;var We=y(200608),He=y(562761),Be=y(341550),Oe=y(563711),Ue=y(918705),ze=y(364463),ke=y(472744),Ge=y(21738),Ye=y(131220),$e=y(409200),Ve=y(665280),Ke=y(77913),Xe=y(811048),Se=y(878639),Me=(t,e,n)=>new Promise((x,E)=>{var G=K=>{try{j(n.next(K))}catch(tt){E(tt)}},Q=K=>{try{j(n.throw(K))}catch(tt){E(tt)}},j=K=>K.done?x(K.value):Promise.resolve(K.value).then(G,Q);j((n=n.apply(t,e)).next())});const je="page",Ce=function(t,e,n,x,E,G){this.init(t,e,n,x,E,G)},O=Ce.prototype;(0,Xe.A)(O),O.getName=function(){return"PageLayout"},O.init=function(t,e,n,x,E,G){this.displayLockedState=!1,this.queue=G||(0,ke.A)(),E=E||{},this.scoreData=t,this.editionId=this.scoreData.getEditionId();const Q=(0,N.A)(t);(0,u.A)(E,t),typeof E.logoFontJson!="undefined"&&(E.logoFont=new U.A(E.logoFontJson,e,Q)),typeof E.systemBreakConfig=="undefined"&&(E.systemBreakConfig=this.scoreData.getSystemBreakPolicy()),typeof E.hideEmptyParts=="undefined"&&(E.hideEmptyParts=this.scoreData.getHideEmptyParts()),typeof E.pageNumberingStart=="undefined"&&(E.pageNumberingStart=null,this.scoreData.hasPageNumberingStart()&&(E.pageNumberingStart=this.scoreData.getPageNumberingStart()));const j=this.scoreData.getDefaults();(0,B.A)(j,E),this.drawingContext=new M.A(n,x,Q,e,E);const K=Je(E),tt=new Ue.A(E.measureNumberingPolicy,E.hasPickup);this.measuresContainer=new We.A(K),this.slicesContainer=new He.A,this.shardsContainer=new Be.A,this.pagesContainer=new Oe.A;const rt=new Ne,Bt={measureColumns:this.measuresContainer,measuresSlices:this.slicesContainer,shards:this.shardsContainer,pages:this.pagesContainer},he=(0,V.A)(t,E);this.scoreDataCache=new L.A(he,E),this.pageProvider=rt.build({scoreData:this.scoreData,scoreDataCache:this.scoreDataCache,containers:Bt,drawingContext:this.drawingContext,pageOpts:E,measureNumberingPolicy:tt,startMeasureIdx:K}),this.headerProvider=rt.headerProvider,this.measureProvider=rt.measureProvider,this.sliceProvider=rt.sliceProvider,this.shardProvider=rt.shardProvider,this.contentProvider=rt.contentProvider,this.pages=[],this.scaling=D.A.DEFAULT,this.pageOpts=E};const Je=function(t){let e=0;return z.A.isValid(t.measureNumberingStart)&&(e=t.measureNumberingStart-1),typeof t.firstMeasureIdx=="number"&&(e+=t.firstMeasureIdx),t.hasPickup&&e--,e};O.getPageSize=function(t){const e=this.getSpaceSize(),n=this.scoreData.getPageWidth()/10*e,x=this.scoreData.getPageHeight()/10*e;let E;const G=t+1;g.default.isNumber(t)&&G%2===1?E=this.scoreData.getOddPageMargins():E=this.scoreData.getEvenPageMargins();const Q=a.A.getTop(E)/10*e,j=a.A.getLeft(E)/10*e,K=a.A.getRight(E)/10*e;return{height:x,width:n,marginTop:Q,marginLeft:j,marginRight:K}},O.getSpaceSize=function(){return this.drawingContext.getSpaceSize()},O.hasRemaining=function(){return this.pageOpts.drawOnlyFirstPage&&this.pages.length>=1?!1:this.pageProvider.hasRemaining()},O.hideFirstPageNumberIfNeeded=function(){const[t]=this.pages;this.pageOpts.pageNumberingStart===null&&this.pagesContainer.getNbPages()===1&&!this.pageProvider.hasRemaining()?t.hidePageNumber():t.showPageNumber()},O.fillNextPage=function(t,e){return this.queue.add(()=>Me(this,null,function*(){Se.HAS_PERF_API&&performance.mark("adagio.fillNextPage.s"),this.lockDisplay("_pageLayout.fillNextPage");try{yield this._fillNextPage(t,e),this.unlockDisplay(),Se.HAS_PERF_API&&(performance.mark("adagio.fillNextPage.e"),performance.measure("adagio.fillNextPage","adagio.fillNextPage.s","adagio.fillNextPage.e"))}catch(n){throw this.unlockDisplay(),Se.HAS_PERF_API&&(performance.mark("adagio.fillNextPage.e"),performance.measure("adagio.fillNextPage","adagio.fillNextPage.s","adagio.fillNextPage.e")),n}}))},O.lockDisplay=function(t){if(this.scoreData.lockDataRead(this),this.displayLockedState)throw this.scoreData.unlockDataRead(this),new b.default(`An operation is already ongoing on the score: "${this.displayLockedState}"`);this.displayLockedState=t||!0},O.unlockDisplay=function(){this.scoreData.unlockDataRead(this),this.displayLockedState=!1},O._fillNextPage=function(t,e){return Me(this,null,function*(){typeof e=="undefined"&&(e=!0);const n=this.pages.length,x=this.getPageSize(n);t.attr("width",x.width*this.scaling),t.attr("height",x.height*this.scaling),t.attr("class",je);const E=t.append("g");E.attr("transform",`scale(${this.scaling})translate(${x.marginLeft}, ${x.marginTop})`);const G=yield this.pageProvider.getPage();this.pages.push(G),G.setParent(E),G.setSvgRoot(t),G.drawContentRec(),this.hideFirstPageNumberIfNeeded(),e&&G.bindToParent()})},O.bindPage=function(t){this.pages[t].bindToParent()},O.unbindPage=function(t){this.pages[t].unbind()},O.setScaling=function(t){D.A.assert(t),t!==this.scaling&&(this.scaling=t,this.pages.forEach(this.updatePageSvgSize,this))},O.updatePagesSvgSize=function(){this.pages.forEach(this.updatePageSvgSize,this)},O.updatePageSvgSize=function(t,e){const n=t.getSvgRoot(),x=this.getPageSize(e);n.attr("width",x.width*this.scaling),n.attr("height",x.height*this.scaling),t.getParent().attr("transform",`scale(${this.scaling})translate(${x.marginLeft}, ${x.marginTop})`)},O.getScaling=function(){return this.scaling},O.resetPagesGeometries=function(){this.pages.forEach(Qe)};const Qe=function(t){t.resetGeometries()};O.getAllPagesGeometries=function(){const t=this.pages.map(Ze);return Array.prototype.concat.apply([],t)};const Ze=function(t){return t.getGeometries()};O.getLastPageGeometries=function(){const t=this.pages.length;if(t===0){const x="There are no pages drawn.";throw new b.default("NoPageDrawn",x)}return this.pages[t-1].getGeometries()},O.uuidGetStaffLyricsUpY=function(t){return t=this.uuidToIdx(t),this.getStaffLyricsUpY(t.staffIdx,t.partIdx,t.measureIdx,t.level)},O.getStaffLyricsUpY=function(t,e,n,x){return this.getSliceForMeasureIdx(n).getStaffLyricsUpY(t,e,n,x)},O.uuidGetStaffWordsY=function(t){return t=this.uuidToIdx(t),this.getStaffWordsY(t.staffIdx,t.partIdx,t.measureIdx,t.placement)},O.getStaffWordsY=function(t,e,n,x){return this.getSliceForMeasureIdx(n).getStaffWordsY(t,e,n,x)},O.uuidGetSystemChordsY=function(t){return t=this.uuidToIdx(t),this.getSystemChordsY(t.partIdx,t.measureIdx)},O.getSystemChordsY=function(t,e){return this.getSliceForMeasureIdx(e).getSystemChordsY(t,e)},O.getSystemClassicHarmonyY=function(t,e){return this.getSystemTopStaffClassicHarmonyY(t,e)},O.uuidGetSystemTopStaffClassicHarmonyY=function(t){return t=this.uuidToIdx(t),this.getSystemTopStaffClassicHarmonyY(t.partIdx,t.measureIdx)},O.getSystemTopStaffClassicHarmonyY=function(t,e){return this.getSliceForMeasureIdx(e).getSystemTopStaffClassicHarmonyY(t,e)},O.uuidGetSystemBottomStaffClassicHarmonyY=function(t){return t=this.uuidToIdx(t),this.getSystemBottomStaffClassicHarmonyY(t.partIdx,t.measureIdx)},O.getSystemBottomStaffClassicHarmonyY=function(t,e){return this.getSliceForMeasureIdx(e).getSystemBottomStaffClassicHarmonyY(t,e)},O.uuidGetSystemBottomStaffFiguredBassY=function(t){return t=this.uuidToIdx(t),this.getSystemBottomStaffFiguredBassY(t.partIdx,t.measureIdx,t.level)},O.getSystemBottomStaffFiguredBassY=function(t,e,n){return this.getSliceForMeasureIdx(e).getSystemBottomStaffFiguredBassY(t,e,n)},O.getPagesStructures=function(){return this.pages.map(qe)};const qe=function(t){return t.getStructure()};O.getLyricsFontSize=function(){return this.drawingContext.getLyricsFontSize()},O.getHarmonyFontSize=function(){return this.drawingContext.getHarmonyFontSize()},O.getWordFontSize=function(){return this.drawingContext.getWordFontSize()},O.removePage=function(t){this.checkPageIdx(t),this.pagesContainer.remove(t),this.getPage(t).unbind(),this.pages.splice(t,1)},O.getLastContent=function(){return this.pagesContainer.getLastPage()},O.hasAnyPageContent=function(){return this.pagesContainer.hasAnyPage()},O.getContentProvider=function(){return this.contentProvider},O.getMeasureProvider=function(){return this.measureProvider},O.getShardProvider=function(){return this.shardProvider},O.getNbShards=function(){return this.shardsContainer.getNbShards()},O.getSliceProvider=function(){return this.sliceProvider},O.getPageProvider=function(){return this.pageProvider},O.getNbSlices=function(){return this.slicesContainer.getNbSlices()},O.getPage=function(t){return this.checkPageIdx(t),this.pages[t]},O.checkPageIdx=function(t){const e=this.getNbPages();if(!g.default.isInteger(t)||t<0||t>=e){const n=`Bad page index: [${t}]`;throw new b.default("BadPageIdx",n)}},O.getNbPages=function(){return this.pages.length},O.getMeasuresContainer=function(){return this.measuresContainer},O.getDrawingContext=function(){return this.drawingContext},O.getNbMeasures=function(){return this.measuresContainer.getNbMeasures()+this.measureProvider.getNbMeasuresInCache()},O.getSlicesContainer=function(){return this.slicesContainer},O.getShardsContainer=function(){return this.shardsContainer},O.getPagesContainer=function(){return this.pagesContainer},O.getHeaderProvider=function(){return this.headerProvider},O.drawBasicCursor=function(t,e){this.getSliceForMeasureIdx(t.measureIdx).drawBasicCursor(t,e)},O.drawGraceCursor=function(t,e){this.getSliceForMeasureIdx(t.measureIdx).drawGraceCursor(t,e)},O.drawTabCursor=function(t,e){this.getSliceForMeasureIdx(t.measureIdx).drawTabCursor(t,e)},O.drawDynamicCursor=function(t,e){this.getSliceForMeasureIdx(t.measureIdx).drawDynamicCursor(t,e)},O.drawPizzicatoCursor=function(t,e){this.getSliceForMeasureIdx(t.measureIdx).drawPizzicatoCursor(t,e)},O.drawMuteCursor=function(t,e){this.getSliceForMeasureIdx(t.measureIdx).drawMuteCursor(t,e)},O.drawHorizontalCursor=function(t,e){const n=t.startMeasureIdx,x=t.stopMeasureIdx;this.getSlicesForMeasuresRange(n,x+1).forEach(function(G,Q,j){if(G===null)return;const K=j.length,tt=(0,S.default)(t);tt.startNoteIdx=Q>0?null:t.startNoteIdx,tt.stopNoteIdx=Q<K-1?null:t.stopNoteIdx,G.drawHorizontalCursor(tt,e)})},O.drawHorizontalCursorTimePos=function(t,e){const n=t.startMeasureIdx,x=t.stopMeasureIdx;this.getSlicesForMeasuresRange(n,x+1).forEach(function(G,Q,j){if(G===null)return;const K=j.length,tt=(0,S.default)(t);tt.startTimePos=Q>0?null:t.startTimePos,tt.stopTimePos=Q<K-1?null:t.stopTimePos,G.drawHorizontalCursorTimePos(tt,e)})},O.drawHorizontalMeasureWideCursor=function(t,e){this.getSliceForMeasureIdx(t.measureIdx).drawHorizontalMeasureWideCursor(t,e)},O.drawCrossMeasureNoteCursor=function(t,e){if(t=(0,Ke.A)(this,t),t===null)return;const n=t.startMeasureIdx,x=t.stopMeasureIdx;this.getSlicesForMeasuresRange(n,x+1).forEach(function(G,Q,j){if(G===null)return;const K=j.length,tt=(0,S.default)(t);tt.startNoteIdx=Q>0?null:t.startNoteIdx,tt.stopNoteIdx=Q<K-1?null:t.stopNoteIdx,G.drawCrossMeasureNoteCursor(tt,e)})},O.getSliceForMeasureIdx=function(t){const e=this.measuresContainer.getNbMeasures();return t<e?this.measuresContainer.getMeasuresSliceForMeasureIdx(t):(t-=e,this.measureProvider.checkMeasureIdx(t),null)},O.getSlicesForMeasuresRange=function(t,e){const n=this.measuresContainer.getNbMeasures();return t>n?(t-=n,this.measureProvider.checkMeasureIdx(t),[]):(e=Math.min(e,n),this.measuresContainer.getSlicesForMeasuresRange(t,e))},O.getScoreData=function(){return this.scoreData},O.uuidGetMeasureEnclosingStaffElem=function(t){return t=this.uuidToIdx(t),this.getMeasureEnclosingStaffElem(t.partIdx,t.staffIdx,t.measureIdx)},O.getMeasureEnclosingStaffElem=function(t,e,n){return this.getSliceForMeasureIdx(n).getStaffElem(t,e)},O.uuidGetMeasureWidth=function(t){return t=this.uuidToIdx(t),this.getMeasureWidth(t.partIdx,t.measureIdx)},O.getMeasureWidth=function(t,e){return this.getSliceForMeasureIdx(e).getMeasureWidth(t,e)},O.uuidGetMeasurePosXInStaff=function(t){return t=this.uuidToIdx(t),this.getMeasurePosXInStaff(t.partIdx,t.measureIdx)},O.getMeasurePosXInStaff=function(t,e){return this.getSliceForMeasureIdx(e).getMeasurePosXInStaff(t,e)},O.uuidGetNoteXInMeasure=function(t){return t=this.uuidToIdx(t),this.getNoteXInMeasure(t.partIdx,t.staffIdx,t.measureIdx,t.voiceIdx,t.noteIdx)},O.getNoteXInMeasure=function(t,e,n,x,E){return this.getSliceForMeasureIdx(n).getNoteXInMeasure(t,e,n,x,E)},O.uuidGetTimePosXInMeasure=function(t){return t=this.uuidToIdx(t),this.getTimePosXInMeasure(t.partIdx,t.staffIdx,t.measureIdx,t.timePos,t.dpq)},O.getTimePosXInMeasure=function(t,e,n,x,E){return this.getSliceForMeasureIdx(n).getTimePosXInMeasure(t,e,n,x,E)},O.uuidGetSystemHeight=function(t){const e=this.uuidToIdx(t);return this.getSystemHeight(e.partIdx,e.measureIdx)},O.getSystemHeight=function(t,e){return this.getSliceForMeasureIdx(e).getStaffHeight(t)},O.uuidGetStaffInnerHeight=function(t){const e=this.uuidToIdx(t);return this.getStaffInnerHeight(e.partIdx,e.staffIdx,e.measureIdx)},O.getStaffInnerHeight=function(t,e,n){return this.getSliceForMeasureIdx(n).getStaffInnerHeight(t,e)},O.uuidGetSpaceAboveStaff=function(t){const e=this.uuidToIdx(t);return this.getSpaceAboveStaff(e.partIdx,e.staffIdx,e.measureIdx)},O.getSpaceAboveStaff=function(t,e,n){return this.getSliceForMeasureIdx(n).getSpaceAboveStaff(t,e)},O.uuidGetMeasureNbNotes=function(t){const e=this.uuidToIdx(t);return this.getMeasureNbNotes(e.partIdx,e.staffIdx,e.measureIdx,e.voiceIdx)},O.getMeasureNbNotes=function(t,e,n,x){return this.getSliceForMeasureIdx(n).getMeasureNbNotes(t,e,n,x)},O.getScoreDataCache=function(){return this.scoreDataCache},O.uuidGetPartBottomMeasureElem=function(t){const e=this.uuidToIdx(t);return this.getSliceForMeasureIdx(e.measureIdx).getPartBottomMeasureElem(e.partIdx,e.measureIdx)},O.uuidGetMeasureEventRect=function(t){const e=this.uuidToIdx(t),n=this.getSliceForMeasureIdx(e.measureIdx);return n===null?null:n.getMeasureEventRect(e.partIdx,e.staffIdx,e.measureIdx)},O.uuidGetMeasureElem=function(t){const e=this.uuidToIdx(t);return this.getSliceForMeasureIdx(e.measureIdx).getMeasureElem(e.partIdx,e.staffIdx,e.measureIdx)},O.getMeasureElemFromDataIdx=function(t,e,n){const x=this.scoreDataCache.dataToDisplayedPartIdx(t);return this.getSliceForMeasureIdx(n).getMeasureElem(x,e,n)},O.getMeasureElem=function(t,e,n){return this.getSliceForMeasureIdx(n).getMeasureElem(t,e,n)},O.splitMeasuresRangeBySlices=function(t){return(0,ze.A)(this.measuresContainer,t)},O.uuidGetMeasurePageSvgParent=function(t){const e=this.uuidToIdx(t),n=this.getSliceForMeasureIdx(e.measureIdx);if(n===null)return null;const x=n.getShards(),E=n.getSystem(e.partIdx),G=x.find(ts,E);if(!G||!G.hasPartContent())return null;const Q=G.getPageIdx();return Q>=this.getNbPages()?null:this.getPageSvg(Q)},O.getPageSvg=function(t){const e=this.getPage(t);return e.hasSvgRoot()?e.getSvgRoot():null};function ts(t){const e=this;return t.hasSystem(e)}O.uuidIsMeasureRendered=function(t){return this.uuidGetMeasurePageSvgParent(t)!==null},O.uuidToIdx=function(t){t=(0,S.default)(t);const e=this.getScoreData();if((0,Ge.default)(e,t),(0,Ve.default)(e,t),(0,$e.default)(e,t),(0,Ye.default)(e,t),typeof t.partIdx!="undefined"){const n=this.getScoreDataCache();t.partIdx=n.dataToDisplayedPartIdx(t.partIdx)}return t},O.isSyncWithData=function(){return this.editionId===this.scoreData.getEditionId()},O.stateSyncWithData=function(){this.editionId=this.scoreData.getEditionId()};const es=Ce},91960:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>U});const b=function(){this.init()},N=b.prototype;N.init=function(){this.updateMeasureIdxFrom=null,this.addedStaffMeasures=[],this.slicesIndexesSet={}},N.logAddedMeasure=function(M){this.addedStaffMeasures.push(M)},N.logUpdateMeasureIdxFrom=function(M){this.updateMeasureIdxFrom===null?this.updateMeasureIdxFrom=M:this.updateMeasureIdxFrom=Math.min(this.updateMeasureIdxFrom,M)},N.logMeasuresSliceIdx=function(M){this.slicesIndexesSet[M]=!0},N.getUpdateData=function(){return{updateMeasureIdxFrom:this.updateMeasureIdxFrom,addedStaffMeasures:this.addedStaffMeasures,slicesIndexesSet:this.slicesIndexesSet}};const U=b},182879:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>U});var b=y(364842);const N={ADD:"ADD",REMOVE:"REMOVE",UPDATE:"UPDATE",ADD_VOICE:"ADD_VOICE",MMR:"MMR"};N.raiseError=function(M){const B=`Bad display update operation type: [${M}].`;throw new b.default("BadUpdateType",B)};const U=N},220650:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>U});const b=function(M,B){this.init(M,B)},N=b.prototype;N.init=function(M,B){this.measuresContainer=M,this.measureProvider=B},N.perform=function(M,B){let u=M.displayLocation.measureIdx;B.logUpdateMeasureIdxFrom(u);const a=this.measuresContainer.getNbMeasures();if(u<a){const g=this.measuresContainer.getMeasuresSliceIdxFromMeasureIdx(u);B.logMeasuresSliceIdx(g),this.measuresContainer.removeMeasureColumn(u)}else u-=a,this.measureProvider.removeCachedMeasure(u)};const U=b},293329:function(st,Y,y){"use strict";var b=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(Y,"__esModule",{value:!0});const N=b(y(769681)),U=b(y(352363)),M=b(y(606741)),B={};B.getStep=function(g){return g["display-step"]},B.getOctave=function(g){return parseInt(g["display-octave"],10)},B.create=function(g,S){return{"display-step":S,"display-octave":g.toString()}},B.getStepIdx=function(g){const S=B.getStep(g);return M.default.getStepIdx(S)},B.stringify=function(g){let S="u";return S+=B.getStep(g),S+="/",S+=B.getOctave(g),S},B.parse=function(g){let S=g;if(S[0]!=="u")throw new N.default(g);S=S.substr(1);const D=S.split("/"),z=D[0];if(!M.default.isValid(z))throw new N.default(g);const V=D[1],L=parseInt(V,0);if(!U.default.isValid(L))throw new N.default(g);return B.create(L,z)},B.isSame=function(g,S){const D=B.getOctave(g),z=B.getOctave(S);if(D!==z)return!1;const V=B.getStep(g),L=B.getStep(S);return V===L},B.isSameLine=function(g,S){return B.isSame(g,S)},B.compare=function(g,S){const D=u(g,S);return D!==0?D:a(g,S)};const u=function(g,S){const D=B.getOctave(g),z=B.getOctave(S);return D-z},a=function(g,S){const D=B.getStepIdx(g),z=B.getStepIdx(S);return D-z};B.copy=function(g){const S=B.getOctave(g),D=B.getStep(g);return B.create(S,D)},Y.default=B},306967:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>B});var b=y(98710);const N=function(u,a,g){this.init(u,a,g)},U=N.prototype;U.init=function(u,a,g){this.measuresContainer=u,this.measureProvider=a,this.drawingContext=g},U.perform=function(u,a){const g=u.actions,S=g[0],D=S.displayLocation.measureIdx,z=S.realLocation.measureIdx,V=this.getMeasureColumn(D);if(V.setDataIdx(z),V.areSystemsInitialized()&&g.forEach(function(L){const h=L.data,v=this.createSystemMeasure(h);M(a,v);const w=L.displayLocation.partIdx;V.replaceMeasure(v,w)},this),V.hasMeasuresSlice()){const L=V.getMeasuresSliceIdx();a.logMeasuresSliceIdx(L)}},U.getMeasureColumn=function(u){const a=this.measuresContainer.getNbMeasures();return u<a?this.measuresContainer.getMeasureColumn(u):(u-=a,this.measureProvider.getCachedMeasure(u))},U.createSystemMeasure=function(u){const a=this.drawingContext.getMeasureRendererOpts(),S=new b.A(a).renderMeasure(u);return S.forEach(this.renderStaffMeasure,this),S},U.renderStaffMeasure=function(u){u.render(this.drawingContext)};const M=function(u,a){a.forEach(function(g){u.logAddedMeasure(g)})},B=N},341550:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>B});var b=y(364842),N=y(726042);const U=function(){this.init()},M=U.prototype;M.init=function(){this.shards=[]},M.push=function(u){this.shards.push(u)},M.indexOf=function(u){return this.shards.indexOf(u)},M.insert=function(u,a){this.shards.splice(a,0,u)},M.remove=function(u){this.checkShardIdx(u);const a=this.shards.splice(u,1)[0],g=a.getPageContent(),S=g.getIdxInPage(a);g.removeShard(S),a.destroy()},M.updateShardIdxFrom=function(u){const a=this.getNbShards();for(let g=u;g<a;g++)this.getShard(g).setIdx(g)},M.getShard=function(u){return this.checkShardIdx(u),this.shards[u]},M.checkShardIdx=function(u){const a=this.getNbShards();if(!N.default.isInteger(u)||u<0||u>=a){const g=`Bad shard index [${u}]`;throw new b.default("BadShardIdx",g)}},M.getNbShards=function(){return this.shards.length},M.getUnbindedShards=function(){const u=this.getNbShards(),a=[];for(let g=u-1;g>=0;g--){const S=this.getShard(g);if(!S.hasPageContent())a.unshift(S),this.shards.pop();else return a}return a};const B=U},364463:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>N});function b(U,M){const B=U.getNbMeasures();return M.startMeasureIdx>=B?null:{startMeasureIdx:M.startMeasureIdx,stopMeasureIdx:Math.min(M.stopMeasureIdx,B-1)}}function N(U,M){if(M=b(U,M),M===null)return[];const B=[];let u={startMeasureIdx:M.startMeasureIdx,stopMeasureIdx:null};for(let a=M.startMeasureIdx+1;a<=M.stopMeasureIdx;a++){const g=a-1,S=U.getMeasuresSliceIdxForMeasureIdx(g),D=U.getMeasuresSliceIdxForMeasureIdx(a);S!==D&&(u.stopMeasureIdx=g,B.push(u),u={startMeasureIdx:a,stopMeasureIdx:null})}return u.stopMeasureIdx=M.stopMeasureIdx,B.push(u),B}},411259:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>a});var b=y(364842),N=y(851083);const U=function(g,S){if(typeof S.fretData!="undefined"){const D=M(g,S),z=B(g,S),V=(0,N.A)(S.fretData,D,z);S.pitch=V}},M=function(g,S){const D=u(g,S);return g.getStaffDetails(D)},B=function(g,S){const D=u(g,S);return g.getKey(D)},u=function(g,S){if(typeof S.staffIdx!="undefined")return S.staffIdx;if(typeof S.voiceIdx!="undefined")return g.getVoiceMainStaffIdx(S.voiceIdx);{const D="Cannot convert fret to pitch since there is no staffIdx informations.";throw new b.default("NoStaffIdx",D)}},a=U},413160:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>pt});var b=y(364842),N=y(182879);const U=function(){this.init()},M=U.prototype;M.init=function(){this.number=0},M.getId=function(){const f=this.number;return this.number++,f};const B=U,u=function(f,I){const A=new a(f,I);return A.replay(),A.getResult()},a=function(f,I){this.init(f,I)},g=a.prototype;g.init=function(f,I){this.actions=f,this.wrappedActions=[],this.idGenerator=new B,this.measures=[],this.initialMeasures=[],this.initMeasures(I)},g.initMeasures=function(f){for(let I=0;I<f;I++){const A=this.getId();this.measures.push(A)}this.initialMeasures=this.measures.slice()},g.replay=function(){this.replayActions()},g.replayActions=function(){this.actions.forEach(this.replayAction,this)},g.replayAction=function(f){const I=this.applyAction(f),A=S(I,f);this.wrappedActions.push(A)};const S=function(f,I){return{id:f,action:I}};g.applyAction=function(f){const I=f.type;if(I===N.A.UPDATE)return this.applyUpdate(f);if(I===N.A.ADD)return this.applyAdd(f);if(I===N.A.REMOVE)return this.applyRemove(f);N.A.raiseError(I)},g.applyUpdate=function(f){const I=f.displayLocation.measureIdx;return this.checkGetIdx(I),this.measures[I]},g.applyRemove=function(f){const I=f.displayLocation.measureIdx;this.checkGetIdx(I);const A=this.measures[I];return this.measures.splice(I,1),A},g.checkGetIdx=function(f){if(typeof f!="number"||f<0||f>=this.measures.length){const I=`The measure idx [${f}] is outside autorized range.`;throw new b.default("BadMeasureIdx",I)}},g.applyAdd=function(f){const I=f.displayLocation.measureIdx;this.checkInsertionIdx(I);const A=this.getId();return this.measures.splice(I,0,A),A},g.checkInsertionIdx=function(f){if(typeof f!="number"||f<0||f>this.measures.length){const I=`The measure insertion idx [${f}] is outside autorized range.`;throw new b.default("BadMeasureIdx",I)}},g.getId=function(){return this.idGenerator.getId()},g.getResult=function(){return{wrappedActions:this.wrappedActions,initialMeasures:this.initialMeasures,finalMeasures:this.measures}};const D=u,z=function(f){return f=f.filter(V),f},V=function(f){return f.action.type===N.A.UPDATE},L=z,h=function(f,I,A){const X={finalIdToIdx:I,addedIds:A};return f=f.filter(v,X),f},v=function(f){const I=this.finalIdToIdx,A=this.addedIds,X=f.id;return!(typeof A[X]!="undefined"||typeof I[X]=="undefined")},w=h,p=function(f){const I={};return f.filter(m,I)},m=function(f){if(f.action.type!==N.A.UPDATE)return!0;const I=this,A=P(f);return typeof I[A]=="undefined"?(I[A]=!0,!0):!1},P=function(f){const I=f.action.displayLocation.partIdx,A=f.id;return`${I}/${A}`},W=p;var s=y(890439),i=y(726042);const c=function(f){return f=s.Ay.toList(f),f=f.map(i.default.intPart),f.map(d)},d=function(f){return{id:f,action:{type:N.A.ADD,displayLocation:{measure:null}}}},F=c,$=function(f){return f=s.Ay.toList(f),f=f.map(i.default.intPart),f.map(q)},q=function(f){return{id:f,action:{type:N.A.REMOVE,displayLocation:{measure:null}}}},J=$,T=function(f,I){const A=this.valueOf(),X=H(A,f),ut=H(A,I);return-(X-ut)},H=function(f,I){const A=I.id;if(typeof f[A]=="undefined"){const X=`There is no index for the measure id [${A}]`;throw new b.default("BadMeasureId",X)}else return f[A]},R=T,k=function(f,I,A){new vt(f,I,A).fixDisplayLocations()},vt=function(f,I,A){this.init(f,I,A)},ot=vt.prototype;ot.init=function(f,I,A){this.srcAdds=f.slice(),this.initialIdToIdx=A,this.finalMeasures=I.slice(),this.finalMeasures.reverse(),this.buffer=[]},ot.fixDisplayLocations=function(){if(this.finalMeasures.forEach(this.addMeasure,this),this.setDisplayIdx(0),this.srcAdds.length>0){const f="At this point there should be no add actions not processed.";throw new b.default("RemainingActions",f)}},ot.addMeasure=function(f){this.isInitialMeasure(f)?(this.setDisplayIdxFromId(f),this.flush()):this.addActionToBuffer(f)},ot.isInitialMeasure=function(f){return typeof this.initialIdToIdx[f]!="undefined"},ot.setDisplayIdxFromId=function(f){const A=this.getInitialIdxFromId(f)+1;this.setDisplayIdx(A)},ot.getInitialIdxFromId=function(f){if(this.isInitialMeasure(f))return this.initialIdToIdx[f];{const I=`The measure id [${f}] is invalid.`;throw new b.default("BadMeasureId",I)}},ot.setDisplayIdx=function(f){this.buffer.forEach(Tt,f)};const Tt=function(f){const I=this.valueOf(),A=f.action.displayLocation;A.measureIdx=I};ot.flush=function(){this.buffer=[]},ot.addActionToBuffer=function(f){let I;if(this.srcAdds.length===0)throw I="There should be remaining actions.",new b.default("NoMoreActions",I);{const A=this.srcAdds.shift();if(f!==A.id)throw I=`The measure id [${f}] do not match the action measure id [${A.id}].`,new b.default("MeasureIdMissmatch",I);this.buffer.push(A)}},ot.getWrappedAdds=function(){return this.destAdds};const Ct=k,dt=function(f,I,A){new Dt(f,I,A).fixDisplayLocations()},Dt=function(f,I,A){this.init(f,I,A)},xt=Dt.prototype;xt.init=function(f,I,A){this.wrappedRemoves=f,this.removedIds=A,this.intermediateMeasures=I,this.actionIdx=0},xt.fixDisplayLocations=function(){const f=this.intermediateMeasures.length;for(let I=f-1;I>=0;I--){const A=this.intermediateMeasures[I];this.isMeasureRemoved(A)&&this.fillDisplayIdx(A,I)}if(this.actionIdx!==this.wrappedRemoves.length){const I="At this point, all remove actions should have been processed.";throw new b.default("RemainingActions",I)}},xt.isMeasureRemoved=function(f){return this.removedIds[f]===!0},xt.fillDisplayIdx=function(f,I){let A;if(this.actionIdx>=this.wrappedRemoves.length)throw A="There should be remaining actions at this point.",new b.default("Missing action",A);const X=this.wrappedRemoves[this.actionIdx];if(X.id!==f)throw A=`The measure id [${f}] do not match the action measure id [${X.id}].`,new b.default("MeasureIdMissmatch",A);X.action.displayLocation.measureIdx=I,this.actionIdx++};const gt=dt,Ot=function(f){const I={};return f.forEach(Ut,I),I},Ut=function(f,I){const A=this.valueOf();A[f]=I},wt=Ot,zt=function(f,I){const A=f.slice();return I.forEach(At,A),A},At=function(f){const I=this,A=f.action.type;A===N.A.UPDATE?mt(f,I):A===N.A.ADD?kt(f,I):A===N.A.REMOVE?ee(f,I):N.A.raiseError(A)},mt=function(f,I){const A=f.id,X=f.action.displayLocation.measureIdx;Et(I,X);const ut=I[X];if(A!==ut){const ft=`The action id [${A}] do not match the measure id [${ut}].`;throw new b.default("MeasureIdMissmatch",ft)}},kt=function(f,I){const A=f.id,X=f.action.displayLocation.measureIdx;Lt(I,X),I.splice(X,0,A)},Lt=function(f,I){if(I<0||I>f.length){const A=`The measure insertion idx [${I}] is out of range.`;throw new b.default("BadInsertIdx",A)}},ee=function(f,I){const A=f.id,X=f.action.displayLocation.measureIdx;Et(I,X);const ut=I[X];if(A!==ut){const ft=`The action id [${A}] do not match the measure id [${ut}].`;throw new b.default("MeasureIdMissmatch",ft)}I.splice(X,1)},Et=function(f,I){if(I<0||I>=f.length){const A=`The measure idx [${I}] is out of range.`;throw new b.default("BadGetIdx",A)}},It=zt,Gt=function(f,I){f.forEach(Yt,I)},Yt=function(f){const I=f.id,A=this.valueOf(),X=$t(A,I);f.action.displayLocation.measureIdx=X},$t=function(f,I){if(typeof f[I]=="undefined"){const A=`There is no measure index for the id [${I}]`;throw new b.default("BadMeasureId",A)}else return f[I]},Rt=Gt,Vt=function(f,I){const A=F(I.addedIds);A.sort(R.bind(I.finalIdToIdx)),Ct(A,I.finalMeasures,I.initialIdToIdx);const X=It(I.initialMeasures,A),ut=wt(X),ft=J(I.removedIds);ft.sort(R.bind(ut)),gt(ft,X,I.removedIds);const _t=It(X,ft);Rt(f,I.finalIdToIdx);const Zt=It(_t,f);return Kt(Zt,I.finalMeasures),[].concat(A,ft,f)},Kt=function(f,I){let A;const X=f.length;if(X!==I.length)throw A="The number of measures after the refinement is different than before.",new b.default("BadNbMeasures",A);for(let ut=0;ut<X;ut++){const ft=f[ut],_t=I[ut];if(ft!==_t)throw A="One of the measure id after the refinement is different that before.",new b.default("BadMeasureId",A)}},Nt=Vt;var Ft=y(737903);const Xt=function(f,I){new jt(f,I).fillRealLocations()},jt=function(f,I){this.init(f,I)},Mt=jt.prototype;Mt.init=function(f,I){this.wrappedActions=f,this.idToIdx=I},Mt.fillRealLocations=function(){this.wrappedActions.forEach(this.fillRealLocation,this)},Mt.fillRealLocation=function(f){if(f.action.type!==N.A.REMOVE){const I=f.id,A=this.getMeasureIdxForId(I),X=f.action,ut=X.displayLocation,ft=se(ut,A);X.realLocation=ft}},Mt.getMeasureIdxForId=function(f){if(typeof this.idToIdx[f]!="undefined")return this.idToIdx[f];{const I=`There is no measure index for the id [${f}].`;throw new b.default("BadMeasureId",I)}};const se=function(f,I){const A=(0,Ft.default)(f);return A.measureIdx=I,A},Wt=Xt,ct=function(f,I){new Ht(f,I).fillFinalDisplayLocations()},Ht=function(f,I){this.init(f,I)},Pt=Ht.prototype;Pt.init=function(f,I){this.wrappedActions=f,this.idToIdx=I},Pt.fillFinalDisplayLocations=function(){this.wrappedActions.forEach(this.fillRealLocation,this)},Pt.fillRealLocation=function(f){if(f.action.type!==N.A.REMOVE){const I=f.id,A=this.getMeasureIdxForId(I),X=f.action,ut=X.displayLocation,ft=lt(ut,A);X.finalDisplayLocation=ft}},Pt.getMeasureIdxForId=function(f){if(typeof this.idToIdx[f]!="undefined")return this.idToIdx[f];{const I=`There is no measure index for the id [${f}].`;throw new b.default("BadMeasureId",I)}};const lt=function(f,I){const A=(0,Ft.default)(f);return A.measureIdx=I,A},Jt=ct,ne=function(f,I){const A={initialMeasures:f,finalMeasures:I};return A.initialIdToIdx=wt(f),A.finalIdToIdx=wt(I),A.idToDataIdx=wt(I),A.addedIds=s.Ay.substract(A.finalIdToIdx,A.initialIdToIdx),A.removedIds=s.Ay.substract(A.initialIdToIdx,A.finalIdToIdx),A},Qt=function(f,I){const A=D(f,I);let X=A.wrappedActions;const ut=ne(A.initialMeasures,A.finalMeasures);return X=L(X),X=w(X,ut.finalIdToIdx,ut.addedIds),X=W(X),X=Nt(X,ut),Wt(X,ut.idToDataIdx),Jt(X,ut.finalIdToIdx),f=X.map(bt),{measureActions:f}},bt=function(f){return f.action},pt=Qt},419262:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>a});var b=y(98710),N=y(532228);const U=function(g,S,D,z){this.init(g,S,D,z)},M=U.prototype;M.init=function(g,S,D,z){this.measuresContainer=g,this.scoreDataCache=z,this.measureProvider=S,this.drawingContext=D;const V=D.getMeasureRendererOpts();this.measureRenderer=new b.A(V)},M.perform=function(g,S){const D=g.realLocation.measureIdx;S.logUpdateMeasureIdxFrom(D);const z=g.data;let V=g.displayLocation.measureIdx;const L=this.measuresContainer.getNbMeasures();if(V<=L){const h=this.createRenderedMeasureColumn(z);u(S,h),this.measuresContainer.insertMeasure(h,V);const v=this.measuresContainer.getMeasuresSliceIdxFromMeasureIdx(V);S.logMeasuresSliceIdx(v)}else{V-=L;let h;B(this.measureProvider,V)?(h=this.createRenderedMeasureColumn(z),u(S,h)):h=this.createEmptyMeasure(z),this.measureProvider.insertMeasureToCache(h,V)}};function B(g,S){const D=g.getNbMeasuresInCache();return S>=D?!1:g.getCachedMeasure(S).areSystemsInitialized()}M.createRenderedMeasureColumn=function(g){const S=this.createScoreMeasure(g),D=new N.A;D.setSystems(S),D.setDrawingContext(this.drawingContext),D.measureNumberShift=g[0].nbMmr||1;const z=this.measureProvider.getMeasureNumberingPolicy();return D.setMeasureNumberingPolicy(z),D},M.createEmptyMeasure=function(g){const S=new N.A;S.setScoreDataCache(this.scoreDataCache),S.setDrawingContext(this.drawingContext),S.measureNumberShift=g[0].nbMmr||1;const D=this.measureProvider.getMeasureNumberingPolicy();S.setMeasureNumberingPolicy(D);const z=this.measureProvider.getMeasureRenderer();return S.setMeasureRenderer(z),S},M.createScoreMeasure=function(g){return g.map(this.createSystemMeasure,this)},M.createSystemMeasure=function(g){const S=this.measureRenderer.renderMeasure(g);return S.forEach(this.renderStaffMeasure,this),S},M.createCommonContent=function(g){const[S]=g;return this.commonContentBuilder.build(S)},M.renderStaffMeasure=function(g){g.render(this.drawingContext)};const u=function(g,S){const z=S.getSystemsMeasure();Array.prototype.concat.apply([],z).forEach(function(L){g.logAddedMeasure(L)})},a=U},444104:function(st,Y,y){var b;(function(N){"use strict";function U(i,c){var d=(i&65535)+(c&65535),F=(i>>16)+(c>>16)+(d>>16);return F<<16|d&65535}function M(i,c){return i<<c|i>>>32-c}function B(i,c,d,F,$,q){return U(M(U(U(c,i),U(F,q)),$),d)}function u(i,c,d,F,$,q,J){return B(c&d|~c&F,i,c,$,q,J)}function a(i,c,d,F,$,q,J){return B(c&F|d&~F,i,c,$,q,J)}function g(i,c,d,F,$,q,J){return B(c^d^F,i,c,$,q,J)}function S(i,c,d,F,$,q,J){return B(d^(c|~F),i,c,$,q,J)}function D(i,c){i[c>>5]|=128<<c%32,i[(c+64>>>9<<4)+14]=c;var d,F,$,q,J,T=1732584193,H=-271733879,R=-1732584194,k=271733878;for(d=0;d<i.length;d+=16)F=T,$=H,q=R,J=k,T=u(T,H,R,k,i[d],7,-680876936),k=u(k,T,H,R,i[d+1],12,-389564586),R=u(R,k,T,H,i[d+2],17,606105819),H=u(H,R,k,T,i[d+3],22,-1044525330),T=u(T,H,R,k,i[d+4],7,-176418897),k=u(k,T,H,R,i[d+5],12,1200080426),R=u(R,k,T,H,i[d+6],17,-1473231341),H=u(H,R,k,T,i[d+7],22,-45705983),T=u(T,H,R,k,i[d+8],7,1770035416),k=u(k,T,H,R,i[d+9],12,-1958414417),R=u(R,k,T,H,i[d+10],17,-42063),H=u(H,R,k,T,i[d+11],22,-1990404162),T=u(T,H,R,k,i[d+12],7,1804603682),k=u(k,T,H,R,i[d+13],12,-40341101),R=u(R,k,T,H,i[d+14],17,-1502002290),H=u(H,R,k,T,i[d+15],22,1236535329),T=a(T,H,R,k,i[d+1],5,-165796510),k=a(k,T,H,R,i[d+6],9,-1069501632),R=a(R,k,T,H,i[d+11],14,643717713),H=a(H,R,k,T,i[d],20,-373897302),T=a(T,H,R,k,i[d+5],5,-701558691),k=a(k,T,H,R,i[d+10],9,38016083),R=a(R,k,T,H,i[d+15],14,-660478335),H=a(H,R,k,T,i[d+4],20,-405537848),T=a(T,H,R,k,i[d+9],5,568446438),k=a(k,T,H,R,i[d+14],9,-1019803690),R=a(R,k,T,H,i[d+3],14,-187363961),H=a(H,R,k,T,i[d+8],20,1163531501),T=a(T,H,R,k,i[d+13],5,-1444681467),k=a(k,T,H,R,i[d+2],9,-51403784),R=a(R,k,T,H,i[d+7],14,1735328473),H=a(H,R,k,T,i[d+12],20,-1926607734),T=g(T,H,R,k,i[d+5],4,-378558),k=g(k,T,H,R,i[d+8],11,-2022574463),R=g(R,k,T,H,i[d+11],16,1839030562),H=g(H,R,k,T,i[d+14],23,-35309556),T=g(T,H,R,k,i[d+1],4,-1530992060),k=g(k,T,H,R,i[d+4],11,1272893353),R=g(R,k,T,H,i[d+7],16,-155497632),H=g(H,R,k,T,i[d+10],23,-1094730640),T=g(T,H,R,k,i[d+13],4,681279174),k=g(k,T,H,R,i[d],11,-358537222),R=g(R,k,T,H,i[d+3],16,-722521979),H=g(H,R,k,T,i[d+6],23,76029189),T=g(T,H,R,k,i[d+9],4,-640364487),k=g(k,T,H,R,i[d+12],11,-421815835),R=g(R,k,T,H,i[d+15],16,530742520),H=g(H,R,k,T,i[d+2],23,-995338651),T=S(T,H,R,k,i[d],6,-198630844),k=S(k,T,H,R,i[d+7],10,1126891415),R=S(R,k,T,H,i[d+14],15,-1416354905),H=S(H,R,k,T,i[d+5],21,-57434055),T=S(T,H,R,k,i[d+12],6,1700485571),k=S(k,T,H,R,i[d+3],10,-1894986606),R=S(R,k,T,H,i[d+10],15,-1051523),H=S(H,R,k,T,i[d+1],21,-2054922799),T=S(T,H,R,k,i[d+8],6,1873313359),k=S(k,T,H,R,i[d+15],10,-30611744),R=S(R,k,T,H,i[d+6],15,-1560198380),H=S(H,R,k,T,i[d+13],21,1309151649),T=S(T,H,R,k,i[d+4],6,-145523070),k=S(k,T,H,R,i[d+11],10,-1120210379),R=S(R,k,T,H,i[d+2],15,718787259),H=S(H,R,k,T,i[d+9],21,-343485551),T=U(T,F),H=U(H,$),R=U(R,q),k=U(k,J);return[T,H,R,k]}function z(i){var c,d="",F=i.length*32;for(c=0;c<F;c+=8)d+=String.fromCharCode(i[c>>5]>>>c%32&255);return d}function V(i){var c,d=[];for(d[(i.length>>2)-1]=void 0,c=0;c<d.length;c+=1)d[c]=0;var F=i.length*8;for(c=0;c<F;c+=8)d[c>>5]|=(i.charCodeAt(c/8)&255)<<c%32;return d}function L(i){return z(D(V(i),i.length*8))}function h(i,c){var d,F=V(i),$=[],q=[],J;for($[15]=q[15]=void 0,F.length>16&&(F=D(F,i.length*8)),d=0;d<16;d+=1)$[d]=F[d]^909522486,q[d]=F[d]^1549556828;return J=D($.concat(V(c)),512+c.length*8),z(D(q.concat(J),640))}function v(i){var c="0123456789abcdef",d="",F,$;for($=0;$<i.length;$+=1)F=i.charCodeAt($),d+=c.charAt(F>>>4&15)+c.charAt(F&15);return d}function w(i){return unescape(encodeURIComponent(i))}function p(i){return L(w(i))}function m(i){return v(p(i))}function P(i,c){return h(w(i),w(c))}function W(i,c){return v(P(i,c))}function s(i,c,d){return c?d?P(c,i):W(c,i):d?p(i):m(i)}b=function(){return s}.call(Y,y,Y,st),b!==void 0&&(st.exports=b)})(this)},448931:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>U,p:()=>b});const b="primitive.AddVoice",U={NAME:b}},456582:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>U,p:()=>b});const b="primitive.RemoveMeasure",U={NAME:b}},494735:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>b});function b(N){window.requestAnimationFrame?window.requestAnimationFrame(N):setTimeout(N)}},518985:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>V});var b=y(364842),N=y(869773),U=y(456582),M=y(448931),B=y(851480),u=y(606333),a=y(182879);const g=function(L){const h=L.type;let v,w;if(h===M.A.NAME)return S(L);if(h===B.A.NAME||h===u.A.NAME)return D(L);const p=L.opts.measureIdx;if(typeof p!="number")throw v=`The measureIdx [${p}] is invalid for the action [${h}]. `,w=new b.default("MissingMeasureIdx",v),w.actionName=h,w;const m=L.opts.partIdx;if(typeof m!="number")throw v=`The partIdx [${m}] is invalid for the action [${m}]. `,w=new b.default("MissingPartIdx",v),w.actionName=h,w;const P=z(L),W={measureIdx:L.opts.measureIdx,partIdx:L.opts.partIdx};return{type:P,displayLocation:W}},S=function(L){const h=M.A.NAME;let v,w;const p=L.opts.partIdx;if(typeof p!="number")throw v=`The partIdx [${p}] is invalid for the action [${p}]. `,w=new b.default("MissingPartIdx",v),w.actionName=h,w;const m=L.opts.voiceIdx;if(typeof m!="number")throw v=`The voiceIdx [${m}] is invalid for the action [${m}]. `,w=new b.default("MissingVoiceIdx",v),w.actionName=h,w;const P=L.opts.staffIdx;if(typeof P!="number")throw v=`The staffIdx [${P}] is invalid for the action [${P}]. `,w=new b.default("MissingStaffIdx",v),w.actionName=h,w;return{type:a.A.ADD_VOICE,displayLocation:{partIdx:p,voiceIdx:m,staffIdx:P}}};function D(L){const h=L.opts.measureIdx,v=L.type;if(typeof h!="number"){const m=`The measureIdx [${h}] is invalid for the action [${v}].`,P=new b.default("MissingMeasureIdx",m);throw P.actionName=v,P}const w=L.opts.partIdx;if(typeof w!="number"){const m=`The partIdx [${w}] is invalid for the action [${v}].`,P=new b.default("MissingPartIdx",m);throw P.actionName=v,P}return{type:a.A.MMR,displayLocation:{measureIdx:h,partIdx:w}}}const z=function(L){return L.type===N.A.NAME?a.A.ADD:L.type===U.A.NAME?a.A.REMOVE:a.A.UPDATE},V=g},558929:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>B});var b=y(182879);const N=function(u){this.init(u)},U=N.prototype;U.init=function(u){this.srcActions=u,this.mergedActions=[],this.columnsActions={}},U.merge=function(){return this.srcActions.forEach(this.addAction,this),this.pushColumnsActions(),this.mergedActions},U.addAction=function(u){M(u)?this.addToColumn(u):(this.pushColumnsActions(),this.mergedActions.push(u))},U.addToColumn=function(u){const a=u.displayLocation.measureIdx;typeof this.columnsActions[a]=="undefined"&&(this.columnsActions[a]=[]),this.columnsActions[a].push(u)};const M=function(u){return u.type===b.A.UPDATE};U.pushColumnsActions=function(){for(const u in this.columnsActions){const g={actions:this.columnsActions[u],type:b.A.UPDATE};this.mergedActions.push(g)}this.columnsActions={}};const B=N},562761:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>B});var b=y(726042),N=y(364842);const U=function(){this.init()},M=U.prototype;M.init=function(){this.measuresSlices=[]},M.push=function(u){this.measuresSlices.push(u)},M.remove=function(u){this.checkSliceIdx(u),this.measuresSlices.splice(u,1)},M.getMeasuresSlice=function(u){return this.checkSliceIdx(u),this.measuresSlices[u]},M.checkSliceIdx=function(u){const a=this.getNbSlices();if(!b.default.isInteger(u)||u<0||u>=a){const g=`Bad slice index [${u}]`;throw new N.default("BadSliceIdx",g)}},M.updateSliceIdxFrom=function(u){const a=this.getNbSlices();for(let g=u;g<a;g++)this.getMeasuresSlice(g).updateId(g)},M.getNbSlices=function(){return this.measuresSlices.length},M.isShardFromLastSlice=function(u){const a=this.getNbSlices()-1;return this.getMeasuresSlice(a).shards.includes(u)},M.forEach=function(u,a){this.measuresSlices.forEach(u,a)};const B=U},563711:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>B});var b=y(364842),N=y(726042);const U=function(){this.init()},M=U.prototype;M.init=function(){this.pages=[]},M.push=function(u){this.pages.push(u)},M.getPage=function(u){return this.checkPageIdx(u),this.pages[u]},M.getLastPage=function(){if(!this.hasAnyPage()){const a="Cannot retrieve last page when there is no page.";throw new b.default("NoLastPages",a)}const u=this.getNbPages();return this.pages[u-1]},M.hasAnyPage=function(){return this.getNbPages()>0},M.remove=function(u){this.checkPageIdx(u),this.pages.splice(u,1)},M.checkPageIdx=function(u){const a=this.getNbPages();if(!N.default.isInteger(u)||u<0||u>=a){const g=`Bad page index [${u}]`;throw new b.default("BadPageIdx",g)}},M.getNbPages=function(){return this.pages.length},M.updatePageIdxFrom=function(u){const a=this.getNbPages();for(let g=u;g<a;g++)this.getPage(g).setIdx(g)};const B=U},572520:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>te});var b=y(523437),N=y(286060),U=y(890439),M=y(726042);const u=function(r){let o=U.Ay.toList(r);return o=o.map(M.default.intPart),o.sort(M.default.cmp),o};var a=y(364842),g=y(225723);const S=function(r,o){o.updateSliceIdxFrom=null;const l=o.slicesIndexes,C=D(r,l);if(C===0)return;const _=z(r,C,o);if(r.getNbSlices()===0){o.updateSliceIdxFrom=0,o.slicesIndexes=[];return}V(r,_),h(l,C),v(l),o.updateSliceIdxFrom=0},D=function(r,o){let l=0,C=0;return o.some(function(_){if(_!==C||!r.getMeasuresSlice(_).isEmpty())return!0;C++,l++}),l},z=function(r,o,l){let C=null;for(let _=0;_<o;_++){const Z=r.getMeasuresSlice(0);C===null&&(C=Z.extractHeaders()),r.remove(0),l.slicesIndexes.shift()}if(C===null)throw new a.default("Unexpected");return C},V=function(r,o){const l=r.getMeasuresSlice(0),_=l.getSystems().map(it=>it.header);L(_),L(o),l.setIsFirst(!0),l.injectSystemsHeaders(o),l.measuresWidth=null;const Z=l.getDisplayedSystems();(0,g.A)(Z)};function L(r){const o=new Set;r.forEach(l=>{if(l.hasGroupBracket()){const C=l.getGroupBracket();o.add(C),l.setGroupBracket(null)}}),o.forEach(l=>l.hide())}const h=function(r,o){const l=r.length;for(let C=0;C<l;C++)r[C]-=o},v=function(r){w(r)&&r.unshift(0)},w=function(r){return r.length===0?!0:r[0]!==0},p=S,m=function(r,o){let l=[];const C=r.getNbSlices(),_=o.slicesIndexes;for(let Z=0;Z<_.length;Z++){const it=_[Z],nt=r.getMeasuresSlice(it);nt.unshiftMeasures(l),nt.needRecomputeUsedWidth()&&nt.recomputeUsedWidth(),l=nt.popOverflowMeasures(),l.length>0&&P(C,_,Z)}},P=function(r,o,l){if(W(r,o,l)){const _=o[l]+1;o.splice(l+1,0,_)}},W=function(r,o,l){const C=o[l];if(C+1===r)return!1;const _=o[l+1];return C+1!==_},s=m,i=function(r,o){o.updateSliceIdxFrom=null;const l=o.slicesIndexes;let C=0,_=0;for(;C<l.length;){l[C]-=_;const Z=l[C];r.getMeasuresSlice(Z).isEmpty()?(r.remove(Z),l.splice(C,1),c(o,Z),_++):C++}},c=function(r,o){r.updateSliceIdxFrom===null?r.updateSliceIdxFrom=o:r.updateSliceIdxFrom=Math.min(r.updateSliceIdxFrom,o)},d=i;function F(r,o,l){const C=$(r,o);C!==0&&(q(r,o,C,l),J(r,o))}function $(r,o){let l=0;return r.getNbShards()>0&&r.shards.some(_=>{if(_.isEmpty())l++;else return!0})||o.getNbCachedShards()>0&&o.cachedShards.some(C=>{if(C.isEmpty())l++;else return!0}),l}function q(r,o,l,C){for(;r.getNbShards()>0&&l>0;){const it=r.getShard(0).getPageContent().getIdx();C.pageIdxSet[it]=!0,r.remove(0),l--}if(l!==0){for(;o.getNbCachedShards()>0&&l>0;)o.removeCachedShard(0),l--;if(l>0)throw new a.default("Cannot remove more empty shards then there is shards.")}}function J(r,o){let l;if(r.getNbShards()>0)l=r.getShard(0);else if(o.getNbCachedShards()>0)l=o.getCachedShard(0);else return;l.setIsFirst(!0)}var T=y(701933),H=y(760210);function R({slice:r,shardsContainer:o,shardProvider:l,updateData:C}){new k({slice:r,shardsContainer:o,shardProvider:l,updateData:C}).dispatch()}class k{constructor({slice:o,shardsContainer:l,shardProvider:C,updateData:_}){this.shardsContainer=l,this.slice=o,this.shardProvider=C,this.updateData=_,this.currentShard=null,this.systemsToSplit=o.getDisplayedSystems().slice(),this.shards=o.getShards().slice(),this.shardIdx=0,this.newShards=[],this.lastExistingShard=null}dispatch(){this.slice.reloadAllCrossMeasures(),this.slice.dispatchHorizontalFormattingForVerticalComputation(),this.slice.dropVerticalFormatting(),this.assignSystems(),this.shards.length>0&&(this.removeEmptyShards(),this.shardIdx===1&&this.removeBreaks()),this.newShards.length>0&&this.addBreaks()}assignSystems(){for(;this.systemsToSplit.length>0;){const o=this.systemsToSplit.shift();this.addSystemToShard(o)}}addSystemToShard(o){this.currentShard===null&&this.createShard();const l=this.getSystemLocation();if(o.setLocation(l),!this.currentShard.canFit(o)){if(o.hasGroup()&&!o.hasGroupStart()&&!this.currentShard.hasOnlyOneGroup()){const C=this.currentShard.popLastGroupSystems();C.push(o),o=C.shift(),this.systemsToSplit.unshift(...C)}this.createShard()}this.currentShard.pushSystem(o)}getSystemLocation(){return this.currentShard.getNbSystems()>0?T.A.OTHER:this.shardIdx===1?T.A.FIRST_OF_SLICE:T.A.FIRST_OF_SHARD}createShard(){if(this.shards.length===0)if(this.currentShard=new H.A,this.currentShard.setDrawingContext(this.shardProvider.drawingContext),this.currentShard.setSystemBreakPolicy(this.shardProvider.systemBreakPolicy),this.currentShard.setMetrics(this.shardProvider.metrics),this.currentShard.setIsFirst(!1),this.shardProvider.metrics.hasSingleStaff||this.currentShard.createVerticalLine(),this.newShards.push(this.currentShard),this.slice.addShard(this.currentShard),this.lastExistingShard.hasPageContent()){const o=this.shardsContainer.indexOf(this.lastExistingShard);if(o===-1)throw new a.default("The previous shard should be in the shardsContainer since it is attached to a page");this.shardsContainer.insert(this.currentShard,o+1);const l=this.lastExistingShard.getPageContent(),C=l.getIdxInPage(this.lastExistingShard);l.insertShard(this.currentShard,C+1)}else{const o=this.shardProvider.indexOf(this.lastExistingShard);if(o===-1)throw new a.default("The previous shard should be in the shardsContainer since it is attached to a page");this.shardProvider.insert(this.currentShard,o+1)}else this.currentShard=this.shards.shift(),this.currentShard.systems=[];this.lastExistingShard=this.currentShard,this.currentShard.height=0,this.shardIdx++}removeEmptyShards(){this.shards.forEach(this.removeEmptyShard,this)}removeEmptyShard(o){if(o.hasPageContent()){const C=o.getPageContent().getIdx();this.updateData.pageIdxSet[C]=!0;const _=this.shardsContainer.indexOf(o);if(_===-1)throw new a.default("The previous shard should be in the shardsContainer since it is attached to a page");this.shardsContainer.remove(_)}else{const l=this.shardProvider.indexOf(o);this.shardProvider.removeCachedShard(l)}this.slice.removeShard(o)}removeBreaks(){this.slice.getShards().forEach(vt)}addBreaks(){this.slice.getShards().forEach(ot)}}function vt(r){r.setBreakBefore(!1),r.setBreakAfter(!1)}function ot(r){r.setBreakBefore(!0),r.setBreakAfter(!0)}function Tt({slicesContainer:r,shardsContainer:o,shardProvider:l,updateData:C}){C.slicesIndexes.forEach(function(Z){const it=r.getMeasuresSlice(Z);if(it.updateDisplayedSystems()){const et=it.getDisplayedSystems();(0,g.A)(et),et.forEach(St=>St.transferHeaderExternalSpace())}R({slice:it,shardsContainer:o,shardProvider:l,updateData:C})})}function Ct(r,o){o.slicesIndexes.forEach(function(C){r.getMeasuresSlice(C).getShardsIndexes().forEach(dt,o)})}function dt(r){const o=this;o.shardIdxSet[r]=!0}function Dt(r,o){o.slicesIndexes.forEach(C=>{r.getMeasuresSlice(C).updateChildrenBindings()})}function xt(r,o){o.slicesIndexes.forEach(C=>{r.getMeasuresSlice(C).updateMeasuresLastOfSystem()})}function gt(r,o,l){Ot(o),Ut(r,l)}function Ot(r){const o=r.getNbCachedShards();for(let l=o-1;l>=0;l--)r.getCachedShard(l).isEmpty()&&r.removeCachedShard(l)}function Ut(r,o){const l=r.getNbShards();for(let C=l-1;C>=0;C--){const _=r.getShard(C);if(_.isEmpty()){const it=_.getPageContent().getIdx();o.pageIdxSet[it]=!0,r.remove(C)}}}var wt=y(860984);function zt(r,o,l,C,_){_.shardsIndexes.forEach(function(it){const nt=r.getNbShards();if(it>=nt){const me=o.getCachedShard(it-nt);me.needUpdateFormatting=!0;return}const et=r.getShard(it),St=et.getPageContent();et.linkGroupBracket(),et.updateGroupBracketsOffsets();const ue=St.getWidth(),ge=At(et,l,C);(0,wt.A)(et,ue,ge),et.dispatchVerticalFormatting(),et.needUpdateFormatting=!1;const pe=et.getPageIdx();_.pageIdxSet[pe]=!0})}function At(r,o,l){return l.hasRemaining()?!1:o.isShardFromLastSlice(r)}const mt=function(r,o){let l=[];const C=r.getNbPages(),_=o.pagesIndexes;for(let Z=0;Z<_.length;Z++){const it=_[Z],nt=r.getPage(it);nt.unshiftShards(l),nt.recomputeShardsHeight(),l=nt.popOverflowShards(),l.length>0&&kt(C,_,Z)}},kt=function(r,o,l){if(Lt(r,o,l)){const _=o[l]+1;o.splice(l+1,0,_)}},Lt=function(r,o,l){const C=o[l];if(C+1===r)return!1;const _=o[l+1];return C+1!==_},ee=mt,Et=function(r,o){o.updatePageIdxFrom=null;const l=o.pagesIndexes,C=r.getPagesContainer();let _=0,Z=0;for(;_<l.length;){l[_]-=Z;const it=l[_];C.getPage(it).isEmpty()?(r.removePage(it),It(o,it),Gt(o,it,Z),Z++,l.splice(_,1)):_++}},It=function(r,o){r.updatePageIdxFrom===null?r.updatePageIdxFrom=o:r.updatePageIdxFrom=Math.min(r.updatePageIdxFrom,o)},Gt=function(r,o,l){const C=o+l;r.removedPagesIndexes.push(C)},Yt=Et,$t=function(r,o){o.updatePageIdxFrom=null;const l=o.pagesIndexes,C=r.getPagesContainer(),_=Rt(C,l);if(_!==0){if(Vt(r,_,o),C.getNbPages()===0){o.updatePageIdxFrom=0,o.pagesIndexes=[];return}Kt(l,_),Nt(l),o.updatePageIdxFrom=0}},Rt=function(r,o){let l=0,C=0;return o.some(function(_){if(_!==C||!r.getPage(_).isEmpty())return!0;C++,l++}),l},Vt=function(r,o,l){for(let C=0;C<o;C++)r.removePage(0),l.pagesIndexes.shift(),l.removedPagesIndexes.push(C)},Kt=function(r,o){const l=r.length;for(let C=0;C<l;C++)r[C]-=o},Nt=function(r){Ft(r)&&r.unshift(0)},Ft=function(r){return r.length===0?!0:r[0]!==0},Xt=$t,Mt=function(r,o){const l=o.updatePageIdxFrom;if(l===null)return;const C=r.getNbPages(),_=r.getHeaderProvider(),Z=r.getPagesContainer();Z.updatePageIdxFrom(l);for(let nt=l;nt<C;nt++){const et=r.getPage(nt),St=_.getPageHeader(nt);et.swapHeader(St),nt===0&&(Z.getPage(nt).setIsFirst(!0),et.formatVertically())}r.getPageProvider().setPageIdx(C)},Wt=function(r){const o=r.getNbPages();r.getContentProvider().setPageIdx(o);const C=r.getNbSlices();r.getSliceProvider().setSliceIdx(C);const Z=r.getNbShards(),it=r.getShardProvider(),nt=it.getNbCachedShards();it.setShardIdx(Z+nt)};var ct=(r,o,l)=>new Promise((C,_)=>{var Z=et=>{try{nt(l.next(et))}catch(St){_(St)}},it=et=>{try{nt(l.throw(et))}catch(St){_(St)}},nt=et=>et.done?C(et.value):Promise.resolve(et.value).then(Z,it);nt((l=l.apply(r,o)).next())});const Ht=function(r,o){return ct(this,null,function*(){const l=r.getContentProvider();if(l.hasRemaining()&&r.hasAnyPageContent()){const C=r.getLastContent();C.recomputeShardsHeight();const _=r.getNbSlices();yield l.fillPageContent(C);const Z=r.getNbSlices();Pt(o.slicesIndexes,_,Z);const it=C.getIdx();lt(o.pagesIndexes,it)}})},Pt=function(r,o,l){for(let C=o;C<l;C++)r.push(C)},lt=function(r,o){Jt(r,o)&&r.push(o)},Jt=function(r,o){const l=r.length;return l===0?!0:r[l-1]!==o},ie=Ht,Qt=function(r,o){o.pagesIndexes.forEach(function(C){r.getPage(C).drawContentRec()})},bt=function(r,o){const _=o.slicesIndexes.map(pt,r).map(f);return Array.prototype.concat.apply([],_)},pt=function(r){return this.getMeasuresSlice(r)},f=function(r){const l=r.getBindedShards().map(I);return Array.prototype.concat.apply([],l)},I=function(r){return r.getAllMeasuresGeometries()},A=bt,X=function(r,o){o.forEach(ut,r)},ut=function(r){this.forEach(ft,r)},ft=function(r){const o=this,l=o.displayLocation.partIdx,C=o.displayLocation.voiceIdx,_=o.displayLocation.staffIdx;r.getSystem(l).addVoice(_,C)},_t=X;var Zt=y(540674);function re(r,o,l){l.shardsIndexes.forEach(_=>{qt(_,r,o).updateChildrenBindings()})}function qt(r,o,l){const C=o.getNbShards();if(r<C)return o.getShard(r);r-=C;const _=l.getNbCachedShards();if(r<_)return l.getCachedShard(r);throw new a.default(`Invalid shardIdx: ${r+C}`)}function oe(r,o){o.pagesIndexes.forEach(l=>{r.getPage(l).updateChildrenBindings()})}var ae=y(249394),yt=y(878639),at=(r,o,l)=>new Promise((C,_)=>{var Z=et=>{try{nt(l.next(et))}catch(St){_(St)}},it=et=>{try{nt(l.throw(et))}catch(St){_(St)}},nt=et=>et.done?C(et.value):Promise.resolve(et.value).then(Z,it);nt((l=l.apply(r,o)).next())});const ce=function(r,o){this.init(r,o)},ht=ce.prototype;ht.init=function(r,o){this.pageLayout=o,this.queue=o.queue;const l=o.getScoreDataCache();this.updateActionsExtractor=new b.default(l);const C=o.getMeasuresContainer(),_=o.getMeasureProvider(),Z=o.getDrawingContext();this.measureColumnsUpdater=new N.default(C,_,Z,l),this.updateData=null},ht.setScaling=function(r){return this.queue.add(()=>at(this,null,function*(){this.lockDisplay("_pageDisplayUpdater.setScaling"),yt.HAS_PERF_API&&performance.mark("adagio.setScaling.s");try{yield this._setScaling(r),this.unlockDisplay(),yt.HAS_PERF_API&&(performance.mark("adagio.setScaling.e"),performance.measure("adagio.setScaling","adagio.setScaling.s","adagio.setScaling.e"))}catch(o){throw this.unlockDisplay(),yt.HAS_PERF_API&&(performance.mark("adagio.setScaling.e"),performance.measure("adagio.setScaling","adagio.setScaling.s","adagio.setScaling.e")),o}}))},ht._setScaling=function(r){return at(this,null,function*(){ae.A.assert(r);const o=this.pageLayout.getScaling();if(r!==o){this.pageLayout.scaling=r;const C=this.pageLayout.getWidth()*o/r;yield this._setWidth(C)}})},ht.setExternalWidth=function(r){return at(this,null,function*(){const o=this.pageLayout.getScaling();r/=o,yield this.setWidth(r)})},ht.setWidth=function(r){return this.queue.add(()=>at(this,null,function*(){this.lockDisplay("_pageDisplayUpdater.setWidth"),yt.HAS_PERF_API&&performance.mark("adagio.setWidth.s");try{yield this._setWidth(r),yt.HAS_PERF_API&&(performance.mark("adagio.setWidth.e"),performance.measure("adagio.setWidth","adagio.setWidth.s","adagio.setWidth.e")),this.unlockDisplay()}catch(o){throw this.unlockDisplay(),yt.HAS_PERF_API&&(performance.mark("adagio.setWidth.e"),performance.measure("adagio.setWidth","adagio.setWidth.s","adagio.setWidth.e")),o}}))},ht.lockDisplay=function(r){this.pageLayout.lockDisplay(r)},ht.unlockDisplay=function(){this.pageLayout.unlockDisplay()},ht._setWidth=function(r){return at(this,null,function*(){this.pageLayout.setWidth(r),this.updateData=null;const l=this.pageLayout.getSlicesContainer().getNbSlices();let C=de(l);C=this.updateSlices(C),C=this.updateShards(C),C=yield this.updatePages(C),this.updateData=C,this.pageLayout.updatePagesSvgSize()})};const de=function(r){const o={addedStaffMeasures:[],slicesIndexesSet:{},updateMeasureIdxFrom:null};for(let l=0;l<r;l++)o.slicesIndexesSet[l]=!0;return o};ht.update=function(r){return this.queue.add(()=>at(this,null,function*(){yt.HAS_PERF_API&&performance.mark("adagio.update.s"),this.lockDisplay("_pageDisplayUpdater.update");try{yield this._update(r),this.unlockDisplay(),yt.HAS_PERF_API&&(performance.mark("adagio.update.e"),performance.measure("adagio.update","adagio.update.s","adagio.update.e"))}catch(o){throw this.unlockDisplay(),yt.HAS_PERF_API&&(performance.mark("adagio.update.e"),performance.measure("adagio.update","adagio.update.s","adagio.update.e")),o}}))},ht._update=function(r){return at(this,null,function*(){this.updateData=null;const o=this.cancelStackToUpdateData(r);this.updateVoices(o.voice);let l=this.updateMeasures(o.measure,o.hasMmrChange);l=this.updateSlices(l),l=this.updateShards(l),l=yield this.updatePages(l),this.updateMeasureNumbers(l),this.updateData=l,this.pageLayout.stateSyncWithData()})},ht.cancelStackToUpdateData=function(r){const o=this.pageLayout.getNbMeasures(),l=this.updateActionsExtractor.extract(r,o);return{measure:l.measureActions,voice:l.voiceActions,hasMmrChange:l.hasMmrChange}},ht.updateVoices=function(r){const o=this.pageLayout.getSlicesContainer();_t(o,r)},ht.updateMeasures=function(r,o){const l=this.measureColumnsUpdater.update(r);return o&&(l.updateMeasureIdxFrom=0),this.updateMeasureIdx(l),l},ht.updateMeasureIdx=function(r){const o=r.updateMeasureIdxFrom;if(o!==null){const l=this.pageLayout.getMeasuresContainer(),C=this.pageLayout.getMeasureProvider();(0,Zt.default)(l,C,o)}},ht.updateSlices=function(r){r.updateSliceIdxFrom=null,r.slicesIndexes=u(r.slicesIndexesSet),r.shardIdxSet={},r.pageIdxSet={};const o=this.pageLayout.getSlicesContainer();p(o,r),this.updateSliceIdx(r);const l=this.pageLayout.getShardsContainer(),C=this.pageLayout.getShardProvider();F(l,C,r),s(o,r);const _=this.pageLayout.getMeasuresContainer(),Z=this.pageLayout.getMeasureProvider();return le(_,Z),d(o,r),this.updateSliceIdx(r),gt(l,C,r),Tt({slicesContainer:o,shardsContainer:l,shardProvider:C,updateData:r}),this.updateShardIdx(),Ct(o,r),Dt(o,r),xt(o,r),r};function le(r,o){const l=r.getUnbindedMeasures();o.handBackMeasures(l)}ht.updateSliceIdx=function(r){const o=r.updateSliceIdxFrom;o!==null&&this.pageLayout.getSlicesContainer().updateSliceIdxFrom(o)},ht.updateShardIdx=function(){const o=this.pageLayout.getShardsContainer();o.updateShardIdxFrom(0);const l=this.pageLayout.getShardProvider(),C=o.getNbShards();l.updateCachedShardIdxFrom(0,C)},ht.updateShards=function(r){r.shardsIndexes=u(r.shardIdxSet);const o=this.pageLayout.getShardsContainer(),l=this.pageLayout.getShardProvider();re(o,l,r);const C=this.pageLayout.getSlicesContainer(),_=this.pageLayout.getMeasureProvider();return zt(o,l,C,_,r),r},ht.updatePages=function(r){return at(this,null,function*(){r.pagesIndexes=u(r.pageIdxSet),r.removedPagesIndexes=[];const o=this.pageLayout.getPagesContainer();Xt(this.pageLayout,r),Mt(this.pageLayout,r),ee(o,r);const l=this.pageLayout.getShardsContainer(),C=this.pageLayout.getShardProvider();return fe(l,C),Yt(this.pageLayout,r),Mt(this.pageLayout,r),Wt(this.pageLayout),yield ie(this.pageLayout,r),Qt(o,r),o.getNbPages()>0&&(this.pageLayout.hideFirstPageNumberIfNeeded(),oe(o,r)),r})};function fe(r,o){const l=r.getUnbindedShards();o.handBackShards(l)}ht.updateMeasureNumbers=function(r){if(r.updateMeasureIdxFrom===null||r.updateMeasureIdxFrom>=this.pageLayout.getNbMeasures())return;const o=this.pageLayout.getSliceForMeasureIdx(r.updateMeasureIdxFrom);if(o===null)return;const l=o.getShards();if(l.length===0)return;const[C]=l;if(!C.hasPageContent())return;const Z=C.getPageContent().getIdx(),it=this.pageLayout.getPagesContainer(),nt=it.getNbPages();for(let et=Z;et<nt;et++){if(r.pageIdxSet[et])continue;it.getPage(et).updateMeasureNumbers()}},ht.getGeometries=function(){const r=this.pageLayout.getSlicesContainer();return A(r,this.updateData)},ht.getRemovedPagesIndexes=function(){return this.updateData.removedPagesIndexes};const te=ce},604824:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>N});var b=y(493596);class N{constructor(M,B){Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hasPickup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),b.A.fillDefault(M),b.A.check(M),this.config=M,this.hasPickup=B}isCountForbidden(M){return this.config.forbiddenCounts[M]===!0}hasMaxLimit(){return this.config.maxNbMeasuresPerLine!==null}getFirstMaxNbMeasuresPerLine(){let M=this.config.maxNbMeasuresPerLine;return this.hasPickup&&M!==null&&M++,M}getMaxNbMeasuresPerLine(){return this.config.maxNbMeasuresPerLine}}},615565:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>u});const b={};b.extractTrueActions=function(a){return b.extractActions(a).filter(N)},b.extractDrawActions=function(a){return b.extractActions(a).filter(B)};const N=function(a){return!a.type.endsWith("-close")},U=function(a){const g=[];return a.stack.forEach(function(S){if(M(S))g.push(S);else{const D=U(S);g.push.apply(g,D)}}),g},M=function(a){return typeof a.type=="string"},B=function(a){return!a.noDraw};b.extractActions=U;const u=b},652490:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>V});var b=y(182879);const N=function(L){const h=new U(L);return h.filter(),h.getFilteredActions()},U=function(L){this.init(L)},M=U.prototype;M.init=function(L){this.actions=L,this.filteredActions=[],this.buffer=null},M.filter=function(){this.actions.forEach(this.addAction,this),this.flushBuffer()},M.addAction=function(L){this.isTypeChange(L)?(this.flushBuffer(),this.createBuffer(L)):this.buffer.processAction(L)},M.isTypeChange=function(L){return this.buffer===null?!0:this.buffer.isChange(L)},M.flushBuffer=function(){if(this.buffer!==null){const L=this.buffer.dump();Array.prototype.push.apply(this.filteredActions,L),this.buffer=null}},M.createBuffer=function(L){L.type===b.A.REMOVE?this.buffer=new B(L):L.type===b.A.ADD?this.buffer=new a(L):L.type===b.A.UPDATE?this.buffer=new D(L):b.A.raiseError(L.type)},M.getFilteredActions=function(){return this.filteredActions};const B=function(L){this.init(L)},u=B.prototype;u.init=function(L){const h=S(L);this.actions=[h]},u.isChange=function(L){return L.type!==b.A.REMOVE?!0:L.displayLocation.partIdx===0},u.processAction=function(){},u.dump=function(){return this.actions};const a=function(L){this.init(L)},g=a.prototype;g.init=function(L){const h=S(L);this.actions=[h]};const S=function(L){return{displayLocation:{measureIdx:L.displayLocation.measureIdx},type:L.type}};g.isChange=function(L){return L.type!==b.A.ADD?!0:L.displayLocation.partIdx===0},g.processAction=function(){},g.dump=function(){return this.actions};const D=function(L){this.init(L)},z=D.prototype;z.init=function(L){this.actions=[L]},z.isChange=function(L){return L.type!==b.A.UPDATE},z.processAction=function(L){this.actions.push(L)},z.dump=function(){return this.actions};const V=N},782027:()=>{(function(){"use strict";if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function st(p){try{return p.defaultView&&p.defaultView.frameElement||null}catch(m){return null}}var Y=function(p){for(var m=p,P=st(m);P;)m=P.ownerDocument,P=st(m);return m}(window.document),y=[],b=null,N=null;function U(p){this.time=p.time,this.target=p.target,this.rootBounds=V(p.rootBounds),this.boundingClientRect=V(p.boundingClientRect),this.intersectionRect=V(p.intersectionRect||z()),this.isIntersecting=!!p.intersectionRect;var m=this.boundingClientRect,P=m.width*m.height,W=this.intersectionRect,s=W.width*W.height;P?this.intersectionRatio=Number((s/P).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function M(p,m){var P=m||{};if(typeof p!="function")throw new Error("callback must be a function");if(P.root&&P.root.nodeType!=1&&P.root.nodeType!=9)throw new Error("root must be a Document or Element");this._checkForIntersections=u(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=p,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(P.rootMargin),this.thresholds=this._initThresholds(P.threshold),this.root=P.root||null,this.rootMargin=this._rootMarginValues.map(function(W){return W.value+W.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}M.prototype.THROTTLE_TIMEOUT=100,M.prototype.POLL_INTERVAL=null,M.prototype.USE_MUTATION_OBSERVER=!0,M._setupCrossOriginUpdater=function(){return b||(b=function(p,m){!p||!m?N=z():N=L(p,m),y.forEach(function(P){P._checkForIntersections()})}),b},M._resetCrossOriginUpdater=function(){b=null,N=null},M.prototype.observe=function(p){var m=this._observationTargets.some(function(P){return P.element==p});if(!m){if(!(p&&p.nodeType==1))throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:p,entry:null}),this._monitorIntersections(p.ownerDocument),this._checkForIntersections()}},M.prototype.unobserve=function(p){this._observationTargets=this._observationTargets.filter(function(m){return m.element!=p}),this._unmonitorIntersections(p.ownerDocument),this._observationTargets.length==0&&this._unregisterInstance()},M.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},M.prototype.takeRecords=function(){var p=this._queuedEntries.slice();return this._queuedEntries=[],p},M.prototype._initThresholds=function(p){var m=p||[0];return Array.isArray(m)||(m=[m]),m.sort().filter(function(P,W,s){if(typeof P!="number"||isNaN(P)||P<0||P>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return P!==s[W-1]})},M.prototype._parseRootMargin=function(p){var m=p||"0px",P=m.split(/\s+/).map(function(W){var s=/^(-?\d*\.?\d+)(px|%)$/.exec(W);if(!s)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(s[1]),unit:s[2]}});return P[1]=P[1]||P[0],P[2]=P[2]||P[0],P[3]=P[3]||P[1],P},M.prototype._monitorIntersections=function(p){var m=p.defaultView;if(m&&this._monitoringDocuments.indexOf(p)==-1){var P=this._checkForIntersections,W=null,s=null;this.POLL_INTERVAL?W=m.setInterval(P,this.POLL_INTERVAL):(a(m,"resize",P,!0),a(p,"scroll",P,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in m&&(s=new m.MutationObserver(P),s.observe(p,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))),this._monitoringDocuments.push(p),this._monitoringUnsubscribes.push(function(){var d=p.defaultView;d&&(W&&d.clearInterval(W),g(d,"resize",P,!0)),g(p,"scroll",P,!0),s&&s.disconnect()});var i=this.root&&(this.root.ownerDocument||this.root)||Y;if(p!=i){var c=st(p);c&&this._monitorIntersections(c.ownerDocument)}}},M.prototype._unmonitorIntersections=function(p){var m=this._monitoringDocuments.indexOf(p);if(m!=-1){var P=this.root&&(this.root.ownerDocument||this.root)||Y,W=this._observationTargets.some(function(c){var d=c.element.ownerDocument;if(d==p)return!0;for(;d&&d!=P;){var F=st(d);if(d=F&&F.ownerDocument,d==p)return!0}return!1});if(!W){var s=this._monitoringUnsubscribes[m];if(this._monitoringDocuments.splice(m,1),this._monitoringUnsubscribes.splice(m,1),s(),p!=P){var i=st(p);i&&this._unmonitorIntersections(i.ownerDocument)}}}},M.prototype._unmonitorAllIntersections=function(){var p=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var m=0;m<p.length;m++)p[m]()},M.prototype._checkForIntersections=function(){if(!(!this.root&&b&&!N)){var p=this._rootIsInDom(),m=p?this._getRootRect():z();this._observationTargets.forEach(function(P){var W=P.element,s=D(W),i=this._rootContainsTarget(W),c=P.entry,d=p&&i&&this._computeTargetAndRootIntersection(W,s,m),F=null;this._rootContainsTarget(W)?(!b||this.root)&&(F=m):F=z();var $=P.entry=new U({time:B(),target:W,boundingClientRect:s,rootBounds:F,intersectionRect:d});c?p&&i?this._hasCrossedThreshold(c,$)&&this._queuedEntries.push($):c&&c.isIntersecting&&this._queuedEntries.push($):this._queuedEntries.push($)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},M.prototype._computeTargetAndRootIntersection=function(p,m,P){if(window.getComputedStyle(p).display!="none"){for(var W=m,s=v(p),i=!1;!i&&s;){var c=null,d=s.nodeType==1?window.getComputedStyle(s):{};if(d.display=="none")return null;if(s==this.root||s.nodeType==9)if(i=!0,s==this.root||s==Y)b&&!this.root?!N||N.width==0&&N.height==0?(s=null,c=null,W=null):c=N:c=P;else{var F=v(s),$=F&&D(F),q=F&&this._computeTargetAndRootIntersection(F,$,P);$&&q?(s=F,c=L($,q)):(s=null,W=null)}else{var J=s.ownerDocument;s!=J.body&&s!=J.documentElement&&d.overflow!="visible"&&(c=D(s))}if(c&&(W=S(c,W)),!W)break;s=s&&v(s)}return W}},M.prototype._getRootRect=function(){var p;if(this.root&&!w(this.root))p=D(this.root);else{var m=w(this.root)?this.root:Y,P=m.documentElement,W=m.body;p={top:0,left:0,right:P.clientWidth||W.clientWidth,width:P.clientWidth||W.clientWidth,bottom:P.clientHeight||W.clientHeight,height:P.clientHeight||W.clientHeight}}return this._expandRectByRootMargin(p)},M.prototype._expandRectByRootMargin=function(p){var m=this._rootMarginValues.map(function(W,s){return W.unit=="px"?W.value:W.value*(s%2?p.width:p.height)/100}),P={top:p.top-m[0],right:p.right+m[1],bottom:p.bottom+m[2],left:p.left-m[3]};return P.width=P.right-P.left,P.height=P.bottom-P.top,P},M.prototype._hasCrossedThreshold=function(p,m){var P=p&&p.isIntersecting?p.intersectionRatio||0:-1,W=m.isIntersecting?m.intersectionRatio||0:-1;if(P!==W)for(var s=0;s<this.thresholds.length;s++){var i=this.thresholds[s];if(i==P||i==W||i<P!=i<W)return!0}},M.prototype._rootIsInDom=function(){return!this.root||h(Y,this.root)},M.prototype._rootContainsTarget=function(p){var m=this.root&&(this.root.ownerDocument||this.root)||Y;return h(m,p)&&(!this.root||m==p.ownerDocument)},M.prototype._registerInstance=function(){y.indexOf(this)<0&&y.push(this)},M.prototype._unregisterInstance=function(){var p=y.indexOf(this);p!=-1&&y.splice(p,1)};function B(){return window.performance&&performance.now&&performance.now()}function u(p,m){var P=null;return function(){P||(P=setTimeout(function(){p(),P=null},m))}}function a(p,m,P,W){typeof p.addEventListener=="function"?p.addEventListener(m,P,W||!1):typeof p.attachEvent=="function"&&p.attachEvent("on"+m,P)}function g(p,m,P,W){typeof p.removeEventListener=="function"?p.removeEventListener(m,P,W||!1):typeof p.detachEvent=="function"&&p.detachEvent("on"+m,P)}function S(p,m){var P=Math.max(p.top,m.top),W=Math.min(p.bottom,m.bottom),s=Math.max(p.left,m.left),i=Math.min(p.right,m.right),c=i-s,d=W-P;return c>=0&&d>=0&&{top:P,bottom:W,left:s,right:i,width:c,height:d}||null}function D(p){var m;try{m=p.getBoundingClientRect()}catch(P){}return m?(m.width&&m.height||(m={top:m.top,right:m.right,bottom:m.bottom,left:m.left,width:m.right-m.left,height:m.bottom-m.top}),m):z()}function z(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function V(p){return!p||"x"in p?p:{top:p.top,y:p.top,bottom:p.bottom,left:p.left,x:p.left,right:p.right,width:p.width,height:p.height}}function L(p,m){var P=m.top-p.top,W=m.left-p.left;return{top:P,left:W,height:m.height,width:m.width,bottom:P+m.height,right:W+m.width}}function h(p,m){for(var P=m;P;){if(P==p)return!0;P=v(P)}return!1}function v(p){var m=p.parentNode;return p.nodeType==9&&p!=Y?st(p):(m&&m.assignedSlot&&(m=m.assignedSlot.parentNode),m&&m.nodeType==11&&m.host?m.host:m)}function w(p){return p&&p.nodeType===9}window.IntersectionObserver=M,window.IntersectionObserverEntry=U})()},804541:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>W});var b=y(377072),N=y(726042),U=y(737903),M=y(364842),B=y(15049);const u=function(){this.init()},a=u.prototype;a.init=function(){this.id=null,this.isFirst=null,this.metrics=null,this.systemProvider=null,this.systemBreakPolicy=null,this.drawingContext=null,this.measuresWidth=0,this.measures=[],this.systems=null,this.displayedSystemsIndexesSet=null,this.shards=[]},a.setId=function(s){this.id=s},a.setMetrics=function(s){this.metrics=s},a.setDrawingContext=function(s){this.drawingContext=s},a.setIsFirst=function(s){if(this.isFirst=s,this.isFirst&&this.measures.length>0){const[i]=this.measures,d=this.getInsertedMeasurePosition(!0);i.setMeasurePosition(d)}},a.setSystemProvider=function(s){this.systemProvider=s},a.setSystemBreakPolicy=function(s){this.systemBreakPolicy=s},a.addShard=function(s){this.shards.push(s),s.setMeasuresSlice(this)},a.hasPageBreakBefore=function(){return this.measures[0].hasPageBreakBefore()},a.hasPageBreakAfter=function(){return this.measures[this.measures.length-1].hasPageBreakAfter()},a.removeShard=function(s){const i=this.shards.indexOf(s);if(i<0)throw new M.default("The shard do not belong to the slice");this.shards.splice(i,1)},a.canPushMeasure=function(s){const i=this.measures.length===0;if(i)return!0;if(this.isAtPolicyLimit())return!1;if(s.hasSystemBreakBefore()||this.measures[this.measures.length-1].hasSystemBreakAfter())return!1;const d=this.getInsertedMeasurePosition(i),F=s.getWidthForPosition(d),$=this.getAvailableWidth();return F<$},a.isAtPolicyLimit=function(){if(this.systemBreakPolicy.hasMaxLimit()){const s=this.getMaxNbMeasuresPerLine();return this.measures.length===s}else return!1},a.pushMeasure=function(s){const i=this.measures.length===0,c=this.getInsertedMeasurePosition(i);if(s.setMeasurePosition(c),this.measuresWidth!==null){const F=s.getWidth();this.measuresWidth+=F}const d=this.getNbMeasures();this.measures.push(s),this.insertMeasureToSystems(s,d),s.setMeasuresSlice(this)},a.getMeasurePosition=function(s){return this.measures[s].getMeasurePosition()},a.getInsertedMeasurePosition=function(s){return s?this.isFirst?b.A.FIRST_OF_SCORE:b.A.FIRST_OF_LINE:b.A.OTHER},a.unshiftMeasures=function(s){s=s.slice(),s.reverse(),s.forEach(this.unshiftMeasure,this)},a.unshiftMeasure=function(s){this.measuresWidth=null;const c=this.getInsertedMeasurePosition(!0);s.setMeasurePosition(c),this.measures.unshift(s),s.setMeasuresSlice(this),this.insertMeasureToSystems(s,0),this.getNbMeasures()>1&&this.measures[1].setMeasurePosition(b.A.OTHER)},a.insertMeasure=function(s,i){this.measuresWidth=null;const c=i===0,d=this.getInsertedMeasurePosition(c);s.setMeasurePosition(d),this.measures.splice(i,0,s),s.setMeasuresSlice(this),this.insertMeasureToSystems(s,i),c&&this.measures.length>1&&this.measures[1].setMeasurePosition(b.A.OTHER)},a.insertMeasureToSystems=function(s,i){this.getSystems().forEach(function(d,F){const $=s.getSystemMeasure(F);d.insertMeasure($,i)})},a.popMeasure=function(){const s=this.getNbMeasures();if(s===0){const d="Cannon pop on an empty MeasuresSlice.";throw new M.default("PopOnEmpty",d)}const i=s-1;this.removeMeasureFromSystems(i);const c=this.measures.pop();if(c.setMeasuresSlice(null),this.measuresWidth!==null){const d=c.getWidth();this.measuresWidth-=d}return c},a.removeMeasure=function(s){if(this.measuresWidth=null,this.removeMeasureFromSystems(s),this.measures.splice(s,1)[0].setMeasuresSlice(null),s===0&&this.measures.length>0){const c=this.measures[0],F=this.getInsertedMeasurePosition(!0);c.setMeasurePosition(F)}},a.removeMeasureFromSystems=function(s){this.getSystems().forEach(function(c){c.removeMeasure(s)})},a.needRecomputeUsedWidth=function(){return this.measuresWidth===null},a.recomputeUsedWidth=function(){const s=this.measures.map(g);this.measuresWidth=s.reduce(N.default.add,0)};const g=function(s){return s.getWidth()};a.reloadAllCrossMeasures=function(){this.getDisplayedSystems().forEach(function(i){i.reloadAllCrossMeasures()})},a.dispatchHorizontalFormattingForVerticalComputation=function(){const s=this.getDisplayedSystems(),i=this.measures.map(c=>c.getFormatting());s.forEach(c=>c.dispatchHorizontalFormattingForVerticalComputation(i))},a.dropVerticalFormatting=function(){this.getDisplayedSystems().forEach(i=>i.dropVerticalFormatting()),this.shards.forEach(i=>{i.height=null})},a.hasWidthOverflow=function(){const s=this.getWidth(),i=this.getHeadersWidth();return this.measuresWidth+i>=s},a.popOverflowMeasures=function(){const s=[];let i;for(;this.isOverPolicyLimit()||this.hasWidthOverflow()&&this.measures.length>1;)i=this.popMeasure(),s.unshift(i);let c=this.getNbToPop();for(;c>0;)i=this.popMeasure(),s.unshift(i),c--;return s},a.isOverPolicyLimit=function(){if(this.systemBreakPolicy.hasMaxLimit()){const s=this.getMaxNbMeasuresPerLine();return this.measures.length>s}else return!1},a.getNbToPop=function(){const s=this.getNbMeasures();for(let i=0;i<s;i++){const c=this.measures[i];if(i>0&&c.hasSystemBreakBefore())return s-i;if(c.hasSystemBreakAfter())return s-(i+1)}return 0},a.getMaxNbMeasuresPerLine=function(){let s;return this.isFirst?s=this.systemBreakPolicy.getFirstMaxNbMeasuresPerLine():s=this.systemBreakPolicy.getMaxNbMeasuresPerLine(),s},a.getMeasureStartDisplayIdx=function(){return this.measures[0].getDisplayIdx()},a.replaceMeasure=function(s,i,c){const d=this.measures.indexOf(s),F=this.getSystems(),$=F[c];if(typeof $=="undefined"){const q=new M.default("Unexpected","[bughunt-1] system value is undefined in `_measuresSlice.replaceMeasure`.");throw q.systemIdx=c,q.nbSystems=F.length,q}$.replaceMeasure(i,d),this.measuresWidth=null},a.updateId=function(s){this.id=s,s===0&&(this.isFirst=!0,this.isEmpty()||(this.measures[0].setMeasurePosition(b.A.FIRST_OF_SCORE),this.measuresWidth=null))},a.getDisplayedSystems=function(){if(this.displayedSystemsIndexesSet===null){const i=this.getSystems();let c=i.slice();this.shouldHideSystems()&&(c=c.filter(F=>!F.isEmpty()),c.length===0&&(c=i.slice()));const d=c.map(F=>i.indexOf(F));return this.displayedSystemsIndexesSet=new Set(d),c}let s=this.getSystems();return s=s.filter((i,c)=>this.displayedSystemsIndexesSet.has(c)),s},a.updateDisplayedSystems=function(){if(this.displayedSystemsIndexesSet===null)throw new M.default("At this point, the displayed systems set should have been initialised");const s=this.getSystems();if(!this.shouldHideSystems()){if(this.displayedSystemsIndexesSet.length===s.length)return!1;{const F=s.map(($,q)=>q);return this.displayedSystemsIndexesSet=new Set(F),!0}}const c=s.filter(F=>!F.isEmpty()).map(F=>s.indexOf(F));let d=!1;return c.forEach(F=>{this.displayedSystemsIndexesSet.has(F)||(d=!0,this.displayedSystemsIndexesSet.add(F))}),d},a.shouldHideSystems=function(){const s=this.drawingContext.hideEmptyParts();return!(s===B.A.NEVER||s===B.A.AFTER_FIRST_SYSTEM&&this.id===0)},a.getSystems=function(){return this.systems===null&&this.createSystems(),this.systems},a.createSystems=function(){this.systems=[];const s=this.getNbSystems();for(let i=0;i<s;i++){const c=this.systemProvider.getSystem(i,this.isFirst);this.systems.push(c)}this.systemProvider.insertGroups(this.systems)},a.getNbSystems=function(){return this.measures[0].getNbSystems()},a.getNbMeasures=function(){return this.measures.length},a.getMeasureStartDataIdx=function(){return this.measures[0].getDataIdx()},a.getIdx=function(){return this.id},a.getIdxInSlice=function(s){const i=this.measures.indexOf(s);if(i===-1){const c="The measure is not in this slice";throw new M.default("NotInSlice",c)}return i},a.isEmpty=function(){return this.getNbMeasures()===0},a.getBindedShards=function(){let s=this.getShards();return s=s.filter(S),s};const S=function(s){return s.hasPageContent()};a.getShards=function(){return this.shards},a.getShardsIndexes=function(){return this.shards.map(D)};const D=function(s){return s.getIdx()};a.getAvailableWidth=function(){const s=this.getWidth(),i=this.getHeadersWidth();return s-(i+this.measuresWidth)},a.getWidth=function(){return this.metrics.availableWidth},a.getHeadersWidth=function(){return this.isFirst?this.metrics.firstSliceHeaderWidth:this.metrics.otherSlicesHeaderWidth},a.drawBasicCursor=function(s,i){if(!this.displayedSystemsIndexesSet.has(s.partIdx))return;s=this.shiftLocation(s),this.getSystem(s.partIdx).drawCursor(s,i)},a.drawGraceCursor=function(s,i){if(!this.displayedSystemsIndexesSet.has(s.partIdx))return;s=this.shiftLocation(s),this.getSystem(s.partIdx).drawGraceCursor(s,i)},a.drawTabCursor=function(s,i){if(!this.displayedSystemsIndexesSet.has(s.partIdx))return;s=this.shiftLocation(s),this.getSystem(s.partIdx).drawTabCursor(s,i)},a.drawDynamicCursor=function(s,i){if(!this.displayedSystemsIndexesSet.has(s.partIdx))return;s=this.shiftLocation(s),this.getSystem(s.partIdx).drawDynamicCursor(s,i)},a.drawPizzicatoCursor=function(s,i){if(!this.displayedSystemsIndexesSet.has(s.partIdx))return;s=this.shiftLocation(s),this.getSystem(s.partIdx).drawPizzicatoCursor(s,i)},a.drawMuteCursor=function(s,i){if(!this.displayedSystemsIndexesSet.has(s.partIdx))return;s=this.shiftLocation(s),this.getSystem(s.partIdx).drawMuteCursor(s,i)},a.drawHorizontalCursor=function(s,i){if(!this.displayedSystemsIndexesSet.has(s.partIdx))return;s=this.shiftRangeLocation(s),this.normalizeRangeLocation(s),this.getSystem(s.partIdx).drawHorizontalCursor(s,i)},a.drawHorizontalCursorTimePos=function(s,i){if(!this.displayedSystemsIndexesSet.has(s.partIdx))return;s=this.shiftRangeLocation(s),this.normalizeRangeLocation(s),this.getSystem(s.partIdx).drawHorizontalCursorTimePos(s,i)},a.drawHorizontalMeasureWideCursor=function(s,i){if(!this.displayedSystemsIndexesSet.has(s.partIdx))return;s=this.shiftLocation(s),this.normalizeRangeLocation(s),this.getSystem(s.partIdx).drawHorizontalMeasureWideCursor(s,i)},a.drawCrossMeasureNoteCursor=function(s,i){if(!this.displayedSystemsIndexesSet.has(s.partIdx))return;s=this.shiftRangeLocation(s),this.normalizeRangeLocation(s),this.getSystem(s.partIdx).drawCrossMeasureNoteCursor(s,i)},a.shiftLocation=function(s){return s=(0,U.default)(s),s.measureIdx-=this.getMeasureStartDataIdx(),s},a.shiftRangeLocation=function(s){return s=(0,U.default)(s),s.startMeasureIdx-=this.getMeasureStartDataIdx(),s.stopMeasureIdx-=this.getMeasureStartDataIdx(),s},a.normalizeRangeLocation=function(s){const i=this.getNbMeasures();s.startMeasureIdx=Math.max(0,s.startMeasureIdx),s.stopMeasureIdx=Math.min(i-1,s.stopMeasureIdx)},a.getSystem=function(s){const i=this.getSystems(),c=i.length;if(!N.default.isInteger(s)||s<0||s>=c){const d=`The system idx [${s}] is invalid.`;throw new M.default("BadSystemIdx",d)}return i[s]},a.extractHeaders=function(){return this.getSystems().map(z)};const z=function(s){return s.extractHeader()};a.injectSystemsHeaders=function(s){this.getSystems().forEach(function(c,d){const F=s[d];c.injectHeader(F)})},a.getStaffLyricsUpY=function(s,i,c,d){return c-=this.getMeasureStartDataIdx(),this.getSystem(i).getStaffLyricsUpY(s,c,d)},a.getStaffWordsY=function(s,i,c,d){return c-=this.getMeasureStartDataIdx(),this.getSystem(i).getStaffWordsY(s,c,d)},a.getSystemChordsY=function(s,i){return i-=this.getMeasureStartDataIdx(),this.getSystem(s).getChordsY(i)},a.getSystemTopStaffClassicHarmonyY=function(s,i){return i-=this.getMeasureStartDataIdx(),this.getSystem(s).getTopStaffClassicHarmonyY(i)},a.getSystemBottomStaffClassicHarmonyY=function(s,i){return i-=this.getMeasureStartDataIdx(),this.getSystem(s).getBottomStaffClassicHarmonyY(i)},a.getSystemBottomStaffFiguredBassY=function(s,i,c){return i-=this.getMeasureStartDataIdx(),this.getSystem(s).getBottomStaffFiguredBassY(i,c)},a.getMeasureWidth=function(s,i){return i-=this.getMeasureStartDataIdx(),this.getSystem(s).getMeasureWidth(i)},a.getNoteXInMeasure=function(s,i,c,d,F){return c-=this.getMeasureStartDataIdx(),this.getSystem(s).getNoteXInMeasure(i,c,d,F)},a.getMeasurePosXInStaff=function(s,i){return i-=this.getMeasureStartDataIdx(),this.getSystem(s).getMeasurePosX(i)},a.getTimePosXInMeasure=function(s,i,c,d,F){return c-=this.getMeasureStartDataIdx(),this.getSystem(s).getTimePosXInMeasure(i,c,d,F)},a.getStaffInnerHeight=function(s,i){return this.getSystem(s).getStaffInnerHeight(i)},a.getStaffHeight=function(s){return this.getSystem(s).getHeight()},a.getStaffElem=function(s,i){return this.displayedSystemsIndexesSet.has(s)?this.getSystem(s).getStaffElem(i):null},a.getSpaceAboveStaff=function(s,i){return this.getSystem(s).getSpaceAboveStaff(i)},a.getMeasureNbNotes=function(s,i,c,d){return c-=this.getMeasureStartDataIdx(),this.getSystem(s).getMeasureNbNotes(i,c,d)},a.getMeasureElem=function(s,i,c){return c-=this.getMeasureStartDataIdx(),this.getSystem(s).getMeasureElem(i,c)},a.getMeasureEventRect=function(s,i,c){return c-=this.getMeasureStartDataIdx(),this.getSystem(s).getMeasureEventRect(i,c)},a.getPartBottomMeasureElem=function(s,i){return i-=this.getMeasureStartDataIdx(),this.getSystem(s).getBottomMeasureElem(i)},a.updateChildrenBindings=function(){this.getSystems().forEach(i=>i.updateMeasuresBindings())},a.bindStaves=function(){this.getSystems().forEach(i=>i.bindStaves())},a.updateMeasuresLastOfSystem=function(){this.measures.forEach((s,i)=>{const c=i===this.measures.length-1;s.setIsLastOfSystem(c)})};const V=u;var L=(s,i,c)=>new Promise((d,F)=>{var $=T=>{try{J(c.next(T))}catch(H){F(H)}},q=T=>{try{J(c.throw(T))}catch(H){F(H)}},J=T=>T.done?d(T.value):Promise.resolve(T.value).then($,q);J((c=c.apply(s,i)).next())});const h=8;function v(s,i,c){return L(this,null,function*(){const d=s.getAvailableWidth(),F=w(i);let $=h;F!==null&&($=Math.ceil(d/F)),yield c.initNextMeasuresSystems($)})}function w(s){const i=[],c=s.getNbMeasures();for(let $=0;$<c;$++){const q=s.getMeasureColumn($);if(q.hasFormatting()){const J=q.getWidth();i.push(J)}}return i.length===0?null:i.reduce(N.default.add)/i.length}var p=(s,i,c)=>new Promise((d,F)=>{var $=T=>{try{J(c.next(T))}catch(H){F(H)}},q=T=>{try{J(c.throw(T))}catch(H){F(H)}},J=T=>T.done?d(T.value):Promise.resolve(T.value).then($,q);J((c=c.apply(s,i)).next())});const m=function(s){this.init(s)},P=m.prototype;P.init=function({measureProvider:s,systemProvider:i,metrics:c,systemBreakPolicy:d,measuresSlicesContainer:F,measureColumnsContainer:$,drawingContext:q}){this.measureProvider=s,this.systemProvider=i,this.metrics=c,this.measuresSlicesContainer=F,this.measureColumnsContainer=$,this.systemBreakPolicy=d,this.drawingContext=q,this.sliceIdx=0},P.setMeasureProvider=function(s){this.measureProvider=s},P.setSliceIdx=function(s){this.sliceIdx=s},P.hasRemaining=function(){return this.measureProvider.hasRemaining()},P.getSlice=function(){return p(this,null,function*(){const s=this.createSlice();for(yield v(s,this.measureColumnsContainer,this.measureProvider);this.measureProvider.hasRemaining();){const c=this.measureProvider.getMeasure();if(c.areSystemsInitialized()||(yield c.initSystems()),s.canPushMeasure(c))s.pushMeasure(c),this.measureColumnsContainer.push(c);else{this.measureProvider.handBackMeasure(c);break}}let i=s.getNbMeasures();for(;this.systemBreakPolicy.isCountForbidden(i);){const c=s.popMeasure();this.measureProvider.handBackMeasure(c),i--}return s.bindStaves(),s.updateChildrenBindings(),s.updateMeasuresLastOfSystem(),s})},P.createSlice=function(){const s=new V;s.setId(this.sliceIdx),s.setMetrics(this.metrics);const i=this.sliceIdx===0;return s.setIsFirst(i),s.setSystemProvider(this.systemProvider),s.setSystemBreakPolicy(this.systemBreakPolicy),s.setDrawingContext(this.drawingContext),this.sliceIdx++,this.measuresSlicesContainer.push(s),s};const W=m},811048:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>b});function b(N){N.uuidGetMeasureColumnFirstPageSvgParent=function(U){const M=this.uuidToIdx(U),B=this.getSliceForMeasureIdx(M.measureIdx);if(B===null)return null;const u=B.getShards();if(u.length===0)return null;const[a]=u;if(!a.hasPartContent())return null;const g=a.getPageIdx();if(g>=this.getNbPages())return null;const S=this.getPage(g);return S.hasSvgRoot()?S.getSvgRoot():null},N.uuidGetFirstShardForMeasure=function(U){const M=this.uuidToIdx(U),B=this.getSliceForMeasureIdx(M.measureIdx);if(B===null)return null;const u=B.getShards();if(u.length===0)return null;const[a]=u;return a}}},827494:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>L});var b=y(364842),N=y(269352);const U=1,M=3,B=function(){this.init()};B.NAME="pageContent";const u=B.prototype;u.name=B.NAME,u.init=function(){this.drawingContext=null,this.displayOpts=null,this.metrics=null,this.idx=null,this.posY=null,this.isLast=null,this.isFirst=null,this.shardsHeight=0,this.shards=[],this.group=null,this.parent=null},u.setDrawingContext=function(h){this.drawingContext=h},u.setDisplayOpts=function(h){this.displayOpts=h},u.setMetrics=function(h){this.metrics=h},u.setIsLast=function(h){this.isLast=h},u.setIsFirst=function(h){this.isFirst=h},u.setIdx=function(h){this.idx=h},u.setParent=function(h){this.parent=h},u.setPosition=function(h){this.posY=h},u.canPushShard=function(h){if(this.shards.length===0)return!0;{if(h.shouldBreakBefore())return!1;const v=this.getLastShard();if(v.shouldBreakAfter())return!1;const w=this.getHeight()-this.getShardsHeight(),p=a(v,h,this.drawingContext);return h.getHeight()+p<w}},u.pushShard=function(h){if(this.shardsHeight!==null){const w=this.shards.length===0,p=h.getHeight();if(this.shardsHeight+=p,!w){const m=this.getLastShard(),P=a(m,h,this.drawingContext);this.shardsHeight+=P}}this.shards.push(h),h.setPageContent(this);const v=this.getGroup();h.setParent(v)},u.insertShard=function(h,v){this.shardsHeight=null,this.shards.splice(v,0,h),h.setPageContent(this);const w=this.getGroup();h.setParent(w)},u.unshiftShards=function(h){h=h.slice(),h.reverse(),h.forEach(this.unshiftShard,this)},u.unshiftShard=function(h){this.shardsHeight=null,this.shards.unshift(h),h.setPageContent(this);const v=this.getGroup();h.setParent(v)},u.popOverflowShards=function(){const h=[];for(;this.hasHeightOverflow()&&this.shards.length>1;){const w=this.popShard();h.unshift(w)}let v=this.getNbToPop();for(;v>0;){const w=this.popShard();h.unshift(w),v--}return h},u.hasHeightOverflow=function(){const h=this.getHeight();return this.getShardsHeight()>=h},u.getNbToPop=function(){const h=this.getNbShards();for(let v=0;v<h;v++){const w=this.shards[v];if(v>0&&w.shouldBreakBefore())return h-v;if(w.shouldBreakAfter())return h-(v+1)}return 0},u.popShard=function(){if(this.getNbShards()===0){const w="Cannon pop on an empty PageContent.";throw new b.default("PopOnEmpty",w)}const v=this.shards.pop();return v.setParent(null),v.setPageContent(null),this.shardsHeight=null,v},u.getNbShards=function(){return this.shards.length},u.getShardsHeight=function(){return this.shardsHeight===null&&this.recomputeShardsHeight(),this.shardsHeight},u.recomputeShardsHeight=function(){this.shardsHeight=0,!this.isEmpty()&&this.shards.forEach((h,v)=>{if(this.shardsHeight+=h.getHeight(),v>0){const w=this.shards[v-1],p=a(w,h,this.drawingContext);this.shardsHeight+=p}},this)},u.updateVerticalDisplay=function(){if(this.isEmpty())return;let h=0;this.shards.forEach(function(v,w){if(w===0){const p=this.drawingContext.getSpaceSize()*M;v.setFirstSystemMeasureGapAbove(p)}else{const p=this.shards[w-1],m=a(p,v,this.drawingContext);h+=m;const P=this.getAdditionalSpaceBetweenSystems();h+=P,v.setFirstSystemMeasureGapAbove(m),p.setLastSystemMeasureGapBelow(m)}if(v.setPosition(h),v.move(),h+=v.getHeight(),w===this.shards.length-1){const p=this.drawingContext.getSpaceSize()*M;v.setLastSystemMeasureGapBelow(p)}},this)};function a(h,v,w){const p=g(h,v,w),m=h.getSpaceBelowLastStaff(),P=v.getSpaceAboveFirstStaff();return p-m-P}function g(h,v,w){const p=h.getSpaceBelowLastStaff(),m=v.getSpaceAboveFirstStaff(),P=w.getSpaceSize()*U,W=p+m+P,s=h.getNotesSpaceBelowLastStaff(),i=v.getNotesSpaceAboveFirstStaff(),c=w.getSpaceSize()*M,d=s+i+c,F=w.getSpaceBetweenSystems();return Math.max(W,d,F)}u.getAdditionalSpaceBetweenSystems=function(){const h=this.getHeight()-this.getShardsHeight();return this.shards.length>1&&h>0&&!this.isLast&&this.displayOpts.systemVerticalSpaceDistribution?h/this.shards.length:0},u.drawContentRec=function(){this.updateVerticalDisplay(),this.shards.forEach(h=>h.drawContentRec())},u.getGroup=function(){return this.group===null&&(this.group=new N.A("g"),this.group.attr("class",this.name)),this.group},u.drawContent=function(){this.shards.forEach(S)};const S=function(h){h.draw()};u.move=function(){this.getGroup().attr("transform",`translate(0, ${this.posY})`)},u.bindToParent=function(){const h=this.getGroup();this.parent.append(h)},u.resetGeometries=function(){this.shards.forEach(D)};const D=function(h){h.resetGeometries()};u.getGeometries=function(){const h=this.shards.map(z);return Array.prototype.concat.apply([],h)};const z=function(h){return h.getAllMeasuresGeometries()};u.getStructure=function(){const h=this.getShardsStructures();return{pageIdx:this.idx,shards:h}},u.getShardsStructures=function(){return this.shards.map(V)};const V=function(h){return h.getStructure()};u.getIdx=function(){return this.idx},u.getIdxInPage=function(h){const v=this.shards.indexOf(h);if(v===-1){const w="The shard is not in this page";throw new b.default("NotInPage",w)}return v},u.removeShard=function(h){const v=this.shards.splice(h,1)[0];v.setParent(null),v.setPageContent(null),this.shardsHeight=null},u.isEmpty=function(){return this.shards.length===0},u.getWidth=function(){return this.metrics.availableWidth},u.getHeight=function(){return this.isFirst?this.metrics.firstShardAvailableHeight:this.metrics.otherShardsAvailableHeight},u.getLastShard=function(){const h=this.shards.length;if(h.length===0)throw new b.default("Unexpected");const v=h-1;return this.shards[v]},u.updateChildrenBindings=function(){for(let h=this.shards.length-1;h>=0;h--){const v=this.shards[h];if(!v.needUpdateBinding())continue;if(h===this.shards.length-1)v.setInsertionPoint(null);else{const m=this.shards[h+1].getGroup();v.setInsertionPoint(m)}v.updateBinding()}},u.updateMeasureNumbers=function(){this.shards.forEach(h=>h.updateMeasureNumbers())};const L=B},851480:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>U,p:()=>b});const b="primitive.AddMultiMeasureRest",U={NAME:b}},860984:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>h});var b=y(364842),N=y(726042),U=y(2255),M=y(515819);function B(v,w,p){v=v.slice();const m=v.map(u);let P=m.reduce(N.default.add),W=w+p;const s=v.map(a);let i=s.reduce(N.default.add),c=(W-i)/P;do{let d=!1;for(let F=v.length-1;F>=0;F--){const $=v[F];if(($.getWidth()-$.getNotesX())/m[F]>c){v.splice(F,1);const[J]=m.splice(F,1);P-=J;const[T]=s.splice(F,1);i-=T,W-=$.getWidth(),d=!0}}if(d)c=(W-i)/P;else{v.forEach((F,$)=>{const q=m[$]*c,J=F.getNotesX(),T=q+J;F.setWidth(T)});return}}while(v.length>0)}function u(v){const w=v.getNotesFormatter(),p=w.getDpq(),m=w.getNbDivisions();return M.default.divisionsToQuarter(m,p)}function a(v){return v.getNotesX()}const g=function(v,w,p){const m=v.getHeaderWidth();let P=D(v),W=P.map(z),s=W.reduce(N.default.add),i=m+s,c=w-i;if(c<0&&(P=S(v),W=P.map(z),s=W.reduce(N.default.add),i=m+s,c=w-i),c>0){const d=v.getNbMeasures(),F=v.getMaxNbMeasuresPerLine(),$=V(w,d,s,m,p,F);B(P,s,$)}else c<0;v.dispatchHorizontalFormatting(P)},S=function(v){return D(v,!0)},D=function(v,w){const p=[],m=v.getDrawingContext(),P=v.getMeasuresSlice(),W=P.getNbMeasures();for(let s=0;s<W;s++){const i=P.getMeasurePosition(s),c=v.getMeasuresHorizontalData(s),d=m.getNotesFormatter(),F=new U.A(m,c,d,w);F.format();const $=m.getMeasureWidth(),q=F.getFormatting();q.setMeasurePosition(i),q.setWidth($),p.push(q)}return p},z=function(v){return v.getWidth()},V=function(v,w,p,m,P,W){return v=L(v,p,P,w,W),v-(p+m)},L=function(v,w,p,m,P){if(!p||m>=P||m>=3)return v;let W;if(m===2)return W=v/4*3,w<W?W:v;if(m===1)return W=v/4*1.8,w<W||(W=v/4*3,w<W)?W:v;throw new b.default("Unexpected")},h=g},869207:function(st,Y,y){"use strict";var b=this&&this.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(Y,"__esModule",{value:!0});const N=b(y(364842)),U=b(y(292681)),M=b(y(719631)),B=b(y(721247)),u={},a=B.default.createPercussion();u.lineToPitch=function(S,D){if(D!==5)if(D===3)S-=1;else if(D===1)S-=2;else{const z=`The number of staff lines [${D}] is not supported for unpitched staff.`;throw new N.default("Unexpected",z)}return M.default.toPitch(U.default,S,a)},u.pitchToLine=function(S,D){const z=M.default.toLine(U.default,S,a);if(D===5)return z;if(D===3)return z+1;if(D===1)return z+2;{const V=`The number of staff lines [${D}] is not supported for unpitched staff.`;throw new N.default("Unexpected",V)}},u.hasInstrumentId=function(S,D,z){const V=U.default.stringify(D);return typeof S[V]=="undefined"?!1:typeof S[V][z]!="undefined"},u.hasInstrumentForUnpitched=function(S,D){const z=U.default.stringify(D);return typeof S[z]!="undefined"},u.getDefaultMIDIHead=function(S,D){let z;if(u.hasInstrumentForUnpitched(S,D))return z=U.default.stringify(D),S[z].default;{z=U.default.stringify(D);const V=`There is no MIDI unpitched for the pitch [${z}].`;throw new N.default("MIDIUnpitchedNotFound",V)}},u.getInstrumentId=function(S,D,z){let V;if(u.hasInstrumentId(S,D,z))return V=U.default.stringify(D),S[V][z];{V=U.default.stringify(D);const L=`There is no unpitched instrument id for the pitch [${V}] and notehead [${z}]`;throw new N.default("UnpitchedInstrumentIdNotFound",L)}},u.getHeadsForLine=function(S,D,z){const V=u.lineToPitch(D,z);if(u.hasInstrumentForUnpitched(S,V)){const L=U.default.stringify(V);let h=Object.keys(S[L]);return h=h.filter(g),h}else return[]};const g=function(S){return S!=="default"};Y.default=u},869773:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>U,p:()=>b});const b="primitive.AddMeasure",U={NAME:b}},949605:(st,Y,y)=>{"use strict";y.d(Y,{A:()=>g});var b=y(182879);const N=function(S,D,z){if(z===b.A.UPDATE)return M(S,D.partIdx,D.measureIdx);if(z===b.A.ADD)return U(S,D.measureIdx)},U=function(S,D){const z=[],V=S.getNbParts();for(let L=0;L<V;L++){const h=M(S,L,D);z.push(h)}return z},M=function(S,D,z){return S.getMeasureDisplayData(D,z)},B=N,u=function(S,D){S.forEach(a,D)},a=function(S){const D=this;S.data=B(D,S.realLocation,S.type)},g=u},950020:function(st,Y,y){"use strict";var b=Object.defineProperty,N=Object.getOwnPropertySymbols,U=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,B=(h,v,w)=>v in h?b(h,v,{enumerable:!0,configurable:!0,writable:!0,value:w}):h[v]=w,u=(h,v)=>{for(var w in v||(v={}))U.call(v,w)&&B(h,w,v[w]);if(N)for(var w of N(v))M.call(v,w)&&B(h,w,v[w]);return h},a=this&&this.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(Y,"__esModule",{value:!0}),Y.buildPitchedPart=z,Y._unpitchedLinesMappingToMusicXMLV2=V,Y.buildUnpitchedPart=L;const g=a(y(869207)),S=a(y(293329)),D=h=>JSON.parse(JSON.stringify(h));function z({instrument:h,fifths:v,useTabStaff:w,useChordGrid:p,hasQuarterTone:m}){m&&(w=!1,p=!1);const P=h.clefs,W={hasQuarterTone:!!m,instrumentName:h.longname,abbreviation:h.shortname,partName:h.longname,staves:[],MIDIProgram:h.midichannel.default.program};for(let s=0;s<P.length;s++){const i=h.transposechromatic%12||0,c=h.transposediatonic%7||0,d=h.transposechromatic<0?Math.ceil(h.transposechromatic/12)||0:Math.floor(h.transposechromatic/12)||0;if(W.staves.push({clef:P[s],transpose:{chromatic:i,diatonic:c,"octave-change":d}}),h.details&&(w||p)){const F=u({},h.details);p&&(F["$adagio-tabFrameEnabled"]=!0,w||(F["$adagio-noTab"]=!0)),W.staves[s].staffDetails=F}typeof v=="number"&&(W.staves[s].concertKey={fifths:v})}return W}function V({mapping:h=[],lines:v=5}={}){const w={};h.forEach(m=>{let P=m.noteLine;v===1&&(P+=2);const W=g.default.lineToPitch(P,v),s=S.default.stringify(W);w[s]=w[s]||{},w[s][m.noteHead]={midiUnpitched:m.midiKey,midiProgram:m.midiProgram},m.noteDefault&&(w[s].default=m.noteHead)});const p=Object.keys(w);for(let m=0;m<p.length;m++){const P=p[m],W=Object.keys(w[P]);w[P].default||(W.includes("normal")?w[P].default="normal":w[P].default=W[0])}return w}function L({instrument:h}){if(h=D(h),h.instruments){const v=h.midiprogram||1;for(let w=0;w<h.instruments.length;w++)h.instruments[w].MIDIProgram=v;h.unpitchedMapping=h.mapping,Object.keys(h.unpitchedMapping).forEach(w=>{Object.keys(h.unpitchedMapping[w]).forEach(p=>{p!=="default"&&typeof h.unpitchedMapping[w][p]=="string"&&(h.unpitchedMapping[w][p]={midiProgram:v,midiUnpitched:h.unpitchedMapping[w][p]})})})}else{h.instruments=[];for(let v=0;v<h.mapping.length;v++){const w=h.mapping[v];h.instruments.push({name:w.longname,shortname:w.shortname,MIDIProgram:w.midiProgram,unpitched:w.midiKey})}h.unpitchedMapping=V({mapping:h.mapping,lines:h.staffLines})}return{name:h.longname,abbreviation:h.shortname,instrumentsList:h.instruments,unpitchedMapping:h.unpitchedMapping,nbStaffLines:h.lines||h.staffLines}}}}]);})();


//# debugId=32a9387c-73db-5ea2-ae14-df53eac6175f
