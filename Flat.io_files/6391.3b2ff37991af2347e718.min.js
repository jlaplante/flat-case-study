"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="1d418c5f-c98d-59c0-83f4-84cb583c00dc")}catch(e){}}();
(()=>{/*! Copyright (c) 2025 Tutteo Ltd. */(self.webpackChunk_flat_flat=self.webpackChunk_flat_flat||[]).push([[6391],{1838:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(364842),e=t(951066);function s(o){return`Style ${o}is invalid.`}class c extends e.A{constructor(r){const n=s(r);super(n),Object.defineProperty(this,"style",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadDynamicsStyleError",this.style=r}}const d={},i=["ppp","pp","p","mp","mf","f","ff","fff","sfz","rfz","pf","fp"];d.assert=function(o){d.isValid(o)||d.raiseError(o)},d.check=function(o){if(!d.isValid(o))throw new c(o)},d.isValid=function(o){return i.includes(o)},d.raiseError=function(o){const r=`The dynamic style [${o}] is invalid.`;throw new f.default("BadDynamicStyle",r)};const a=d},8391:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(432712),e=t(746641),s=t(35802),c=t(701387),d=t(579102);function i(o){let r=c.default.getNbStaves(o);r=new f.A(r),c.default.getAllRawAttributes(o).forEach(u=>{if(s.default.hasMeasureStyle(u)){let l=s.default.getMeasureStyle(u);l=a(l,r,d.A),s.default.setMeasureStyle(u,l)}})}function a(o,r,n){return o=new e.A(o,r.get(),n).dumpAttribute(),o}},9160:(O,A,t)=>{t.d(A,{A:()=>P});var f=t(446921),e=t(701387),s=t(35802),c=t(104907),d=t(423508);function i(T){const _=e.default.getOwnAttributes(T),g=s.default.getNbStaves(_);if(g===1||(0,d.A)(T))return!1;const E=s.default.getWrappedStaffDetailsOrDefault(_);for(let D=0;D<g;D++){const M=E.getEntry(D);if(c.default.hasStaffTuning(M))return!0}return!1}var a=t(359932),o=t(721247),r=t(123491);function n(T){const _=f.A.getMeasures(T),[g]=_;u(g),_.forEach(h)}function u(T){const _=e.default.getOwnAttributes(T),g=s.default.getNbStaves(_),E=s.default.getWrappedStaffDetailsOrDefault(_);for(let m=0;m<g;m++){const v=E.getEntry(m);c.default.clearTuning(v)}const D=E.dumpAttribute();s.default.setStaffDetails(_,D);const M=s.default.getWrappedClef(_);let p=!1;for(let m=0;m<g;m++){const v=M.getEntry(m);if(o.default.isTab(v)){p=!0;const U=l(m);M.setEntry(U,m)}}if(p){const m=M.dumpAttribute();e.default.setOwnClef(T,m)}}function l(T){return T===0?o.default.create("G"):o.default.create("F")}function h(T){e.default.getNotes(T).forEach(I)}function I(T){r.default.removeHammerOnPullOff(T),r.default.removeTechnical(T,a.default.FRET),r.default.removeTechnical(T,a.default.STRING)}function P(T){const _=f.A.getFirstMeasure(T);i(_)&&n(T)}},10571:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(c){const d=`There is no octave shift at the index [${c}].`;super(d),Object.defineProperty(this,"octaveShiftIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadOctaveShiftIdxError",this.octaveShiftIdx=c}}},13262:(O,A,t)=>{t.d(A,{A:()=>l});var f=t(383279),e=t(701387),s=t(123491),c=t(832560),d=t(673817),i=t(199992);const a=function(h,I){const P={hasExtracted:!1};e.default.getNotes(h).forEach(o,P),P.hasExtracted&&r(h,I)},o=function(h){if(!s.default.hasUnpitched(h)&&s.default.hasAccidentalWithParentheses(h)){s.default.addCourtesyAccidental(h),s.default.removeAccidental(h);const I=this;I.hasExtracted=!0}},r=function(h,I){const P=new c.A(h),T=n(I);P.scoreData=T,P.forEachVoice(u,P)},n=function(h){return{getPartVoiceMainStaffIdx:function(I,P){return f.default.getVoiceMainStaffIdx(h,P)},checkPartIdx:function(){},checkMeasureIdx:function(){}}},u=function(h,I){const P=this,T={voiceIdx:I},_=new d.A;new i.A(P,T,_).perform()},l=a},13800:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(123491),e=t(351277),s=t(852363),c=t(343568);const d=function(r,n,u){this.init(r,n,u)};d.NAME="primitive.RemoveFromChord";const i=d.prototype;i.name=d.NAME,i.initMeasureData=c.A,i.init=function(r,n,u){this.initMeasureData(r,n),this.cancelStack=u,this.opts=n},i.perform=function(){const r=this.getVoice(),l=r.getChord(this.opts.noteIdx).map(f.default.getPitch).findIndex(a,this.opts.pitch);r.removeNoteFromChord(this.opts.noteIdx,l),this.updateStack()},i.getVoice=function(){return this.measureData.getVoice(this.opts.voiceIdx)};const a=function(r){const n=this;return e.default.isSameLine(r,n)};i.updateStack=function(){const r={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx}};this.cancelStack.push(r),(0,s.default)(this.cancelStack,this.measureData,this.opts)};const o=d},14302:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(123491),e=t(292681),s=t(793317),c=t(852363);const d=function(r,n,u){this.init(r,n,u)};d.NAME="primitive.RemoveGraceFromChordPercu";const i=d.prototype;i.name=d.NAME,i.initMeasureData=s.default,i.init=function(r,n,u){this.initMeasureData(r,n),this.cancelStack=u,this.opts=n},i.perform=function(){const r=this.getVoice(),u=r.getGraceChord(this.opts.noteIdx,this.opts.graceIdx).findIndex(this.unpitchedPredicate,this);r.removeGraceFromChord(this.opts.noteIdx,this.opts.graceIdx,u),this.updateStack()},i.unpitchedPredicate=function(r){const n=f.default.getUnpitched(r),u=this.opts.unpitched;return e.default.isSameLine(n,u)},i.getVoice=function(){const r=this.opts.voiceIdx;return this.measureData.getVoice(r)},i.updateStack=function(){const r={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx},n={type:this.name,opts:r};this.cancelStack.push(n),(0,c.default)(this.cancelStack,this.measureData,this.opts)};const o=d},15730:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(210888),e=t(601770);const s={};s.checkOrGenerateHeaders=function(d,i){const a=this.getNbHeaders(d);if(i<a){const o=this.getHeader(d,i);(!e.A.hasUuid(o)||!f.default.isValid(e.A.getUuid(o)))&&this.setUuid(d,i,f.default.generate())}else this.generateNewHeader(d,i)},s.generateNewHeader=function(d,i){const a=e.A.create(f.default.generate());this.addHeader(d,a,i)},s.isEmpty=function(d){return d.length===0},s.addHeader=function(d,i,a){d.splice(a,0,i)},s.removeHeader=function(d,i){d.splice(i,1)},s.getHeader=function(d,i){return d[i]},s.setUuid=function(d,i,a){const o=this.getHeader(d,i);e.A.setUuid(o,a)},s.getUuid=function(d,i){const a=this.getHeader(d,i);return e.A.getUuid(a)},s.getNbHeaders=function(d){return d.length},s.hasUuid=function(d,i){return d.some(function(a){return e.A.getUuid(a)===i})};const c=s},16757:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(555172),s=t(269032);function c(a){d(a),i(a)}function d(a){if(!f.default.hasLeftBarline(a))return;const o=f.default.getLeftBarline(a);if(!e.A.hasRepeat(o))return;const r=e.A.getRepeat(o);if(!s.A.isForward(r)){e.A.removeRepeat(o);return}s.A.hasTimes(r)&&s.A.removeTimes(r)}function i(a){if(!f.default.hasRightBarline(a))return;const o=f.default.getRightBarline(a);if(!e.A.hasRepeat(o))return;const r=e.A.getRepeat(o);if(!s.A.isBackward(r)){e.A.removeRepeat(o);return}if(!s.A.hasTimes(r))s.A.setTimes(r,s.A.DEFAULT_TIMES);else{const n=s.A.getRawTimes(r);s.A.isValidTimes(n)||s.A.setTimes(r,s.A.DEFAULT_TIMES)}}},22260:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(9688);const e={},s="system-distance";e.getDistance=function(d){return e.hasDistance(d)?parseFloat(d[s]):f.A.DEFAULT},e.hasDistance=function(d){const i=parseFloat(d[s]);return f.A.isValid(i)},e.setDistance=function(d,i){d[s]=i.toString()};const c=e},22729:(O,A,t)=>{t.d(A,{A:()=>s});const f="TuxGuitar",e="Flat (TabToXML)";function s(c){const{identification:d}=c;if(typeof d=="undefined")return!1;const{encoding:i}=d;if(typeof i=="undefined")return!1;const{software:a}=i;return typeof a!="string"?!1:a.startsWith(f)||a.startsWith(e)}},24724:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(123491),e=t(511890),s=t(364842);function c(a,o){const n=a.getRightChord().find(d,o);if(n)return f.default.getPitch(n);throw new s.default("Unexpected",`There is no slide stop with the number ${o}`)}function d(a){const o=this.valueOf();return f.default.getSlideStops(a).some(i,o)}function i(a){const o=this.valueOf();return e.default.getNumber(a)===o}},26698:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(364842),e=t(123491);const c=function(d,i,a){let o=0;const r=d.size();let n;for(n=0;n<r;n++){if(o===a)return n;const l=d.getNote(n),h=e.default.getDuration(l);if(o+=h*i,o>a)return n}if(o===a)return n;const u=`There is no noteIdx for time position [${o}].`;throw new f.default("Unexpected",u)}},27308:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(446921),e=t(383279),s=t(476943);const c=function(a,o){const r=s.default.listToMap(o,f.A.getId);return a=a.filter(d,r),a},d=function(a){const o=this,r=e.default.getId(a);return typeof o[r]!="undefined"},i=c},28281:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(89679),e=t(141624),s=t(701387),c=t(788220),d=t(555172),i=t(269032);function a(n){if(!(0,f.A)(n.getScorePartWise()))return;const u=n.getNbMeasures();for(let l=0;l<u;l++)o(n,l)}function o(n,u){const I=n.getMeasure(0,u),P=s.default.getNbDivisions(I),T=s.default.getWords(I,0);if(T.length===0)return;const _=T[T.length-1];if(c.A.getTimePos(_)!==P||c.A.getPlacement(_)!==e.A.ABOVE)return;const D=c.A.getText(_);if(D.length<=1||D[D.length-1]!=="x")return;const M=parseInt(D,10);if(Number.isNaN(M))return;const p=n.getNbParts();for(let m=0;m<p;m++)r(n,u,m,M);T.pop(),s.default.setWords(I,0,T)}function r(n,u,l,h){const I=n.getMeasure(l,u);if(!s.default.hasRepeatBackward(I))return;const P=s.default.getRightBarline(I),T=d.A.getRepeat(P);i.A.setTimes(T,h)}},32302:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(701387),e=t(838603);function s(d){d.forEach(c)}function c(d){const i=f.default.getNbStaves(d);for(let a=0;a<i;a++){if(!f.default.hasMeasureRepeat(d,a))continue;const o=f.default.getMeasureRepeat(d,a);e.A.setPatternMeasureIdx(o,0)}}},32979:(O,A,t)=>{t.d(A,{A:()=>P});var f=t(411993),e=t(123491),s=t(701387),c=t(562628),d=t(364842);const i=function(){this.init()},a=i.prototype;a.init=function(){this.leftNotes={}},a.addChord=function(T){this.matchTies(T),this.dropStartedTies(),this.storeStartingTies(T)},a.matchTies=function(T){T=T.filter(e.default.hasTieStop),T=o(T);let _;for(_ in this.leftNotes)typeof T[_]!="undefined"&&(delete this.leftNotes[_],delete T[_]);for(_ in T){const g=T[_];e.default.removeTieStop(g)}},a.dropStartedTies=function(){for(const T in this.leftNotes){const _=this.leftNotes[T];e.default.removeTieStart(_)}this.leftNotes={}},a.storeStartingTies=function(T){T=T.filter(e.default.hasTieStart),this.leftNotes=o(T)};const o=function(T){const _={};return T.forEach(function(g){let E;if(e.default.hasPitch(g))E=e.default.getPitchStr(g);else if(e.default.hasUnpitched(g)){const D=e.default.getHead(g);E=e.default.getUnpitchedStr(g)+D}else throw new d.default("Unexpected");_[E]=g}),_};a.endReached=function(){this.dropStartedTies()};const r=i,n=function(T){new u(T).filter()},u=function(T){this.init(T)},l=u.prototype;l.init=function(T){this.measures=T,this.buffers={},this.voicesSet=new Set},l.filter=function(){this.measures.forEach(this.filterMeasure,this),this.flushBuffers()},l.filterMeasure=function(T){const _=s.default.getNotes(T);_.forEach(h);const g=f.A.groupVoices(_);for(const E in g)this.voicesSet.add(parseInt(E,10));this.voicesSet.forEach(E=>{let D=g[E];if(!D){const M=e.default.createRest();e.default.setVoiceIdx(M,E),D=[M]}this.filterNotes(D)})};const h=function(T){(e.default.isRest(T)||e.default.isGraceNote(T))&&e.default.removeTie(T)};l.filterNotes=function(T){const _=I(T),g=this.getVoiceBuffer(_);(0,c.A)(T).forEach(g.addChord,g)};const I=function(T){const _=T[0];return e.default.getVoiceIdx(_)};l.getVoiceBuffer=function(T){return this.hasBuffer(T)||this.createBuffer(T),this.buffers[T]},l.hasBuffer=function(T){return typeof this.buffers[T]!="undefined"},l.createBuffer=function(T){this.buffers[T]=new r},l.flushBuffers=function(){for(const T in this.buffers)this.buffers[T].endReached()};const P=n},39489:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(737903);const s=function(i){const a=i[0];if(f.default.hasOwnAttributes(a))return;const o=i.slice(1),r={attributes:null};if(o.some(c,r),r.attributes===null)return;const n=(0,e.default)(r.attributes);f.default.setOwnAttributes(a,n)},c=function(i){const a=this;return f.default.hasOwnAttributes(i)?(a.attributes=f.default.getOwnAttributes(i),!0):!1},d=s},39573:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(428925),e=t(898439),s=t(701387),c=t(886766);function d(a,o){const r=(0,f.A)(o),n=a.getMeasure(),u=i(n,r),l=s.default.getOctaveShifts(n,r),h=a.getVoice(o.voiceIdx),I=(0,e.A)(h,o.noteIdx);return(0,c.A)(u,l,I,!0)}function i(a,o){return s.default.hasLeftOctaveShift(a,o)?s.default.getLeftOctaveShift(a,o):null}},40732:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(373758);const s=function(c,d){c.forEach(function(i,a){const o=d[a];f.A.updateInstrumentsIds(i,o)})}},42681:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(522117);function e(s,c=!1){const d=s.getNbParts(s),i=s.getNbMeasures(s),a={commonContent:s.getCommonContent(),hasRestsInsideBeams(o){return c?this.commonContent.hasRestsInsideBeams(o):!1},getBeatsList(o){return this.commonContent.getBeatsList(o)}};for(let o=0;o<d;o++)for(let r=0;r<i;r++){const n=s.getMeasure(o,r);f.A.canShape(n)&&f.A.shapeMeasure(n,r,a)}}},44229:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(123491),e=t(292681),s=t(852363),c=t(343568);const d=function(r,n,u){this.init(r,n,u)};d.NAME="primitive.RemoveFromChordPercu";const i=d.prototype;i.name=d.NAME,i.initMeasureData=c.A,i.init=function(r,n,u){this.initMeasureData(r,n),this.cancelStack=u,this.opts=n},i.perform=function(){const r=this.getVoice(),n=r.getChord(this.opts.noteIdx),l=n.map(f.default.getUnpitched).findIndex(a,this.opts.unpitched),h=n[l];r.removeNoteFromChord(this.opts.noteIdx,l),this.updateStack(h)},i.getVoice=function(){return this.measureData.getVoice(this.opts.voiceIdx)};const a=function(r){const n=this;return e.default.isSameLine(r,n)};i.updateStack=function(r){const n=f.default.getUnpitched(r),u=f.default.getHead(r),l={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,noteIdx:this.opts.noteIdx,voiceIdx:this.opts.voiceIdx,unpitched:e.default.copy(n),notehead:u}};this.cancelStack.push(l),(0,s.default)(this.cancelStack,this.measureData,this.opts)};const o=d},44703:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(701387),e=t(558280),s=t(963062);const c=function(n,u){u.placement=e.A.getPlacement(n),u.type=e.A.getType(n)},d=function(n){const u=this.getMeasure(n);return f.default.getWedges(u,this.location.staffIdx)},i=function(n,u){return this.getMeasureDpq(u)},a={getEntities:d,isStart:e.A.isLeft,isStop:e.A.isRight,fillEntity:c,getDpq:i},r=function(n,u){return new s.A(n,u,a).get()}},46563:(O,A,t)=>{t.d(A,{A:()=>u});var f=t(343568),e=t(892853),s=t(123491),c=t(21738),d=t(131220),i=t(409200),a=t(457652);const o=function(l,h,I){return new r(l,h,I).hasAvailableSpace()},r=function(l,h,I){this.init(l,h,I)},n=r.prototype;n.init=function(l,h,I){this.scoreData=l,this.durationOpts=I,(0,c.default)(l,h),(0,d.default)(l,h),(0,i.default)(l,h),(0,a.A)(I),this.location=h},n.hasAvailableSpace=function(){const l={};f.A.call(l,this.scoreData,this.location),this.measureData=l.measureData,this.measureData.checkVoiceIdx(this.location.voiceIdx);const h=this.getVoice(),I=this.location.noteIdx;h.checkNoteIdx(I);const P=this.getAvailableDuration(),T=this.getRequiredDuration();return P>=T},n.getVoice=function(){return this.measureData.getVoice(this.location.voiceIdx)},n.getAvailableDuration=function(){const l=this.getVoiceOrTupletForGet(),h=l.getAbsoluteTimeModif(),I=l.getStopNoteIdx();let P=0;for(let T=this.location.noteIdx;T<=I;T++){if(this.isBlockingExpantion(T,h))return P;const _=l.getNote(T),g=s.default.getDuration(_);P+=g}return P},n.isBlockingExpantion=function(l,h){const I=this.getVoice(),P=I.getNote(l);return!s.default.isRest(P)||s.default.needRestLock(P)||!I.isSameTimeModifAt(l,h)},n.getRequiredDuration=function(){const l=this.measureData.getDpqValue(),h=this.getTimeModif();return(0,e.A)(this.durationOpts,l,h)},n.getTimeModif=function(){return this.getVoiceOrTupletForGet().getAbsoluteTimeModif()},n.getVoiceOrTupletForGet=function(){const l=this.location.voiceIdx,h=this.location.noteIdx;return this.measureData.getVoiceOrTupletForGet(l,h)};const u=o},51598:(O,A,t)=>{t.d(A,{A:()=>T});var f=t(701387),e=t(515819),s=t(726042);function c(_){const g=f.default.getDpq(_),E=f.default.getAnyTime(_),D=e.default.timeToRequiredDpq(E);return s.default.lcm(g,D)!==g}function d(_){const g=f.default.getDpq(_),E=f.default.getAnyTime(_),D=e.default.timeToRequiredDpq(E);return s.default.lcm(g,D)/g}var i=t(952818),a=t(614653),o=t(123491),r=t(35802);function n(_,g){f.default.getNotes(_).forEach(u,g),f.default.getAllDirections(_).forEach(l,g),f.default.getJazzHarmonies(_).forEach(h,g),f.default.getClassicHarmonies(_).forEach(h,g);const m=f.default.getAttributes(_);I(m,g)}function u(_){const g=this.valueOf();if(o.default.hasDuration(_)){const D=o.default.getDuration(_)*g;o.default.setDuration(_,D)}if(o.default.hasBackup(_)){const E=o.default.getBackupDuration(_);if(E>0){const D=E*g;o.default.addBackup(_,D)}}if(o.default.hasForward(_)){const E=o.default.getForwardDuration(_);if(E>0){const D=E*g;o.default.addForward(_,D)}}}function l(_){const g=i.A.getTimePos(_),E=this.valueOf(),D=g*E;i.A.setTimePos(_,D)}function h(_){const g=a.default.getTimePos(_),E=this.valueOf(),D=g*E;a.default.setTimePos(_,D)}function I(_,g){const D=r.default.getDpq(_)*g;r.default.setDpq(_,D)}function P(_){const g=d(_);n(_,g)}function T(_){c(_)&&P(_)}},54949:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(123491);const e={};e.groupStaves=function(a){return d.group(a)},e.resolvePos=function(a){let o=0;const r=[];let n=f.default.getStaffIdx(a[0]);for(let u=0;u<a.length;u++)f.default.getStaffIdx(a[u])!==n&&(o=0),f.default.isChord(a[u])||o++,n=f.default.getStaffIdx(a[u]),r.push({note:o-1,staff:n+1});return r};const s=function(){},c=s.prototype;c.group=function(a){return this.reset(),a.forEach(this.addNote.bind(this)),this.staffs},c.reset=function(){this.staffs={}},c.addNote=function(a){const o=f.default.getStaffIdx(a);this.addNoteToStaff(a,o)},c.addNoteToStaff=function(a,o){typeof this.staffs[o]=="undefined"&&(this.staffs[o]=[]),this.staffs[o].push(a)};const d=new s,i=e},55758:(O,A,t)=>{t.d(A,{A:()=>l});var f=t(476943),e=t(364596),s=t(123491),c=t(351277),d=t(832560),i=t(354703),a=t(673817),o=t(551690),r=t(749138),n=t(49906),u=t(275722);function l(D){const M=new d.A(D);M.getVoicesIndexes().map(M.getVoice,M).forEach(h,M)}function h(D){const M=D.getNbNotes(),p=this,m=D.getNote(0),v=s.default.getStaffIdx(m),U=p.getKey(v),x=e.default.getFifths(U),S=new i.A(x);for(let K=0;K<M;K++)if(!D.isRest(K)){if(D.hasGrace(K)){const H=D.getNbGraces(K);for(let Y=0;Y<H;Y++)I({measureData:p,voice:D,alterationTable:S,noteIdx:K,graceIdx:Y})}_({measureData:p,voice:D,alterationTable:S,noteIdx:K})}}function I({measureData:D,voice:M,alterationTable:p,noteIdx:m,graceIdx:v}){const U=M.getVoiceIdx();let x=M.getGraceChord(m,v);x=f.default.makeArray(x),x.forEach(S=>{const K=s.default.getPitch(S),H=p.getAlterValue(K),Y=c.default.getAlter(K);if(p.setAlterValue(K),H===Y)s.default.hasAccidental(S)&&!s.default.hasCourtesyAccidental(S)&&P({measureData:D,voiceIdx:U,noteIdx:m,graceIdx:v,pitch:K});else{const C=c.default.alterToAccidental(Y);(!s.default.hasAccidental(S)||s.default.getAccidental(S)!==C)&&T({measureData:D,voiceIdx:U,noteIdx:m,graceIdx:v,pitch:K,accidental:C})}})}function P({measureData:D,voiceIdx:M,noteIdx:p,graceIdx:m,pitch:v}){const U={voiceIdx:M,noteIdx:p,graceIdx:m,pitch:c.default.copy(v)},x=new a.A;new o.A(D,U,x).perform()}function T({measureData:D,voiceIdx:M,noteIdx:p,graceIdx:m,pitch:v,accidental:U}){const x={voiceIdx:M,noteIdx:p,graceIdx:m,pitch:c.default.copy(v),accidental:U},S=new a.A;new r.A(D,x,S).perform()}function _({measureData:D,voice:M,alterationTable:p,noteIdx:m}){const v=M.getVoiceIdx();let U=M.getChord(m);U=f.default.makeArray(U),U.forEach(x=>{const S=s.default.getPitch(x);if(m===0&&s.default.hasTieStop(x)){s.default.hasAccidental(x)&&g({measureData:D,voiceIdx:v,noteIdx:m,pitch:S});return}const K=p.getAlterValue(S),H=c.default.getAlter(S);if(p.setAlterValue(S),K===H)s.default.hasAccidental(x)&&!s.default.hasCourtesyAccidental(x)&&g({measureData:D,voiceIdx:v,noteIdx:m,pitch:S});else{const Y=c.default.alterToAccidental(H);(!s.default.hasAccidental(x)||s.default.getAccidental(x)!==Y)&&E({measureData:D,voiceIdx:v,noteIdx:m,pitch:S,accidental:Y})}})}function g({measureData:D,voiceIdx:M,noteIdx:p,pitch:m}){const v={voiceIdx:M,noteIdx:p,pitch:c.default.copy(m)},U=new a.A;new n.default(D,v,U).perform()}function E({measureData:D,voiceIdx:M,noteIdx:p,pitch:m,accidental:v}){const U={voiceIdx:M,noteIdx:p,pitch:c.default.copy(m),accidental:v},x=new a.A;new u.default(D,U,x).perform()}},60615:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(701387),e=t(584416),s=t(245689),c=t(817066),d=t(868743),i=t(468852);const a=function(u){(0,s.A)(u).map(c.A).forEach(function(I){new o(I,u).fillPedals()})},o=function(u,l){this.init(u,l)},r=o.prototype;r.init=function(u,l){this.wrappedPedals=u,this.measures=l,this.measuresScroller=null},r.fillPedals=function(){const u=this.wrappedPedals.length;for(let l=0;l<u-1;l+=2){const h=this.wrappedPedals[l],I=this.wrappedPedals[l+1];this.fillPedal(h,I)}},r.fillPedal=function(u,l){const h=u.measureIdx,I=l.measureIdx;this.addContinues(h,I,u)},r.addContinues=function(u,l,h){for(let I=u;I<l;I++)this.addContinue(I,h)},r.addContinue=function(u,l){const h=e.A.getStaffIdx(l.direction),I=e.A.getPlacement(l.direction),P=e.A.getTimePos(l.direction),T=this.measures[u],_=e.A.create(h,I,P,d.A.CONTINUE,i.A.RIGHT);f.default.setRightPedal(T,h,_);const g=this.measures[u+1],E=e.A.create(h,I,P,d.A.CONTINUE,i.A.LEFT);f.default.setLeftPedal(g,h,E)};const n=a},62503:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(348742),e=t(843678),s=t(383279);const c=function(a,o){for(let r=0;r<a.length;){const n=a[r];d(n)?(a.splice(r,1),o.splice(r,1)):r++}if(a.length===0)throw new f.A("NoPartRemaining")},d=function(a){if(s.default.hasUnpitchedMapping(a)){const o=s.default.getUnpitchedMapping(a);return e.default.isEmpty(o)}else return!1},i=c},69602:(O,A,t)=>{t.d(A,{A:()=>T});var f=t(411993),e=t(123491),s=t(701387),c=t(562628),d=t(316197),i=t(129283);const a=function(){this.init()},o=a.prototype;o.init=function(){this.leftNotes={}},o.addChord=function(_){this.matchGlissandos(_),this.dropStartedGlissandos(),this.storeStartingGlissandos(_)},o.matchGlissandos=function(_){_=_.filter(e.default.hasGlissandoStop),_=r(_,i.default.STOP);let g;for(g in this.leftNotes)typeof _[g]!="undefined"&&(delete this.leftNotes[g],delete _[g]);for(g in _){const E=_[g],D=e.default.getGlissando(E,i.default.STOP,parseInt(g,10));e.default.removeGlissando(E,D)}},o.dropStartedGlissandos=function(){for(const _ in this.leftNotes){const g=this.leftNotes[_],E=e.default.getGlissando(g,i.default.START,parseInt(_,10));e.default.removeGlissando(g,E)}this.leftNotes={}},o.storeStartingGlissandos=function(_){_=_.filter(e.default.hasGlissandoStart),this.leftNotes=r(_,i.default.START)};const r=function(_,g){const E={};return _.forEach(function(D){e.default.getGlissandosType(D,g).slice().forEach(function(p){const m=d.default.getNumber(p);typeof E[m]!="undefined"?e.default.removeGlissando(D,p):E[m]=D})}),E};o.endReached=function(){this.dropStartedGlissandos()};const n=a,u=function(_){new l(_).filter()},l=function(_){this.init(_)},h=l.prototype;h.init=function(_){this.measures=_,this.buffers={}},h.filter=function(){this.measures.forEach(this.filterMeasure,this),this.flushBuffers()},h.filterMeasure=function(_){const g=s.default.getNotes(_);g.forEach(I);const E=f.A.groupVoices(g);for(const D in E){const M=E[D];this.filterNotes(M)}};function I(_){e.default.isGraceNote(_)&&e.default.removeGlissandos(_)}h.filterNotes=function(_){const g=P(_),E=this.getVoiceBuffer(g);(0,c.A)(_).forEach(E.addChord,E)};const P=function(_){const g=_[0];return e.default.getVoiceIdx(g)};h.getVoiceBuffer=function(_){return this.hasBuffer(_)||this.createBuffer(_),this.buffers[_]},h.hasBuffer=function(_){return typeof this.buffers[_]!="undefined"},h.createBuffer=function(_){this.buffers[_]=new n},h.flushBuffers=function(){for(const _ in this.buffers)this.buffers[_].endReached()};const T=u},73925:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(316826),e=t(648920),s=t(726042),c=t(364842);const d=function(n){const u=[];let l=null;for(let h=0;h<n.nbBeams;h++){const I=i(n,h,l);l=I;const P=e.A.create(h,I);u.push(P)}return u},i=function(n,u,l){if(n.left[u]===!0&&n.right[u]===!0)return f.A.CONTINUE;if(n.left[u]===!0&&n.right[u]===!1)return f.A.END;if(n.left[u]===!1&&n.right[u]===!0)return f.A.BEGIN;if(n.left[u]===!1&&n.right[u]===!1)return a(l,n.position,n.duration);throw new c.default("Unreachable")},a=function(n,u,l){if(n===f.A.BEGIN||n===f.A.FORWARD)return f.A.FORWARD;if(n===f.A.END||n===f.A.BACKWARD)return f.A.BACKWARD;if(n===f.A.CONTINUE)return o(u,l);if(n===null){const h="Cannot have ";throw new c.default("Unexpected",h)}else f.A.raiseError(n)};function o(n,u){const l=n/u;if(!s.default.isNumber(l))throw new c.default(`Invalid relative position value ${l}`);return s.default.isInteger(l)?s.default.isEven(l)?f.A.FORWARD:f.A.BACKWARD:f.A.FORWARD}const r=d},74816:(O,A,t)=>{t.d(A,{A:()=>u});var f=t(476943);const e=function(l){c(l),s(l)},s=function(l){for(const h in l){const I=l[h];f.default.isArray(I)&&(I.length===1?l[h]=I[0]:I.length===0&&delete l[h])}},c=function(l){for(const h in l)d(l,h)},d=function(l,h){const I=l[h];I===null||typeof I=="undefined"?delete l[h]:o(l,h)},i=function(l){for(let h=0;h<l.length;h++)a(l,h)},a=function(l,h){o(l,h)},o=function(l,h){const I=l[h];typeof I=="number"&&h!=="timePos"&&h!=="dpq"&&h!=="noteBefore"?l[h]=I.toString():r(I)?i(I):n(I)&&c(I)},r=function(l){return Object.prototype.toString.call(l)==="[object Array]"},n=function(l){return Object.prototype.toString.call(l)==="[object Object]"},u=e},80353:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(123491),e=t(209175),s=t(892853),c=t(343568),d=t(852363);const i=function(r,n,u){this.init(r,n,u)};i.NAME="primitive.AddRest";const a=i.prototype;a.name=i.NAME,a.initMeasureData=c.A,a.init=function(r,n,u){this.initMeasureData(r,n),this.cancelStack=u,this.opts=n},a.perform=function(){const r=this.getVoice(),n=e.default.copy(r.getAbsoluteTimeModif()),u=this.createRest(n,r);r.insertNote(u,this.opts.noteIdx),this.updateStack()},a.getVoice=function(){const r=this.opts.voiceIdx,n=this.opts.noteIdx;return this.measureData.getVoiceOrTupletForInsert(r,n)},a.createRest=function(r,n){const u=this.opts.nbDots||0,l={rest:{}};f.default.setVoiceIdx(l,this.opts.voiceIdx),f.default.setStaffIdx(l,this.opts.staffIdx),f.default.setNbDots(l,u);const h=this.getDuration();f.default.setDuration(l,h),f.default.setTimeModif(l,r);const I=n.getRangeSpace(0,this.opts.noteIdx);return f.default.setTimePos(l,I),l},a.getDuration=function(){const r=this.measureData.getDivisionsPerQuarterValue(),u=this.getVoice().getAbsoluteTimeModif();return(0,s.A)(this.opts,r,u)},a.updateStack=function(){const r={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,noteIdx:this.opts.noteIdx,voiceIdx:this.opts.voiceIdx,staffIdx:this.opts.staffIdx,durationType:this.opts.durationType,nbDots:this.opts.nbDots}};this.cancelStack.push(r),(0,d.default)(this.cancelStack,this.measureData,this.opts)};const o=i},84136:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(383279),e=t(446921),s=t(701387),c=t(123491),d=t(351277),i=t(292681);function a(u){e.A.getMeasures(u).forEach(o)}function o(u){s.default.getNotes(u).forEach(r)}function r(u){if(!c.default.isRest(u)&&c.default.hasUnpitched(u)){const l=c.default.getUnpitched(u),h=i.default.getOctave(l),I=i.default.getStep(l),P=d.default.create(h,I);c.default.setPitch(u,P),delete u.unpitched}}function n(u,l){u.forEach(function(h,I){if(f.default.hasUnpitched(h))return;const P=l[I];a(P)})}},87554:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(210888),e=t(701387),s=t(589501);function c(i){e.default.getFiguredBasses(i).forEach(d)}function d(i){const a=f.default.generate();s.A.setUuid(i,a)}},88217:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(701387),e=t(123491);const s=function(a){const o=f.default.getNotes(a),r=o.reduce(c,null);r>0&&o.forEach(d,r)},c=function(a,o){let r=0;if(e.default.hasVoiceIdx(o)){const n=e.default.getVoiceIdx(o);n<0&&(r=Math.abs(n))}return Math.max(a,r)},d=function(a){const o=this;if(e.default.hasVoiceIdx(a)){const r=e.default.getVoiceIdx(a);e.default.setVoiceIdx(a,r+o)}},i=s},89679:(O,A,t)=>{t.d(A,{A:()=>e});const f="Noteflight";function e(s){const{identification:c}=s;if(typeof c=="undefined")return!1;const{encoding:d}=c;if(typeof d=="undefined")return!1;const{software:i}=d;return typeof i!="string"?!1:i.startsWith(f)}},92078:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(607682);class e extends f.default{constructor(i,a){super(c(i,a)),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"idx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="DuplicateIndexError",this.type=i,this.idx=a}}Object.defineProperty(e,"PART",{enumerable:!0,configurable:!0,writable:!0,value:"part"}),Object.defineProperty(e,"STAFF",{enumerable:!0,configurable:!0,writable:!0,value:"staff"});const s=e,c=function(d,i){return`The first ${d} index [${i}] appears twice`}},93923:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(c){const d=`There is no pedal at the index [${c}].`;super(d),Object.defineProperty(this,"pedalIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadPedalIdxError",this.pedalIdx=c}}},94622:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(123491),e=t(701387);const c=function(d,i){let a=null,o=i.measureIdx;const r=d.getNbMeasures();for(;o<r;o++){const n=d.getMeasureData(o);if(!n.hasVoice(i.voiceIdx)){a=0;continue}const u=n.getVoice(i.voiceIdx);a===null?a=i.noteIdx:a=0;const l=u.size();for(;a<l;a++){const I=u.getNote(a);if((a!==i.noteIdx||o!==i.measureIdx)&&f.default.hasSlurStart(I))return null;if(f.default.hasSlurStop(I))return{measureIdx:o,noteIdx:a}}const h=n.data;if(!e.default.hasRightSlur(h,i.voiceIdx))return null}return null}},95901:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(446921),e=t(123491),s=t(35802),c=t(104907),d=t(701387);function i(I){const P=f.A.getMeasures(I);a(P)&&P.forEach(l)}function a(I){const P={hasTuning:!1};return I.some(o,P)?!1:P.hasTuning&&P.hasPitchedNote}function o(I){const P=this;P.hasTuning||d.default.getAllRawAttributes(I).some(n,P);const T=d.default.getNotes(I);return!P.hasPitchedNote&&T.some(r)&&(P.hasPitchedNote=!0),T.some(e.default.hasFretData)}function r(I){return e.default.isGraceNote(I)?!1:e.default.hasPitch(I)}function n(I){const P=s.default.getStaffDetails(I),T=this;return P.some(u,T)}function u(I){if(c.default.hasTab(I)){const P=this;return P.hasTuning=!0,!0}}function l(I){d.default.getAllRawAttributes(I).forEach(h)}function h(I){s.default.getStaffDetails(I).forEach(c.default.clearTuning)}},96354:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(123491),s=t(533296);const d=function(o){const r=e.default.getTies(o),n=s.A.copy(r);e.default.setTieds(o,n)},a=function(o){f.default.getNotes(o).forEach(d)}},96874:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(701387),e=t(35802),s=t(721247);const c="G",d=function(r){f.default.getAllRawAttributes(r).forEach(i)},i=function(r){const n=e.default.getClef(r),u={previousSign:null};n.forEach(a,u)},a=function(r){const n=this;s.default.hasSign(r)?n.previousSign===null&&(n.previousSign=s.default.getSign(r)):n.previousSign!==null?s.default.setSign(r,n.previousSign):s.default.setSign(r,c)},o=d},99923:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(){super("This operation is not possible on pitched."),this.name="NotPossibleOnPitchedError"}}},100489:(O,A,t)=>{t.d(A,{A:()=>M});var f=t(883782),e=t(607682);class s extends e.default{constructor(m){const v=`The pluckedRange uuid ${m} is invalid.`;super(v),Object.defineProperty(this,"pluckedRangeUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadPluckedRangeUuidError",this.pluckedRangeUuid=m}}var c=t(443749),d=t(21738),i=t(409200),a=t(665280),o=t(799851),r=t(173739),n=t(189247),u=t(446921),l=t(701387),h=t(368495),I=t(737903),P=t(726042);const T=function(p,m){(0,d.default)(p,m),(0,i.default)(p,m),(0,a.default)(p,m),p.checkPartIdx(m.partIdx);const v=p.getPartContent(m.partIdx);if(!u.A.hasPluckedRange(v,m.pluckedRangeUuid))throw new s(m.pluckedRangeUuid);const U=u.A.getPluckedRange(v,m.pluckedRangeUuid),x=p.getMeasureIdxFromUuid(U.measureUuid);if(p.checkMeasureIdx(x),!p.hasPartVoiceIdx(m.partIdx,m.voiceIdx))throw new f.default(m.voiceIdx);const S=p.getPartNbStaves(m.partIdx),K=m.staffIdx;if(!P.default.isInteger(K)||K<0||K>=S)throw new c.default(m.staffIdx);const H=p.getMeasure(m.partIdx,x);let Y=l.default.getPluckedRanges(H,m.staffIdx);Y=Y.filter(h.A.isStart);const C=g(Y,U.pluckedRangeUuid),y=h.A.getTimePos(C),F=p.getPartMeasures(m.partIdx),N=(0,r.A)(F,x,m.staffIdx,y);N.startDpq=l.default.getDpq(H);const G=p.getMeasure(m.partIdx,N.stopMeasureIdx);N.stopDpq=l.default.getDpq(G),N.partIdx=m.partIdx,N.staffIdx=m.staffIdx;const nt=_(p,m,N);return Object.assign(N,nt),D(N,p),N},_=function(p,m,v){const U=(0,I.default)(v);U.searchedVoiceIdx=m.voiceIdx,U.staffVoicesIndexes=p.getPartStaffVoicesIndexes(m.partIdx,m.staffIdx);const x=p.getPartMeasures(m.partIdx),S=new n.A(x,m.partIdx,p);return(0,o.A)(S,U)},g=function(p,m){return p.find(E,m)},E=function(p){const m=this.valueOf();return h.A.getPluckedRangeUuid(p)===m},D=function(p,m){p.startMeasureUuid=m.getMeasureUuid(p.startMeasureIdx),p.startVoiceUuid=m.getPartVoiceUuid(p.partIdx,p.startVoiceIdx),p.stopMeasureUuid=m.getMeasureUuid(p.stopMeasureIdx),p.stopVoiceUuid=m.getPartVoiceUuid(p.partIdx,p.stopVoiceIdx),p.partUuid=m.getPartUuid(p.partIdx),p.staffUuid=m.getPartStaffUuid(p.partIdx,p.staffIdx)},M=T},101341:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(726042);const s=function(o){const n=o.map(f.default.getStaffContentMap).reduce(c,0);return d(o,n)},c=function(o,r){return Object.keys(r).forEach(function(u){o=e.default.max2(o,e.default.toInt(u)+1)},this),o},d=function(o,r){const n=[];for(let u=0;u<r;u++){const l=o.map(i,u);n.push(l)}return n},i=function(o){const r=this.valueOf();return f.default.getPluckedRanges(o,r)},a=s},101585:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(951066);function e(){return"The beats list is invalid in regard of the time signature."}class s extends f.A{constructor(){const d=e();super(d),this.name="BadBeatsListError"}}},104864:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(579102),s=t(35802),c=t(746641);function d(i){const a=i.getCommonContent(),o=i.getNbParts(),r=i.getNbMeasures();for(let n=0;n<r;n++){if(!a.hasMultiMeasureRest(n))continue;const u=a.getMultiMeasureRest(n);for(let l=0;l<o;l++){const h=i.getMeasure(l,n),I=f.default.getNbStaves(h),P=f.default.getOwnAttributes(h);let T=s.default.getMeasureStyle(P);const _=new c.A(T,I,e.A);for(let g=0;g<I;g++){let E={};_.hasEntry(g)&&(E=_.getEntry(g)),e.A.setMultiMeasureRest(E,u),_.setEntry(E,g)}T=_.dumpAttribute(),s.default.setMeasureStyle(P,T),f.default.setOwnAttributes(h,P)}}}},105977:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(701387),e=t(123491);function s(d){const i=f.default.getNotes(d),a={voices:{}};i.forEach(c,a)}function c(d){const i=e.default.getVoiceIdx(d);typeof this.voices[i]=="undefined"&&(this.voices[i]={timePos:0,previousTimePos:0});const a=this.voices[i];if(e.default.isChord(d)?e.default.setTimePos(d,a.previousTimePos):(e.default.setTimePos(d,a.timePos),a.previousTimePos=a.timePos),e.default.hasDuration(d)&&!e.default.isChord(d)){const o=e.default.getDuration(d);a.timePos+=o}}},108216:(O,A,t)=>{t.d(A,{A:()=>p});var f=t(446921),e=t(701387),s=t(518558),c=t(726042),d=t(123491),i=t(515819);const a=function(m){const v=e.default.getDpq(m),U=o(m);return i.default.divisionsToQuarter(U,v)},o=function(m){const v=e.default.getNotes(m);return new r(v).getNbDivisions()},r=function(m){this.init(m)},n=r.prototype;n.init=function(m){this.maxLength=0,this.timePos=0,this.notes=m},n.getNbDivisions=function(){return this.searchMeasureSize(),this.maxLength},n.searchMeasureSize=function(){this.notes.forEach(this.addNote,this)},n.addNote=function(m){if(!d.default.isChord(m)&&(this.applyTimeShifts(m),d.default.hasDuration(m))){const v=d.default.getDuration(m);this.addDuration(v)}},n.applyTimeShifts=function(m){if(d.default.hasBackup(m)){const v=d.default.getBackupDuration(m);this.timePos-=v}if(d.default.hasForward(m)){const v=d.default.getForwardDuration(m);this.timePos+=v}this.recordMax()},n.recordMax=function(){this.maxLength=Math.max(this.timePos,this.maxLength)},n.addDuration=function(m){this.timePos+=m,this.recordMax()};const u=a,h=function(m,v){if(m===0)return s.default.copy(v);const U=s.default.getBeatType(v),x=i.default.beatTypeToQuarter(U),S=i.default.extractSmallestBaseDuration(m),K=Math.min(x,S),H=m/K,Y=i.default.quarterToBeatType(K);return s.default.create(H,Y)};var I=t(35802);function P(m,v,U){const x=e.default.getOwnAttributes(U);return I.default.hasPersistedTime(x)?I.default.getAnyPersistedTime(x):m.getDisplayedTime(v)}const T=function(m){const v=m.getNbMeasures();for(let U=0;U<v;U++)_(m,U)},_=function(m,v){const U=g(m,v),x=E(U),S=m.getCommonContent(),H=m.getMeasure(0,v),Y=P(S,v,H),C=h(x,Y);D(U,C)},g=function(m,v){const U=[],x=m.getNbParts();for(let S=0;S<x;S++){const K=m.getPartContent(S),H=f.A.getMeasure(K,v);U.push(H)}return U},E=function(m){return m.map(u).reduce(c.default.max2)},D=function(m,v){m.forEach(M,v)},M=function(m){const v=this,U=e.default.getWrappedTime(m),x=U.getNbStaves();for(let K=0;K<x;K++){const H=s.default.copy(v);U.setEntry(H,K)}const S=U.dumpAttribute();e.default.setTime(m,S)},p=T},108262:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(343568),e=t(21738),s=t(131220),c=t(409200),d=t(123491);const i=function(n,u){return(0,e.default)(n,u),(0,s.default)(n,u),(0,c.default)(n,u),new a(n,u).get()},a=function(n,u){this.init(n,u)},o=a.prototype;o.init=function(n,u){this.scoreData=n,this.location=u},o.get=function(){this.noteData={};const n={};f.A.call(n,this.scoreData,this.location),this.measureData=n.measureData,this.measureData.checkVoiceIdx(this.location.voiceIdx),this.measureData.getVoice(this.location.voiceIdx).checkNoteIdx(this.location.noteIdx);let l=this.getNote();if(d.default.hasSlur(l)||!this.canMoveForward())return null;do{if(this.moveForward(),!this.hasVoice()||(l=this.getNote(),d.default.hasSlur(l)))return null;if(!d.default.isRest(l)){const h=this.location.measureIdx;return{measureIdx:h,measureUuid:this.scoreData.getMeasureUuid(h),noteIdx:this.location.noteIdx}}}while(this.canMoveForward());return null},o.canMoveForward=function(){const u=this.measureData.getVoice(this.location.voiceIdx).getNbNotes(),l=this.scoreData.getNbMeasures();return this.location.noteIdx<u-1?!0:this.location.measureIdx<l-1},o.hasVoice=function(){return this.measureData.hasVoice(this.location.voiceIdx)},o.moveForward=function(){const u=this.measureData.getVoice(this.location.voiceIdx).getNbNotes();this.location.noteIdx<u-1?this.location.noteIdx++:(this.location.noteIdx=0,this.location.measureIdx++,this.measureData=this.measureData.getNextMeasure());const l=this.scoreData.getNbMeasures();for(;this.location.measureIdx<l&&!this.measureData.hasVoice(this.location.voiceIdx);)this.location.noteIdx=0,this.location.measureIdx++,this.measureData.hasNextMeasure()&&(this.measureData=this.measureData.getNextMeasure())},o.getNote=function(){return this.measureData.getVoice(this.location.voiceIdx).getNote(this.location.noteIdx)};const r=i},109068:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(123491);function e(s){(s.artificialHarmonicTouchNotes||[]).forEach(f.default.removeFretData)}},109708:(O,A,t)=>{t.d(A,{A:()=>e});const f={};f.DEFAULT_DIRECTION="up",f.copy=function(s){const c=f.create();if(f.hasNumber(s)){const d=f.getNumber(s);f.setNumber(c,d)}if(f.hasDisplayedDirection(s)){const d=f.getDirection(s);f.setDisplayedDirection(c,d)}return c},f.create=function(){return{}},f.getNumber=function(s){return f.hasNumber(s)?parseInt(s.$number,10)-1:0},f.hasNumber=function(s){return typeof s.$number!="undefined"},f.setNumber=function(s,c){s.$number=(c+1).toString()},f.getDirection=function(s){return f.hasDisplayedDirection(s)?s.$direction:f.DEFAULT_DIRECTION},f.hasDisplayedDirection=function(s){return typeof s.$direction!="undefined"},f.setDisplayedDirection=function(s,c){s.$direction=c};const e=f},110094:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(210888),e=t(701387),s=t(721247);function c(i){const a=e.default.getNbStaves(i);for(let o=0;o<a;o++)e.default.getMiddleClefs(i,o).forEach(d)}function d(i){const a=f.default.generate();s.default.setClefUuid(i,a)}},111450:(O,A,t)=>{t.d(A,{A:()=>Y});var f=t(378432),e=t(343568),s=t(886766),c=t(476943),d=t(123491),i=t(351277),a=t(292681),o=t(701387),r=t(377180),n=t(345912),u=t(104907),l=t(414787),h=t(856219),I=t(595382),P=t(21738),T=t(131220),_=t(409200);const g=function(C,y){return new E(C,y).get()},E=function(C,y){this.init(C,y)},D=E.prototype;D.init=function(C,y){(0,P.default)(C,y),(0,T.default)(C,y),(0,_.default)(C,y),this.scoreData=C,this.location=y,this.pitch=null,this.unpitched=null,this.octaveShifts={},this.timePos=null},D.get=function(){this.noteData={isGrace:!0};const C={};e.A.call(C,this.scoreData,this.location),this.measureData=C.measureData,this.measureData.checkVoiceIdx(this.location.voiceIdx);const y=this.getVoice();return y.checkGraceIdx(this.location.noteIdx,this.location.graceIdx),y.isUnpitched(this.location.noteIdx)?this.extractUnpitchedInstrument():this.extractPitched(),this.fillNoteData(),this.noteData},D.getVoice=function(){return this.measureData.getVoice(this.location.voiceIdx)},D.extractUnpitchedInstrument=function(){let y=this.getVoice().getGraceChord(this.location.noteIdx,this.location.graceIdx);y=c.default.makeArray(y).slice(),this.baseNote=y[0],y.sort(M),this.noteData.noteheads=y.map(d.default.getHead),this.noteData.lines=y.map(this.extractUnpitchedLine,this),this.noteData.accidentals=y.map(p),this.noteData.isChord=y.length>1,this.getUnpitchedInstruments(y),this.extractDuration(),this.extractIsSlashed(),this.extractColors(y)};const M=function(C,y){const F=d.default.getUnpitched(C),N=d.default.getUnpitched(y);return a.default.compare(F,N)},p=function(){return null};D.extractUnpitchedLine=function(C){const y=d.default.getUnpitched(C),F=d.default.getStaffIdx(C),N=this.measureData.getStaffDetails(F),G=u.default.getNbStaffLines(N);return l.A.pitchToLine(y,G)},D.getUnpitchedInstruments=function(C){this.noteData.unpitched=C.map(function(y){const F=d.default.getInstrumentId(y),N=this.location.partIdx,G=this.scoreData.getMIDIInstrumentById(N,F),nt=h.default.getMIDIProgram(G),J=h.default.getUnpitched(G);return{MIDIProgram:nt,MIDIUnpitched:J}},this)},D.extractPitched=function(){let y=this.getVoice().getGraceChord(this.location.noteIdx,this.location.graceIdx);y=c.default.makeArray(y).slice(),this.baseNote=y[0],y.sort(m),this.noteData.isChord=y.length>1,this.extractStaffIndexes(y),this.getPitches(y),this.isTab(y)&&this.getTabsData(y),this.getLines(),this.extractAccidentals(y),this.extractColors(y),this.extractDuration(),this.extractIsSlashed(),this.shiftLinesIfNeeded()};const m=function(C,y){const F=d.default.getPitch(C),N=d.default.getPitch(y);return i.default.compareLine(F,N)};D.extractStaffIndexes=function(C){this.staffIndexes=C.map(d.default.getStaffIdx)},D.getPitches=function(C){let y=C.map(d.default.getPitch);const F={};y.forEach(v,F),this.noteData.canTryEnharmonicSwitch=y.map(x,{getter:this,pitchesSet:F}),y=y.map(this.transposePitchIfNeeded,this),this.noteData.pitches=y.map(U)};function v(C){C=i.default.copyWithoutAlter(C);const y=i.default.stringify(C),F=this;F[y]=!0}const U=function(C){return{step:i.default.getStep(C),octave:i.default.getOctave(C),alter:i.default.getAlter(C)}};D.transposePitchIfNeeded=function(C,y){if(!this.location.isConcertPitch)return C;const F=this.staffIndexes[y],N=this.getTranspose(F);return r.default.isIdentity(N)||(C=i.default.transpose(C,N,!0)),C},D.getTranspose=function(C){return this.measureData.getTranspose(C)};function x(C,y){const{getter:F,pitchesSet:N}=this,G=F.staffIndexes[y],nt=F.getKey(G);try{const J=I.A.switchEnharmonic(C,nt);if(i.default.isSamePitch(C,J))return!1;const V=i.default.stringify(i.default.copyWithoutAlter(J));return N[V]!==!0}catch(J){if(J instanceof f.A)return!1;throw J}}D.getKey=function(C){return this.measureData.getKey(C)},D.getLines=function(){this.noteData.lines=this.noteData.pitches.map(this.pitchToLine,this)},D.pitchToLine=function(C,y){const F=this.staffIndexes[y],N=this.getClef(F);return i.default.pitchToLine(C,N)},D.getClef=function(C){return this.measureData.getClef(C)},D.isTab=function(C){const y=C[0],F=d.default.getStaffIdx(y),N=this.measureData.getStaffDetails(F);return u.default.hasTab(N)},D.getTabsData=function(C){const y=C.map(S);this.noteData.tabsData=y};const S=function(C){return d.default.hasTabData(C)?d.default.getTabData(C):null};D.extractAccidentals=function(C){this.noteData.accidentals=C.map(this.extractAccidental,this)},D.extractColors=function(C){this.noteData.colors=C.map(K)};function K(C){return d.default.hasColor(C)?d.default.getColor(C):null}D.extractAccidental=function(C,y){if(d.default.hasAccidental(C)){let F=d.default.getPitch(C);F=this.transposePitchIfNeeded(F,y);const N=i.default.getAlter(F);return i.default.alterToAccidental(N)}else return null},D.shiftLinesIfNeeded=function(){typeof this.noteData.lines!="undefined"&&(this.noteData.lines=this.noteData.lines.map(this.shiftLineIfNeeded,this))},D.shiftLineIfNeeded=function(C,y){const F=this.staffIndexes[y],N=this.getOctaveShift(F);return N!==null&&(C=n.A.applyShiftToLine(N,C)),C},D.getOctaveShift=function(C){return typeof this.octaveShifts[C]=="undefined"&&this.initOctaveShift(C),this.octaveShifts[C]},D.initOctaveShift=function(C){const y=this.measureData.getMeasure(),F=H(y,C);if(F===null&&!o.default.hasOctaveShifts(y,C))this.octaveShifts[C]=null;else{const N=this.getTimePos(),G=o.default.getOctaveShifts(y,C),nt=(0,s.A)(F,G,N,!0);this.octaveShifts[C]=nt}},D.getTimePos=function(){if(this.timePos===null){const C=this.measureData.getVoice(this.location.voiceIdx);this.timePos=C.getRangeSpace(0,this.location.noteIdx)}return this.timePos};const H=function(C,y){return o.default.hasLeftOctaveShift(C,y)?o.default.getLeftOctaveShift(C,y):null};D.extractDuration=function(){this.noteData.durationType=d.default.getDurationType(this.baseNote)},D.extractIsSlashed=function(){d.default.isSlashedGrace(this.baseNote)&&(this.noteData.isSlashed=!0)},D.fillNoteData=function(){const C=this.scoreData.getNoteData(this.location);this.noteData.articulations=C.articulations,this.noteData.technical=C.technical,this.noteData.ornaments=C.ornaments,this.noteData.isRest=C.isRest,this.noteData.lyrics=C.lyrics,this.noteData.isTied=C.isTied||!1,this.noteData.hasGlissando=C.hasGlissando||!1,this.noteData.tupletType=C.tupletType,this.noteData.wedgeType=C.wedgeType,this.noteData.dynamicStyle=C.dynamicStyle,C.dynamicStyle!==null&&(this.noteData.dynamicIdx=C.dynamicIdx),typeof this.noteData.tempoChange!="undefined"&&(this.noteData.tempoChange=C.tempoChange),this.noteData.isInSlur=C.isInSlur,this.noteData.harmony=C.harmony,this.noteData.classicHarmony=C.classicHarmony,this.noteData.hasArpeggio=C.hasArpeggio||!1,this.noteData.nbGraces=C.nbGraces,this.noteData.possibleTuplets=C.possibleTuplets,this.noteData.possibleExpandedTuplets=C.possibleExpandedTuplets};const Y=g},114054:(O,A,t)=>{t.d(A,{A:()=>H});var f=t(701387),e=t(952818),s=t(717434),c=t(375950),d=t(735178),i=t(97324);const a=function(Y){return e.A.getEntries(Y).some(o)},o=function(Y){if(s.A.getType(Y)!==d.A.PLUCKED_RANGE)return!1;const y=s.A.getPluckedRange(Y),F=c.A.getType(y);return i.A.isValid(F)},r=a;var n=t(368495);const u=function(Y){const C=e.A.getStaffIdx(Y),y=e.A.getTimePos(Y),F=e.A.getPlacement(Y),N=l(Y);return n.A.create(C,F,y,N)},l=function(Y){const y=e.A.getEntries(Y).find(h),F=s.A.getPluckedRange(y);return c.A.getType(F)},h=function(Y){if(s.A.getType(Y)!==d.A.PLUCKED_RANGE)return!1;const y=s.A.getPluckedRange(Y),F=c.A.getType(y);return i.A.isValid(F)},I=u,P=function(Y){return M().extract(Y)},T=function(){this.pluckedRangesByStaff=null},_=T.prototype;_.extract=function(Y){this.reset(),Y.forEach(this.processDirection,this);const C=this.pluckedRangesByStaff;return this.pluckedRangesByStaff=null,C},_.reset=function(){this.pluckedRangesByStaff={}},_.processDirection=function(Y){if(r(Y)){const C=I(Y);this.addPluckedRange(C)}},_.addPluckedRange=function(Y){const C=e.A.getStaffIdx(Y),y=this.getStaffPluckedRanges(C),F=e.A.getTimePos(Y);g(y,F),y.push(Y)},_.getStaffPluckedRanges=function(Y){return typeof this.pluckedRangesByStaff[Y]=="undefined"&&(this.pluckedRangesByStaff[Y]=[]),this.pluckedRangesByStaff[Y]};const g=function(Y,C){E(Y,C)&&Y.pop()},E=function(Y,C){if(Y.length===0)return!1;{const y=Y.length-1,F=Y[y];return e.A.getTimePos(F)===C}};let D=null;const M=function(){return D===null&&(D=new T),D},p=P;var m=t(843678),v=t(726042);const U=function(Y,C){m.default.forEach(C,x,Y)};function x(Y,C){Y=v.default.intPart(Y);const y=this;f.default.setPluckedRanges(y,Y,C)}const S=U,H=function(Y){const C=f.default.getRawDirections(Y),y=p(C);S(Y,y)}},114521:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(353922),e=t(701387),s=t(123491),c=t(351277);function d(a){let o=e.default.getNotes(a),r=null;const n=[];o=o.filter(u=>{if(r&&(delete u.chord,n.push(r)),r=null,!s.default.hasPitch(u))return!0;const l=s.default.getPitch(u);try{return c.default.check(l),!0}catch(h){}return s.default.isChord(u)||s.default.isGraceNote(u)?!1:(s.default.isChord(u)||(r=u),i(u),!0)}),n.length>0&&(o=o.filter(u=>!n.includes(u))),e.default.setNotes(a,o)}function i(a){delete a.pitch,delete a.accidental,a.rest={},s.default.setGraceSlur(a,!1),s.default.makeUnbeamed(a),s.default.removeSlur(a),s.default.removeBeamStatus(a),s.default.removeAllArticulations(a),s.default.removeAllOrnaments(a),s.default.removeAllTechnicals(a,[]),s.default.removeTie(a),s.default.removeGlissandos(a),s.default.removeSlides(a),s.default.setHead(a,f.A.NORMAL)}},117157:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(701387),e=t(721247);function s(d){const i=f.default.getNbStaves(d);for(let a=0;a<i;a++){let o=f.default.getMiddleClefs(d,a);o.reverse();const r={};o=o.filter(c,r),o.reverse(),f.default.setMiddleClefs(d,a,o)}}function c(d){const i=this,a=e.default.getTimePos(d);return i[a]===!0?!1:(i[a]=!0,!0)}},118824:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(364842),e=t(857552),s=t(443749),c=t(883782),d=t(701387),i=t(446921),a=t(189247);const o=function(u,l,h){this.init(u,l,h)},r=o.prototype;r.init=function(u,l,h){this.utils=h,this.scoreData=u,this.location=l,this.measuresScroller=null,this.start=null},r.checkPreconditions=function(){this.checkLocation()},r.checkLocation=function(){this.scoreData.checkPartIdx(this.location.partIdx);const u=this.location.startMeasureIdx,l=this.location.stopMeasureIdx;if(this.scoreData.checkMeasureIdx(u),this.scoreData.checkMeasureIdx(l),u>l)throw new e.default(e.default.MEASURE,u,l);this.checkStaffIdx(),this.checkVoiceIdx()},r.checkStaffIdx=function(){const u=this.getMeasure(0),l=d.default.getNbStaves(u);if(this.location.staffIdx<0||this.location.staffIdx>=l)throw new s.default(this.location.staffIdx)},r.checkVoiceIdx=function(){if(!this.scoreData.hasPartVoiceIdx(this.location.partIdx,this.location.voiceIdx))throw new c.default(this.location.voiceIdx)},r.get=function(){if(this.entries=[],this.hasLeftContinue()){const h=this.searchLeftStart();this.addStart(h)}const u=this.location.startMeasureIdx,l=this.location.stopMeasureIdx;for(let h=u;h<=l;h++)this.measureIdx=h,this.utils.getEntities.call(this,h).forEach(this.processEntity,this);if(this.hasStart()){const h=this.searchRightStop();this.addStop(h)}return this.entries},r.processEntity=function(u){const l=this.measureIdx;if(this.utils.isEntityStart(u)){const h=this.createStart(u,l);this.addStart(h)}else if(this.utils.isEntityStop(u)){const h=this.createStop(u,l);this.addStop(h)}else throw new f.default("Unexpected")},r.hasLeftContinue=function(){return this.utils.hasLeftContinue.call(this)},r.searchLeftStart=function(){return this.utils.searchLeftStart.call(this)},r.createStart=function(u,l){return this.utils.createStart.call(this,u,l)},r.createStop=function(u,l){return this.utils.createStop.call(this,u,l)},r.addStart=function(u){if(this.hasStart())throw new f.default("Unexpected","There is already an entity started");this.start=u},r.hasRightContinue=function(){return this.utils.hasRightContinue.call(this)},r.searchRightStop=function(){return this.utils.searchRightStop.call(this)},r.getMeasure=function(u){return this.scoreData.getMeasure(this.location.partIdx,u)},r.addStop=function(u){if(!this.hasStart())throw new f.default("Unexpected","There is no entity started");this.closeEntity(this.start,u),this.start=null},r.hasStart=function(){return this.start!==null},r.closeEntity=function(u,l){const h=this.utils.createEntry.call(this,u,l);this.entries.push(h)},r.getVoice=function(u){const l=this.getMeasureData(u),h=this.getVoiceIdx(u);return l.getVoice(h)},r.getVoiceIdx=function(u){const l=this.getMeasureData(u);if(l.hasVoice(this.location.voiceIdx))return this.location.voiceIdx;{let h=this.scoreData.getPartStaffVoicesIndexes(this.location.partIdx,this.location.staffIdx);return h=h.filter(l.hasVoice,l),h[0]}},r.getMeasureData=function(u){return this.getMeasuresScroller().getMeasureData(u)},r.getMeasuresScroller=function(){if(this.measuresScroller===null){const u=this.location.partIdx,l=this.getMeasures();this.measuresScroller=new a.A(l,u,this.scoreData)}return this.measuresScroller},r.getMeasures=function(){const u=this.scoreData.getPartContent(this.location.partIdx);return i.A.getMeasures(u)};const n=o},119634:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(343568),e=t(852363);const s=function(i,a,o){this.init(i,a,o)};s.NAME="primitive.DeleteGraceNotePercu";const c=s.prototype;c.name=s.NAME,c.initMeasureData=f.A,c.init=function(i,a,o){this.initMeasureData(i,a),this.cancelStack=o,this.opts=a},c.perform=function(){this.getVoice().removeGrace(this.opts.noteIdx,this.opts.graceIdx),this.updateStack()},c.getVoice=function(){const i=this.opts.voiceIdx;return this.measureData.getVoice(i)},c.updateStack=function(){const i={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx},a={type:this.name,opts:i};this.cancelStack.push(a),(0,e.default)(this.cancelStack,this.measureData,this.opts)};const d=s},121061:(O,A,t)=>{t.d(A,{A:()=>C});var f=t(701387),e=t(952818),s=t(717434),c=t(857546),d=t(735178),i=t(1838);const a=function(y){return e.A.getEntries(y).some(o)},o=function(y){if(s.A.getType(y)!==d.A.DYNAMIC)return!1;const N=s.A.getDynamic(y);if(!c.A.hasStyle(N))return!1;const G=c.A.getStyle(N);return i.A.isValid(G)},r=a;var n=t(496819);const u=function(y){const F=e.A.getStaffIdx(y),N=e.A.getTimePos(y),G=e.A.getPlacement(y),nt=l(y),J=h(y),V=P(y);return n.A.create(F,G,N,nt,V,J)},l=function(y){const N=e.A.getEntries(y).find(I),G=s.A.getDynamic(N);return c.A.getStyle(G)},h=function(y){const N=e.A.getEntries(y).find(I),G=s.A.getDynamic(N),nt=c.A.getRelativePositionX(G),J=c.A.getRelativePositionY(G);return{x:nt,y:J}},I=function(y){if(s.A.getType(y)!==d.A.DYNAMIC)return!1;const N=s.A.getDynamic(y),G=c.A.getStyle(N);return i.A.isValid(G)},P=function(y){return e.A.hasSoundDynamic(y)?e.A.getSoundDynamic(y):null},T=u,_=function(y){return m().extract(y)},g=function(){this.dynamicsByStaff=null},E=g.prototype;E.extract=function(y){this.reset(),y.forEach(this.processDirection,this);const F=this.dynamicsByStaff;return this.dynamicsByStaff=null,F},E.reset=function(){this.dynamicsByStaff={}},E.processDirection=function(y){if(r(y)){const F=T(y);this.addDynamic(F)}},E.addDynamic=function(y){const F=e.A.getStaffIdx(y),N=this.getStaffDynamics(F),G=e.A.getTimePos(y);D(N,G),N.push(y)},E.getStaffDynamics=function(y){return typeof this.dynamicsByStaff[y]=="undefined"&&(this.dynamicsByStaff[y]=[]),this.dynamicsByStaff[y]};const D=function(y,F){M(y,F)&&y.pop()},M=function(y,F){if(y.length===0)return!1;{const N=y.length-1,G=y[N];return e.A.getTimePos(G)===F}};let p=null;const m=function(){return p===null&&(p=new g),p},v=_;var U=t(843678),x=t(726042);const S=function(y,F){U.default.forEach(F,K,y)},K=function(y,F){y=x.default.intPart(y);const N=this;f.default.setDynamics(N,y,F)},H=S,C=function(y){const F=f.default.getRawDirections(y),N=v(F);H(y,N)}},122169:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(701387),e=t(555172);function s(d){f.default.getBarlines(d).forEach(c)}const c=function(d){const i=e.A.getStyle(d);e.A.isSupportedStyle(i)||e.A.setStyle(d,e.A.DEFAULT_STYLE)}},125911:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(123491);const s=function(c,d,i){let a=0;const o=c.size();for(let r=0;r<o-1&&a<i;r++){const n=c.getNote(r),u=f.default.getDuration(n);a+=u*d}return a===i}},126597:(O,A,t)=>{t.d(A,{A:()=>_});var f=t(364842),e=t(955154),s=t(351277),c=t(860716),d=t(701387),i=t(123491),a=t(446921),o=t(104907),r=t(377180),n=t(627300),u=t(297805);const l=r.default.createComplete(0,0,1),h=r.default.createComplete(7,4,1),I=r.default.createComplete(0,0,2),P=r.default.createComplete(4,2,2),T=new Map([[12,l],[7,h],[19,h],[5,I],[17,I],[4,P],[4,P],[9,P],[16,P]]);function _(m){const v=a.A.getFirstMeasure(m);if(!(0,u.A)(v))return;const U=a.A.getMeasures(m),x=new g;x.indexMeasures(U),x.matchVoices(),x.processPairs()}class g{constructor(){this.topMap=new Map,this.bottomMap=new Map,this.pairs=[],this.firstMeasure=null,this.octaveShift=null,this.staffDetails=null}indexMeasures(v){this.firstMeasure=v[0],v.forEach(this.indexMeasure,this)}indexMeasure(v,U){this.measureIdx=U;let x=d.default.getNotes(v);x=x.filter(E),x.forEach(this.indexNote,this)}indexNote(v){const U=i.default.getStaffIdx(v),x=this.getMap(U),S=i.default.getVoiceIdx(v),K=D(x,S),H=i.default.getTimePos(v),Y=i.default.getDurationType(v),C={measureIdx:this.measureIdx,timePos:H,note:v,durationType:Y};K.push(C)}getMap(v){if(v===0)return this.topMap;if(v===1)return this.bottomMap;throw new f.default(`Invalid staffIdx: ${v}`)}matchVoices(){this.topMap.forEach(this.matchTopVoice,this)}matchTopVoice(v){const U=[...this.bottomMap.values()];U.some((x,S)=>{if(M(v,x)){const K={top:v,bottom:x};return this.pairs.push(K),U.splice(S,1),!0}})}processPairs(){this.pairs.forEach(this.processPairEntries,this)}processPairEntries({top:v,bottom:U}){v.forEach((x,S)=>{const K=U[S];this.processPair(x,K)})}processPair(v,U){const x=i.default.getPitch(U.note),S=i.default.getFretData(U.note),K=this.getBasePitch(S.string);if(p(x,K)!==S.fret||!T.has(S.fret))return;const Y=T.get(S.fret),C=s.default.transpose(K,Y),y=this.getOctaveDiff();{const G=s.default.getOctave(C);s.default.setOctave(C,G-y)}const F=i.default.getPitch(v.note);if(!s.default.isSamePitch(F,C))return;const N=s.default.copy(x);{const G=s.default.getOctave(N);s.default.setOctave(N,G-y)}i.default.setPitch(v.note,N)}getBasePitch(v){if(this.staffDetails===null){const x=d.default.getWrappedOwnStaffDetailsOrDefault(this.firstMeasure);this.staffDetails=x.getEntry(1)}let U=o.default.getShiftedTuningByString(this.staffDetails,v);return U=n.default.toPitch(U),U}getOctaveDiff(){if(this.octaveShift===null){const v=d.default.getWrappedOwnTransposeOrDefault(this.firstMeasure),U=v.getEntry(0),x=r.default.getOctaveChange(U),S=v.getEntry(1),K=r.default.getOctaveChange(S);this.octaveShift=x-K}return this.octaveShift}}function E(m){if(!i.default.hasHarmonic(m))return!1;const v=i.default.getHarmonic(m);return c.default.getType(v)===e.default.NATURAL_TOUCHING}function D(m,v){return m.has(v)||m.set(v,[]),m.get(v)}function M(m,v){return m.length!==v.length?!1:m.every((U,x)=>{const S=v[x];return!(U.measureIdx!==S.measureIdx||U.timePos!==S.timePos||U.durationType!==S.durationType)})}function p(m,v){const U=s.default.getTransposeDiff(m,v),x=r.default.getOctaveChange(U),S=r.default.getChromatic(U);return x*r.default.NB_CHROMATIC+S}},132308:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(156902),e=t(701387),s=t(952818);function c(i,a){const o=e.default.getAllDirections(i),r=e.default.getExportMapping(i,a);o.forEach(d,r),e.default.setDirections(i,o)}function d(i){const a=this,o=s.A.getTimePos(i),r=s.A.getStaffIdx(i),n=(0,f.A)(a[r],o);s.A.setNoteBefore(i,n.noteBefore),s.A.setOffset(i,n.offset),s.A.setIsFirst(i,n.isFirst)}},136088:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(701387);function e(s,c,d){f.default.hasRestsInsideBeams(s)&&d.setRestsInsideBeams(c,!0)}},143200:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(607682);const e=function(){return"cannot have a duration frame lower than a sixty fourth"};class s extends f.default{constructor(){const d=e();super(d),this.name="DurationTooSmallError"}}},145638:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(607682);const e=function(){return"There is no pedal at this location."};class s extends f.default{constructor(){const d=e();super(d),this.name="NoPedalError"}}},147716:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(702544),e=t(153271),s=t(782540),c=t(21738),d=t(131220),i=t(409200),a=t(832560);const r=function(n,u){(0,c.default)(n,u),(0,d.default)(n,u),(0,i.default)(n,u);const l=u.partIdx,h=n.getNbParts();if(l<0||l>=h)throw new f.default(l,f.default.GET);const I=n.getNbMeasures(),P=u.measureIdx;if(P<0||P>=I)throw new e.default(P,e.default.GET);const T=n.getMeasure(l,P),_=new a.A(T);_.checkVoiceIdx(u.voiceIdx);const g=_.getVoice(u.voiceIdx);return u.startNoteIdx=g.getStartNoteIdx(),u.stopNoteIdx=g.getStopNoteIdx(),(0,s.A)(n,u,_)}},149622:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387);const e=function(i){let a=1;i.hasMeasureNumberingStart()&&(a=i.getMeasureNumberingStart()),i.forEachPart(s,a)},s=function(i){const a=this.valueOf();i.measure.forEach(c,a)},c=function(i,a){const o=this.valueOf();f.default.setNumber(i,a+o)},d=e},150042:(O,A,t)=>{t.d(A,{A:()=>Y});const e=function(C,y){if(C.hasWorkTitle()){const F=C.getWorkTitle();y.title=F}else if(C.hasMovementTitle()){const F=C.getMovementTitle();y.title=F}};var s=t(433401);const d=function(C,y){s.A.hasTitle(C)?y.title=s.A.getTitle(C):s.A.hasFallbackTitle(C)&&(y.title=s.A.getFallbackTitle(C))},a=function(C,y){s.A.hasSubtitle(C)&&(y.subtitle=s.A.getSubtitle(C))};var o=t(365340);const r=function(C,y){if(s.A.hasRights(C)){let F=s.A.getRights(C);F=o.default.splitStringsByEol(F),F=F.map(n),F=F.filter(u),F.length>0&&(y.rights=F)}};function n(C){return C.trim()}function u(C){return!!C}const l=r,I=function(C,y){s.A.hasComposer(C)&&(y.composer=s.A.getComposer(C)),s.A.hasLyricist(C)&&(y.lyricist=s.A.getLyricist(C)),s.A.hasArranger(C)&&(y.arranger=s.A.getArranger(C))};var P=t(921492);const T=function(C,y){if(P.A.hasRights(C)){let F=P.A.getRightsEntries(C);F=o.default.splitStringsByEol(F),F=F.map(_),F=F.filter(g),F.length>0&&(y.rights=F)}};function _(C){return C.trim()}function g(C){return!!C}const E=T,M=function(C,y){P.A.hasComposer(C)&&(y.composer=P.A.getComposerStr(C)),P.A.hasLyricist(C)&&(y.lyricist=P.A.getLyricistStr(C)),P.A.hasArranger(C)&&(y.arranger=P.A.getArrangerStr(C))},m=function(C){const y={};e(C,y);const F=C.getCredits();d(F,y),a(F,y),l(F,y),I(F,y);const N=C.getIdentification();return E(N,y),M(N,y),y};var v=t(309682);const x=function(C){const y=[];if(typeof C.title!="undefined"){const F=v.A.createTitle(C.title);y.push(F)}if(typeof C.subtitle!="undefined"){const F=v.A.createSubtitle(C.subtitle);y.push(F)}return y},K=function(C,y){C.removeMovementTitle(),C.cleanCredits();const F=x(y);C.setCredits(F),typeof y.rights!="undefined"&&C.setRightsEntries(y.rights),typeof y.lyricist!="undefined"&&C.setLyricistStr(y.lyricist),typeof y.composer!="undefined"&&C.setComposerStr(y.composer),typeof y.arranger!="undefined"&&C.setArrangerStr(y.arranger)},Y=function(C){const y=m(C);K(C,y)}},155157:(O,A,t)=>{t.d(A,{A:()=>I});var f=t(443749),e=t(607682);class s extends e.default{constructor(E){const D=`The mute uuid "${E} is invalid."`;super(D),Object.defineProperty(this,"muteUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadMuteUuidError",this.muteUuid=E}}var c=t(883782),d=t(447819),i=t(701387),a=t(726042),o=t(21738),r=t(131220),n=t(665280),u=t(409200),l=t(507004),h=t(189247);function I(g,E){if((0,o.default)(g,E),(0,r.default)(g,E),(0,u.default)(g,E),(0,n.default)(g,E),g.checkPartIdx(E.partIdx),g.checkMeasureIdx(E.measureIdx),!g.hasPartVoiceIdx(E.partIdx,E.voiceIdx))throw new c.default(E.voiceIdx);const D=g.getMeasure(E.partIdx,E.measureIdx),M=E.staffIdx,p=i.default.getNbStaves(D);if(!a.default.isInteger(M)||M<0||M>=p)throw new f.default(M);const v=i.default.getMutes(D,E.staffIdx).find(P,E);if(!v)throw new s(E.muteUuid);const U=d.A.getType(v),x=i.default.getDpq(D),S=d.A.getTimePos(v),K=d.A.getPlacement(v),H={partIdx:E.partIdx,staffIdx:M,measureIdx:E.measureIdx,dpq:x,timePos:S,type:U,placement:K},Y=T(g,E,H);return Object.assign(H,Y),_(H,g),H}function P(g){return d.A.getUuid(g)===this.muteUuid}function T(g,E,D){const M={searchedVoiceIdx:E.voiceIdx,staffVoicesIndexes:g.getPartStaffVoicesIndexes(E.partIdx,E.staffIdx),measureIdx:E.measureIdx,timePos:D.timePos,dpq:D.dpq},p=g.getPartMeasures(E.partIdx),m=new h.A(p,E.partIdx,g);return(0,l.A)(m,M)}function _(g,E){g.measureUuid=E.getMeasureUuid(g.measureIdx),g.voiceUuid=E.getPartVoiceUuid(g.partIdx,g.voiceIdx),g.partUuid=E.getPartUuid(g.partIdx),g.staffUuid=E.getPartStaffUuid(g.partIdx,g.staffIdx)}},156902:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(248670);function e(c,d){let i,a=0,o=!1;if(typeof c.indexedRefs[d]!="undefined")i=c.indexedRefs[d],d===0&&(o=!0);else{let r={timePos:d};const n=f.A.searchFirstInsertionIdx(c.orderedRefs,r,s);r=c.orderedRefs[n-1],i=r.noteBefore,a=d-r.timePos,r.timePos===0&&(o=!0)}return{noteBefore:i,offset:a,isFirst:o}}function s(c,d){return c.timePos-d.timePos}},157158:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(737903),e=t(726042),s=t(515819),c=t(343568),d=t(733982);const i=function(r,n,u){this.init(r,n,u)};i.NAME="composite.AdaptDpqToDuration";const a=i.prototype;a.initMeasureData=c.A,a.name=i.NAME,a.init=function(r,n,u){this.initMeasureData(r,n),this.cancelStack=u,this.opts=n},a.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name);const r=s.default.durationOptsToDivisions(this.opts,this.opts.timeModif),n=this.measureData.getDivisions().getDivisions(),u=e.default.lcm(n,r);if(u>n){const l=u/n;this.increaseDivisions(l)}},a.increaseDivisions=function(r){const n=(0,f.default)(this.opts);n.coeff=r,new d.A(this.measureData,n,this.cancelStack).perform()};const o=i},161733:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(476943),e=t(351277),s=t(123491);const c=function(a,o,r,n){let u=a.getGraceChord(o,r);return u=f.default.makeArray(u),u.find(d,n)},d=function(a){const o=this,r=s.default.getPitch(a);return e.default.isSameLine(r,o)},i=c},162621:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(364842),e=t(868743),s=t(584416);const c=function(n,u,l){u=u.sort(d);const h=new a(n,u,l);return h.search(),h.getPedal()},d=function(n,u){const l=s.A.getTimePos(n),h=s.A.getTimePos(u),I=l-h;if(I!==0)return I;const P=s.A.getType(n),T=s.A.getType(u);return i(P,T)},i=function(n,u){return n===e.A.START&&u===e.A.STOP?1:n===e.A.STOP&&u===e.A.START?-1:0},a=function(n,u,l){this.init(n,u,l)},o=a.prototype;o.init=function(n,u,l){this.currentPedal=n,this.pedals=u,this.searchedTimePosition=l},o.search=function(){this.pedals.some(this.analyzePedal,this)},o.analyzePedal=function(n){const u=s.A.getTimePos(n);if(u>this.searchedTimePosition)return!0;const l=s.A.getType(n);return l===e.A.START&&this.startPedal(n),l===e.A.STOP&&(this.stopPedal(),u===this.searchedTimePosition)?!1:u===this.searchedTimePosition},o.startPedal=function(n){if(this.currentPedal!==null)throw new f.default("Unexpected","There is already a pedal");this.currentPedal=n},o.stopPedal=function(){if(this.currentPedal===null){const n="There is no pedal to stop.";throw new f.default("Unexpected",n)}else this.currentPedal=null},o.getPedal=function(){return this.currentPedal};const r=c},162977:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(){super("There is no tempo change at this location."),this.name="NoTempoChangeError"}}},165559:(O,A,t)=>{t.d(A,{A:()=>l});var f=t(383279),e=t(856219),s=t(446921),c=t(701387),d=t(377180);const i={9:{name:"pitched-percussion.celesta",chromatic:0,diatonic:0,octaveChange:1},10:{name:"pitched-percussion.glockenspiel",chromatic:0,diatonic:0,octaveChange:2},14:{name:"pitched-percussion.xylophone",chromatic:0,diatonic:0,octaveChange:1},57:{name:"brass.trumpet",chromatic:-2,diatonic:-1,octaveChange:0},61:{name:"brass.horn",chromatic:-7,diatonic:-4,octaveChange:0},65:{name:"woodwinds.soprano-saxophone",chromatic:-2,diatonic:-1,octaveChange:0},66:{name:"woodwinds.alto-saxophone",chromatic:-9,diatonic:-5,octaveChange:0},67:{name:"woodwinds.tenor-saxophone",chromatic:-2,diatonic:-1,octaveChange:-1},68:{name:"woodwinds.baritone-saxophone",chromatic:-9,diatonic:-5,octaveChange:-1},70:{name:"woodwinds.brass.english-horn",chromatic:-7,diatonic:-4,octaveChange:0},72:{name:"woodwinds.clarinet",chromatic:-2,diatonic:-1,octaveChange:0},110:{name:"woodwinds.bagpipe",chromatic:-2,diatonic:-1,octaveChange:0},269:{name:"brass.baritone-horn-treble",chromatic:-2,diatonic:-1,octaveChange:-1},272:{name:"woodwinds.bass-clarinet",chromatic:-2,diatonic:-1,octaveChange:-1},274:{name:"woodwinds.alto-flute",chromatic:-5,diatonic:-3,octaveChange:0}},a=function(h,I){if(f.default.getNbInstruments(h)>1||f.default.hasUnpitched(h))return;const T=f.default.getMIDIInstruments(h)[0];if(!e.default.hasMIDIProgram(T))return;const _=e.default.getMIDIProgram(T);if(typeof i[_]=="undefined")return;const g=i[_];o(I,g)},o=function(h,I){const P=s.A.getFirstMeasure(h),T=c.default.getNbStaves(P),_=c.default.getWrappedTranspose(P);for(let E=0;E<T;E++){const D=_.getEntry(E),M=d.default.getChromatic(D),p=d.default.getOctaveChange(D);M===I.chromatic&&p===I.octaveChange&&d.default.setDiatonic(D,I.diatonic)}const g=_.dumpAttribute();c.default.setTranspose(P,g)},r=a,n=function(h,I){h.forEach(u,I)},u=function(h,I){const T=this[I];r(h,T)},l=n},166326:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(911066),e=t(273885);const s=34,c="$adagio-displayMode";function d(i,a){a>=s||(e.A.isDisplayModeEnabled(i,f.A.FIXED_DO)||e.A.isDisplayModeEnabled(i,f.A.NOTE_SHAPES)&&e.A.setDisplayMode(i,f.A.MOVABLE_DO,!0),i[c]&&delete i[c][f.A.FIXED_DO])}},169823:(O,A,t)=>{t.d(A,{A:()=>E});var f=t(273885),e=t(868224),s=t(615898),c=t(291539),d=t(22260),i=t(475672);function a(m){m=m.toLowerCase();const U=i.A.values.find(o,m);return U||i.A.DEFAULT}function o(m){const v=this.valueOf();return m=m.toLowerCase(),v.includes(m)}var r=t(914390),n=t(398738);function u(m){if(f.A.hasMusicFont(m)){let v=f.A.getMusicFont(m);v=a(v),f.A.setMusicFont(m,v)}if(f.A.hasFontEntry(m,n.default.LYRICS)){let v=f.A.getFontEntry(m,n.default.LYRICS);v=r.default.normalize(v),f.A.setFontEntry(m,n.default.LYRICS,v)}if(f.A.hasFontEntry(m,n.default.GLOBAL)){let v=f.A.getFontEntry(m,n.default.GLOBAL);v=r.default.normalize(v),f.A.setFontEntry(m,n.default.GLOBAL,v)}}const l=7,h=40,I=12.7,P=279.4,T=215.9,_=20.16,g=12.7;function E(m){f.A.hasScaling(m)||f.A.setScaling(m,l,h),D(m),M(m),p(m),u(m)}function D(m){const v=f.A.getOrCreatePageLayout(m);if(!e.A.hasPageHeight(v)){const U=f.A.scaleToTenths(m,P);e.A.setPageHeight(v,U)}if(!e.A.hasPageWidth(v)){const U=f.A.scaleToTenths(m,T);e.A.setPageWidth(v,U)}if(!e.A.hasMargins(v)){const U=f.A.scaleToTenths(m,I);e.A.setTopMargin(v,U,s.A.TYPE_BOTH),e.A.setBottomMargin(v,U,s.A.TYPE_BOTH),e.A.setLeftMargin(v,U,s.A.TYPE_BOTH),e.A.setRightMargin(v,U,s.A.TYPE_BOTH)}}function M(m){const v=f.A.getSystemLayout(m);if(!d.A.hasDistance(v)){const U=f.A.scaleToTenths(m,_);d.A.setDistance(v,U)}f.A.setSystemLayout(m,v)}function p(m){const v=f.A.getStaffLayout(m);if(!c.A.hasDistance(v)){const U=f.A.scaleToTenths(m,g);c.A.setDistance(v,U)}f.A.setStaffLayout(m,v)}},173171:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(210888),e=t(701387),s=t(536949);function c(i){const a=e.default.getNbStaves(i);for(let o=0;o<a;o++)e.default.getPizzicatos(i,o).forEach(d)}function d(i){const a=f.default.generate();s.A.setPizzicatoUuid(i,a)}},173739:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(364842),e=t(97324),s=t(701387),c=t(368495);const d=function(n,u,l,h){const I=new i(n,u,l,h);return I.search(),I.getResult()},i=function(n,u,l,h){this.init(n,u,l,h)},a=i.prototype;a.init=function(n,u,l,h){this.measures=n,this.entryMeasureIdx=u,this.entryTimePos=h,this.entryStaffIdx=l,this.candidateMeasureIdx=null,this.directionsByMeasures={},this.startTimePos=null,this.startMeasureIdx=null,this.stopTimePos=null,this.stopMeasureIdx=null,this.placement=null},a.search=function(){this.searchStart(),this.isStartAtEntry()&&this.shiftEntryTimePos(),this.searchStop()},a.searchStart=function(){for(this.candidateMeasureIdx=this.entryMeasureIdx;this.candidateMeasureIdx>=0&&!this.hasFoundStart();this.candidateMeasureIdx--)this.searchStartMeasure();if(!this.hasFoundStart()){const n="We were not able to find the octave shift left side.";throw new f.default("PluckedRangeStartNotFound",n)}},a.searchStartMeasure=function(){let n=this.getPluckedRangeDirectionsAtCandidateMeasure();this.isEntryMeasure()&&(n=this.filterLowerOrEqual(n)),this.searchStartTimePos(n)},a.filterLowerOrEqual=function(n){const u=[],l=n.length;for(let h=0;h<l;h++){const I=n[h];if(c.A.getTimePos(I)>this.entryTimePos)return u;u.push(I)}return u},a.searchStartTimePos=function(n){const u=n.length;for(let l=u-1;l>=0&&!this.hasFoundStart();l--){const h=n[l],I=c.A.getType(h);e.A.isStart(I)&&this.startFound(h,h)}},a.hasFoundStart=function(){return this.startMeasureIdx!==null},a.startFound=function(n){const u=c.A.getTimePos(n);this.startTimePos=u,this.startMeasureIdx=this.candidateMeasureIdx,this.placement=c.A.getPlacement(n),this.type=c.A.getType(n)},a.isStartAtEntry=function(){return this.startMeasureIdx===this.entryMeasureIdx&&this.startTimePos===this.entryTimePos},a.shiftEntryTimePos=function(){this.entryTimePos++},a.searchStop=function(){const n=this.measures.length;for(this.candidateMeasureIdx=this.entryMeasureIdx;this.candidateMeasureIdx<n&&!this.hasFoundStop();this.candidateMeasureIdx++)this.searchStopMeasure();if(!this.hasFoundStop()){const u="We were not able to find the octave shift right side.";throw new f.default("PluckedRangeStopNotFound",u)}},a.searchStopMeasure=function(){let n=this.getPluckedRangeDirectionsAtCandidateMeasure();this.isEntryMeasure()&&(n=this.filterGreaterOrEqual(n)),this.searchStopTimePos(n)},a.getPluckedRangeDirectionsAtCandidateMeasure=function(){if(typeof this.directionsByMeasures[this.candidateMeasureIdx]=="undefined"){const n=this.measures[this.candidateMeasureIdx],u=s.default.getPluckedRanges(n,this.entryStaffIdx);u.sort(o),this.directionsByMeasures[this.candidateMeasureIdx]=u}return this.directionsByMeasures[this.candidateMeasureIdx]};const o=function(n,u){const l=c.A.getTimePos(n),h=c.A.getTimePos(u);return l-h};a.isEntryMeasure=function(){return this.candidateMeasureIdx===this.entryMeasureIdx},a.filterGreaterOrEqual=function(n){const u=[],l=n.length;for(let h=l-1;h>=0;h--){const I=n[h];if(c.A.getTimePos(I)<this.entryTimePos)return u;u.unshift(I)}return u},a.searchStopTimePos=function(n){const u=n.length;for(let l=0;l<u&&!this.hasFoundStop();l++){const h=n[l],I=c.A.getType(h);e.A.isStop(I)&&this.stopFound(h)}},a.hasFoundStop=function(){return this.stopMeasureIdx!==null},a.stopFound=function(n){const u=c.A.getTimePos(n);this.stopTimePos=u,this.stopMeasureIdx=this.candidateMeasureIdx},a.getResult=function(){return{startMeasureIdx:this.startMeasureIdx,startTimePos:this.startTimePos,stopMeasureIdx:this.stopMeasureIdx,stopTimePos:this.stopTimePos,placement:this.placement,type:this.type}};const r=d},174621:(O,A,t)=>{t.d(A,{A:()=>I});var f=t(443749),e=t(607682);class s extends e.default{constructor(E){const D=`The word uuid "${E} is invalid."`;super(D),Object.defineProperty(this,"wordUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadWordUuidError",this.wordUuid=E}}var c=t(883782),d=t(788220),i=t(701387),a=t(726042),o=t(21738),r=t(131220),n=t(665280),u=t(409200),l=t(507004),h=t(189247);function I(g,E){if((0,o.default)(g,E),(0,r.default)(g,E),(0,u.default)(g,E),(0,n.default)(g,E),g.checkPartIdx(E.partIdx),g.checkMeasureIdx(E.measureIdx),typeof E.voiceIdx!="undefined"&&!g.hasPartVoiceIdx(E.partIdx,E.voiceIdx))throw new c.default(E.voiceIdx);const D=g.getMeasure(E.partIdx,E.measureIdx),M=E.staffIdx,p=i.default.getNbStaves(D);if(!a.default.isInteger(M)||M<0||M>=p)throw new f.default(M);const v=i.default.getWords(D,E.staffIdx).find(P,E);if(!v)throw new s(E.wordUuid);const U=d.A.getText(v),x=i.default.getDpq(D),S=d.A.getTimePos(v),K=d.A.getPlacement(v),H={partIdx:E.partIdx,staffIdx:M,measureIdx:E.measureIdx,dpq:x,timePos:S,text:U,placement:K};if(typeof E.voiceIdx!="undefined"){const Y=T(g,E,H);Object.assign(H,Y)}return _(H,g),H}function P(g){return d.A.getWordUuid(g)===this.wordUuid}function T(g,E,D){const M={searchedVoiceIdx:E.voiceIdx,staffVoicesIndexes:g.getPartStaffVoicesIndexes(E.partIdx,E.staffIdx),measureIdx:E.measureIdx,timePos:D.timePos,dpq:D.dpq},p=g.getPartMeasures(E.partIdx),m=new h.A(p,E.partIdx,g);return(0,l.A)(m,M)}function _(g,E){g.measureUuid=E.getMeasureUuid(g.measureIdx),typeof g.voiceIdx!="undefined"&&(g.voiceUuid=E.getPartVoiceUuid(g.partIdx,g.voiceIdx)),g.partUuid=E.getPartUuid(g.partIdx),g.staffUuid=E.getPartStaffUuid(g.partIdx,g.staffIdx)}},178295:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(952818);const s=function(c){return f.A.hasSound(c)?!1:f.A.hasValidWord(c)}},180289:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(364842),e=t(909748),s=t(346797),c=t(515819);const d=function(r,n,u,l){if(typeof l=="undefined")throw new Error("DPQ missing");const h=new i(r,n,u,l);return h.search(),h.getResult()},i=function(r,n,u,l){this.init(r,n,u,l)},a=i.prototype;a.init=function(r,n,u,l){this.commonContent=r,this.entryMeasureIdx=n,this.entryQuarterPos=c.default.divisionsToQuarter(u,l),this.candidateMeasureIdx=null,this.tempoChangesByMeasures={},this.startTimePos=null,this.startDpq=null,this.startMeasureIdx=null,this.stopTimePos=null,this.stopDpq=null,this.stopMeasureIdx=null,this.type=null},a.search=function(){this.searchStart(),this.searchStop()},a.searchStart=function(){for(this.candidateMeasureIdx=this.entryMeasureIdx;this.candidateMeasureIdx>=0&&!this.hasFoundStart();this.candidateMeasureIdx--)this.searchStartMeasure();if(!this.hasFoundStart()){const r="We were not able to find the tempo change left side.";throw new f.default("TempoChangeStartNotFound",r)}},a.searchStartMeasure=function(){let r=this.getTempoChangeDirectionsAtCandidateMeasure();this.isEntryMeasure()&&(r=this.filterLowerOrEqual(r)),this.searchStartTimePos(r)},a.filterLowerOrEqual=function(r){const n=[],u=r.length;for(let l=0;l<u;l++){const h=r[l];if(s.A.getQuarterPos(h)>this.entryQuarterPos)return n;n.push(h)}return n},a.searchStartTimePos=function(r){const n=r.length;for(let u=n-1;u>=0&&!this.hasFoundStart();u--){const l=r[u],h=s.A.getType(l);e.A.isStart(h)&&this.startFound(l,l)}},a.hasFoundStart=function(){return this.startMeasureIdx!==null},a.startFound=function(r){this.startTimePos=s.A.getTimePos(r),this.startDpq=s.A.getDpq(r),this.startMeasureIdx=this.candidateMeasureIdx,this.type=s.A.getType(r)},a.searchStop=function(){const r=this.commonContent.getNbMeasures();for(this.candidateMeasureIdx=this.entryMeasureIdx;this.candidateMeasureIdx<r&&!this.hasFoundStop();this.candidateMeasureIdx++)this.searchStopMeasure();if(!this.hasFoundStop()){const n="We were not able to find the tempo change right side.";throw new f.default("TempoChangeStopNotFound",n)}},a.searchStopMeasure=function(){let r=this.getTempoChangeDirectionsAtCandidateMeasure();this.isEntryMeasure()&&(r=this.filterGreaterOrEqual(r),this.isStartAtEntry()&&(r=this.filterDifferent(r))),this.searchStopTimePos(r)},a.getTempoChangeDirectionsAtCandidateMeasure=function(){if(typeof this.tempoChangesByMeasures[this.candidateMeasureIdx]=="undefined"){const r=this.commonContent.getTempoChanges(this.candidateMeasureIdx);r.sort(s.A.compare),this.tempoChangesByMeasures[this.candidateMeasureIdx]=r}return this.tempoChangesByMeasures[this.candidateMeasureIdx]},a.isEntryMeasure=function(){return this.candidateMeasureIdx===this.entryMeasureIdx},a.filterGreaterOrEqual=function(r){const n=[],u=r.length;for(let l=u-1;l>=0;l--){const h=r[l];if(s.A.getQuarterPos(h)<this.entryQuarterPos)return n;n.unshift(h)}return n},a.isStartAtEntry=function(){return c.default.divisionsToQuarter(this.startTimePos,this.startDpq)===this.entryQuarterPos&&this.startMeasureIdx===this.entryMeasureIdx},a.filterDifferent=function(r){return r=r.filter(this.isDifferent,this),r},a.isDifferent=function(r){return s.A.getQuarterPos(r)!==this.entryQuarterPos||this.candidateMeasureIdx!==this.startMeasureIdx},a.searchStopTimePos=function(r){const n=r.length;for(let u=0;u<n&&!this.hasFoundStop();u++){const l=r[u];s.A.getType(l)===e.A.STOP&&this.stopFound(l)}},a.hasFoundStop=function(){return this.stopMeasureIdx!==null},a.stopFound=function(r){this.stopTimePos=s.A.getTimePos(r),this.stopDpq=s.A.getDpq(r),this.stopMeasureIdx=this.candidateMeasureIdx},a.getResult=function(){return{startMeasureIdx:this.startMeasureIdx,startTimePos:this.startTimePos,startDpq:this.startDpq,stopMeasureIdx:this.stopMeasureIdx,stopTimePos:this.stopTimePos,stopDpq:this.stopDpq,type:this.type}};const o=d},181902:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(446921),e=t(701387),s=t(35802),c=t(123491);function d(r){const n={dpq:1};f.A.getMeasures(r).forEach(i,n)}function i(r){const n=this;n.timePos=0,n.previousTimePos=0,e.default.getAllRawAttributes(r).forEach(a,n),e.default.getNotes(r).forEach(o,n)}function a(r){const n=this;s.default.hasDivisions(r)&&(n.dpq=s.default.getDpq(r))}function o(r){const n=this,u=c.default.getBackupDuration(r),l=c.default.getForwardDuration(r);if(n.timePos+=l,n.timePos-=u,c.default.setDpq(r,n.dpq),c.default.isChord(r))c.default.setTimePos(r,n.previousTimePos);else if(c.default.setTimePos(r,n.timePos),n.previousTimePos=n.timePos,c.default.hasDuration(r)){const h=c.default.getDuration(r);n.timePos+=h}}},183957:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(669038),e=t(383279);const c=function(d,i){let a=-1;for(let o=0;o<d.length;o++)if(e.default.getUuid(d[o])===i){a=o;break}if(a<0)throw new f.A(i,f.A.GET);return a}},184469:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(381216),e=t(843678),s=t(74957),c=t(865349);function d(o,r){const n=e.default.fromList(o,s.A.getValue),u=e.default.fromList(r,s.A.getValue),l=[];return Array.from(Object.keys(n)).forEach(h=>{u[h]||(h=parseInt(h,10),l.push(s.A.create(h,f.A.SUBTRACT,0)),delete n[h])}),Array.from(Object.keys(u)).forEach(h=>{if(!n[h]){h=parseInt(h,10);const I=s.A.getAlter(u[h]);l.push(s.A.create(h,f.A.ADD,I)),delete u[h]}}),Array.from(Object.keys(n)).forEach(h=>{const I=s.A.getAlter(n[h]),P=s.A.getAlter(u[h]);if(I!==P){h=parseInt(h,10);const T=P-I;l.push(s.A.create(h,f.A.ALTER,T))}}),l.sort(i),l}function i(o,r){return o=s.A.getValue(o),r=s.A.getValue(r),o-r}function a(o,r){const n=(0,c.A)(o);return d(n,r)}},185381:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(210888),e=t(601770),s=t(446921),c=t(701387),d=t(123491),i=t(712947),a=t(726042);function o(u,l){const h={partContent:u,measuresHeaders:l,slurUuidByVoice:{}};s.A.getMeasures(u).forEach(r,h)}function r(u,l,h){const I=this;I.measureUuid=e.A.getUuid(I.measuresHeaders[l]);let P=c.default.getNotes(u);P=P.filter(d.default.hasSlurStart),P.forEach(n,I),Object.keys(I.slurUuidByVoice).forEach(function(T){if(T=a.default.intPart(T),c.default.hasRightSlur(u,T)){const _=I.slurUuidByVoice[T],g=c.default.getRightSlur(u,T);g.slurUuid=_,i.default.setUuid(g,_);const E=h[l+1],D=c.default.getLeftSlur(E,T);D.slurUuid=_,i.default.setUuid(D,_)}})}function n(u){const l=this,h=f.default.generate(),I={slurUuid:h,measureUuid:l.measureUuid};s.A.addSlur(l.partContent,I);const P=d.default.getVoiceIdx(u),T=d.default.getSlur(u);i.default.setUuid(T,h),l.slurUuidByVoice[P]=h}},186238:(O,A,t)=>{t.d(A,{A:()=>N});var f=t(446921),e=t(843678),s=t(383279),c=t(856219),d=t(226804);const i="Piano",a="Pno.",o="1",r=function(){},n=r.prototype;n.getInstrument=function(){return this.createPiano()},n.createPiano=function(){const G=d.default.create(i);d.default.setAbbreviation(G,a);const nt={};return c.default.setMIDIProgram(nt,o),{MIDI:nt,score:G}};const u=r,l=[{name:"Violin",abbreviation:"Vln.",MIDIProgram:"41",sound:"strings.violin"},{name:"Piano",abbreviation:"Pno.",MIDIProgram:"1",sound:"keyboard.piano.grand"},{name:"Choir Tenor",abbreviation:"Ten.",MIDIProgram:"53",sound:"voice.tenor",alternateNames:["Tenor"]},{name:"French Horn",MIDIProgram:"61",sound:"brass.french-horn"},{name:"Trumpet",MIDIProgram:"57",sound:"brass.trumpet"},{name:"Trombone",MIDIProgram:"58",sound:"brass.trombone"},{name:"Baritone Horn",MIDIProgram:"268",sound:"brass.baritone-horn"},{name:"Baritone TC",MIDIProgram:"269"},{name:"Euphonium",MIDIProgram:"270",sound:"brass.euphonium"},{name:"Tuba",MIDIProgram:"59",sound:"brass.tuba"},{name:"Brass Section",MIDIProgram:"62",sound:"brass.group"},{name:"Choir Synthesizer",MIDIProgram:"92",sound:"synth.pad.choir"},{name:"Accordion",MIDIProgram:"22",sound:"keyboard.accordion"},{name:"Harmonica",MIDIProgram:"23",sound:"wind.reed.harmonica"},{name:"Grand Piano",MIDIProgram:"1",sound:"keyboard.piano"},{name:"Harpsichord",MIDIProgram:"7",sound:"keyboard.harpsichord"},{name:"Celesta",MIDIProgram:"9",sound:"keyboard.celesta"},{name:"Organ",MIDIProgram:"20",sound:"keyboard.organ"},{name:"Hammond Organ",MIDIProgram:"17",sound:"keyboard.organ.drawbar"},{name:"Reed Organ",MIDIProgram:"21",sound:"keyboard.organ.reed"},{name:"Rotary Organ",MIDIProgram:"19",sound:"keyboard.organ.rotary"},{name:"Percussive Organ",MIDIProgram:"18",sound:"keyboard.organ.percussive"},{name:"Timpani",MIDIProgram:"48",sound:"drum.timpani"},{name:"Xylophone",MIDIProgram:"14",sound:"pitched-percussion.xylophone"},{name:"Vibraphone",MIDIProgram:"12",sound:"pitched-percussion.vibraphone"},{name:"Glockenspiel",MIDIProgram:"10",sound:"pitched-percussion.glockenspiel"},{name:"Marimba",MIDIProgram:"13",sound:"pitched-percussion.marimba"},{name:"Tubular Bells (Orchestral Chimes)",MIDIProgram:"15",sound:"pitched-percussion.tubular-bells"},{name:"Music Box",MIDIProgram:"11",sound:"pitched-percussion.music-box"},{name:"Steel Drums",MIDIProgram:"115",sound:"metal.steel-drums"},{name:"Classical Guitar (Nylon)",MIDIProgram:"25",sound:"pluck.guitar.nylon-string"},{name:"Acoustic Guitar (steel)",MIDIProgram:"26",sound:"pluck.guitar.steel-string"},{name:"Electric Guitar (clean)",MIDIProgram:"28",sound:"pluck.guitar.electric"},{name:"Electric Bass",MIDIProgram:"34",sound:"pluck.bass.electric"},{name:"Ukulele",MIDIProgram:"224",sound:"pluck.ukulele"},{name:"Banjo",MIDIProgram:"106",sound:"pluck.banjo"},{name:"Mandolin",MIDIProgram:"225",sound:"pluck.mandolin"},{name:"Harp",MIDIProgram:"47",sound:"pluck.harp"},{name:"Sitar",MIDIProgram:"105",sound:"pluck.sitar"},{name:"Violin",MIDIProgram:"41",sound:"strings.violin"},{name:"Viola",MIDIProgram:"42",sound:"strings.viola"},{name:"Cello",MIDIProgram:"43",sound:"strings.cello"},{name:"Contrabass",MIDIProgram:"44",sound:"strings.contrabass"},{name:"String Ensemble",MIDIProgram:"49",sound:"strings.group"},{name:"Choir Soprano",MIDIProgram:"53",sound:"voice.soprano"},{name:"Voice Oohs",MIDIProgram:"54",sound:"voice.oo"},{name:"Voice Lead",MIDIProgram:"86",sound:"voice.synth"},{name:"Kazoo",MIDIProgram:"286",sound:"voice.kazoo"},{name:"Piccolo",MIDIProgram:"73",sound:"wind.flutes.flute.piccolo"},{name:"Flute",MIDIProgram:"74",sound:"wind.flutes.flute"},{name:"Alto Flute",MIDIProgram:"274",sound:"wind.flutes.flute.alto"},{name:"Pan Flute",MIDIProgram:"76",sound:"wind.flutes.panpipes"},{name:"Recorder",MIDIProgram:"75",sound:"wind.flutes.recorder"},{name:"Tin Whistle",MIDIProgram:"79",sound:"wind.flutes.whistle.tin"},{name:"Oboe",MIDIProgram:"69",sound:"wind.reed.oboe"},{name:"English Horn",MIDIProgram:"70",sound:"wind.reed.english-horn"},{name:"Clarinet",MIDIProgram:"72",sound:"wind.reed.clarinet"},{name:"Alto Clarinet",MIDIProgram:"273",sound:"wind.reed.clarinet.alto"},{name:"Bass Clarinet",MIDIProgram:"272",sound:"wind.reed.clarinet.bass"},{name:"Contrabass Clarinet",MIDIProgram:"271",sound:"wind.reed.clarinet.contrabass"},{name:"Contrabass Clarinet",MIDIProgram:"271",sound:"wind.reed.clarinet.contrabass"},{name:"Bassoon",MIDIProgram:"71",sound:"wind.reed.bassoon"},{name:"Soprano Saxophone",MIDIProgram:"65",sound:"wind.reed.saxophone.soprano"},{name:"Alto Saxophone",MIDIProgram:"66",sound:"wind.reed.saxophone.alto"},{name:"Tenor Saxophone",MIDIProgram:"67",sound:"wind.reed.saxophone.tenor"},{name:"Baritone Saxophone",MIDIProgram:"68",sound:"wind.reed.saxophone.baritone"},{name:"Bagpipe",MIDIProgram:"110",sound:"wind.pipes.bagpipes"},{name:"Ocarina",MIDIProgram:"80",sound:"wind.flutes.ocarina"}],h=[{name:"Classical Guitar (Nylon)",MIDIProgram:"25",sound:"pluck.guitar"},{name:"Electric Bass",MIDIProgram:"34",sound:"pluck.bass"},{name:"Choir Alto",MIDIProgram:"53",sound:"voice.alto"},{name:"Choir Tenor",MIDIProgram:"53",sound:"voice.tenor"},{name:"Choir Bass",MIDIProgram:"53",sound:"voice.bass"},{name:"Choir Aahs",MIDIProgram:"53",sound:"voice.aa"},{name:"Tin Whistle",MIDIProgram:"79",sound:"wind.flutes.whistle"},{name:"Soprano Saxophone",MIDIProgram:"65",sound:"wind.reed.saxophone"}],I=e.default.fromList(l,({MIDIProgram:G})=>G),P=e.default.fromList(l.concat(h),({sound:G})=>G),T=e.default.fromList(l,({name:G})=>G);l.forEach(G=>{const{alternateNames:nt}=G;nt&&nt.forEach(J=>{T[J]=G})});function _(G){return T[G]}function g(G){const nt=G.split(".");for(;nt.length>1;){if(G=nt.join("."),P[G])return P[G];nt.pop()}return null}function E(G){return I[G]}var D=t(51431);function M({partHeader:G,scoreInstrument:nt}){if(d.default.hasSound(nt)){const Z=d.default.getSound(nt),dt=g(Z);if(dt){const at=D.A.NO;return{MIDIProgram:dt.MIDIProgram,soundInterferenceStatus:at}}}if(d.default.hasName(nt)){const Z=d.default.getName(nt),dt=_(Z);if(dt){const at=D.A.INFERED;return{MIDIProgram:dt.MIDIProgram,soundInterferenceStatus:at}}}if(s.default.hasName(G)){const Z=s.default.getName(G),dt=_(Z),at=D.A.INFERED;if(dt)return{MIDIProgram:dt.MIDIProgram,soundInterferenceStatus:at}}const V=new u().getInstrument(),W=D.A.FALLBACK;return{MIDIProgram:c.default.getMIDIProgram(V.MIDI),soundInterferenceStatus:W}}const p="Unidentified instrument";function m({partHeader:G,MIDIInstrument:nt}){if(s.default.hasScoreInstruments(G)){const[J]=s.default.getScoreInstruments(G);if(d.default.hasSound(J)){const V=d.default.getSound(J),W=g(V);if(W)return W.name}}{const J=c.default.getMIDIProgram(nt),V=E(J);if(V)return V.name}return s.default.hasName(G)?s.default.getName(G):p}const v=/^P[0-9]+\-[IX]([0-9]+)$/;function U(G,nt){let J=s.default.getScoreInstruments(G),V=s.default.getMIDIInstruments(G);const W=e.default.fromList(J,d.default.getId),Z=e.default.fromList(V,c.default.getId),dt={context:nt,scoreInstrumentsMap:W,MIDIInstrumentsMap:Z,partHeader:G};e.default.forEach(W,S,dt),e.default.forEach(Z,K,dt),e.default.forEach(Z,H,dt),e.default.forEach(W,Y,dt),e.default.isEmpty(Z)&&x({partHeader:G,context:nt,MIDIInstrumentsMap:Z,scoreInstrumentsMap:W}),J=e.default.getValues(W),J.sort(C),s.default.setScoreInstruments(G,J),V=e.default.getValues(Z),V.sort(C),s.default.setMIDIInstruments(G,V),s.default.hasName(G)||y(G)}function x({partHeader:G,MIDIInstrumentsMap:nt,scoreInstrumentsMap:J}){const V=new u,W=s.default.getId(G);s.default.setSoundInferenceStatus(G,D.A.FALLBACK);const Z=V.getInstrument();c.default.initId(Z.MIDI,W,0);const dt=c.default.getId(Z.MIDI);d.default.setId(Z.score,dt),nt[dt]=Z.MIDI,J[dt]=Z.score}function S(G,nt){const{MIDIInstrumentsMap:J,context:V,partHeader:W}=this;if(!J[G]){const{MIDIProgram:Z,soundInterferenceStatus:dt}=M({partHeader:W,context:V,scoreInstrument:nt});s.default.setSoundInferenceStatus(W,dt);const at={};c.default.setMIDIProgram(at,Z),c.default.setId(at,G),J[G]=at}}function K(G,nt){if(!c.default.hasMIDIProgram(nt)&&!c.default.hasUnpitched(nt)){const{scoreInstrumentsMap:J,context:V,partHeader:W}=this,Z=J[G],{MIDIProgram:dt,soundInterferenceStatus:at}=M({partHeader:W,context:V,scoreInstrument:Z});s.default.setSoundInferenceStatus(W,at),c.default.setMIDIProgram(nt,dt)}}function H(G,nt){const{scoreInstrumentsMap:J,partHeader:V}=this;if(!J[G]){const W={},Z=m({partHeader:V,MIDIInstrument:nt});d.default.setId(W,G),d.default.setName(W,Z),J[G]=W}}function Y(G,nt){const{MIDIInstrumentsMap:J,context:V,partHeader:W}=this;if(!d.default.hasName(nt)){const Z=J[G],dt=m({partHeader:W,MIDIInstrument:Z});d.default.setId(nt,G),d.default.setName(nt,dt)}if(!J[G]){const{MIDIProgram:Z,soundInterferenceStatus:dt}=M({partHeader:W,context:V,scoreInstrument:nt});s.default.setSoundInferenceStatus(W,dt);const at={};c.default.setMIDIProgram(at,Z),c.default.setId(at,G),J[G]=at}}function C(G,nt){let J=d.default.getId(G),V=d.default.getId(nt);return v.test(J)&&v.test(V)&&(J=v.exec(J)[1],J=parseInt(J,"10"),V=v.exec(V)[1],V=parseInt(V,"10")),J>V?1:J<V?-1:0}function y(G){if(s.default.hasAbbreviation(G)){const V=s.default.getAbbreviation(G);s.default.setName(G,V);return}const[nt]=s.default.getScoreInstruments(G),J=d.default.getName(nt);if(s.default.setName(G,J),d.default.hasAbbreviation(nt)){const V=d.default.getAbbreviation(nt);s.default.setAbbreviation(G,V)}}const N=function(G,nt){G.forEach(function(J,V){const W=nt[V],Z=f.A.getInstrumentContext(W);U(J,Z)})}},189247:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(364842),e=t(153271),s=t(726042),c=t(832560);class d{constructor(a,o,r){this.measures=a,this.partIdx=o,this.scoreData=r||null,this.measureDataMap={}}registerMeasureData(a){const o=a.getIdx();if(this.checkMeasureIdx(o),this.hasMeasureData(o)){const r=`the measure idx ${o} is already used.`;throw new f.default("MeasureIdxAlreadyUsed",r)}else this.measureDataMap[o]=a}checkMeasureIdx(a){const o=this.getNbMeasures();if(!s.default.isInteger(a)||a<0||a>=o)throw new e.default(a)}getNbMeasures(){return this.measures.length}hasMeasureData(a){return typeof this.measureDataMap[a]!="undefined"}getMeasureData(a){if(this.checkMeasureIdx(a),this.hasMeasureData(a))return this.measureDataMap[a];{const o=this.measures[a];return new c.A(o,a,this,this.scoreData)}}getPartIdx(){return this.partIdx}hasScoreData(){return this.scoreData!==null}getScoreData(){return this.scoreData}}},189997:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(614653),s=t(156902);const c=function(o,r){if(f.default.hasHarmonies(o)){const n=f.default.getDpq(o),l=f.default.getStaffExportMapping(o,0,r),h=f.default.getAllHarmonies(o);h.forEach(d,l),h.forEach(i,n),f.default.setRawHarmonies(o,h)}else f.default.setRawHarmonies(o,[])},d=function(o){const r=this,n=e.default.getTimePos(o),u=(0,s.A)(r,n);e.default.setNoteBefore(o,u.noteBefore)};function i(o){const r=this.valueOf();e.default.setDpq(o,r)}const a=c},193272:(O,A,t)=>{t.d(A,{A:()=>l});var f=t(364842);const e="title",s="subtitle",c="rights",d="composer",i="lyricist",a="arranger",o=[e,s];function r(h){n(h)||u(h)}function n(h){return o.includes(h)}function u(h){const I=`Invalid internal value for wedge type: [${h}].`;throw new f.default("CreditType",I)}const l={TITLE:e,SUBTITLE:s,RIGHTS:c,COMPOSER:d,LYRICIST:i,ARRANGER:a,internalValues:o,assertInternal:r,isValidInternal:n,raiseError:u}},196871:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(35802),s=t(104907);function c(o){const r=f.default.getOwnAttributes(o),n=e.default.getStaffDetails(r);if(!d(n))return;n.filter(i).forEach(a)}function d(o){return o.some(s.default.hasStaffTuning)}function i(o){return s.default.hasStaffTuning(o)&&!s.default.hasStaffLines(o)}function a(o){const n=s.default.getStaffTunings(o).length;s.default.setNbStaffLines(o,n)}},197173:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(343568),e=t(726042),s=t(607682);class c extends s.default{constructor(o,r){super(`The absulute grace idx [${r}] is invalid.`),Object.defineProperty(this,"noteIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"absoluteGraceIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadAbsoluteGraceIdx",this.noteIdx=o,this.absoluteGraceIdx=r}}const i=function(a,o){if(!e.default.isInteger(o.absoluteGraceIdx)||o.absoluteGraceIdx<0)throw new c(o.absoluteGraceIdx);const r={};f.A.call(r,a,o);const n=r.measureData;n.checkVoiceIdx(o.voiceIdx);const u=n.getVoice(o.voiceIdx);let l=0;const h=u.getNbNotes();for(let I=0;I<h;I++){const P=u.getNbGraces(I);if(l+=P,l>o.absoluteGraceIdx)return I}throw new c(o.absoluteGraceIdx)}},199992:(O,A,t)=>{t.d(A,{A:()=>I});var f=t(737903),e=t(364596),s=t(476943),c=t(123491),d=t(351277),i=t(275722),a=t(49906),o=t(749138),r=t(551690),n=t(343568),u=t(354703);const l=function(P,T,_){this.init(P,T,_)};l.NAME="primitive.UpdateAccidentals";const h=l.prototype;h.initMeasureData=n.A,h.name=l.NAME,h.init=function(P,T,_){this.initMeasureData(P,T),this.cancelStack=_,this.opts=T},h.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name);const T=this.measureData.getScoreData().getPartVoiceMainStaffIdx(this.opts.partIdx,this.opts.voiceIdx),_=this.measureData.getKey(T),g=e.default.getFifths(_);this.alterationTable=new u.A(g);const E=this.getVoice(),D=E.getNbNotes();for(let M=0;M<D;M++)if(!E.isRest(M)){const p=E.getNbGraces(M);for(let m=0;m<p;m++)this.updateChordGraces(M,m);this.updateChordNotes(M)}},h.updateChordGraces=function(P,T){let g=this.getVoice().getGraceChord(P,T);g=s.default.makeArray(g),g.forEach(function(E){this.updateChordGrace(P,T,E)},this)},h.updateChordGrace=function(P,T,_){const g=c.default.getPitch(_),E=this.alterationTable.getAlterValue(g),D=d.default.getAlter(g);if(this.alterationTable.setAlterValue(g),E===D)c.default.hasAccidental(_)&&this.removeGraceAccidental(P,T,g);else{const M=d.default.alterToAccidental(D);(!c.default.hasAccidental(_)||c.default.getAccidental(_)!==M)&&this.setGraceAccidental(P,T,g,M)}},h.removeGraceAccidental=function(P,T,_){const g={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:P,graceIdx:T,pitch:(0,f.default)(_)};new r.A(this.measureData,g,this.cancelStack).perform()},h.setGraceAccidental=function(P,T,_,g){const E={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:P,graceIdx:T,pitch:(0,f.default)(_),accidental:g};new o.A(this.measureData,E,this.cancelStack).perform()},h.updateChordNotes=function(P){let _=this.getVoice().getChord(P);_=s.default.makeArray(_),_.forEach(function(g){this.updateChordNote(P,g)},this)},h.getVoice=function(){return this.measureData.getVoice(this.opts.voiceIdx)},h.updateChordNote=function(P,T){const _=c.default.getPitch(T),g=this.alterationTable.getAlterValue(_),E=d.default.getAlter(_);if(this.alterationTable.setAlterValue(_),g===E)c.default.hasAccidental(T)&&this.removeAccidental(P,_);else{const D=d.default.alterToAccidental(E);(!c.default.hasAccidental(T)||c.default.getAccidental(T)!==D)&&this.setAccidental(P,_,D)}},h.removeAccidental=function(P,T){const _={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:P,pitch:(0,f.default)(T)};new a.default(this.measureData,_,this.cancelStack).perform()},h.setAccidental=function(P,T,_){const g={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,noteIdx:P,pitch:(0,f.default)(T),accidental:_};new i.default(this.measureData,g,this.cancelStack).perform()};const I=l},200503:(O,A,t)=>{t.d(A,{A:()=>T});var f=t(883782),e=t(607682);class s extends e.default{constructor(g){const E=`The tempoChange uuid "${g} is invalid."`;super(E),Object.defineProperty(this,"tempoChangeUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadTempoChangeUuidError",this.tempoChangeUuid=g}}var c=t(21738),d=t(409200),i=t(799851),a=t(180289),o=t(189247),r=t(346797),n=t(737903);const u=function(_,g){(0,c.default)(_,g),(0,d.default)(_,g);const E=_.getCommonContent();if(!E.hasTempoChangeUuid(g.tempoChangeUuid))throw new s(g.tempoChangeUuid);const D=E.getTempoChangeAtUuid(g.tempoChangeUuid),M=_.getMeasureIdxFromUuid(D.measureUuid);if(_.checkMeasureIdx(M),!_.hasPartVoiceIdx(g.partIdx,g.voiceIdx))throw new f.default(g.voiceIdx);g.staffIdx=_.getPartVoiceMainStaffIdx(g.partIdx,g.voiceIdx);let p=E.getTempoChanges(M);p=p.filter(r.A.isStart);const m=h(p,D.tempoChangeUuid),v=r.A.getTimePos(m),U=r.A.getDpq(m),x=(0,a.A)(E,M,v,U);x.partIdx=g.partIdx,x.staffIdx=g.staffIdx;const S=l(_,g,x);return Object.assign(x,S),P(x,_),x},l=function(_,g,E){const D=(0,n.default)(E);D.searchedVoiceIdx=g.voiceIdx,D.staffVoicesIndexes=_.getPartStaffVoicesIndexes(g.partIdx,g.staffIdx);const M=_.getPartMeasures(g.partIdx),p=new o.A(M,g.partIdx,_);return(0,i.A)(p,D)},h=function(_,g){return _.find(I,g)},I=function(_){const g=this.valueOf();return r.A.getTempoChangeUuid(_)===g},P=function(_,g){_.startMeasureUuid=g.getMeasureUuid(_.startMeasureIdx),_.startVoiceUuid=g.getPartVoiceUuid(_.partIdx,_.startVoiceIdx),_.stopMeasureUuid=g.getMeasureUuid(_.stopMeasureIdx),_.stopVoiceUuid=g.getPartVoiceUuid(_.partIdx,_.stopVoiceIdx),_.partUuid=g.getPartUuid(_.partIdx),_.staffUuid=g.getPartStaffUuid(_.partIdx,_.staffIdx)},T=u},203066:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(123491),e=t(701387);const c=function(d,i){let a=i.noteIdx,o=i.measureIdx;for(;o>=0;o--){const r=d.getMeasureData(o);if(!r.hasVoice(i.voiceIdx)){a=-1;continue}const n=r.getVoice(i.voiceIdx);for(a===-1&&(a=n.size()-1);a>=0;a--){const l=n.getNote(a);if((a!==i.noteIdx||o!==i.measureIdx)&&f.default.hasSlurStop(l))return null;if(f.default.hasSlurStart(l))return{measureIdx:o,noteIdx:a}}const u=r.data;if(!e.default.hasLeftSlur(u,i.voiceIdx))return null}return null}},205079:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(701387),e=t(746641),s=t(579102),c=t(668674),d=t(35802);function i(u){u.forEach(a)}function a(u,l,h){if(l===0)o(u);else{const I=h[l-1];r(u,I)}}function o(u){const l=f.default.getNbStaves(u),h=f.default.getOwnAttributes(u);let I=d.default.getMeasureStyle(h);const P=new e.A(I,l,s.A);for(let T=0;T<l;T++)if(f.default.hasSlash(u,T)){let _=f.default.getSlash(u,T);_=c.A.copy(_),c.A.makeStart(_);let g={};P.hasEntry(T)&&(g=P.getEntry(T)),s.A.setSlash(g,_),P.setEntry(g,T)}I=P.dumpAttribute(),d.default.setMeasureStyle(h,I),f.default.setOwnAttributes(u,h)}function r(u,l){const h=f.default.getNbStaves(u),I=f.default.getOwnAttributes(u);let P=d.default.getMeasureStyle(I);const T=new e.A(P,h,s.A);for(let _=0;_<h;_++)if(f.default.hasSlash(l,_)&&!f.default.hasSlash(u,_)){const g=c.A.createStop();let E={};T.hasEntry(_)&&(E=T.getEntry(_)),s.A.setSlash(E,g),T.setEntry(E,_)}else if(n(u,l,_)){let g=f.default.getSlash(u,_);g=c.A.copy(g),c.A.makeStart(g);let E={};T.hasEntry(_)&&(E=T.getEntry(_)),s.A.setSlash(E,g),T.setEntry(E,_)}P=T.dumpAttribute(),d.default.setMeasureStyle(I,P),f.default.setOwnAttributes(u,I)}function n(u,l,h){if(!f.default.hasSlash(u,h))return!1;if(!f.default.hasSlash(l,h))return!0;const I=f.default.getSlash(u,h),P=f.default.getSlash(l,h);return!c.A.isSameWorking(I,P)}},205617:(O,A,t)=>{t.d(A,{A:()=>g});var f=t(701387),e=t(35802),s=t(364596),c=t(476943),d=t(364842),i=t(843678);const a=7,o=function(E){if(s.default.hasFifths(E))return;let D=s.default.getCustomAlters(E);if(s.default.removeCustom(E),D=D.filter(r),D.length===0){s.default.setFifths(E,0);return}let M={};D.forEach(n,M),M=i.default.toPairs(M);const p=M.reduce(u),m=l(p),v=h(p),U=m*v;s.default.setFifths(E,U)},r=function(E){return E===1||E===-1},n=function(E){const D=this;typeof D[E]=="undefined"?D[E]=1:D[E]++},u=function(E,D){return E.value>=D.value?E:D},l=function(E){if(E.key==="1")return 1;if(E.key==="-1")return-1;throw new d.default("Unexpected")},h=function(E){let D=E.value;return D=Math.min(D,a),D},I=o,P=function(E){f.default.getAllRawAttributes(E).forEach(T)},T=function(E){let D=e.default.getKey(E);D=D.map(_),e.default.setKey(E,D),D.forEach(I)},_=function(E){return c.default.isObject(E)?E:s.default.createDefault()},g=P},206203:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(701387),e=t(721247);function s(d){const i=f.default.getNbStaves(d),a=f.default.getNbDivisions(d);for(let o=0;o<i;o++){let r=f.default.getMiddleClefs(d,o);r=r.filter(c,a),f.default.setMiddleClefs(d,o,r)}}function c(d){const i=this.valueOf(),a=e.default.getTimePos(d);return a>=0&&a<i}},206568:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(718477),e=t(21738),s=t(131220),c=t(701387),d=t(614653),i=t(726042);const o=function(r,n){(0,e.default)(r,n),(0,s.default)(r,n),r.checkPartIdx(n.partIdx),r.checkMeasureIdx(n.measureIdx);const u=r.getMeasure(n.partIdx,n.measureIdx),l=c.default.getNbClassicHarmonies(u),h=n.harmonyIdx;if(!i.default.isInteger(h)||h<0||h>=l)throw new f.A(h);const P=c.default.getClassicHarmonies(u)[h],T=d.default.getFunction(P),_=d.default.getKindValue(P),g=d.default.getInversion(P);return{chordFunction:T,kind:_,inversion:g}}},213081:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(820686),e=t(424104),s=t(987901),c=t(383279);const d=function(n,u){n.forEach(i,u)},i=function(n,u){const h=this[u],I=c.default.getVoiceMapping(n);(0,f.A)(h,I);let P=c.default.getStaffMapping(n);a(P)&&(P=(0,e.A)(n,h),c.default.setStaffMapping(n,P))},a=function(n){return n.some(o)},o=function(n){return n.voices.length>s.A.MAX_NB_VOICES_PER_STAFF},r=d},213977:(O,A,t)=>{t.d(A,{A:()=>l});var f=t(701387),e=t(104907),s=t(123491),c=t(860716),d=t(476943),i=t(955154),a=t(359932),o=t(579283),r=t(832560),n=t(351277),u=t(35802);function l(_){const g=f.default.getAttributes(_),E=u.default.getStaffDetails(g)[0];if(!e.default.hasStaffTuning(E)||!f.default.getNotes(_).some(h))return;const M=this,p=new r.A(_),m={measureData:p,tmpContent:M};p.getVoicesIndexes().forEach(U=>{const x=p.getVoice(U),S=x.getNbNotes();for(let K=0;K<S;K++){if(x.isRest(K))continue;let H=x.getChord(K);H=d.default.makeArray(H),H=H.slice(),H.sort(I),H.reverse(),H.forEach(P,m)}})}function h(_){if(!s.default.hasHarmonic(_))return!1;const g=s.default.getHarmonic(_);return c.default.getType(g)===i.default.ARTIFICIAL_TOUCHING}function I(_,g){const E=s.default.getPitch(_),D=s.default.getPitch(g);return n.default.naiveComparePitch(E,D)}function P(_,g,E){const{measureData:D,tmpContent:M}=this;if(!s.default.hasHarmonic(_))return;const p=s.default.getHarmonic(_);if(c.default.getType(p)!==i.default.ARTIFICIAL_TOUCHING)return;const v=E.find(T,_);if(!v||!s.default.hasFretData(v))return;const U=s.default.getFretData(v),x=s.default.getStaffIdx(U),S=D.getStaffDetails(x),K=s.default.getPitch(_),H=(0,o.default)(K,U.string,S);H!==null&&(s.default.addTechnical(_,a.default.FRET,{fret:H}),s.default.addTechnical(_,a.default.STRING,{string:U.string}),typeof M.artificialHarmonicTouchNotes=="undefined"&&(M.artificialHarmonicTouchNotes=[]),M.artificialHarmonicTouchNotes.push(_))}function T(_){const g=this;if(!s.default.hasHarmonic(_))return!1;const E=s.default.getHarmonic(_);if(c.default.getType(E)!==i.default.ARTIFICIAL_BASE)return!1;const M=s.default.getPitch(_),p=s.default.getPitch(g);return n.default.naiveComparePitch(p,M)>0}},215459:(O,A,t)=>{t.d(A,{A:()=>D});var f=t(701387),e=t(345912),s=t(756042),c=t(891921),d=t(26698),i=t(21738),a=t(779146),o=t(409200),r=t(665280),n=t(118824);const u=function(M,p){(0,i.default)(M,p),(0,a.default)(M,p),(0,o.default)(M,p),(0,r.default)(M,p);const m={hasLeftContinue:l,searchLeftStart:h,getEntities:I,createStart:P,createStop:T,hasRightContinue:_,searchRightStop:g,createEntry:E,isEntityStart:e.A.isStart,isEntityStop:e.A.isStop},v=new n.A(M,p,m);return v.checkPreconditions(),v.get()},l=function(){const M=this.getMeasure(this.location.startMeasureIdx);return f.default.hasLeftOctaveShift(M,this.location.staffIdx)},h=function(){const M=this.getMeasures(),p=(0,s.A)(M,this.location.startMeasureIdx,this.location.staffIdx,0),m=this.getMeasure(p.startMeasureIdx),v=f.default.getDpq(m);return{measureIdx:p.startMeasureIdx,timePos:p.startTimePos,dpq:v,placement:p.placement,type:p.type,size:p.size}},I=function(M){const p=this.getMeasure(M);return f.default.getOctaveShifts(p,this.location.staffIdx)},P=function(M,p){const m=e.A.getTimePos(M),v=e.A.getPlacement(M),U=e.A.getType(M),x=e.A.getSize(M),S=this.getMeasure(p),K=f.default.getDpq(S);return{measureIdx:p,timePos:m,dpq:K,placement:v,type:U,size:x}},T=function(M,p){const m=e.A.getTimePos(M),v=this.getMeasure(p),U=f.default.getDpq(v);return{measureIdx:p,timePos:m,dpq:U}},_=function(){const M=this.getMeasure(this.location.stopMeasureIdx);return f.default.hasRightOctaveShift(M,this.location.staffIdx)},g=function(){const M=this.getMeasures(),p=(0,s.A)(M,this.location.stopMeasureIdx+1,this.location.staffIdx,0),m=this.getMeasure(p.stopMeasureIdx),v=f.default.getDpq(m);return{measureIdx:p.stopMeasureIdx,timePos:p.stopTimePos,dpq:v}},E=function(M,p){const m={startMeasureIdx:M.measureIdx,startMeasureUuid:this.scoreData.getMeasureUuid(M.measureIdx),startTimePos:M.timePos,startDpq:M.dpq,stopMeasureIdx:p.measureIdx,stopMeasureUuid:this.scoreData.getMeasureUuid(p.measureIdx),stopTimePos:p.timePos,stopDpq:p.dpq,placement:M.placement,type:M.type,size:M.size},v=this.location.partIdx,U=1;m.startVoiceIdx=this.getVoiceIdx(M.measureIdx),m.startVoiceUuid=this.scoreData.getPartVoiceUuid(this.location.partIdx,m.startVoiceIdx);const x=this.getVoice(M.measureIdx);m.startNoteIdx=(0,c.A)(x,U,M.timePos),m.startIdxInStaff=this.scoreData.voiceIdxToIdxInMainStaff(v,m.startVoiceIdx),m.stopVoiceIdx=this.getVoiceIdx(p.measureIdx),m.stopVoiceUuid=this.scoreData.getPartVoiceUuid(this.location.partIdx,m.stopVoiceIdx);const S=this.getVoice(p.measureIdx);return m.stopNoteIdx=(0,d.A)(S,U,p.timePos),m.stopIdxInStaff=this.scoreData.voiceIdxToIdxInMainStaff(v,m.stopVoiceIdx),m},D=u},216700:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(701387),e=t(589501),s=t(21738),c=t(131220),d=t(536863);function i(o,r){(0,s.default)(o,r),(0,c.default)(o,r),o.checkPartIdx(r.partIdx),o.checkMeasureIdx(r.measureIdx);const n=o.getMeasure(r.partIdx,r.measureIdx),u=f.default.getFiguredBasses(n),l=(0,d.A)(r,n),h=u.find(a,l);return h?e.A.getFiguresData(h):[]}function a(o){const r=this.valueOf(),n=e.A.getTimePos(o);return n<r?!1:n===r}},222268:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(383279);function e(s){const c=new Set;return s.forEach(a=>{f.default.getVoicesIndexes(a).forEach(r=>c.add(r))}),Math.max(...c.keys())+2}},226296:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(210888),e=t(601770),s=t(446921),c=t(701387),d=t(584416);function i(r,n){const u={partContent:r,measuresHeaders:n,pedalUuidByStaff:{}};s.A.getMeasures(r).forEach(a,u)}function a(r,n,u){const l=this,h=c.default.getNbStaves(r);l.measureUuid=e.A.getUuid(l.measuresHeaders[n]);for(let I=0;I<h;I++){let P=c.default.getPedals(r,I);if(P=P.filter(d.A.isStart),P.forEach(o,l),c.default.hasRightPedal(r,I)){const T=l.pedalUuidByStaff[I],_=c.default.getRightPedal(r,I);d.A.setPedalUuid(_,T);const g=u[n+1],E=c.default.getLeftPedal(g,I);d.A.setPedalUuid(E,T)}}}function o(r){const n=this,u=f.default.generate(),l={pedalUuid:u,measureUuid:n.measureUuid};s.A.addPedal(n.partContent,l);const h=d.A.getStaffIdx(r);d.A.setPedalUuid(r,u),n.pedalUuidByStaff[h]=u}},231189:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(364842);const e={LEFT:"left",RIGHT:"right"};e.values=[e.LEFT,e.RIGHT],e.isValid=function(c){return e.values.includes(c)},e.assert=function(c){e.isValid(c)||e.raiseError(c)},e.isLeft=function(c){return c===e.LEFT},e.isRight=function(c){return c===e.RIGHT},e.raiseError=function(c){const d=`The plucked range location [${c}] is invalid.`;throw new f.default("BadPluckedRangeLocation",d)};const s=e},236139:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(123491),s=t(838603);function c(a){a.forEach(d)}function d(a,o,r){const n=f.default.getNbStaves(a),u=f.default.getNotes(a);for(let l=0;l<n;l++){if(!f.default.hasMeasureRepeat(a,l))continue;if(o===0){f.default.removeMeasureRepeat(a,l);continue}const h=f.default.getQuarterDuration(a),I=r[o-1],P=f.default.getQuarterDuration(I);if(h!==P){f.default.removeMeasureRepeat(a,l);continue}const T=f.default.getMeasureRepeat(a,l);if(!s.A.isSupported(T)){f.default.removeMeasureRepeat(a,l);continue}if(u.some(i,l)){f.default.removeMeasureRepeat(a,l);continue}if(f.default.hasSlash(a,l)){f.default.removeMeasureRepeat(a,l);continue}}}function i(a){const o=this.valueOf(),r=e.default.getStaffIdx(a);return o!==r?!1:!!(!e.default.isRest(a)||e.default.needRestLock(a))}},238423:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(398738),e=t(475672);const s=15,c="Petaluma Script";function d(a){a.getFormatVersion()<s&&i(a)}function i(a){if(f.default.values.forEach(r=>{a.removeFontEntry(r)}),a.getMusicFont()===e.A.PETALUMA){const r={"$font-family":c};a.setFontEntry(f.default.GLOBAL,r)}}},242962:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(35802),e=t(701387),s=t(446921),c=t(383279),d=t(104907);function i(n,u){n.forEach(function(l,h){if(!c.default.hasUnpitched(l))return;const I=u[h];s.A.getMeasures(I).forEach(a)})}function a(n){e.default.getAllRawAttributes(n).forEach(o)}function o(n){f.default.getStaffDetails(n).forEach(r)}function r(n){const u=d.default.getNbStaffLines(n);u!==1&&u!==5&&d.default.setNbStaffLines(n,5)}},244240:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(614653),e=t(310868);function s(c){const d=f.default.getKindValue(c),i=f.default.getDegrees(c);return(0,e.A)(d,i)}},245689:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(726042);const s=function(o){const n=o.map(f.default.getStaffContentMap).reduce(c,0);return d(o,n)},c=function(o,r){return Object.keys(r).forEach(function(u){o=e.default.max2(o,e.default.toInt(u)+1)},this),o},d=function(o,r){const n=[];for(let u=0;u<r;u++){const l=i(o,u);n.push(l)}return n},i=function(o,r){return o.map(function(n){return f.default.getPedals(n,r)})},a=s},245770:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(364842),e=t(909748),s=t(515819),c=t(346797);const d=function(r,n,u,l){if(typeof l=="undefined")throw new Error("DPQ missing");n=n.sort(c.A.compare);const h=new i(r,n,u,l);return h.search(),h.getTempoChange()},i=function(r,n,u,l){this.init(r,n,u,l)},a=i.prototype;a.init=function(r,n,u,l){this.currentTempoChange=r,this.tempoChanges=n,this.searchedQuarterPos=s.default.divisionsToQuarter(u,l)},a.search=function(){this.tempoChanges.some(this.analyzeTempoChange,this)},a.analyzeTempoChange=function(r){const n=c.A.getQuarterPos(r);if(n>this.searchedQuarterPos)return!0;const u=c.A.getType(r);return e.A.isStart(u)&&this.startTempoChange(r),n===this.searchedQuarterPos?!0:(u===e.A.STOP&&this.stopTempoChange(),!1)},a.startTempoChange=function(r){if(this.currentTempoChange!==null)throw new f.default("Unexpected","There is already a tempo change");this.currentTempoChange=r},a.stopTempoChange=function(){if(this.currentTempoChange===null){const r="There is no tempo change to stop.";throw new f.default("Unexpected",r)}else this.currentTempoChange=null},a.getTempoChange=function(){return this.currentTempoChange};const o=d},246294:(O,A,t)=>{t.d(A,{A:()=>M});var f=t(917530),e=t(916502),s=t(10571),c=t(123491),d=t(701387),i=t(446921),a=t(726042),o=t(345912),r=t(886766),n=t(756042),u=t(891921),l=t(26698),h=t(189247),I=t(490617),P=t(372585);const T=function(p,m){const v=new _(p,m);return v.checkPreconditions(),v.get()},_=function(p,m){this.init(p,m)},g=_.prototype;g.init=function(p,m){this.scoreData=p,this.location=m,this.measuresScroller=null,this.targetTimePos=null},g.checkPreconditions=function(){this.checkLocation(),this.sanitize(),this.checkExistence()},g.checkLocation=function(){this.scoreData.checkPartIdx(this.location.partIdx),this.scoreData.checkMeasureIdx(this.location.measureIdx),this.getMeasureData(this.location.measureIdx).checkVoiceIdx(this.location.voiceIdx),(0,I.A)(this.scoreData,this.location)},g.sanitize=function(){if(typeof this.location.octaveShiftIdx!="undefined"){const p=this.getTargetMeasure(),m=d.default.getOctaveShifts(p,this.location.staffIdx);if(!a.default.isInteger(this.location.octaveShiftIdx)||this.location.octaveShiftIdx>=m.length)throw new s.A(this.location.octaveShiftIdx);const v=m[this.location.octaveShiftIdx];this.targetTimePos=o.A.getTimePos(v)}else if(typeof this.location.noteIdx!="undefined"){const p=this.getTargetVoice();p.checkNoteIdx(this.location.noteIdx),this.targetTimePos=E(p,this.location.noteIdx)}else throw new e.default("noteIdx OR octaveShiftIdx")},g.fillTargetTimePos=function(){};const E=function(p,m){let v=0;for(let U=0;U<m;U++){const x=p.getNote(U),S=c.default.getDuration(x);v+=S}return v};g.getTargetVoice=function(){return this.getMeasureData(this.location.measureIdx).getVoice(this.location.voiceIdx)},g.checkExistence=function(){if(!this.hasOctaveShift())throw new f.A},g.hasOctaveShift=function(){const p=this.getTargetMeasure(),m=d.default.getOctaveShifts(p,this.location.staffIdx),v=D(p,this.location.staffIdx);return(0,r.A)(v,m,this.targetTimePos)!==null},g.getTargetMeasure=function(){return this.scoreData.getMeasure(this.location.partIdx,this.location.measureIdx)};const D=function(p,m){return d.default.hasLeftOctaveShift(p,m)?d.default.getLeftOctaveShift(p,m):null};g.get=function(){this.searchSides(),this.convertSidesToNoteIdx(),this.fetchOctaveShiftsIdx();const p={placement:this.placement,type:this.type,size:this.size,startOctaveShiftIdx:this.startOctaveShiftIdx,stopOctaveShiftIdx:this.stopOctaveShiftIdx};return this.addLocationData(p),p},g.addLocationData=function(p){const m=this.location.partIdx,v=this.scoreData.voiceIdxToIdxInMainStaff(m,this.startVoiceIdx),U=this.scoreData.voiceIdxToIdxInMainStaff(m,this.stopVoiceIdx);p.startMeasureIdx=this.startMeasureIdx,p.startVoiceIdx=this.startVoiceIdx,p.startIdxInStaff=v,p.startNoteIdx=this.startNoteIdx,p.stopMeasureIdx=this.stopMeasureIdx,p.stopVoiceIdx=this.stopVoiceIdx,p.stopIdxInStaff=U,p.stopNoteIdx=this.stopNoteIdx},g.searchSides=function(){const p=this.getMeasures(),m=(0,n.A)(p,this.location.measureIdx,this.location.staffIdx,this.targetTimePos);this.startMeasureIdx=m.startMeasureIdx,this.startTimePos=m.startTimePos,this.stopMeasureIdx=m.stopMeasureIdx,this.stopTimePos=m.stopTimePos,this.placement=m.placement,this.type=m.type,this.size=m.size},g.getMeasures=function(){const p=this.scoreData.getPartContent(this.location.partIdx);return i.A.getMeasures(p)},g.convertSidesToNoteIdx=function(){this.convertLeftSide(),this.convertRightSide()},g.convertLeftSide=function(){const p=this.getLeftVoice(),m=1;this.startNoteIdx=(0,u.A)(p,m,this.startTimePos)},g.getLeftVoice=function(){const p=this.getMeasureData(this.startMeasureIdx);if(p.hasVoice(this.location.voiceIdx))this.startVoiceIdx=this.location.voiceIdx;else{let v=this.scoreData.getPartStaffVoicesIndexes(this.location.partIdx,this.location.staffIdx);v=v.filter(p.hasVoice,p),this.startVoiceIdx=v[0]}return p.getVoice(this.startVoiceIdx)},g.convertRightSide=function(){const p=this.getRightVoice(),m=1;this.stopNoteIdx=(0,l.A)(p,m,this.stopTimePos)},g.getRightVoice=function(){const p=this.getMeasureData(this.stopMeasureIdx);if(p.hasVoice(this.location.voiceIdx))this.stopVoiceIdx=this.location.voiceIdx;else{let v=this.scoreData.getPartStaffVoicesIndexes(this.location.partIdx,this.location.staffIdx);v=v.filter(p.hasVoice,p),this.stopVoiceIdx=v[0]}return p.getVoice(this.stopVoiceIdx)},g.getMeasureData=function(p){return this.getMeasuresScroller().getMeasureData(p)},g.getMeasuresScroller=function(){if(this.measuresScroller===null){const p=this.location.partIdx,m=this.scoreData.getPartContent(p),v=i.A.getMeasures(m);this.measuresScroller=new h.A(v,p,this.scoreData)}return this.measuresScroller},g.fetchOctaveShiftsIdx=function(){this.fetchLeftOctaveShiftIdx(),this.fetchRightOctaveShiftIdx()},g.fetchLeftOctaveShiftIdx=function(){this.octaveShiftIdx=null;const p=this.scoreData.getMeasure(this.location.partIdx,this.startMeasureIdx),m=d.default.getOctaveShifts(p,this.location.staffIdx);this.startOctaveShiftIdx=m.findIndex(function(v){const U=o.A.getTimePos(v),x=o.A.getType(v);return U===this.startTimePos&&x===P.A.UP||x===P.A.DOWN},this)},g.fetchRightOctaveShiftIdx=function(){this.octaveShiftIdx=null;const p=this.scoreData.getMeasure(this.location.partIdx,this.stopMeasureIdx),m=d.default.getOctaveShifts(p,this.location.staffIdx);this.stopOctaveShiftIdx=m.findIndex(function(v){const U=o.A.getTimePos(v),x=o.A.getType(v);return U===this.stopTimePos&&x===P.A.STOP},this)};const M=T},246772:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(123491);function e(s){(s.artificialHarmonicBaseNotes||[]).forEach(f.default.removeHarmonic)}},247548:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(383279),e=t(646319);function s(a,o){const r={};a.forEach(c,r),o.forEach(d,r)}function c(a,o){const r=this,n=f.default.getId(a);r[n]={idx:o,header:a}}function d(a){const o=this,r=e.A.getPartsIds(a);r.forEach((n,u)=>{if(u===0)return;const l=r[u-1];if(i(o,l,n)){const h=o[n].header;f.default.groupWithPrevious(h)}})}function i(a,o,r){const n=a[o];if(!n)return!1;const u=a[r];return!(!u||u.idx-n.idx!==1)}},247739:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(607682),e=t(414787),s=t(292681);function c(a,o,r){let n;if(a===d.INSERT)n="There is already an unpitched note at the ";else if(a===d.GET)n="There is no unpitched note at the ";else return`fail at failing, bad action provided: [${a}]`;return typeof r!="undefined"?n+=`line ${e.A.pitchToLine(o,r)}`:n+=`unpitched ${s.default.stringify(o)}`,n}class d extends f.default{constructor(o,r,n){const u=c(o,r,n);super(u),Object.defineProperty(this,"unpitched",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"action",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="UnpitchedCollisionError",this.unpitched=r,this.action=o}}Object.defineProperty(d,"INSERT",{enumerable:!0,configurable:!0,writable:!0,value:"insert"}),Object.defineProperty(d,"GET",{enumerable:!0,configurable:!0,writable:!0,value:"get"});const i=d},253689:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(35802),s=t(474072),c=t(721247);function d(r){const n=f.default.getAllRawAttributes(r),u=f.default.getNbStaves(r);n.filter(i).forEach(h=>{const I=e.default.getWrappedClef(h,u),P=s.A.getTimePos(h);for(let T=0;T<u;T++)if(I.hasEntry(T)){let _=I.getEntry(T);_=c.default.copy(_),c.default.setTimePos(_,P);const g=f.default.getMiddleClefs(r,T);g.push(_),f.default.setMiddleClefs(r,T,g)}}),a(r)}function i(r){return s.A.getTimePos(r)===0?!1:e.default.hasClef(r)}function a(r){const n=f.default.getNbStaves(r);for(let u=0;u<n;u++){const l=f.default.getMiddleClefs(r,u);l.sort(o),f.default.setMiddleClefs(r,u,l)}}function o(r,n){const u=c.default.getTimePos(r),l=c.default.getTimePos(n);return u-l}},254326:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(701387),e=t(952818),s=t(723631);const c=function(r){f.default.getRawDirections(r).filter(a).forEach(d)},d=function(r){const n=i(r);e.A.setPlacement(r,n)},i=function(r){const n=e.A.getStaffIdx(r);return n===0?s.A.BELOW:n===1?s.A.ABOVE:s.A.BELOW},a=function(r){return!e.A.hasPlacement(r)},o=c},256504:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(883782),e=t(701387),s=t(123491);const c=function(a,o){if(a.checkPartIdx(o.partIdx),a.checkMeasureIdx(o.measureIdx),!a.hasPartVoiceIdx(o.partIdx,o.voiceIdx))throw new f.default(o.voiceIdx);const r=a.getMeasure(o.partIdx,o.measureIdx);return e.default.getNotes(r).some(d,o)},d=function(a){const o=this;return s.default.getVoiceIdx(a)===o.voiceIdx},i=c},257069:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(607682);class e extends f.default{constructor(d,i){typeof i=="undefined"&&(i=e.GET);const a=`${i.msgPrefix} staff with the following Uuid ${d}`;super(a),Object.defineProperty(this,"staffUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"action",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadStaffUuidError",this.staffUuid=d,this.action=i}}Object.defineProperty(e,"GET",{enumerable:!0,configurable:!0,writable:!0,value:{msgPrefix:"There is no"}}),Object.defineProperty(e,"INSERT",{enumerable:!0,configurable:!0,writable:!0,value:{msgPrefix:"Cannot insert"}});const s=e},257272:(O,A,t)=>{t.d(A,{A:()=>M});var f=t(883782),e=t(607682);class s extends e.default{constructor(m){const v=`The pedal uuid "${m} is invalid."`;super(v),Object.defineProperty(this,"pedalUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadPedalUuidError",this.pedalUuid=m}}var c=t(443749),d=t(21738),i=t(409200),a=t(665280),o=t(799851),r=t(546522),n=t(189247),u=t(446921),l=t(701387),h=t(584416),I=t(737903),P=t(726042);const T=function(p,m){(0,d.default)(p,m),(0,i.default)(p,m),(0,a.default)(p,m),p.checkPartIdx(m.partIdx);const v=p.getPartContent(m.partIdx);if(!u.A.hasPedal(v,m.pedalUuid))throw new s(m.pedalUuid);const U=u.A.getPedal(v,m.pedalUuid),x=p.getMeasureIdxFromUuid(U.measureUuid);if(p.checkMeasureIdx(x),!p.hasPartVoiceIdx(m.partIdx,m.voiceIdx))throw new f.default(m.voiceIdx);const S=p.getPartNbStaves(m.partIdx),K=m.staffIdx;if(!P.default.isInteger(K)||K<0||K>=S)throw new c.default(m.staffIdx);const H=p.getMeasure(m.partIdx,x);let Y=l.default.getPedals(H,m.staffIdx);Y=Y.filter(h.A.isStart);const C=g(Y,U.pedalUuid),y=h.A.getTimePos(C),F=p.getPartMeasures(m.partIdx),N=(0,r.A)(F,x,m.staffIdx,y);N.startDpq=l.default.getDpq(H);const G=p.getMeasure(m.partIdx,N.stopMeasureIdx);N.stopDpq=l.default.getDpq(G),N.partIdx=m.partIdx,N.staffIdx=m.staffIdx;const nt=_(p,m,N);return Object.assign(N,nt),D(N,p),N},_=function(p,m,v){const U=(0,I.default)(v);U.searchedVoiceIdx=m.voiceIdx,U.staffVoicesIndexes=p.getPartStaffVoicesIndexes(m.partIdx,m.staffIdx);const x=p.getPartMeasures(m.partIdx),S=new n.A(x,m.partIdx,p);return(0,o.A)(S,U)},g=function(p,m){return p.find(E,m)},E=function(p){const m=this.valueOf();return h.A.getPedalUuid(p)===m},D=function(p,m){p.startMeasureUuid=m.getMeasureUuid(p.startMeasureIdx),p.startVoiceUuid=m.getPartVoiceUuid(p.partIdx,p.startVoiceIdx),p.stopMeasureUuid=m.getMeasureUuid(p.stopMeasureIdx),p.stopVoiceUuid=m.getPartVoiceUuid(p.partIdx,p.stopVoiceIdx),p.partUuid=m.getPartUuid(p.partIdx),p.staffUuid=m.getPartStaffUuid(p.partIdx,p.staffIdx)},M=T},258780:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(364842);const e={LEFT:"left",RIGHT:"right"};e.values=[e.LEFT,e.RIGHT],e.isValid=function(c){return e.values.includes(c)},e.assert=function(c){e.isValid(c)||e.raiseError(c)},e.isLeft=function(c){return c===e.LEFT},e.isRight=function(c){return c===e.RIGHT},e.raiseError=function(c){const d=`The octave shift location [${c}] is invalid.`;throw new f.default("BadOctaveShiftLocation",d)};const s=e},261586:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(476943);const e=function(d,i,a){this.init(d,i,a)},s=e.prototype;s.init=function(d,i,a){this.measureData=d,this.voiceIdx=i,this.noteIdx=a},s.checkVoiceIdx=function(){this.checkLeftVoiceIdx(),this.checkRightVoiceIdx()},s.checkLeftVoiceIdx=function(){this.getLeftMeasure().checkVoiceIdx(this.voiceIdx)},s.checkRightVoiceIdx=function(){this.getRightMeasure().checkVoiceIdx(this.voiceIdx)},s.checkNoteIdx=function(){this.checkLeftNoteIdx(),this.checkRightNoteIdx()},s.checkLeftNoteIdx=function(){const d=this.getLeftVoice(),i=this.getLeftNoteIdx();d.checkNoteIdx(i)},s.checkRightNoteIdx=function(){const d=this.getRightVoice(),i=this.getRightNoteIdx();d.checkNoteIdx(i)},s.isLeftRest=function(){const d=this.getLeftVoice(),i=this.getLeftNoteIdx();return d.isRest(i)},s.isRightRest=function(){const d=this.getRightVoice(),i=this.getRightNoteIdx();return d.isRest(i)},s.getLeftChord=function(){const d=this.getLeftVoice(),i=this.getLeftNoteIdx(),a=d.getChord(i);return f.default.makeArray(a)},s.hasRightGrace=function(){const d=this.getRightVoice(),i=this.getRightNoteIdx();return d.hasGrace(i)},s.getRightChord=function(){const d=this.getRightVoice(),i=this.getRightNoteIdx(),a=d.getChord(i);return f.default.makeArray(a)},s.getLeftNoteIdx=function(){return this.hasLeftOverflow()?this.getPreviousVoiceSize()-1:this.noteIdx},s.getPreviousVoiceSize=function(){return this.getPreviousVoice().size()},s.getRightNoteIdx=function(){return this.hasRightOverflow()?0:this.noteIdx+1},s.hasLeftVoice=function(){return this.hasLeftOverflow()?this.hasPreviousVoice():this.hasVoice()},s.hasPreviousVoice=function(){return this.getPreviousMeasure().hasVoice(this.voiceIdx)},s.hasRightVoice=function(){return this.hasRightOverflow()?this.hasNextVoice():this.hasVoice()},s.hasNextVoice=function(){return this.getNextMeasure().hasVoice(this.voiceIdx)},s.hasVoice=function(){return this.measureData.hasVoice(this.voiceIdx)},s.getLeftVoice=function(){return this.hasLeftOverflow()?this.getPreviousVoice():this.getVoice()},s.getPreviousVoice=function(){return this.getPreviousMeasure().getVoice(this.voiceIdx)},s.hasLeftOverflow=function(){return this.noteIdx===-1},s.getRightVoice=function(){return this.hasRightOverflow()?this.getNextVoice():this.getVoice()},s.hasRightOverflow=function(){const d=this.getVoiceSize();return this.noteIdx+1===d},s.getVoiceSize=function(){return this.getVoice().size()},s.getNextVoice=function(){return this.getNextMeasure().getVoice(this.voiceIdx)},s.getVoice=function(){return this.measureData.getVoice(this.voiceIdx)},s.getRightMeasureIdx=function(){return this.getRightMeasure().getIdx()},s.getRightMeasure=function(){let d;return this.hasRightOverflow()?d=this.getNextMeasure():d=this.getMeasure(),d},s.getLeftMeasureIdx=function(){return this.getLeftMeasure().getIdx()},s.getLeftMeasure=function(){let d;return this.hasLeftOverflow()?d=this.getPreviousMeasure():d=this.getMeasure(),d},s.getPreviousMeasure=function(){return this.measureData.getPreviousMeasure()},s.getNextMeasure=function(){return this.measureData.getNextMeasure()},s.getMeasure=function(){return this.measureData};const c=e},263857:(O,A,t)=>{t.d(A,{A:()=>g});var f=t(726042),e=t(701387),s=t(346797);const d=function(E,D){const p=E.getTempoChanges(D).map(s.A.getDpq);let m=1;return m=p.reduce(f.default.lcm,m),m};var i=t(952818);const a=function(E,D,M){E.getTempoChanges(D).forEach(o,M)},o=function(E){const D=this.valueOf(),M=i.A.getDpq(E),p=D/M;let m=i.A.getTimePos(E);m*=p,i.A.setTimePos(E,m),i.A.setDpq(E,D)},r=a,n=function(E,D){E.getTempoChanges(D).forEach(u)},u=function(E){let D=i.A.getTimePos(E),M=i.A.getDpq(E);const p=f.default.gcd(D,M);D/=p,M/=p,i.A.setTimePos(E,D),i.A.setDpq(E,M)},l=n;var h=t(59443);const P=function(E,D,M){l(E,M);const p=d(E,M),m=e.default.getDpq(D),v=f.default.lcm(p,m),U=v/m;new h.A(D).multiplyDivisions(U),r(E,M,v)},T=function(E,D){D.forEach(_,E)},_=function(E,D){P(this,E,D)},g=T},269352:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(342023);const e=f.default},272388:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(446921),e=t(701387),s=t(35802),c=t(104907);function d(a){const o=f.A.getFirstMeasure(a);i(o)}function i(a){const o=e.default.getOwnAttributes(a),r=s.default.getNbStaves(o);if(r===1)return;let n=s.default.getStaffDetails(o);if(!n.some(c.default.hasKodaly))return;const u=s.default.getWrappedStaffDetailsOrDefault(o,r);for(let l=0;l<r;l++){let h=u.getEntry(l);h=c.default.copy(h),c.default.removeKodaly(h),u.setEntry(h,l)}n=u.dumpAttribute(),s.default.setStaffDetails(o,n)}},272778:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(843678),e=t(701387),s=t(35802),c=t(579102),d=t(838603);function i(u){const[l]=u,h=e.default.getNbStaves(l),I=a(h);u.forEach(o,I)}function a(u){const l={};for(let h=0;h<u;h++)l[h]=null;return l}function o(u){const l=this;e.default.getAllRawAttributes(u).forEach(r,l),n(u,l)}function r(u){const l=this,h=f.default.getSize(l),I=s.default.getWrappedMeasureStyle(u,h);for(let P=0;P<h;P++){if(!I.hasEntry(P))continue;const T=I.getEntry(P);if(!c.A.hasMeasureRepeat(T))continue;const _=c.A.getMeasureRepeat(T);d.A.isStart(_)?l[P]=d.A.copy(_):l[P]=null}}function n(u,l){const h=e.default.getNbStaves(u);for(let I=0;I<h;I++)if(l[I]!==null){const P=d.A.copy(l[I]);e.default.setMeasureRepeat(u,I,P)}}},273885:(O,A,t)=>{t.d(A,{A:()=>Nt});var f=t(364842),e=t(911066),s=t(756710),c=t(365340),d=t(951066);function i(j){return`millimeters scaling value [${j}] is invalid. It has to be a number strictly positive. `}class a extends d.A{constructor(ot){const et=i(ot);super(et),Object.defineProperty(this,"millimeters",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadMillimetersScalingError",this.millimeters=ot}}function o(j){return`tenths scaling value [${j}] is invalid. It has to be a number strictly positive. `}class r extends d.A{constructor(ot){const et=o(ot);super(et),Object.defineProperty(this,"tenths",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadTenthsScalingError",this.tenths=ot}}const n={};n.create=function(j,ot){n.check(j,ot);const et={};return n.set(et,j,ot),et},n.set=function(j,ot,et){n.check(ot,et),j.millimeters=ot.toString(),j.tenths=et.toString()},n.isComplete=function(j){const ot=n.getMillimeters(j),et=n.getTenths(j);return n.isValidMillimeters(ot)&&n.isValidTenths(et)},n.check=function(j,ot){n.checkMillimeters(j),n.checkTenths(ot)},n.checkMillimeters=function(j){if(!n.isValidMillimeters(j))throw new a(j)},n.isValidMillimeters=function(j){return u(j)},n.checkTenths=function(j){if(!n.isValidTenths(j))throw new r(j)},n.isValidTenths=function(j){return u(j)};const u=function(j){return!Number.isNaN(j)&&j>0};n.getMillimeters=function(j){return parseFloat(j.millimeters)},n.getTenths=function(j){return parseFloat(j.tenths)},n.toMillimeters=function(j,ot){const et=n.getMillimeters(j),Tt=n.getTenths(j);return ot*et/Tt},n.toTenths=function(j,ot){const et=n.getMillimeters(j),Tt=n.getTenths(j);return ot*Tt/et};const l=n;var h=t(868224),I=t(615898),P=t(493596),T=t(291539),_=t(22260),g=t(891959),E=t(15049),D=t(475672),M=t(398738),p=t(843678),m=t(914390),v=t(851653),U=t(571349);const x="music-font",S="$font-family",K="Century Schoolbook L",H="normal",Y="normal",C=p.default.fromPairs([{key:M.default.LYRICS,value:{"$font-family":"Century Schoolbook L","$font-weight":"normal","$font-style":"normal","$font-size":"2.22sp"}},{key:M.default.TITLE,value:{"$font-family":"Century Schoolbook L","$font-weight":"normal","$font-style":"normal","$font-size":"24"}},{key:M.default.SUBTITLE,value:{"$font-family":"Century Schoolbook L","$font-weight":"normal","$font-style":"normal","$font-size":"14"}},{key:M.default.RIGHTS,value:{"$font-family":"Century Schoolbook L","$font-weight":"normal","$font-style":"normal","$font-size":"9"}},{key:M.default.COMPOSER,value:{"$font-family":"Century Schoolbook L","$font-weight":"normal","$font-style":"normal","$font-size":"10"}},{key:M.default.LYRICIST,value:{"$font-family":"Century Schoolbook L","$font-weight":"normal","$font-style":"normal","$font-size":"10"}},{key:M.default.ARRANGER,value:{"$font-family":"Century Schoolbook L","$font-weight":"normal","$font-style":"normal","$font-size":"10"}},{key:M.default.HARMONY,value:{"$font-family":"Century Schoolbook L","$font-weight":"normal","$font-style":"normal","$font-size":"2.8sp"}},{key:M.default.REHEARSAL,value:{"$font-family":"Century Schoolbook L","$font-weight":"normal","$font-style":"normal","$font-size":"2.6sp"}},{key:M.default.WORD,value:{"$font-family":"Century Schoolbook L","$font-weight":"normal","$font-style":v.A.ITALIC,"$font-size":"1.92sp"}},{key:M.default.PART_NAME,value:{"$font-family":"Century Schoolbook L","$font-weight":U.A.NORMAL,"$font-style":v.A.NORMAL,"$font-size":"3sp"}},{key:M.default.PAGE_NUMBER,value:{"$font-family":"Century Schoolbook L","$font-weight":U.A.NORMAL,"$font-style":v.A.NORMAL,"$font-size":"12"}},{key:M.default.MEASURE_NUMBER,value:{"$font-family":"Century Schoolbook L","$font-weight":U.A.NORMAL,"$font-style":v.A.NORMAL,"$font-size":"2sp"}},{key:M.default.PIZZICATO,value:{"$font-family":"Century Schoolbook L","$font-weight":U.A.NORMAL,"$font-style":v.A.ITALIC,"$font-size":"1.92sp"}},{key:M.default.TEMPO,value:{"$font-family":"Century Schoolbook L","$font-weight":U.A.NORMAL,"$font-style":v.A.NORMAL,"$font-size":"2.75sp"}},{key:M.default.FRET_NUMBER,value:{"$font-family":"Century Schoolbook L","$font-weight":U.A.NORMAL,"$font-style":v.A.NORMAL,"$font-size":"2sp"}}]),y=p.default.fromPairs([{key:M.default.GLOBAL,value:"word-font"},{key:M.default.LYRICS,value:"lyric-font"},{key:M.default.TITLE,value:"$adagio-title-font"},{key:M.default.SUBTITLE,value:"$adagio-subtitle-font"},{key:M.default.RIGHTS,value:"$adagio-rights-font"},{key:M.default.COMPOSER,value:"$adagio-composer-font"},{key:M.default.LYRICIST,value:"$adagio-lyricist-font"},{key:M.default.ARRANGER,value:"$adagio-arranger-font"},{key:M.default.HARMONY,value:"$adagio-harmony-font"},{key:M.default.REHEARSAL,value:"$adagio-rehearsal-font"},{key:M.default.WORD,value:"$adagio-word-font"},{key:M.default.PART_NAME,value:"$adagio-partName-font"},{key:M.default.PAGE_NUMBER,value:"$adagio-pageNumber-font"},{key:M.default.MEASURE_NUMBER,value:"$adagio-measureNumber-font"},{key:M.default.PIZZICATO,value:"$adagio-pizzicato-font"},{key:M.default.TEMPO,value:"$adagio-tempo-font"},{key:M.default.FRET_NUMBER,value:"$adagio-fretNumber-font"}]),N=function(j){j.getMusicFont=function(et){return j.hasMusicFont(et)?et[x][S]:D.A.DEFAULT},j.hasMusicFont=function(et){return typeof et[x]!="undefined"&&typeof et[x][S]=="string"},j.setMusicFont=function(et,Tt){const Lt={};Lt[S]=Tt,et[x]=Lt},j.getTextTypeFontFamily=function(et,Tt){return j.getTextTypeFontValue(et,Tt,m.default.hasFontFamily,m.default.getFontFamily)},j.getTextTypeFontStyle=function(et,Tt){return j.getTextTypeFontValue(et,Tt,m.default.hasFontStyle,m.default.getFontStyle)},j.getTextTypeFontWeight=function(et,Tt){return j.getTextTypeFontValue(et,Tt,m.default.hasFontWeight,m.default.getFontWeight)},j.getGlobalFontFamily=function(et){const Tt=j.getGlobalFontEntry(et);return m.default.hasFontFamily(Tt)?m.default.getFontFamily(Tt):K},j.getGlobalFontWeight=function(et){const Tt=j.getGlobalFontEntry(et);return m.default.hasFontWeight(Tt)?m.default.getFontWeight(Tt):H},j.getGlobalFontStyle=function(et){const Tt=j.getGlobalFontEntry(et);return m.default.hasFontStyle(Tt)?m.default.getFontStyle(Tt):Y},j.getTextTypeFontSize=function(et,Tt){const Lt=m.default.hasFontSize,Vt=m.default.getFontSize,bt=j.getDefaultFontEntry(Tt),Ut=j.getFontEntry(et,Tt);if(Lt(Ut))return Vt(Ut);if(Lt(bt))return Vt(bt);throw new f.default("No value available ")},j.getTextTypeFontValue=function(et,Tt,Lt,Vt){const bt=j.getDefaultFontEntry(Tt),Ut=j.getGlobalFontEntry(et,Tt),Xt=j.getFontEntry(et,Tt);if(Lt(Xt))return Vt(Xt);if(Lt(Ut))return Vt(Ut);if(Lt(bt))return Vt(bt);throw new f.default("No value available ")},j.getDefaultFontEntry=function(et){if(typeof C[et]!="undefined")return C[et];M.default.raiseError(et)},j.getGlobalFontEntry=function(et,Tt){return Tt===M.default.HARMONY?{}:j.getFontEntry(et,M.default.GLOBAL)},j.removeFontEntry=function(et,Tt){const Lt=ot(Tt);delete et[Lt]},j.getFontEntry=function(et,Tt){if(j.hasFontEntry(et,Tt)){const Lt=ot(Tt);return et[Lt]}else return{}},j.hasFontEntry=function(et,Tt){const Lt=ot(Tt);return typeof et[Lt]!="undefined"},j.setFontEntry=function(et,Tt,Lt){const Vt=ot(Tt);et[Vt]=Lt};function ot(et){if(typeof y[et]!="undefined")return y[et];M.default.raiseError(et)}};var G=t(183820),nt=t(399564),J=Object.defineProperty,V=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,dt=(j,ot,et)=>ot in j?J(j,ot,{enumerable:!0,configurable:!0,writable:!0,value:et}):j[ot]=et,at=(j,ot)=>{for(var et in ot||(ot={}))W.call(ot,et)&&dt(j,et,ot[et]);if(V)for(var et of V(ot))Z.call(ot,et)&&dt(j,et,ot[et]);return j};const B={},gt="$adagio-notesSpacing",lt="$adagio-systemBreakPolicy",X="$adagio-measureNumberingPolicy",k="$adagio-hideEmptyParts",L="$adagio-hasPickupShift",$="$adagio-displayMode",ut="staff-layout",w="system-layout",st="$adagio-tempoMarkDisplayed",tt="$adagio-pageNumberingStart",it="$adagio-measureNumberingStart",It="$adagio-jazzChordDisplay",xt="$adagio-notesColorMode",Ot=1.25,St=!1;B.DEFAULT_TEMPO_MARK_VISIBILITY=!0,N(B),B.getStaffDistance=function(j){const ot=B.getStaffLayout(j);return T.A.getDistance(ot)},B.setStaffDistance=function(j,ot){const et=B.getStaffLayout(j);T.A.setDistance(et,ot),B.setStaffLayout(j,et)},B.getStaffLayout=function(j){return B.hasStaffLayout(j)?c.default.getSingle(j,ut):{}},B.hasStaffLayout=function(j){return c.default.hasArrayNotEmpty(j,ut)},B.setStaffLayout=function(j,ot){j[ut]=ot},B.getSystemDistance=function(j){const ot=B.getSystemLayout(j);return _.A.getDistance(ot)},B.setSystemDistance=function(j,ot){const et=B.getSystemLayout(j);_.A.setDistance(et,ot),B.setSystemLayout(j,et)},B.getSystemLayout=function(j){return B.hasSystemLayout(j)?c.default.getSingle(j,w):{}},B.hasSystemLayout=function(j){return c.default.hasArrayNotEmpty(j,w)},B.setSystemLayout=function(j,ot){j[w]=ot},B.setNotesSpacingCoeff=function(j,ot){j[gt]=ot},B.getNotesSpacingCoeff=function(j){return B.hasNotesSpacingCoeff(j)?j[gt]:Ot},B.hasNotesSpacingCoeff=function(j){return typeof j[gt]!="undefined"},B.setMeasureNumberingPolicy=function(j,ot){j[X]=ot},B.getMeasureNumberingPolicy=function(j){return B.hasMeasureNumberingPolicy(j)?j[X]:g.A.DEFAULT},B.hasMeasureNumberingPolicy=function(j){return typeof j[X]!="undefined"},B.setHideEmptyParts=function(j,ot){j[k]=ot},B.getHideEmptyParts=function(j){return B.hasHideEmptyParts(j)?j[k]:E.A.DEFAULT},B.hasHideEmptyParts=function(j){return typeof j[k]!="undefined"},B.setSystemBreakPolicy=function(j,ot){j[lt]=ot},B.getSystemBreakPolicy=function(j){return B.hasSystemBreakPolicy(j)?j[lt]:P.A.createDefault()},B.hasPickupShiftValue=function(j){return typeof j[L]!="undefined"},B.setHasPickupShift=function(j,ot){j[L]=ot},B.hasPickupShift=function(j){return B.hasPickupShiftValue(j)?j[L]:St},B.hasSystemBreakPolicy=function(j){return typeof j[lt]!="undefined"},B.hasScaling=function(j){return typeof j.scaling!="undefined"&&l.isComplete(j.scaling)},B.setScaling=function(j,ot,et){if(!B.hasScaling(j))j.scaling=l.create(ot,et);else{const Tt=B.getScaling(j);l.set(Tt,ot,et)}},B.getScaling=function(j){return j.scaling},B.getMillimetersScaling=function(j){const ot=B.getScaling(j);return l.getMillimeters(ot)},B.getTenthsScaling=function(j){const ot=B.getScaling(j);return l.getTenths(ot)},B.scaleToTenths=function(j,ot){B.checkHasScaling(j);const et=B.getScaling(j);return l.toTenths(et,ot)},B.scaleToMillimeters=function(j,ot){B.checkHasScaling(j);const et=B.getScaling(j);return l.toMillimeters(et,ot)},B.checkHasScaling=function(j){if(!B.hasScaling(j)){const ot="Cannot take parameters as millimeters whithout scaling informations";throw new f.default("ScalingMissing",ot)}},B.getOrCreatePageLayout=function(j){return B.hasPageLayout(j)||B.createPageLayout(j),B.getPageLayout(j)},B.createPageLayout=function(j){j["page-layout"]={}},B.hasPageLayout=function(j){return typeof j["page-layout"]!="undefined"},B.getPageLayout=function(j){return j["page-layout"]},B.setPageSizeAsMillimeters=function(j,ot,et){ot=B.scaleToTenths(j,ot),et=B.scaleToTenths(j,et);const Tt=B.getOrCreatePageLayout(j);h.A.setPageSize(Tt,ot,et)},B.getPageWidthAsMillimeters=function(j){const ot=B.getPageWidth(j);return B.scaleToMillimeters(j,ot)},B.getPageWidth=function(j){const ot=B.getPageLayout(j);return h.A.getWidth(ot)},B.getPageHeightAsMillimeters=function(j){const ot=B.getPageHeight(j);return B.scaleToMillimeters(j,ot)},B.getPageHeight=function(j){const ot=B.getPageLayout(j);return h.A.getHeight(ot)},B.getPageUsableSize=function(j,ot){let et;if(ot===I.A.TYPE_EVEN)et=B.getEvenPageMargins(j);else if(ot===I.A.TYPE_ODD)et=B.getOddPageMargins(j);else{const Vt=`The margin type [${ot}] is invalid.`;throw new f.default("BadMarginType",Vt)}let Tt=B.getPageWidth(j);Tt-=I.A.getLeft(et),Tt-=I.A.getRight(et);let Lt=B.getPageHeight(j);return Lt-=I.A.getTop(et),Lt-=I.A.getBottom(et),{width:Tt,height:Lt}},B.hasPageSize=function(j){if(!B.hasPageLayout(j))return!1;const ot=B.getPageLayout(j);return h.A.hasPageSize(ot)},B.setPageTopMarginMillimeters=function(j,ot,et){ot=B.scaleToTenths(j,ot);const Tt=B.getOrCreatePageLayout(j);h.A.setTopMargin(Tt,ot,et)},B.setPageBottomMarginMillimeters=function(j,ot,et){ot=B.scaleToTenths(j,ot);const Tt=B.getOrCreatePageLayout(j);h.A.setBottomMargin(Tt,ot,et)},B.setPageLeftMarginMillimeters=function(j,ot,et){ot=B.scaleToTenths(j,ot);const Tt=B.getOrCreatePageLayout(j);h.A.setLeftMargin(Tt,ot,et)},B.setPageRightMarginMillimeters=function(j,ot,et){ot=B.scaleToTenths(j,ot);const Tt=B.getOrCreatePageLayout(j);h.A.setRightMargin(Tt,ot,et)},B.getOddPageTopMarginAsMillimeters=function(j){const ot=B.getOddPageTopMargin(j);return B.scaleToMillimeters(j,ot)},B.getOddPageTopMargin=function(j){const ot=B.getOddPageMargins(j);return I.A.getTop(ot)},B.getOddPageBottomMarginAsMillimeters=function(j){const ot=B.getOddPageBottomMargin(j);return B.scaleToMillimeters(j,ot)},B.getOddPageBottomMargin=function(j){const ot=B.getOddPageMargins(j);return I.A.getBottom(ot)},B.getOddPageLeftMarginAsMillimeters=function(j){const ot=B.getOddPageLeftMargin(j);return B.scaleToMillimeters(j,ot)},B.getOddPageLeftMargin=function(j){const ot=B.getOddPageMargins(j);return I.A.getLeft(ot)},B.getOddPageRightMarginAsMillimeters=function(j){const ot=B.getOddPageRightMargin(j);return B.scaleToMillimeters(j,ot)},B.getOddPageRightMargin=function(j){const ot=B.getOddPageMargins(j);return I.A.getRight(ot)},B.getOddPageMargins=function(j){const ot=B.getOrCreatePageLayout(j);return h.A.getMarginsForOddOrDefault(ot)},B.getEvenPageTopMarginAsMillimeters=function(j){const ot=B.getEvenPageTopMargin(j);return B.scaleToMillimeters(j,ot)},B.getEvenPageTopMargin=function(j){const ot=B.getEvenPageMargins(j);return I.A.getTop(ot)},B.getEvenPageBottomMarginAsMillimeters=function(j){const ot=B.getEvenPageBottomMargin(j);return B.scaleToMillimeters(j,ot)},B.getEvenPageBottomMargin=function(j){const ot=B.getEvenPageMargins(j);return I.A.getBottom(ot)},B.getEvenPageLeftMarginAsMillimeters=function(j){const ot=B.getEvenPageLeftMargin(j);return B.scaleToMillimeters(j,ot)},B.getEvenPageLeftMargin=function(j){const ot=B.getEvenPageMargins(j);return I.A.getLeft(ot)},B.getEvenPageRightMarginAsMillimeters=function(j){const ot=B.getEvenPageRightMargin(j);return B.scaleToMillimeters(j,ot)},B.getEvenPageRightMargin=function(j){const ot=B.getEvenPageMargins(j);return I.A.getRight(ot)},B.getEvenPageMargins=function(j){const ot=B.getOrCreatePageLayout(j);return h.A.getMarginsForEvenOrDefault(ot)},B.isDisplayModeEnabled=function(j,ot){return typeof j[$]=="undefined"?!1:!!j[$][ot]},B.setDisplayMode=function(j,ot,et){typeof j[$]=="undefined"&&(j[$]={}),j[$][ot]=et},B.getNotesColorMode=function(j){return typeof j[xt]=="undefined"?null:j[xt]},B.setNotesColorMode=function(j,ot){j[xt]=ot},B.getNotesColorModeOrDefault=function(j){const ot=B.getNotesColorMode(j),et=B.isDisplayModeEnabled(j,e.A.BOOMWHACKERS_COLOR);return!ot&&et?nt.A.create(s.A.BOOMWHACKER):ot||nt.A.create(s.A.NORMAL)},B.getJazzChordPartDisplay=function(j,ot){return typeof j[It]=="undefined"||typeof j[It][ot]=="undefined"?null:j[It][ot]},B.setJazzChordPartDisplay=function(j,ot,et){typeof j[It]=="undefined"&&(j[It]={}),et!==null?j[It][ot]=et:delete j[It][ot]},B.getJazzChordPartConfigOrDefault=function(j){const ot=B.getJazzChordPartDefaultConfig(j),et=B.getJazzChordPartConfig(j);return Object.assign(ot,et)},B.getJazzChordPartDefaultConfig=function(j){return B.isDisplayModeEnabled(j,e.A.JAZZ_CHORD_SYMBOLS)?G.A.getSymbolChordConfig():G.A.getTextChordConfig()},B.getJazzChordPartConfig=function(j){return typeof j[It]=="undefined"?{}:at({},j[It])},B.setTempoMarkVisibility=function(j,ot){j[st]=ot},B.isTempoMarkVisible=function(j){return typeof j[st]!="undefined"?j[st]:B.DEFAULT_TEMPO_MARK_VISIBILITY},B.setPageNumberingStart=function(j,ot){j[tt]=ot},B.hasPageNumberingStart=function(j){return typeof j[tt]!="undefined"},B.getPageNumberingStart=function(j){return j[tt]},B.removePageNumberingStart=function(j){delete j[tt]},B.setMeasureNumberingStart=function(j,ot){j[it]=ot},B.hasMeasureNumberingStart=function(j){return typeof j[it]!="undefined"},B.getMeasureNumberingStart=function(j){return j[it]},B.removeMeasureNumberingStart=function(j){delete j[it]};const Nt=B},275212:(O,A,t)=>{t.d(A,{A:()=>I});const f=function(P,T,_){if(P.length!==_)return!1;const g={usedVoices:{},voiceMapping:T};return P.every(e,g)},e=function(P,T){const _=this,g=P.mainVoiceIdx;return P.voices.includes(g)?(_.staffIdx=T,P.voices.every(s,_)):!1},s=function(P){const T=this;return typeof T.voiceMapping[P]=="undefined"||T.voiceMapping[P][0]!==T.staffIdx||typeof T.usedVoices[P]!="undefined"?!1:(T.usedVoices[P]=!0,!0)},c=f;var d=t(383279),i=t(446921);const o=function(P,T){if(d.default.hasStaffMapping(P)){const _=d.default.getStaffMapping(P),g=d.default.getVoiceMapping(P),E=i.A.getNbStaves(T);return!c(_,g,E)}else return!0};var r=t(424104);const u=function(P,T){if(o(P,T)){const _=(0,r.A)(P,T);d.default.setStaffMapping(P,_)}},l=function(P,T){P.forEach(h,T)},h=function(P,T){const g=this[T];u(P,g)},I=l},275408:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(669038),e=t(483139),s=t(213489),c=t(813864);const i=function(a,o){if(a=(0,c.A)(a),typeof o.stopPartUuid!="undefined")if(a.hasPartUuid(o.stopPartUuid))o.stopPartIdx=a.getPartIdxFromUuid(o.stopPartUuid),delete o.stopPartUuid;else throw new f.A(o.stopPartUuid,f.A.GET);if(typeof o.stopMeasureUuid!="undefined")if(a.hasMeasureUuid(o.stopMeasureUuid))o.stopMeasureIdx=a.getMeasureIdxFromUuid(o.stopMeasureUuid),delete o.stopMeasureUuid;else throw new e.A(o.stopMeasureUuid,e.A.GET);if(typeof o.stopVoiceUuid!="undefined")if(a.hasPartVoiceUuid(o.stopPartIdx,o.stopVoiceUuid))o.stopVoiceIdx=a.getPartVoiceIdxFromUuid(o.stopPartIdx,o.stopVoiceUuid),delete o.stopVoiceUuid;else throw new s.default(o.stopVoiceUuid,s.default.GET)}},275844:(O,A,t)=>{t.d(A,{A:()=>f});function f(s,c,d){let i=d;for(;!e(i,s,c);)i++;return c[i]=!0,i}function e(s,c,d){return typeof c[s]=="undefined"&&typeof d[s]=="undefined"}},276885:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(721247),e=t(701387),s=t(21738),c=t(131220),d=t(665280),i=t(364842);function a(o,r){if((0,s.default)(o,r),(0,c.default)(o,r),(0,d.default)(o,r),r.timePos===0){if(r.measureIdx===0)throw new i.default("BadMeasureIdx","Cannot call `fetchPreviousClef` at the begining of the first measure.");r.measureIdx--}const n=o.getMeasure(r.partIdx,r.measureIdx);let l=e.default.getWrappedClef(n).getEntry(r.staffIdx);const h=e.default.getDpq(n);let I;r.timePos===0?I=e.default.getNbDivisions(n):I=r.timePos*h/r.dpq;const P=e.default.getMiddleClefs(n,r.staffIdx);for(const T of P)if(f.default.getTimePos(T)<I)l=T;else return l;return l}},280958:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(701387),e=t(104907),s=t(123491),c=t(860716),d=t(476943),i=t(955154),a=t(832560),o=t(351277),r=t(35802);function n(P){const T=f.default.getAttributes(P),_=r.default.getStaffDetails(T)[0];if(!e.default.hasStaffTuning(_)||!f.default.getNotes(P).some(u))return;const E=this,D=new a.A(P),M={measureData:D,tmpContent:E};D.getVoicesIndexes().forEach(m=>{const v=D.getVoice(m),U=v.getNbNotes();for(let x=0;x<U;x++){if(v.isRest(x))continue;let S=v.getChord(x);S=d.default.makeArray(S),S=S.slice(),S.sort(l),S.reverse(),S.forEach(h,M)}})}function u(P){if(!s.default.hasHarmonic(P))return!1;const T=s.default.getHarmonic(P);return c.default.getType(T)===i.default.ARTIFICIAL_TOUCHING}function l(P,T){const _=s.default.getPitch(P),g=s.default.getPitch(T);return o.default.naiveComparePitch(_,g)}function h(P,T,_){const{tmpContent:g}=this;if(!s.default.hasHarmonic(P))return;const E=s.default.getHarmonic(P);if(c.default.getType(E)!==i.default.ARTIFICIAL_TOUCHING)return;const M=_.find(I,P);if(!M)return;const p=c.default.create(i.default.ARTIFICIAL_BASE);s.default.setHarmonic(M,p),typeof g.artificialHarmonicBaseNotes=="undefined"&&(g.artificialHarmonicBaseNotes=[]),g.artificialHarmonicBaseNotes.push(M)}function I(P){const T=this;if(s.default.hasHarmonic(P))return!1;const _=s.default.getPitch(P),g=s.default.getPitch(T);return o.default.naiveComparePitch(g,_)>0}},283316:(O,A,t)=>{t.d(A,{A:()=>I});var f=t(364842),e=t(432149),s=t(952818),c=t(889113),d=t(345912),i=t(723631),a=t(372585);const o=function(P){(0,e.A)(P).forEach(r)},r=function(P){P.forEach(n)},n=function(P){P.forEach(function(T){const _=d.A.getPlacement(T),g=d.A.getType(T);g!==a.A.STOP&&!u(_,g)&&l(T)})},u=function(P,T){return P===i.A.ABOVE&&T===a.A.DOWN||P===i.A.BELOW&&T===a.A.UP},l=function(P){const T=d.A.getPlacement(P),_=h(T),g=s.A.getDisplayOctaveShift(P);c.A.setType(g,_)},h=function(P){if(P===i.A.ABOVE)return a.A.DOWN;if(P===i.A.BELOW)return a.A.UP;throw new f.default("Unexpected")},I=o},286116:(O,A,t)=>{t.d(A,{A:()=>U});var f=t(883782),e=t(377180),s=t(737903),c=t(561248),d=t(819795),i=t(701387),a=t(364596),o=t(518558),r=t(721247),n=t(74446),u=t(668674),l=t(21738),h=t(131220),I=t(665280),P=t(832560),T=t(838603);const _=function(x,S){return(0,l.default)(x,S),(0,h.default)(x,S),(0,I.default)(x,S),new g(x,S).get()},g=function(x,S){this.init(x,S)},E=g.prototype;E.init=function(x,S){this.scoreData=x,this.location=S},E.get=function(){const x={},S=this.scoreData.getMeasure(this.location.partIdx,this.location.measureIdx),K=i.default.getNbStaves(S),H=this.location.staffIdx;if(H<0||H>=K)throw new f.default(H,f.default.GET);i.default.hasLeftBarline(S)?x.leftBarline=(0,s.default)(i.default.getLeftBarline(S)):x.leftBarline=null,i.default.hasRightBarline(S)?x.rightBarline=(0,s.default)(i.default.getRightBarline(S)):x.rightBarline=null;const Y=i.default.getWrappedClef(S);x.clef=M(Y.getEntry(H));const C=i.default.getWrappedKey(S);x.key=p(C.getEntry(H));const y=i.default.getWrappedTime(S);x.time=m(y.getEntry(H));const F=i.default.getWrappedTranspose(S);x.transpose=v(F.getEntry(H));const N=this.scoreData.getCommonContent(),G=N.getDisplayedTime(this.location.measureIdx);x.displayedTime=m(G);const nt=N.getBeatsList(this.location.measureIdx);if(x.beatsList=n.default.copy(nt),x.restsInsideBeams=N.hasRestsInsideBeams(this.location.measureIdx),N.hasJumpTag(this.location.measureIdx)?x.jumpTag=N.getJumpTag(this.location.measureIdx):x.jumpTag=null,N.hasJumpCall(this.location.measureIdx)?x.jumpCall=N.getJumpCall(this.location.measureIdx):x.jumpCall=null,N.hasRehearsal(this.location.measureIdx)){const W=N.getRehearsal(this.location.measureIdx);x.rehearsal=c.A.getText(W),x.rehearsalType=c.A.getType(W)}else x.rehearsal=null;if(N.hasSystemBreak(this.location.measureIdx)){const W=N.getSystemBreak(this.location.measureIdx);x.systemBreak=W}else x.systemBreak=null;if(N.hasPageBreak(this.location.measureIdx)){const W=N.getPageBreak(this.location.measureIdx);x.pageBreak=W}else x.pageBreak=null;if(N.hasMultiMeasureRest(this.location.measureIdx)){const W=N.getMultiMeasureRest(this.location.measureIdx);x.multiMeasureRest={nbMeasures:W}}else x.multiMeasureRest=null;if(i.default.hasMeasureRepeat(S,this.location.staffIdx)){const W=i.default.getMeasureRepeat(S,this.location.staffIdx),Z=T.A.getPatternMeasureIdx(W);x.measureRepeat=T.A.copy(W),T.A.setPatternMeasureIdx(x.measureRepeat,Z)}else x.measureRepeat=null;if(i.default.hasSlash(S,this.location.staffIdx)){const W=i.default.getSlash(S,this.location.staffIdx);x.slash=u.A.copy(W)}else x.slash=null;const J=this.scoreData.getPartStaffMapping(this.location.partIdx);x.voicesData=(0,s.default)(J[this.location.staffIdx]),delete x.voicesData.staffUuid;const V=D(this.scoreData,this.location);return x.measureVoicesData=V,x};function D(x,S){const K=x.getMeasure(S.partIdx,S.measureIdx),Y=new P.A(K,null,null,null).getVoicesIndexes();return x.getPartStaffMapping(S.partIdx)[S.staffIdx].voices.filter(N=>Y.includes(N)).map(N=>{const G=x.voiceIdxToIdxInMainStaff(S.partIdx,N),nt=x.getPartVoiceUuid(S.partIdx,N);return{voiceIdx:N,voiceIdxInStaff:G,voiceUuid:nt}})}const M=function(x){return x=(0,s.default)(x),r.default.makeLineExplicit(x),d.A.removeStaffIdx(x),x.line=r.default.getLine(x),x["clef-octave-change"]=r.default.getOctaveChange(x),x},p=function(x){return x=(0,s.default)(x),d.A.removeStaffIdx(x),x.fifths=a.default.getFifths(x),x},m=function(x){return x=(0,s.default)(x),d.A.removeStaffIdx(x),x.beats=o.default.getBeats(x),x["beat-type"]=o.default.getBeatType(x),x},v=function(x){return x=e.default.copy(x),x},U=_},287824:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(364596),s=t(35802);const d=function(i){let a=!1;const o=f.default.getWrappedOwnKey(i),r=o.getNbStaves();for(let n=0;n<r;n++)if(!o.hasEntry(n)){a=!0;const u=e.default.createDefault();o.setEntry(u,n)}if(a){const n=f.default.getOwnAttributes(i),u=o.dumpAttribute();s.default.setKey(n,u),f.default.setOwnAttributes(i,n)}}},288794:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(476943),e=t(701387),s=t(555172);function c(i){let a=e.default.getBarlines(i);a=a.filter(d),e.default.setBarlines(i,a)}function d(i){if(!f.default.isObject(i))return!1;const a=s.A.getStyle(i);if(!s.A.isValidStyle(a))return!1;const o=s.A.getLocation(i);return!!s.A.isValidLocation(o)}},289557:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(259563),e=t(701387),s=t(123491),c=t(365340);const d=new Set(["128th","256th","512th","1024th"]);function i(r){e.default.getNotes(r).forEach(a)}function a(r){if(!s.default.isGraceNote(r)||!c.default.hasStringOrContentOrArray(r.type))return;const n=c.default.stringOrContent(r.type);o(n)&&s.default.setDurationType(r,f.default.SIXTY_FOURTH)}function o(r){return d.has(r)}},290087:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(446921),e=t(832560),s=t(189247);const d=function(i,a,o){const r=i.getPartContent(a),n=f.A.getMeasures(r),u=new s.A(n,a,i),l=i.getMeasure(a,o);return new e.A(l,o,u,i)}},291127:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(123491),s=t(209175);function c(a){const o=f.default.getNotes(a),r={hasTremoloSide:!1};o.forEach(d,r)}function d(a){const o=this;if(e.default.isChord(a)){o.hasTremoloSide&&i(a);return}e.default.hasTremoloSide(a)?(o.hasTremoloSide=!0,i(a)):o.hasTremoloSide=!1}function i(a){let o=e.default.getTimeModif(a),r=s.default.getActual(o);r*=2;const n=s.default.getNormal(o);o=s.default.create(r,n),e.default.setTimeModif(a,o)}},291539:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(996896);const e={},s="staff-distance";e.getDistance=function(d){return e.hasDistance(d)?parseFloat(d[s]):f.A.DEFAULT},e.hasDistance=function(d){const i=parseFloat(d[s]);return f.A.isValid(i)},e.setDistance=function(d,i){d[s]=i.toString()};const c=e},293008:(O,A,t)=>{t.d(A,{A:()=>I});var f=t(443749),e=t(990937),s=t(883782),c=t(646456),d=t(788220),i=t(701387),a=t(726042),o=t(21738),r=t(131220),n=t(665280),u=t(409200),l=t(507004),h=t(189247);function I(g,E){if((0,o.default)(g,E),(0,r.default)(g,E),(0,u.default)(g,E),(0,n.default)(g,E),g.checkPartIdx(E.partIdx),g.checkMeasureIdx(E.measureIdx),typeof E.voiceIdx!="undefined"&&!g.hasPartVoiceIdx(E.partIdx,E.voiceIdx))throw new s.default(E.voiceIdx);const D=g.getMeasure(E.partIdx,E.measureIdx),M=E.staffIdx,p=i.default.getNbStaves(D);if(!a.default.isInteger(M)||M<0||M>=p)throw new f.default(M);{const{timePos:N,dpq:G}=E;if(!a.default.isNumber(N)||N<0||!a.default.isNumber(G)||G<=0)throw new c.A(N,G)}const m=i.default.getWords(D,M),v=i.default.getDpq(D),U=a.default.lcm(v,E.dpq),x=E.timePos*U/E.dpq,S=U/v,K=m.find(P,{searchedTimePos:x,ratio:S});if(!K)throw new e.A(x,U);const H=d.A.getText(K),Y=i.default.getDpq(D),C=d.A.getTimePos(K),y=d.A.getPlacement(K),F={partIdx:E.partIdx,staffIdx:M,measureIdx:E.measureIdx,dpq:Y,timePos:C,text:H,placement:y};if(typeof E.voiceIdx!="undefined"){const N=T(g,E,F);Object.assign(F,N)}return _(F,g),F}function P(g){const{searchedTimePos:E,ratio:D}=this;let M=d.A.getTimePos(g);return M*=D,M===E}function T(g,E,D){const M={searchedVoiceIdx:E.voiceIdx,staffVoicesIndexes:g.getPartStaffVoicesIndexes(E.partIdx,E.staffIdx),measureIdx:E.measureIdx,timePos:D.timePos,dpq:D.dpq},p=g.getPartMeasures(E.partIdx),m=new h.A(p,E.partIdx,g);return(0,l.A)(m,M)}function _(g,E){g.measureUuid=E.getMeasureUuid(g.measureIdx),typeof g.voiceIdx!="undefined"&&(g.voiceUuid=E.getPartVoiceUuid(g.partIdx,g.voiceIdx)),g.partUuid=E.getPartUuid(g.partIdx),g.staffUuid=E.getPartStaffUuid(g.partIdx,g.staffIdx)}},293198:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(589501);const s=function(i){const a=f.default.getNbDivisions(i);let o=f.default.getFiguredBasses(i);o=o.filter(c,a),f.default.setFiguredBasses(i,o)},c=function(i){const a=this.valueOf(),o=e.A.getTimePos(i);return o<0?!1:!(o>=a)},d=s},295714:(O,A,t)=>{t.d(A,{A:()=>M});var f=t(701387),e=t(178295),s=t(952818),c=t(788220);const i=function(p){const m=s.A.getStaffIdx(p),v=s.A.getTimePos(p),U=s.A.getPlacement(p),x=s.A.getWordText(p);return c.A.create(m,U,v,x)},a=function(p){return h().extract(p)},o=function(){this.wordsByStaff=null},r=o.prototype;r.extract=function(p){this.reset(),p.forEach(this.processDirection,this);const m=this.wordsByStaff;return this.wordsByStaff=null,m},r.reset=function(){this.wordsByStaff={}},r.processDirection=function(p){if((0,e.A)(p)){const m=i(p);this.addWord(m)}},r.addWord=function(p){const m=s.A.getStaffIdx(p),v=this.getStaffWords(m),U=s.A.getTimePos(p);n(v,U),v.push(p)},r.getStaffWords=function(p){return typeof this.wordsByStaff[p]=="undefined"&&(this.wordsByStaff[p]=[]),this.wordsByStaff[p]};const n=function(p,m){u(p,m)&&p.pop()},u=function(p,m){if(p.length===0)return!1;{const v=p.length-1,U=p[v];return s.A.getTimePos(U)===m}};let l=null;const h=function(){return l===null&&(l=new o),l},I=a;var P=t(843678),T=t(726042);const _=function(p,m){P.default.forEach(m,g,p)},g=function(p,m){p=T.default.intPart(p);const v=this;f.default.setWords(v,p,m)},E=_,M=function(p){const m=f.default.getRawDirections(p),v=I(m);E(p,v)}},297115:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(788220),s=t(477849);const c=function(o,r){r.text=e.A.getText(o),r.placement=e.A.getPlacement(o)},d={getEntities:f.default.getWords,fillEntity:c},a=function(o,r){return new s.A(o,r,d).get()}},297805:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(35802),s=t(104907);function c(d){const i=f.default.getOwnAttributes(d);if(e.default.getNbStaves(i)!==2)return!1;const r=e.default.getWrappedStaffDetailsOrDefault(i).getEntry(1);return!!s.default.hasStaffTuning(r)}},300389:(O,A,t)=>{t.d(A,{A:()=>_});var f=t(952818),e=t(889113),s=t(372585);const c=function(g){return g=new d(g).group(),g},d=function(g){this.init(g)},i=d.prototype;i.init=function(g){this.wrappedDirections=g,this.ongoingOctaveShifts={},this.previousLocation={},this.grouppedDirections=[]},i.group=function(){return this.wrappedDirections.forEach(this.analyzeOctaveShift,this),this.grouppedDirections},i.analyzeOctaveShift=function(g){const E=g.direction,D=f.A.getDisplayOctaveShift(E),M=e.A.getType(D);s.A.assert(M),M===s.A.CONTINUE||(M===s.A.UP||M===s.A.DOWN?this.startOctaveShift(g):M===s.A.STOP&&this.stopOctaveShift(g))},i.startOctaveShift=function(g){const E=g.direction,D=f.A.getStaffIdx(E);this.addOctaveShiftStart(D,g)},i.addOctaveShiftStart=function(g,E){this.ongoingOctaveShifts[g]=E},i.stopOctaveShift=function(g){const E=g.direction,D=f.A.getStaffIdx(E);if(this.hasOctaveShiftStart(D)){const M=this.getWrappedStart(D),p=M.direction;if(a(p,E)&&!o(M,g)){this.addCompleteOctaveShift(M,g);const m=f.A.getTimePos(E);this.previousLocation[D]={timePos:m,measureIdx:M.measureIdx}}this.discardDirection(D)}},i.hasOctaveShiftStart=function(g){return typeof this.ongoingOctaveShifts[g]!="undefined"},i.getWrappedStart=function(g){return this.ongoingOctaveShifts[g]},i.discardDirection=function(g){delete this.ongoingOctaveShifts[g]};const a=function(g,E){const D=f.A.getPlacement(g),M=f.A.getPlacement(E),p=f.A.getStaffIdx(g),m=f.A.getStaffIdx(E);return D===M&&p===m},o=function(g,E){return g.timePos===E.timePos&&g.measureIdx===E.measureIdx};i.addCompleteOctaveShift=function(g,E){this.grouppedDirections.push(g),this.grouppedDirections.push(E)};const r=c;var n=t(432149),u=t(817066),l=t(537920),h=t(701387),I=t(364842);const P=function(g){const E=g.length;let D=(0,n.A)(g),M=D.map(u.A);M=M.map(r),D=M.map(function(p){return(0,l.A)(p,E)}),D.forEach(T,g)},T=function(g,E){const D=this;if(D.length!==g.length){const M="Array size should be the same.";throw new I.default("NotSameSize",M)}D.forEach(function(M,p){const m=g[p];h.default.setOctaveShifts(M,E,m)})},_=P},305403:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(123491),s=t(50060);function c(a){f.default.getNotes(a).forEach(d)}function d(a){let o=e.default.getLyrics(a);const r={};o=o.filter(i,r),e.default.setLyrics(a,o)}function i(a){const o=this,r=s.default.getLevel(a);return o[r]===!0?!1:(o[r]=!0,!0)}},306136:(O,A,t)=>{t.d(A,{A:()=>h});var f=t(718477),e=t(701387),s=t(614653),c=t(377180),d=t(529355),i=t(681670),a=t(359363),o=t(726042),r=t(21738),n=t(131220);const u=function(I,P){(0,r.default)(I,P),(0,n.default)(I,P),I.checkPartIdx(P.partIdx),I.checkMeasureIdx(P.measureIdx);const T=I.getMeasure(P.partIdx,P.measureIdx),_=e.default.getNbJazzHarmonies(T),g=P.harmonyIdx;if(!o.default.isInteger(g)||g<0||g>=_)throw new f.A(g);const D=e.default.getJazzHarmonies(T)[g];let M=s.default.getRoot(D);M=d.A.copy(M);const p=s.default.getKindValue(D);let m=null;s.default.hasBass(D)&&(m=s.default.getBass(D),m=i.A.copy(m));let v=s.default.getDegrees(D);v=a.A.copy(v);const U={root:M,kind:p,bass:m,degrees:v};return l(U,T,P.isConcertPitch),U},l=function(I,P,T){if(!T)return;const _=e.default.getTranspose(P)[0];c.default.isUnison(_)||(I.root=d.A.transpose(I.root,_),I.bass!==null&&(I.bass=i.A.transpose(I.bass,_)))},h=u},309357:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(364842);const s=function(c,d,i){const o=i.getNoteBefore(c)+1;let r=d[o];if(typeof r=="undefined"&&(r=d[o-1]),typeof r=="undefined"){const n=`There is no time position mapping for the absolute note index [${r}]. `;throw new f.default("",n)}if(i.hasOffset(c)){const n=i.getOffsetValue(c);r+=n}i.setTimePos(c,r)}},309682:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(193272),e=t(476943),s=t(365340);const c={};c.setText=function(i,a){i["credit-words"]=a},c.getFontSize=function(i){const a=c.getCreditWords(i);if(!e.default.isObject(a)||typeof a["$font-size"]!="string")return 0;const o=parseFloat(a["$font-size"]);return Number.isNaN(o)?0:o},c.getText=function(i){const a=c.getCreditWords(i);return typeof a=="undefined"?"":s.default.stringOrContent(a)},c.getMultiLinesText=function(i){let a=s.default.getArray(i,"credit-words");return a=a.filter(s.default.hasStringOrContent),a=a.map(s.default.stringOrContent),a},c.getCreditWords=function(i){return s.default.getArray(i,"credit-words").find(s.default.hasStringOrContent)},c.isTitle=function(i){return c.isType(i,f.A.TITLE)},c.isSubtitle=function(i){return c.isType(i,f.A.SUBTITLE)},c.isRights=function(i){return c.isType(i,f.A.RIGHTS)},c.isComposer=function(i){return c.isType(i,f.A.COMPOSER)},c.isLyricist=function(i){return c.isType(i,f.A.LYRICIST)},c.isArranger=function(i){return c.isType(i,f.A.ARRANGER)},c.isType=function(i,a){return c.getType(i)===a},c.getType=function(i){return i["credit-type"]},c.hasNoType=function(i){return!c.hasType(i)},c.hasType=function(i){return typeof i["credit-type"]!="undefined"},c.createTitle=function(i){return c.create(i,f.A.TITLE)},c.createSubtitle=function(i){return c.create(i,f.A.SUBTITLE)},c.create=function(i,a){return f.A.assertInternal(a),{"credit-type":a,"credit-words":i}};const d=c},310868:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(364842),e=t(74957),s=t(843678),c=t(381216),d=t(865349);function i(o,r){const n=(0,d.A)(o),u=s.default.fromList(n,e.A.getValue);r.forEach(h=>{const I=e.A.getType(h),P=e.A.getValue(h);if(I===c.A.ADD)u[P]=e.A.copy(h);else if(I===c.A.SUBTRACT)delete u[P];else if(I===c.A.ALTER){const T=e.A.getAlter(h);if(u[P]){const _=u[P];let g=e.A.getAlter(_);g+=T,e.A.setAlter(_,g)}else{const _=e.A.create(P,c.A.ADD,T);u[P]=_}}else throw new f.default(`Invalid degree type: ${I}`)});const l=s.default.getValues(u);return l.sort(a),l}function a(o,r){return o=e.A.getValue(o),r=e.A.getValue(r),o-r}},313633:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(843678),e=t(701387),s=t(35802),c=t(579102),d=t(668674);function i(u){const[l]=u,h=e.default.getNbStaves(l),I=a(h);u.forEach(o,I)}function a(u){const l={};for(let h=0;h<u;h++)l[h]=null;return l}function o(u){const l=this;e.default.getAllRawAttributes(u).forEach(r,l),n(u,l)}function r(u){const l=this,h=f.default.getSize(l),I=s.default.getWrappedMeasureStyle(u,h);for(let P=0;P<h;P++){if(!I.hasEntry(P))continue;const T=I.getEntry(P);if(!c.A.hasSlash(T))continue;const _=c.A.getSlash(T);d.A.isStart(_)?l[P]=d.A.copy(_):l[P]=null}}function n(u,l){const h=e.default.getNbStaves(u);for(let I=0;I<h;I++)if(l[I]!==null){const P=d.A.copy(l[I]);e.default.setSlash(u,I,P),e.default.hasMeasureRepeat(u,I)&&e.default.removeMeasureRepeat(u,I)}}},315417:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(701387),e=t(123491);function s(i){let a=f.default.getNotes(i);a=a.filter(c),f.default.setNotes(i,a)}function c(i){return!d(i)}function d(i){return e.default.isRest(i)&&e.default.isGraceNote(i)}},319330:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(843678);function e(s,c){f.default.forEach(s,function(d,i){Object.keys(i).forEach(function(o){if(o==="default")return;let r=i[o];if(typeof r=="string"){const n=r;if(typeof c[n]=="undefined"){delete i[o];return}const l=Object.keys(c[n])[0];r={midiUnpitched:n,midiProgram:l},i[o]=r}})})}},320496:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(701387),e=t(123491);function s(d){f.default.getNotes(d).forEach(c)}function c(d){e.default.isGraceNote(d)&&e.default.hasDot(d)&&e.default.setNbDots(d,0)}},322422:(O,A,t)=>{t.d(A,{A:()=>s});const f="Flat",e="Flat (TabToXML)";function s(c){const{identification:d}=c;if(typeof d=="undefined")return!0;const{encoding:i}=d;if(typeof i=="undefined")return!0;const{software:a}=i;return typeof a!="string"||a.startsWith(e)?!0:!a.startsWith(f)}},326043:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(343568),e=t(548042),s=t(891921),c=t(726042);const i=function(a,o){const r={};f.A.call(r,a,o);const n=r.measureData;n.checkVoiceIdx(o.voiceIdx);const u=n.getVoice(o.voiceIdx);if(o.voiceIdxRef===o.voiceIdx)return u.checkNoteIdx(o.noteIdxRef),o.noteIdxRef;(0,e.A)(n,o);const l=n.getDpqValue(),h=c.default.lcm(l,o.divisions),I=o.timePos*h/o.divisions,P=h/l;return(0,s.A)(u,P,I)}},327620:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(123491),s=t(209175);function c(a){const o=f.default.getNotes(a),r={hasTremoloSide:!1};o.forEach(d,r)}function d(a){const o=this;if(e.default.isChord(a)){o.hasTremoloSide&&i(a);return}e.default.hasTremoloSide(a)?(o.hasTremoloSide=!0,i(a)):o.hasTremoloSide=!1}function i(a){if(e.default.hasNormalTimeModif(a))return;let o=e.default.getTimeModif(a),r=s.default.getActual(o);r/=2;const n=s.default.getNormal(o);o=s.default.create(r,n),e.default.setTimeModif(a,o)}},329689:(O,A,t)=>{t.d(A,{A:()=>I});var f=t(476943),e=t(123491),s=t(351277),c=t(364596),d=t(595382),i=t(701387),a=t(377180),o=t(21738),r=t(131220),n=t(665280),u=t(409200),l=t(290087),h=t(195446);function I(D,M){if((0,o.default)(D,M),(0,r.default)(D,M),(0,n.default)(D,M),(0,u.default)(D,M),D.checkPartIdx(M.partIdx),D.checkMeasureIdx(M.measureIdx),D.isPartUnpitched(M.partIdx))throw new h.default;const p=P(D,M);let{pitch:m}=M;s.default.check(m),m=d.A.normalize(m,p);const v=d.A.switchEnharmonic(m,p);if(s.default.isSamePitch(m,v)||typeof M.noteIdx=="undefined"||typeof M.voiceIdx=="undefined")return m;const U=T(D,M,m),x=T(D,M,v);return E(x,U)?v:m}function P(D,{partIdx:M,measureIdx:p,staffIdx:m,isConcertPitch:v}){const U=D.getMeasure(M,p);let S=i.default.getWrappedKey(U).getEntry(m);if(!v)return S;const H=i.default.getWrappedTranspose(U).getEntry(m);return a.default.isIdentity(H)||(S=c.default.transpose(S,H)),S}function T(D,M,p){return new _(D,M,p).get()}const _=function(D,M,p){this.init(D,M,p)},g=_.prototype;g.init=function(D,M,p){this.scoreData=D,this.location=M,this.searchedPitch=p,this.done=!1,this.result=null},g.get=function(){this.measureData=(0,l.A)(this.scoreData,this.location.partIdx,this.location.measureIdx),this.measureData.checkVoiceIdx(this.location.voiceIdx),this.initialMeasureData=this.measureData,this.initialKey=this.measureData.getKey(this.location.staffIdx),this.noteIdx=this.location.noteIdx;const D=this.measureData.getVoice(this.location.voiceIdx);return D.checkNoteIdx(this.noteIdx),this.graceIdx=null,typeof this.location.graceIdx!="undefined"&&(this.graceIdx=this.location.graceIdx,D.checkGraceIdx(this.noteIdx,this.graceIdx)),this.seekPreviousSamePitch(),this.result},g.seekPreviousSamePitch=function(){for(this.moveToPreviousNote();!this.done;){const D=this.getVoice();if(!D.isRest(this.noteIdx)){let p=this.getChord(D).map(e.default.getPitch);p=p.map(this.transposeIfNeeded,this),p.some(this.isSamePitch,this)&&(this.result={measureIdx:this.measureData.getIdx(),noteIdx:this.noteIdx,graceIdx:this.graceIdx},this.done=!0),this.done=!0}this.moveToPreviousNote()}},g.isSamePitch=function(D){return s.default.isSamePitch(D,this.searchedPitch)},g.getChord=function(D){let M;return this.graceIdx!==null?M=D.getGraceChord(this.noteIdx,this.graceIdx):M=D.getChord(this.noteIdx),M=f.default.makeArray(M),M},g.transposeIfNeeded=function(D){if(!this.location.isConcertPitch)return D;const M=this.measureData.getTranspose(0);return a.default.isIdentity(M)||(D=s.default.transpose(D,M,!0)),D},g.moveToPreviousNote=function(){const D=this.getVoice();if(this.graceIdx!==null&&this.graceIdx>0){this.graceIdx--;return}if(this.graceIdx===null&&D.hasGrace(this.noteIdx)){this.graceIdx=D.getNbGraces(this.noteIdx)-1;return}this.graceIdx===0&&(this.graceIdx=null),this.noteIdx--,this.noteIdx<0&&this.moveToPreviousMeasure()},g.moveToPreviousMeasure=function(){do if(this.measureData.hasPreviousMeasure()){this.measureData=this.measureData.getPreviousMeasure();const M=this.measureData.getKey(this.location.staffIdx);if(!c.default.isSame(M,this.initialKey)){this.done=!0;return}}else{this.done=!0;return}while(!this.measureData.hasVoice(this.location.voiceIdx));const D=this.getVoice();this.noteIdx=D.getNbNotes()-1},g.getVoice=function(){return this.measureData.getVoice(this.location.voiceIdx)};function E(D,M){return D===null&&M===null||D===null?!1:M===null?!0:D.measureIdx!==M.measureIdx?D.measureIdx>M.measureIdx:D.noteIdx!==M.noteIdx?D.noteIdx>M.noteIdx:D.graceIdx===M.graceIdx?!1:D.graceIdx===null?!0:M.graceIdx===null?!1:D.graceIdx>M.graceIdx}},332573:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(364842);const e={LEFT:"left",RIGHT:"right"};e.values=[e.LEFT,e.RIGHT],e.isValid=function(c){return e.values.includes(c)},e.assert=function(c){e.isValid(c)||e.raiseError(c)},e.isLeft=function(c){return c===e.LEFT},e.isRight=function(c){return c===e.RIGHT},e.raiseError=function(c){const d=`The tempo change location [${c}] is invalid.`;throw new f.default("BadTempoChangeLocation",d)};const s=e},337788:(O,A,t)=>{t.d(A,{A:()=>gt});var f=t(701387),e=t(474072),s=t(364842);const c={LEFT:"left",RIGHT:"right",MIDDLE:"middle",AMBIGUOUS:"ambiguous"};c.raiseError=function(lt){const X=`The attributes location [${lt}] is invalid.`;throw new s.default("BadAttributesLocation",X)};const d=c;var i=t(476943),a=t(123491);const o=function(lt,X){const k=r(X);return lt.reduce(n,k),k.attributesByLocation},r=function(lt){return{attributesByLocation:i.default.pairsToMap([{key:d.LEFT,value:[]},{key:d.RIGHT,value:[]},{key:d.MIDDLE,value:[]},{key:d.AMBIGUOUS,value:[]}]),notes:lt}},n=function(lt,X){const k=lt.notes,L=lt.attributesByLocation,$=u(X,k);return L[$].push(X),lt},u=function(lt,X){if(e.A.isInitial(lt))return d.LEFT;const k=e.A.getNoteBeforeIdx(lt);if(k===X.length-1)return d.RIGHT;const L=X[k],$=X[k+1],ut=a.default.getVoiceIdx(L),w=a.default.getVoiceIdx($);return ut===w?d.MIDDLE:d.AMBIGUOUS},l=o,h=function(lt,X){const k=I(X);return lt.reduce(T,k),k.attributesByLocation},I=function(lt){const X=lt.reduce(P,0);return{attributesByLocation:i.default.pairsToMap([{key:d.LEFT,value:[]},{key:d.RIGHT,value:[]},{key:d.MIDDLE,value:[]},{key:d.AMBIGUOUS,value:[]}]),biggestTimeDuration:X}};function P(lt,X){if(!a.default.hasDuration(X))return lt;const k=a.default.getTimePos(X),L=a.default.getDuration(X),$=k+L;return $>lt?$:lt}const T=function(lt,X){const k=lt.attributesByLocation,L=_(X,lt.biggestTimeDuration);return k[L].push(X),lt},_=function(lt,X){const k=e.A.getTimePos(lt);return k===0?d.LEFT:k===X?d.RIGHT:d.MIDDLE},g=h;var E=t(35802);const M=function(lt){return!(E.default.hasTime(lt)||E.default.hasKey(lt)||E.default.hasTranspose(lt))};var p=t(819795);const m=function(lt,X){const k={rawsByLocation:lt,notes:X};lt[d.AMBIGUOUS].forEach(v,k)},v=function(lt){const X=this.rawsByLocation,k=this.notes,L=U(lt,k);X[L].push(lt)},U=function(lt,X){if(E.default.hasDivisions(lt))return d.LEFT;if(!E.default.hasClef(lt))return d.RIGHT;let k=E.default.getClef(lt);return k.length>=2||(k=k[0],p.A.isGlobal(k))?d.RIGHT:x(lt,X)},x=function(lt,X){const k=E.default.getClef(lt)[0],L=p.A.getStaffIdx(k),$=e.A.getNoteBeforeIdx(lt),ut=X[$],w=a.default.getStaffIdx(ut);return L===w?d.RIGHT:d.LEFT},S=m,K=function(lt){const X=H();return lt.reduce(Y,X),X.timePositionByNoteIdx},H=function(){return{timePosition:0,timePositionByNoteIdx:{}}},Y=function(lt,X,k){if(a.default.hasForward(X)){const L=a.default.getForwardDuration(X);lt.timePosition+=L}if(a.default.hasBackup(X)){const L=a.default.getBackupDuration(X);lt.timePosition-=L}if(lt.timePositionByNoteIdx[k]=lt.timePosition,!a.default.isChord(X)&&a.default.hasDuration(X)){const L=a.default.getDuration(X);lt.timePosition+=L}return lt},C=K;var y=t(726042);const F=function(lt,X){const k=this.timePositionByNoteIdx,L=this.notes,$=e.A.getNoteBeforeIdx(lt),ut=L[$],w=N(ut),tt=G(k,$)+w,it=e.A.getNoteBeforeIdx(X),It=L[it],xt=N(It),St=G(k,it)+xt;return y.default.cmp(tt,St)},N=function(lt){return a.default.hasDuration(lt)?a.default.getDuration(lt):0},G=function(lt,X){if(typeof lt[X]=="undefined"){const k=`The note idx [${X}] is invalid.`;throw new s.default("BadNoteIdx",k)}else return lt[X]},nt=F,V=function(lt,X){const L={timePositionByNoteIdx:C(X),notes:X};lt.sort(nt.bind(L))};function W(lt){lt.sort(Z)}function Z(lt,X){const k=e.A.getTimePos(lt),L=e.A.getTimePos(X);return k-L}const at=function(lt,X){const k=this.valueOf(),L=f.default.getNotes(X),$=f.default.getAllRawAttributes(X);let ut;k?ut=g($,L):ut=l($,L),S(ut,L);const w=ut[d.LEFT];Array.prototype.unshift.apply(w,lt);const st=ut[d.MIDDLE];k?W(st):V(st,L);let tt=ut[d.RIGHT];Array.prototype.unshift.apply(tt,st),tt=tt.filter(M);const it=w.reduce(e.A.mergeInto,{});return f.default.clearRawAttributes(X),f.default.setOwnAttributes(X,it),tt},gt=function(lt){const X=this.valueOf(),k=[],L=at.bind(X);lt.reduce(L,k)}},338716:(O,A,t)=>{t.d(A,{A:()=>I});var f=t(701387),e=t(35802),s=t(721247),c=t(104907);const d=5,i=function(P){a(P)&&n(P)&&l(P)},a=function(P){const T=f.default.getAttributes(P);return o(T)?!1:!r(T)},o=function(P){const T=e.default.getStaffDetails(P)[0];return c.default.hasStaffTuning(T)},r=function(P){const T=e.default.getClef(P)[0];return s.default.isPercussion(T)},n=function(P){const T=f.default.getAttributes(P);return e.default.getStaffDetails(T).some(u)},u=function(P){return c.default.getNbStaffLines(P)!==d},l=function(P){const T=f.default.getAttributes(P);let _=e.default.getStaffDetails(T);_.forEach(h);const g=f.default.getOwnAttributes(P);e.default.hasStaffDetails(g)&&(_=e.default.getStaffDetails(g),_.forEach(h))},h=function(P){c.default.setNbStaffLines(P,d)},I=i},339423:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(123491),s=t(209175);function c(i){f.default.getNotes(i).forEach(d)}function d(i){if(e.default.isGraceNote(i)){if(e.default.hasTimeModif(i)){const a=s.default.createDefault();e.default.setTimeModif(i,a)}e.default.hasTupletBounds(i)&&e.default.removeTupletBounds(i)}}},343568:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(832560),e=t(290087);function s(c,d){c instanceof f.A?(c.scoreData!==null&&(c.scoreData.checkPartIdx(d.partIdx),c.scoreData.checkMeasureIdx(d.measureIdx)),this.measureData=c):this.measureData=(0,e.A)(c,d.partIdx,d.measureIdx),this.attr=this.measureData.getAttributes(),this.opts=d}},343818:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(){super("There is no slur at this location."),this.name="NoSlurError"}}},345912:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(364842),e=t(773948),s=t(372585),c=t(952818),d=t(717434),i=t(889113);const a={},o=3.5;a.create=function(n,u,l,h,I,P,T){const _={};c.A.setPlacement(_,u),c.A.setStaffIdx(_,n),c.A.setTimePos(_,l);const g=i.A.create(h,I,P,T),E=d.A.createOctaveShift(g);return c.A.setEntry(_,E),_},a.isSame=function(n,u){const l=a.getTimePos(n),h=a.getTimePos(u),I=a.getStaffIdx(n),P=a.getStaffIdx(u),T=a.getPlacement(n),_=a.getPlacement(u),g=a.getType(n),E=a.getType(u),D=i.A.getSize(n),M=i.A.getSize(u),p=i.A.getLocation(u),m=i.A.getLocation(n),v=i.A.getNumber(n),U=i.A.getNumber(u);return l===h&&I===P&&T===_&&g===E&&D===M&&m===p&&v===U},a.getTimePos=function(n){return c.A.getTimePos(n)},a.getStaffIdx=function(n){return c.A.getStaffIdx(n)},a.getPlacement=function(n){return c.A.getPlacement(n)},a.getType=function(n){return c.A.getDisplayOctaveShiftType(n)},a.getSize=function(n){return c.A.getDisplayOctaveShiftSize(n)},a.getLocation=function(n){return c.A.getDisplayOctaveShiftLocation(n)},a.getNumber=function(n){return c.A.getDisplayOctaveShiftNumber(n)},a.isStart=function(n){const u=a.getType(n);return s.A.isStart(u)},a.isStop=function(n){const u=a.getType(n);return s.A.isStop(u)},a.applyShiftToLine=function(n,u){const l=a.getOctaveChange(n);return u-=o*l,u},a.removeShiftFromLine=function(n,u){const l=a.getOctaveChange(n);return u+=o*l,u},a.getOctaveChange=function(n){const u=a.getSize(n),l=a.getType(n),h=e.A.sizeToOctaveShift(u);if(l===s.A.DOWN)return h;if(l===s.A.UP)return-h;throw new f.default("Unexpected")},a.getOctaveShiftUuid=function(n){return c.A.getDirectionUuid(n)},a.setOctaveShiftUuid=function(n,u){c.A.setDirectionUuid(n,u)},a.compare=function(n,u){const l=a.getTimePos(n),h=a.getTimePos(u);if(l!==h)return l-h;const I=a.getNumber(n),P=a.getNumber(u);if(I!==P)return I-P;if(a.isStart(n)||a.isStart(u)){if(a.isStop(n)&&a.isStart(u))return-1;if(a.isStart(n)&&a.isStop(u))return 1}return 0};const r=a},348071:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(210888),e=t(701387),s=t(496819);function c(i){const a=e.default.getNbStaves(i);for(let o=0;o<a;o++)e.default.getDynamics(i,o).forEach(d)}function d(i){const a=f.default.generate();s.A.setDynamicUuid(i,a)}},348742:(O,A,t)=>{t.d(A,{A:()=>f});class f extends Error{constructor(s,c,d){let i=c;typeof c!="string"&&(i=s),super(i),Object.defineProperty(this,"payload",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="ImportError",this.payload=d||null,this.code=s}}},352860:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(701387),e=t(35802),s=t(104907),c=t(627300),d=t(348742);function i(u){f.default.getAllRawAttributes(u).forEach(a)}function a(u){e.default.getStaffDetails(u).forEach(o)}function o(u){if(!s.default.hasStaffTuning(u))return;s.default.getStaffTunings(u).forEach(r)}function r(u){const l=c.default.getStep(u);if(l.includes("/")){const h=l[0],I=l[1],P=n(I);c.default.setStep(u,h),c.default.setAlter(u,P)}}function n(u){if(u==="#")return 1;if(u==="b")return-1;throw new d.A("BadAccidentalError",`The accidental value ${u} in the staff-tuning is invalid.`)}},353346:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(35802),s=t(364596),c=t(377180);const d=function(o){const r=f.default.getAttributes(o);let n=e.default.getKey(r);n=n.map(i),e.default.setKey(r,n)},i=function(o){let r=s.default.getFifths(o);return r=r%c.default.NB_CHROMATIC,s.default.setFifths(o,r),o},a=d},354703:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(351277),e=t(364842);const s=function(a){this.init(a)},c=s.prototype;c.init=function(a){this.fifths=a,this.table={}};const d=function(a){const o=f.default.getStep(a),r=f.default.getOctave(a);return`${o}/${r}`};c.getAlterValue=function(a){const o=d(a);return this.hasAlterValue(o)||this.initAlterValue(a),this.table[o]},c.hasAlterValue=function(a){return typeof this.table[a]!="undefined"},c.initAlterValue=function(a){const o=f.default.getStep(a),r=f.default.stepToAlter(o,this.fifths),n=d(a);this.table[n]=r},c.setAlterValue=function(a){const o=d(a);if(this.hasAlterValue(o)){const r=f.default.getAlter(a);this.table[o]=r}else{const r=`Cannot set a value for key [${o}] when there are no prior entry.`;throw new e.default("NoEntry",r)}};const i=s},363082:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(123491),e=t(701387),s=t(353922);function c(i){let a=e.default.getNotes(i);a=a.filter(d),e.default.setNotes(i,a)}function d(i){return f.default.getHead(i)!==s.A.NONE?!0:f.default.hasPitch(i)?(f.default.setHead(i,s.A.NORMAL),!0):!1}},368011:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(346797),e=t(817066),s=t(909748),c=t(332573);const d=function(n){const u=i(n),l=(0,e.A)(u);new a(l,n).fillTempoChanges()},i=function(n){const u=[],l=n.getNbMeasures();for(let h=0;h<l;h++){const I=n.getTempoChanges(h);u.push(I)}return u},a=function(n,u){this.init(n,u)},o=a.prototype;o.init=function(n,u){this.wrappedTempoChanges=n,this.commonContent=u,this.measuresScroller=null},o.fillTempoChanges=function(){const n=this.wrappedTempoChanges.length;for(let u=0;u<n-1;u+=2){const l=this.wrappedTempoChanges[u],h=this.wrappedTempoChanges[u+1];this.fillTempoChange(l,h)}},o.fillTempoChange=function(n,u){const l=n.measureIdx,h=u.measureIdx;this.addContinues(l,h)},o.addContinues=function(n,u){for(let l=n;l<u;l++)this.addContinue(l)},o.addContinue=function(n){const h=f.A.create(null,null,s.A.CONTINUE,c.A.RIGHT);this.commonContent.setRightTempoChange(n,h);const I=f.A.create(null,null,s.A.CONTINUE,c.A.LEFT);this.commonContent.setLeftTempoChange(n+1,I)};const r=d},369049:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(74957),e=t(843678);function s(c,d){const i=c.chordKind===d.chordKind,a=e.default.fromList(c.allDegrees,f.A.getValue),o=e.default.fromList(d.allDegrees,f.A.getValue);let r=0;Array.from(Object.keys(a)).forEach(l=>{o[l]||(r++,delete a[l])});let n=0;Array.from(Object.keys(o)).forEach(l=>{a[l]||(n++,delete o[l])});let u=0;return Array.from(Object.keys(a)).forEach(l=>{const h=f.A.getAlter(a[l]),I=f.A.getAlter(o[l]);h!==I&&u++}),{nbChanged:u,nbAdded:n,nbRemoved:r,isSameBase:i,total:u+n+r}}},372585:(O,A,t)=>{t.d(A,{A:()=>I});var f=t(364842);const e="up",s="down",c="stop",d="continue",i=[e,s,c,d],a=[e,s];function o(P){return P===e||P===s}function r(P){return P===c}function n(P){return i.includes(P)}function u(P){return a.includes(P)}function l(P){if(!n(P)){const T=`Invalid value for octave shift type: [${P}].`;throw new f.default("OctaveShiftType",T)}}function h(P){if(!u(P)){const T=`Invalid internal value for octave shift type: [${P}].`;throw new f.default("OctaveShiftType",T)}}const I={UP:e,DOWN:s,STOP:c,CONTINUE:d,values:i,internalValues:a,isStart:o,isStop:r,isValid:n,isValidInternal:u,assert:l,assertInternal:h}},372817:(O,A,t)=>{t.d(A,{A:()=>ut});var f=t(843678),e=t(987901);const s=function(w,st){const tt={nbStaves:st,nbVoicesPerStaff:{}};return f.default.every(w,c,tt)},c=function(w,st){if(st.length!==1)return!1;const tt=st[0];return!(tt<0||tt>=this.nbStaves||(typeof this.nbVoicesPerStaff[tt]=="undefined"?this.nbVoicesPerStaff[tt]=1:this.nbVoicesPerStaff[tt]++,this.nbVoicesPerStaff[tt]>e.A.MAX_NB_VOICES_PER_STAFF))},d=s;var i=t(383279),a=t(446921);const r=function(w,st){if(i.default.hasVoiceMapping(w)){const tt=i.default.getVoiceMapping(w),it=a.A.getNbStaves(st);return!d(tt,it)}else return!0};var n=t(701387),u=t(123491);const l=function(w){return new h(w).extract()},h=function(w){this.init(w)},I=h.prototype;I.init=function(w){this.measures=w,this.voices={}},I.extract=function(){return this.measures.forEach(this.addMeasure,this),this.voices},I.addMeasure=function(w){n.default.getNotes(w).forEach(this.addNote,this)},I.addNote=function(w){if(!u.default.isPrinted(w))return;const st=u.default.getVoiceIdx(w),tt=u.default.getStaffIdx(w);if(!Number.isNaN(tt)){const it=this.getVoice(st);P(it,tt)}},I.getVoice=function(w){if(typeof this.voices[w]=="undefined"){const st=this.createVoiceData(w);this.voices[w]=st}return this.voices[w]},I.createVoiceData=function(w){return{voiceIdx:w,nbNotes:0,staves:{}}};const P=function(w,st){w.nbNotes++,typeof w.staves[st]=="undefined"?w.staves[st]={staffIdx:st,nbNotes:1}:w.staves[st].nbNotes++},T=l,_=function(w){const st=f.default.getValues(w);return st.sort(g),st.reverse(),st},g=function(w,st){return w.nbNotes-st.nbNotes},E=_,M=function(w,st){const tt=st*e.A.MAX_NB_VOICES_PER_STAFF;return w.length>tt},m=function(w,st){const tt=st*e.A.MAX_NB_VOICES_PER_STAFF;return w=w.slice(0,tt),w};var v=t(364842);const U=function(w,st){const tt=new x(w,st);return tt.assign(),tt.shouldUpdateNotes()},x=function(w,st){this.init(w,st)},S=x.prototype;S.init=function(w,st){this.voicesEntries=w,this.nbStaves=st,this.usedStaves={},this.orphanVoices=[],this.unusedStaffIndexes=null,this.shouldUpdateNotesValue=!1},S.assign=function(){this.assignStaves(),this.hasOrphanVoices()&&this.assignToOrphanVoices()},S.shouldUpdateNotes=function(){return this.shouldUpdateNotesValue},S.assignStaves=function(){this.voicesEntries.forEach(this.assignVoiceStaff,this)},S.assignVoiceStaff=function(w){const st=K(w.staves),tt=st.filter(this.isFreeStaffData,this);if(tt.length>0){tt.sort(H),tt.reverse();const It=tt[0].staffIdx;w.staffIdx=It,this.useStaff(It),st.length>1&&(this.shouldUpdateNotesValue=!0)}else this.orphanVoices.push(w)};const K=function(w){const st=[];for(const tt in w){const it=w[tt];st.push(it)}return st};S.useStaff=function(w){typeof this.usedStaves[w]=="undefined"?this.usedStaves[w]=1:this.usedStaves[w]++};const H=function(w,st){return w.nbNotes-st.nbNotes};S.isFreeStaffData=function(w){return this.isFreeStaff(w.staffIdx)},S.isFreeStaff=function(w){return this.getNbVoicesOnStaff(w)<e.A.MAX_NB_VOICES_PER_STAFF},S.getNbVoicesOnStaff=function(w){return typeof this.usedStaves[w]=="undefined"?0:this.usedStaves[w]},S.hasOrphanVoices=function(){return this.orphanVoices.length>0},S.assignToOrphanVoices=function(){this.initUnusedStaffIndexes(),this.orphanVoices.forEach(this.assignToOrphanVoice,this)},S.initUnusedStaffIndexes=function(){this.unusedStaffIndexes=[];for(let w=0;w<this.nbStaves;w++)for(;this.isFreeStaff(w);)this.unusedStaffIndexes.push(w),this.useStaff(w)},S.assignToOrphanVoice=function(w){const st=this.getUnusedStaffIdx();w.staffIdx=st,this.shouldUpdateNotesValue=!0},S.getUnusedStaffIdx=function(){if(this.unusedStaffIndexes.length===0)throw new v.default("Unexpected");return this.unusedStaffIndexes.pop()};const Y=U,C=function(w){const st={};return w.forEach(y,st),st},y=function(w){const st=this;st[w.voiceIdx]=[w.staffIdx]},F=C,N=function(w,st){const tt=G(w),it=V(tt,st);W(it,w)},G=function(w){const st={};return f.default.forEach(w,nt,st),st},nt=function(w,st){const tt=this;st.forEach(J,tt)},J=function(w){const st=this;st[w]=!0},V=function(w,st){const tt=[];for(let it=0;it<st;it++)typeof w[it]=="undefined"&&tt.push(it);return tt},W=function(w,st){const tt={seedVoiceIdx:0,voiceMapping:st};w.forEach(Z,tt)},Z=function(w){const st=this.seedVoiceIdx,tt=this.voiceMapping,it=dt(st,tt);this.seedVoiceIdx=it,tt[it]=[w]},dt=function(w,st){for(;typeof st[w]!="undefined";)w++;return w},at=N,gt=function(w){const st=a.A.getMeasures(w),tt=T(st);let it=E(tt);const It=a.A.getNbStaves(w);let xt=!1;M(it,It)&&(xt=!0,it=m(it,It)),Y(it,It)&&(xt=!0);const Ot=F(it);return at(Ot,It),{shouldUpdateNotes:xt,voiceMapping:Ot}};var lt=t(820686);const k=function(w,st){if(r(w,st)){const tt=gt(st),it=tt.voiceMapping;i.default.setVoiceMapping(w,it),tt.shouldUpdateNotes&&(0,lt.A)(st,it)}},L=function(w,st){w.forEach($,st)},$=function(w,st){const it=this[st];k(w,it)},ut=L},373735:(O,A,t)=>{t.d(A,{A:()=>h});var f=t(612040),e=t(701387),s=t(558280),c=t(817066),d=t(805793),i=t(889600),a=t(189247);const o=function(I){(0,d.A)(I).map(r).forEach(function(_){new u(_,I).fillWedges()})};function r(I){return(0,c.A)(I,n)}function n(I,P){const T=I.measureIdx-P.measureIdx;return T!==0?T:s.A.compare(I.direction,P.direction)}const u=function(I,P){this.init(I,P)},l=u.prototype;l.init=function(I,P){this.wrappedWedges=I,this.measures=P,this.measuresScroller=null},l.fillWedges=function(){const I=this.wrappedWedges.length;for(let P=0;P<I-1;P+=2){const T=this.wrappedWedges[P],_=this.wrappedWedges[P+1];this.fillWedge(T,_)}},l.fillWedge=function(I,P){const T=I.direction,_=P.direction,g=s.A.getRawType(T),E=this.getNbNotes(I,P);s.A.fillStartTagInternalValues(T,g,E),s.A.fillStopTagInternalValues(_,g);const D=I.measureIdx,M=P.measureIdx;this.addContinues(D,M,I)},l.getNbNotes=function(I,P){const T=s.A.getTimePos(I.direction),_=s.A.getTimePos(P.direction),g={startMeasureIdx:I.measureIdx,startTimePos:T,stopMeasureIdx:P.measureIdx,stopTimePos:_},E=this.getMeasuresScroller();return(0,i.A)(E,g)},l.getMeasuresScroller=function(){return this.measuresScroller===null&&(this.measuresScroller=new a.A(this.measures,null,null)),this.measuresScroller},l.addContinues=function(I,P,T){for(let _=I;_<P;_++)this.addContinue(_,T)},l.addContinue=function(I,P){const T=s.A.getStaffIdx(P.direction),_=s.A.getPlacement(P.direction),g=s.A.getType(P.direction),E=s.A.getNumber(P.direction),D=null,M=this.measures[I],p=s.A.create(T,_,D,g,f.A.RIGHT_CONTINUE,E);e.default.setRightWedge(M,T,p);const m=this.measures[I+1],v=s.A.create(T,_,D,g,f.A.LEFT_CONTINUE,E);e.default.setLeftWedge(m,T,v)};const h=o},373758:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(383279),e=t(446921),s=t(476943),c=t(210888);const d={};d.checkOrGenerateUuid=function(o,r){if(f.default.hasUuid(o)&&e.A.hasUuid(r)){const n=f.default.getUuid(o),u=e.A.getUuid(r);c.default.isValid(n)&&c.default.isValid(u)?n!==u&&(f.default.setUuid(o,n),e.A.setUuid(r,n)):this.generateUuid(o,r)}else this.generateUuid(o,r)},d.generateUuid=function(o,r){const n=c.default.generate();f.default.setUuid(o,n),e.A.setUuid(r,n)},d.updateIdFromIdx=function(o,r,n){const u=i(n);f.default.setId(o,u),e.A.setId(r,u)};const i=function(o){return`P${o+1}`};d.updateInstrumentsIds=function(o,r){const n=f.default.updateInstrumentsIds(o);s.default.isObjectEmpty(n)||e.A.updateInstrumentsIds(r,n)};const a=d},388907:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(882934);const c=function(d){let i=f.default.getSounds(d);i.forEach(e.A.removeTempo),i=i.filter(e.A.isNotEmpty),f.default.setSounds(d,i)}},395773:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(701387),e=t(35802),s=t(518558);const c=function(a){f.default.getAllRawAttributes(a).forEach(d)},d=function(a){let o=e.default.getTime(a);o=o.filter(s.default.isValid),e.default.setTime(a,o)},i=c},396503:(O,A,t)=>{t.d(A,{A:()=>M});var f=t(883782),e=t(607682);class s extends e.default{constructor(m){const v=`The wedge uuid "${m} is invalid."`;super(v),Object.defineProperty(this,"wedgeUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadWedgeUuidError",this.wedgeUuid=m}}var c=t(443749),d=t(21738),i=t(409200),a=t(665280),o=t(799851),r=t(956722),n=t(189247),u=t(446921),l=t(701387),h=t(558280),I=t(737903),P=t(726042);const T=function(p,m){(0,d.default)(p,m),(0,i.default)(p,m),(0,a.default)(p,m),p.checkPartIdx(m.partIdx);const v=p.getPartContent(m.partIdx);if(!u.A.hasWedge(v,m.wedgeUuid))throw new s(m.wedgeUuid);const U=u.A.getWedge(v,m.wedgeUuid),x=p.getMeasureIdxFromUuid(U.measureUuid);if(p.checkMeasureIdx(x),!p.hasPartVoiceIdx(m.partIdx,m.voiceIdx))throw new f.default(m.voiceIdx);const S=p.getPartNbStaves(m.partIdx),K=m.staffIdx;if(!P.default.isInteger(K)||K<0||K>=S)throw new c.default(m.staffIdx);const H=p.getMeasure(m.partIdx,x);let Y=l.default.getWedges(H,m.staffIdx);Y=Y.filter(h.A.isLeft);const C=g(Y,U.wedgeUuid),y=h.A.getTimePos(C),F=p.getPartMeasures(m.partIdx),N=(0,r.A)(F,x,m.staffIdx,y);N.startDpq=l.default.getDpq(H);const G=p.getMeasure(m.partIdx,N.stopMeasureIdx);N.stopDpq=l.default.getDpq(G),N.partIdx=m.partIdx,N.staffIdx=m.staffIdx;const nt=_(p,m,N);return Object.assign(N,nt),D(N,p),N},_=function(p,m,v){const U=(0,I.default)(v);U.searchedVoiceIdx=m.voiceIdx,U.staffVoicesIndexes=p.getPartStaffVoicesIndexes(m.partIdx,m.staffIdx);const x=p.getPartMeasures(m.partIdx),S=new n.A(x,m.partIdx,p);return(0,o.A)(S,U)},g=function(p,m){return p.find(E,m)},E=function(p){const m=this.valueOf();return h.A.getWedgeUuid(p)===m},D=function(p,m){p.startMeasureUuid=m.getMeasureUuid(p.startMeasureIdx),p.startVoiceUuid=m.getPartVoiceUuid(p.partIdx,p.startVoiceIdx),p.stopMeasureUuid=m.getMeasureUuid(p.stopMeasureIdx),p.stopVoiceUuid=m.getPartVoiceUuid(p.partIdx,p.stopVoiceIdx),p.partUuid=m.getPartUuid(p.partIdx),p.staffUuid=m.getPartStaffUuid(p.partIdx,p.staffIdx)},M=T},398346:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(c){const d=`There is no tempo change at the index [${c}].`;super(d),Object.defineProperty(this,"tempoChangeIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadTempoChangeIdxError",this.tempoChangeIdx=c}}},400598:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(443749),e=t(21738),s=t(131220),c=t(665280),d=t(832560),i=t(701387),a=t(726042);const o=function(u,l){(0,e.default)(u,l),(0,s.default)(u,l),(0,c.default)(u,l),u.checkPartIdx(l.partIdx),u.checkMeasureIdx(l.measureIdx);const h=u.getMeasure(l.partIdx,l.measureIdx),I=i.default.getNbStaves(h),P=l.staffIdx;if(!a.default.isInteger(P)||P<0||P>=I)throw new f.default(P);let T=u.getPartStaffVoicesIndexes(l.partIdx,l.staffIdx);const _=new d.A(h);T=T.filter(_.hasVoice,_);const g={scoreData:u,partIdx:l.partIdx};return T.map(r,g)},r=function(u){const l=this;return l.scoreData.getPartVoiceUuid(l.partIdx,u)},n=o},402119:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(856219);function e(s){const c={};return s.forEach(function(d){const i=f.default.getId(d),a=f.default.getMIDIProgram(d),o=f.default.getUnpitched(d);typeof c[o]=="undefined"&&(c[o]={}),c[o][a]=i}),c}},403038:(O,A,t)=>{t.d(A,{A:()=>e});const f="There is a lock on the score json. You are not allowed to instanciate two Adagio.Data on the same json. You must call Data.exportData() to get an unlocked json. ";class e extends Error{constructor(){super(f),this.name="LockError"}}},404997:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(210888),e=t(701387),s=t(447819);function c(i){const a=e.default.getNbStaves(i);for(let o=0;o<a;o++)e.default.getMutes(i,o).forEach(d)}function d(i){const a=f.default.generate();s.A.setUuid(i,a)}},410114:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(c){const d=`There is no pizzicato at the index [${c}].`;super(d),Object.defineProperty(this,"pizzicatoIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadPizzicatoIdxError",this.pizzicatoIdx=c}}},411461:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(364842),e=t(446921),s=t(383279);const c=function(o,r){o.map(s.default.getId).forEach(function(u,l){d(u,l,r)})},d=function(o,r,n){if(e.A.getId(n[r])!==o){const l=n.findIndex(i,o);if(l>r){const h=n.splice(l,1)[0];n.splice(r,0,h)}else throw new f.default("unreachable")}},i=function(o){const r=this.valueOf();return e.A.getId(o)===r},a=c},411756:(O,A,t)=>{t.d(A,{A:()=>V});var f=t(348742),e=t(123491),s=t(701387),c=t(35802),d=t(518558),i=t(515819),a=t(209175),o=t(726042),r=t(759240),n=t(832560),u=t(673817),l=t(844191);const h="ERR_CHORD_MISSING_FORMER",I="ERR_CHORD_BACKUP",P="ERR_CHORD_FORWARD",T="ERR_CHORD_BADVOICE",_="ERR_TIME_NEGATIVE",g="ERR_NOT_QUARTER",E="ERR_CHORD_GRACE",D=function(W){let Z=s.default.getNotes(W);const dt=s.default.getAttributes(W);M(W);const at=s.default.getNbDivisions(W),gt=new p(Z).getVoices(),lt=x(gt);Z=[],lt.forEach(function(X){const k=gt[X],L=new S(k,dt,at);L.organize();const $=L.getNotes();Array.prototype.push.apply(Z,$)}),s.default.setNotes(W,Z)},M=function(W){const Z=s.default.getDpq(W),dt=s.default.getQuarterDuration(W),at=i.default.quarterDurationToRequiredDpq(dt),gt={partIdx:null,measureIdx:null,timePos:1,dpq:o.default.lcm(Z,at)},lt=new u.A,X=new n.A(W),k=new l.A(X,gt,lt);k.measure=W,k.perform()},p=function(W){this.init(W)},m=p.prototype;m.init=function(W){this.maxTimePos=0,this.voices={},this.timePos=0,this.currentContainer=null,this.currentChord=null,W.forEach(this.addNote,this),this.currentContainer},m.addNote=function(W){e.default.isChord(W)?U(W)&&this.addChordNote(W):this.addSingleNote(W)},m.addChordNote=function(W){let Z;if(this.currentChord===null)throw Z="Cannot have a chord note without note before.",new f.A(h,Z);if(e.default.hasBackup(W))throw Z="a chord note shoud not have backup data.",new f.A(I,Z);if(e.default.hasForward(W))throw Z="a chord note shoud not have forward data.",new f.A(P,Z);const dt=e.default.getVoiceIdx(W),at=this.getCurrentChordVoiceIdx();if(dt!==at)throw Z="the chord note belong to a different voice than the current chord.",new f.A(T,Z);const B=e.default.isGraceNote(W),gt=this.isCurrentChordGrace();if(B!==gt)throw Z="Cannot mix grace and non grace within the same chord.",new f.A(E,Z);this.currentChord.push(W)},m.isCurrentChordGrace=function(){return e.default.isGraceNote(this.currentChord[0])},m.getCurrentChordVoiceIdx=function(){return e.default.getVoiceIdx(this.currentChord[0])},m.addSingleNote=function(W){let Z=this.timePos;if(Z=v(W,Z),Z<0){const dt="The time position is negative.";throw new f.A(_,dt)}this.updateTimePos(Z),U(W)&&this.addNoteAtPos(W,Z)};const v=function(W,Z){let dt;return e.default.hasBackup(W)&&(dt=e.default.getBackupDuration(W),Z-=dt),e.default.hasForward(W)&&(dt=e.default.getForwardDuration(W),Z+=dt),Z};m.addNoteAtPos=function(W,Z){const dt=e.default.getVoiceIdx(W),at=this.getVoice(dt),B=[W],gt=this.getContainer();e.default.isGraceNote(W)?(e.default.removeDuration(W),gt.graces.push(B)):gt.note=B,e.default.isGraceNote(W)||(typeof at[Z]=="undefined"&&(at[Z]=gt),this.currentContainer=null),this.currentChord=B;const lt=e.default.getDuration(W);this.updateTimePos(Z+lt)},m.getVoice=function(W){return typeof this.voices[W]=="undefined"&&(this.voices[W]={}),this.voices[W]},m.updateTimePos=function(W){this.timePos=W,this.maxTimePos=Math.max(W,this.maxTimePos)},m.getContainer=function(){return this.currentContainer===null&&(this.currentContainer={note:null,graces:[]}),this.currentContainer},m.getVoices=function(){return this.voices},m.getMaxTimePos=function(){return this.maxTimePos};const U=function(W){return e.default.isGraceNote(W)?!0:e.default.getDuration(W)>0},x=function(W){let Z=Object.keys(W);return Z=Z.map(o.default.intPart),Z.sort(o.default.cmp),Z},S=function(W,Z,dt){this.init(W,Z,dt)},K=S.prototype;K.init=function(W,Z,dt){this.timePos=0,this.maxTimePos=dt,this.voice=W,this.attributes=Z,this.timePerBeat=null,this.list=null},K.organize=function(){const W=H(this.voice);this.fillGaps(W),N(W),this.list=W};const H=function(W){const Z=[];for(let dt in W){const at=W[dt];dt=parseInt(dt,10);const B={timePos:dt,container:at};Z.push(B)}return Z.sort(Y),Z},Y=function(W,Z){return W.timePos-Z.timePos};K.fillGaps=function(W){let Z=0,dt=0;for(;dt<W.length;){const at=W[dt];if(at.timePos<Z){W.splice(dt,1);continue}if(at.timePos>Z){const B=at.timePos-Z,gt=this.createRests(Z,at,B),lt=[dt,0].concat(gt);Array.prototype.splice.apply(W,lt),dt+=gt.length}Z=at.timePos+e.default.getDuration(at.container.note[0]),dt++}Z<this.maxTimePos&&this.addFinalNotes(W,Z)},K.addFinalNotes=function(W,Z){const dt=W.length-1,at=W[dt],B=this.maxTimePos-Z,gt=this.createRests(Z,at,B);Array.prototype.push.apply(W,gt)},K.createRests=function(W,Z,dt){const at=this.getDivisionsPerQuarter(),B=i.default.divisionsToQuarter(dt,at);if(!i.default.isValidQuarter(B)){const ut=`Cannot fill gap with a duration that is not aligned to a possible quarter duration [${dt}]. Tuplet involved? `;throw new f.A(g,ut)}const gt=this.getTimePerBeat(),lt=a.default.createDefault(),X=new r.A(W,dt,gt,at,lt);X.dispatch();const $=X.getDispatchedRests().map(C,Z).map(y);return $.reduce(F,W),$},K.getDivisionsPerQuarter=function(){return c.default.getDivisions(this.attributes)},K.getTimePerBeat=function(){if(this.timePerBeat===null){const W=c.default.getAnyTime(this.attributes),Z=d.default.getBeatType(W),dt=this.getDivisionsPerQuarter();this.timePerBeat=i.default.beatTypeToDivisions(Z,dt)}return this.timePerBeat};const C=function(W){const dt=this.container.note[0],at=e.default.getVoiceIdx(dt),B=e.default.getStaffIdx(dt),gt=e.default.createRest();return e.default.setVoiceIdx(gt,at),e.default.setStaffIdx(gt,B),e.default.setDuration(gt,W),gt},y=function(W){return{container:{note:[W],graces:[]},timePos:null}},F=function(W,Z){Z.timePos=W;const dt=Z.container.note[0],at=e.default.getDuration(dt);return W+at},N=function(W){W.forEach(function(Z){G(Z.container.note),Z.container.graces.forEach(G)})},G=function(W){const Z=W[0];e.default.hasBackup(Z)&&e.default.removeBackup(Z),e.default.hasForward(Z)&&e.default.removeForward(Z)};K.getNotes=function(){const W=[];return this.list.forEach(nt,W),W};const nt=function(W){const Z=this;W.container.graces.forEach(J,Z),J.call(Z,W.container.note)},J=function(W){const Z=this;Array.prototype.push.apply(Z,W)},V=D},411993:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(123491);const e={};e.groupVoices=function(a){return d.group(a)};const s=function(){},c=s.prototype;c.group=function(a){return this.reset(),a.forEach(this.addNote.bind(this)),this.voices},c.reset=function(){this.voices={}},c.addNote=function(a){const o=f.default.getVoiceIdx(a);this.addNoteToVoice(a,o)},c.addNoteToVoice=function(a,o){typeof this.voices[o]=="undefined"&&(this.voices[o]=[]),this.voices[o].push(a)};const d=new s,i=e},412151:(O,A,t)=>{t.d(A,{A:()=>u});var f=t(607682);class e extends f.default{constructor(T){super(`The figured bass uuid "${T} is invalid."`),Object.defineProperty(this,"figuredBassUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadFiguredBassUuidError",this.figuredBassUuid=T}}var s=t(883782),c=t(701387),d=t(589501),i=t(21738),a=t(131220),o=t(409200),r=t(507004),n=t(189247);function u(P,T){if((0,i.default)(P,T),(0,a.default)(P,T),(0,o.default)(P,T),P.checkPartIdx(T.partIdx),P.checkMeasureIdx(T.measureIdx),!P.hasPartVoiceIdx(T.partIdx,T.voiceIdx))throw new s.default(T.voiceIdx);const _=P.getMeasure(T.partIdx,T.measureIdx),E=c.default.getFiguredBasses(_).find(l,T);if(!E)throw new e(T.figuredBassUuid);const D=c.default.getDpq(_),M=d.A.getTimePos(E),p=d.A.getFiguresData(E),m={partIdx:T.partIdx,measureIdx:T.measureIdx,dpq:D,timePos:M,figuresData:p},v=h(P,T,m);return Object.assign(m,v),I(m,P),m}function l(P){return d.A.getUuid(P)===this.figuredBassUuid}function h(P,T,_){const g=P.getPartVoiceMainStaffIdx(T.partIdx,T.voiceIdx),E={searchedVoiceIdx:T.voiceIdx,staffVoicesIndexes:P.getPartStaffVoicesIndexes(T.partIdx,g),measureIdx:T.measureIdx,timePos:_.timePos,dpq:_.dpq},D=P.getPartMeasures(T.partIdx),M=new n.A(D,T.partIdx,P);return(0,r.A)(M,E)}function I(P,T){P.measureUuid=T.getMeasureUuid(P.measureIdx),P.voiceUuid=T.getPartVoiceUuid(P.partIdx,P.voiceIdx),P.partUuid=T.getPartUuid(P.partIdx)}},415078:(O,A,t)=>{t.d(A,{A:()=>f});class f extends Error{constructor(s){super(s),this.name="MusicXMLFeatureNotSupportedError"}}},423508:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(35802),s=t(104907),c=t(721247);function d(i){const a=f.default.getOwnAttributes(i);if(e.default.getNbStaves(a)!==2)return!1;const n=e.default.getWrappedStaffDetailsOrDefault(a).getEntry(1);if(!s.default.hasStaffTuning(n)||!s.default.hasStaffLines(n))return!1;const u=e.default.getWrappedClef(a),l=u.getEntry(1);if(!c.default.isTab(l))return!1;const h=u.getEntry(0);return!c.default.isTab(h)}},424104:(O,A,t)=>{t.d(A,{A:()=>dt});const e=function(at,B){const gt=at.nbNotes+B.nbNotes,lt=(at.nbNotes*at.pitchValue+B.nbNotes*B.pitchValue)/gt;return{nbNotes:gt,pitchValue:lt}};var s=t(701387),c=t(123491),d=t(351277),i=t(292681),a=t(606741);const o=function(at){const B={};return s.default.getNotes(at).forEach(r,B),B},r=function(at){const B=this;if(!c.default.isPrinted(at))return;let gt;if(c.default.hasPitch(at))gt=n(at);else if(c.default.hasUnpitched(at))gt=u(at);else return;const lt=c.default.getStaffIdx(at),X=c.default.getVoiceIdx(at);h(B,lt,X,gt)},n=function(at){const B=c.default.getPitch(at),gt=d.default.getOctave(B),lt=d.default.getStep(B);return l(gt,lt)},u=function(at){const B=c.default.getUnpitched(at),gt=i.default.getOctave(B),lt=i.default.getStep(B);return l(gt,lt)},l=function(at,B){return at*a.default.getSize()+a.default.getStepIdx(B)},h=function(at,B,gt,lt){typeof at[B]=="undefined"&&(at[B]={});const X=I(lt);if(typeof at[B][gt]=="undefined")at[B][gt]=X;else{const k=at[B][gt],L=e(k,X);at[B][gt]=L}},I=function(at){return{pitchValue:at,nbNotes:1}},P=o;var T=t(737903),_=t(843678);const g=function(at,B){const gt=(0,T.default)(at);return _.default.forEach(B,E,gt),gt},E=function(at,B){const gt=this;typeof gt[at]=="undefined"?gt[at]=(0,T.default)(B):_.default.forEach(B,D,gt[at])},D=function(at,B){const gt=this;if(typeof gt[at]=="undefined")gt[at]=(0,T.default)(B);else{const lt=gt[at],X=e(lt,B);gt[at]=X}},M=g,m=function(at){return at.map(P).reduce(M)},v=function(at,B){_.default.forEach(B,U,at)},U=function(at,B){const gt=this;typeof gt[B]=="undefined"&&(gt[B]={}),typeof gt[B][at]=="undefined"&&(gt[B][at]={nbNotes:0,pitchValue:null})},x=v,S=function(at){const B=_.default.toPairs(at),gt=K(B),lt=C(B);return{voices:gt,mainVoiceIdx:lt}},K=function(at){return at.sort(H),at.map(N)},H=function(at,B){const gt=Y(B.value.pitchValue),lt=Y(at.value.pitchValue),X=gt-lt;return X!==0?X:N(at)-N(B)},Y=function(at){return at===null?-1:at},C=function(at){const B=at.reduce(y);return N(B)},y=function(at,B){return F(at,B)<0?at:B},F=function(at,B){const gt=B.value.nbNotes-at.value.nbNotes;return gt!==0?gt:N(at)-N(B)},N=function(at){return parseInt(at.key,10)},G=S,J=function(at,B){const gt=[];for(let lt=0;lt<B;lt++){const X=at[lt],k=G(X);gt.push(k)}return gt};var V=t(446921),W=t(383279);const dt=function(at,B){const gt=V.A.getMeasures(B),lt=m(gt),X=W.default.getVoiceMapping(at);x(lt,X);const k=V.A.getNbStaves(B);return J(lt,k)}},424495:(O,A,t)=>{t.d(A,{A:()=>E});var f=t(162977),e=t(916502),s=t(398346),c=t(123491),d=t(446921),i=t(726042),a=t(346797),o=t(245770),r=t(180289),n=t(891921),u=t(26698),l=t(189247),h=t(909748);const I=function(D,M){const p=new P(D,M);return p.checkPreconditions(),p.get()},P=function(D,M){this.init(D,M)},T=P.prototype;T.init=function(D,M){this.scoreData=D,this.location=M,this.measuresScroller=null,this.targetTimePos=null,this.targetDpq=null},T.checkPreconditions=function(){this.checkLocation(),this.sanitize(),this.checkExistence()},T.checkLocation=function(){this.scoreData.checkPartIdx(this.location.partIdx),this.scoreData.checkMeasureIdx(this.location.measureIdx),this.getMeasureData(this.location.measureIdx).checkVoiceIdx(this.location.voiceIdx)},T.sanitize=function(){if(typeof this.location.tempoChangeIdx!="undefined"){const M=this.scoreData.getCommonContent().getTempoChanges(this.location.measureIdx);if(!i.default.isInteger(this.location.tempoChangeIdx)||this.location.tempoChangeIdx>=M.length)throw new s.A(this.location.tempoChangeIdx);const p=M[this.location.tempoChangeIdx];this.targetTimePos=a.A.getTimePos(p),this.targetDpq=a.A.getDpq(p)}else if(typeof this.location.noteIdx!="undefined"){const D=this.getMeasureData(this.location.measureIdx),M=this.getTargetVoice();M.checkNoteIdx(this.location.noteIdx),this.targetTimePos=_(M,this.location.noteIdx),this.targetDpq=D.getDpqValue()}else throw new e.default("noteIdx OR tempoChangeIdx")};const _=function(D,M){let p=0;for(let m=0;m<M;m++){const v=D.getNote(m),U=c.default.getDuration(v);p+=U}return p};T.getTargetVoice=function(){return this.getMeasureData(this.location.measureIdx).getVoice(this.location.voiceIdx)},T.checkExistence=function(){if(!this.hasTempoChange())throw new f.A},T.hasTempoChange=function(){const D=this.scoreData.getCommonContent(),M=D.getTempoChanges(this.location.measureIdx),p=g(D,this.location.measureIdx);return(0,o.A)(p,M,this.targetTimePos,this.targetDpq)!==null};const g=function(D,M){return D.hasLeftTempoChange(M)?D.getLeftTempoChange(M):null};T.get=function(){this.searchSides(),this.convertSidesToNoteIdx(),this.fetchTempoChangesIdx();const D={type:this.type,startTempoChangeIdx:this.startTempoChangeIdx,stopTempoChangeIdx:this.stopTempoChangeIdx};return this.addLocationData(D),D},T.addLocationData=function(D){const M=this.location.partIdx,p=this.scoreData.voiceIdxToIdxInMainStaff(M,this.startVoiceIdx),m=this.scoreData.voiceIdxToIdxInMainStaff(M,this.stopVoiceIdx);D.partIdx=this.location.partIdx,D.startMeasureIdx=this.startMeasureIdx,D.startVoiceIdx=this.startVoiceIdx,D.startIdxInStaff=p,D.startNoteIdx=this.startNoteIdx,D.stopMeasureIdx=this.stopMeasureIdx,D.stopVoiceIdx=this.stopVoiceIdx,D.stopIdxInStaff=m,D.stopNoteIdx=this.stopNoteIdx},T.searchSides=function(){const D=this.scoreData.getCommonContent(),M=(0,r.A)(D,this.location.measureIdx,this.targetTimePos,this.targetDpq);this.startMeasureIdx=M.startMeasureIdx,this.startTimePos=M.startTimePos,this.startDpq=M.startDpq,this.stopMeasureIdx=M.stopMeasureIdx,this.stopTimePos=M.stopTimePos,this.stopDpq=M.stopDpq,this.type=M.type},T.convertSidesToNoteIdx=function(){this.convertLeftSide(),this.convertRightSide()},T.convertLeftSide=function(){const D=this.getLeftVoice(),p=this.getMeasureData(this.startMeasureIdx).getDpqValue(),m=i.default.lcm(this.startDpq,p),v=this.startTimePos*m/this.startDpq,U=m/p;this.startNoteIdx=(0,n.A)(D,U,v)},T.getLeftVoice=function(){const D=this.getMeasureData(this.startMeasureIdx);if(D.hasVoice(this.location.voiceIdx))this.startVoiceIdx=this.location.voiceIdx;else{let m=this.scoreData.getPartStaffVoicesIndexes(this.location.partIdx,0);m=m.filter(D.hasVoice,D),this.startVoiceIdx=m[0]}return D.getVoice(this.startVoiceIdx)},T.convertRightSide=function(){const D=this.getRightVoice(),p=this.getMeasureData(this.stopMeasureIdx).getDpqValue(),m=i.default.lcm(this.stopDpq,p),v=this.stopTimePos*m/this.stopDpq,U=m/p;this.stopNoteIdx=(0,u.A)(D,U,v)},T.getRightVoice=function(){const D=this.getMeasureData(this.stopMeasureIdx);if(D.hasVoice(this.location.voiceIdx))this.stopVoiceIdx=this.location.voiceIdx;else{let m=this.scoreData.getPartStaffVoicesIndexes(this.location.partIdx,0);m=m.filter(D.hasVoice,D),this.stopVoiceIdx=m[0]}return D.getVoice(this.stopVoiceIdx)},T.getMeasureData=function(D){return this.getMeasuresScroller().getMeasureData(D)},T.getMeasuresScroller=function(){if(this.measuresScroller===null){const D=this.scoreData.getPartContent(this.location.partIdx),M=d.A.getMeasures(D);this.measuresScroller=new l.A(M,this.location.partIdx,this.scoreData)}return this.measuresScroller},T.fetchTempoChangesIdx=function(){this.fetchLeftTempoChangeIdx(),this.fetchRightTempoChangeIdx()},T.fetchLeftTempoChangeIdx=function(){this.tempoChangeIdx=null;const M=this.scoreData.getCommonContent().getTempoChanges(this.startMeasureIdx);this.startTempoChangeIdx=M.findIndex(function(p){const m=a.A.getTimePos(p),v=a.A.getType(p);return m===this.startTimePos&&h.A.isStart(v)},this)},T.fetchRightTempoChangeIdx=function(){this.tempoChangeIdx=null;const M=this.scoreData.getCommonContent().getTempoChanges(this.stopMeasureIdx);this.stopTempoChangeIdx=M.findIndex(function(p){const m=a.A.getTimePos(p),v=a.A.getType(p);return m===this.stopTimePos&&v===h.A.STOP},this)};const E=I},426119:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(955154),e=t(359932),s=t(701387),c=t(123491),d=t(860716);function i(o){s.default.getNotes(o).forEach(a)}function a(o){if(!c.default.hasHarmonic(o))return;const r=c.default.getHarmonic(o);if(!d.default.isValid(r)){c.default.removeHarmonic(o);return}const n=d.default.getType(r);(n===f.default.ARTIFICIAL_TOUCHING||n===f.default.NATURAL_SOUNDING)&&c.default.hasFretData(o)&&(c.default.removeTechnical(o,e.default.FRET),c.default.removeTechnical(o,e.default.STRING))}},428925:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(364842);function e(s){if(typeof s.staffIdx!="undefined")return s.staffIdx;{const c="Cannot convert line to pitch, or convert from concert pitch, since there is no staffIdx informations provided.";throw new f.default("Unexpected",c)}}},430684:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(348742),e=t(701387),s=t(123491),c=t(515819),d=t(411993);const i=function(n){const u=e.default.getDivisions(n),h=e.default.getWrappedTime(n).getAnyEntry(),I=c.default.timeToDivisions(h,u),P=e.default.getNotes(n),T=d.A.groupVoices(P);for(const _ in T){const g=T[_];a(g,u,I)}},a=function(n,u,l){n=n.filter(o);const h=n.reduce(function(I,P){const T=s.default.getDuration(P);return I+T},0);if(h!==l){const I=`The time signature implies [${l}] divisions while there is actually [${h}] for the notes.`;throw new f.A("TimeSignatureViolation",I)}},o=function(n){return!s.default.isChord(n)},r=i},431481:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(721247),e=t(701387),s=t(21738),c=t(131220),d=t(665280);function i(n,u){(0,s.default)(n,u),(0,c.default)(n,u),(0,d.default)(n,u);const l=a(n,u),{measureIdx:h,timePos:I,dpq:P}=o(n,u,l);return{measureUuid:h===null?null:n.getMeasureUuid(h),timePos:I,dpq:P}}function a(n,u){const l=n.getMeasure(u.partIdx,u.measureIdx);let I=e.default.getWrappedClef(l).getEntry(u.staffIdx);const P=e.default.getDpq(l),T=u.timePos*P/u.dpq,_=e.default.getMiddleClefs(l,u.staffIdx);for(const g of _)if(f.default.getTimePos(g)<=T)I=g;else return I;return I}function o(n,u,l){const h=n.getNbMeasures();let I=u.measureIdx;for(;I<h;I++){const P=n.getMeasure(u.partIdx,I),T=e.default.getDpq(P);let _=e.default.getMiddleClefs(P,u.staffIdx);if(I===u.measureIdx){const E=u.timePos*T/u.dpq;_=_.filter(r,E)}else{const D=e.default.getWrappedClef(P).getEntry(u.staffIdx);if(!f.default.isSame(D,l))return{measureIdx:I,timePos:null,dpq:null}}const g=_[0];if(g){const E=f.default.getTimePos(g);return{measureIdx:I,timePos:E,dpq:T}}}return{measureIdx:null,timePos:null,dpq:null}}function r(n){const u=this.valueOf();return f.default.getTimePos(n)>u}},432149:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(726042);const s=function(o){const n=o.map(f.default.getStaffContentMap).reduce(c,0);return d(o,n)},c=function(o,r){return Object.keys(r).forEach(function(u){o=e.default.max2(o,e.default.toInt(u)+1)},this),o},d=function(o,r){const n=[];for(let u=0;u<r;u++){const l=o.map(i,u);n.push(l)}return n},i=function(o){const r=this.valueOf();return f.default.getOctaveShifts(o,r)},a=s},433401:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(309682);const e={};e.hasComposer=function(i){return i.some(f.A.isComposer)},e.getComposer=function(i){const a=i.find(f.A.isComposer);return f.A.getText(a)},e.removeComposer=function(i){e.removeEntry(i,f.A.isComposer)},e.removeLyricist=function(i){e.removeEntry(i,f.A.isLyricist)},e.hasLyricist=function(i){return i.some(f.A.isLyricist)},e.getLyricist=function(i){const a=i.find(f.A.isLyricist);return f.A.getText(a)},e.hasArranger=function(i){return i.some(f.A.isArranger)},e.getArranger=function(i){const a=i.find(f.A.isArranger);return f.A.getText(a)},e.removeArranger=function(i){e.removeEntry(i,f.A.isArranger)},e.setTitle=function(i,a){let o;s(a)?e.removeEntry(i,f.A.isTitle):e.hasTitle(i)?(o=e.getTitleEntry(i),f.A.setText(o,a)):(o=f.A.createTitle(a),i.push(o))},e.setSubtitle=function(i,a){let o;s(a)?e.removeEntry(i,f.A.isSubtitle):e.hasSubtitle(i)?(o=e.getSubtitleEntry(i),f.A.setText(o,a)):(o=f.A.createSubtitle(a),i.push(o))};const s=function(i){return i.trim()===""};e.hasTitle=function(i){return i.some(f.A.isTitle)},e.getTitle=function(i){const a=e.getTitleEntry(i);return f.A.getText(a)},e.getTitleEntry=function(i){return i.find(f.A.isTitle)},e.hasFallbackTitle=function(i){return i.some(f.A.hasNoType)},e.getFallbackTitle=function(i){const o=i.filter(f.A.hasNoType).reduce(c);return f.A.getText(o)};const c=function(i,a){const o=f.A.getFontSize(i),r=f.A.getFontSize(a);return o>=r?i:a};e.hasRights=function(i){return i.some(f.A.isRights)},e.getRights=function(i){const a=i.find(f.A.isRights);return f.A.getMultiLinesText(a)},e.removeRights=function(i){e.removeEntry(i,f.A.isRights)},e.hasSubtitle=function(i){return i.some(f.A.isSubtitle)},e.getSubtitle=function(i){const a=e.getSubtitleEntry(i);return f.A.getText(a)},e.getSubtitleEntry=function(i){return i.find(f.A.isSubtitle)},e.removeEntry=function(i,a){const o=i.findIndex(a);o!==-1&&i.splice(o,1)};const d=e},434223:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(446921),e=t(423508),s=t(701387),c=t(35802),d=t(104907),i=t(737903);function a(r){const n=s.default.getOwnAttributes(r),u=c.default.getWrappedStaffDetailsOrDefault(n);let l=u.getEntry(0);l=(0,i.default)(l),d.default.clearTuning(l),u.setEntry(l,0);const h=u.dumpAttribute();c.default.setStaffDetails(n,h)}function o(r){const n=f.A.getFirstMeasure(r);(0,e.A)(n)&&a(n)}},434873:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(123491),s=t(244616);function c(i){f.default.getNotes(i).forEach(d)}function d(i){if(e.default.hasColor(i)){const a=e.default.getColor(i);s.default.isBlack(a)&&e.default.removeColor(i)}}},438270:(O,A,t)=>{t.d(A,{A:()=>U});var f=t(145638),e=t(916502),s=t(93923),c=t(123491),d=t(701387),i=t(446921),a=t(726042),o=t(584416),r=t(162621),n=t(546522),u=t(891921),l=t(26698),h=t(189247),I=t(490617),P=t(21738),T=t(131220),_=t(409200),g=t(665280),E=t(868743);const D=function(x,S){(0,P.default)(x,S),(0,T.default)(x,S),(0,_.default)(x,S),(0,g.default)(x,S);const K=new M(x,S);return K.checkPreconditions(),K.get()},M=function(x,S){this.init(x,S)},p=M.prototype;p.init=function(x,S){this.scoreData=x,this.location=S,this.measuresScroller=null,this.targetTimePos=null},p.checkPreconditions=function(){this.checkLocation(),this.sanitize(),this.checkExistence()},p.checkLocation=function(){this.scoreData.checkPartIdx(this.location.partIdx),this.scoreData.checkMeasureIdx(this.location.measureIdx),this.getMeasureData(this.location.measureIdx).checkVoiceIdx(this.location.voiceIdx),(0,I.A)(this.scoreData,this.location)},p.sanitize=function(){if(typeof this.location.pedalIdx!="undefined"){const x=this.getTargetMeasure(),S=d.default.getPedals(x,this.location.staffIdx);if(!a.default.isInteger(this.location.pedalIdx)||this.location.pedalIdx>=S.length)throw new s.A(this.location.pedalIdx);const K=S[this.location.pedalIdx];this.targetTimePos=o.A.getTimePos(K)}else if(typeof this.location.noteIdx!="undefined"){const x=this.getTargetVoice();x.checkNoteIdx(this.location.noteIdx),this.targetTimePos=m(x,this.location.noteIdx)}else throw new e.default("noteIdx OR pedalIdx")},p.fillTargetTimePos=function(){};const m=function(x,S){let K=0;for(let H=0;H<S;H++){const Y=x.getNote(H),C=c.default.getDuration(Y);K+=C}return K};p.getTargetVoice=function(){return this.getMeasureData(this.location.measureIdx).getVoice(this.location.voiceIdx)},p.checkExistence=function(){if(!this.hasPedal())throw new f.A},p.hasPedal=function(){const x=this.getTargetMeasure(),S=d.default.getPedals(x,this.location.staffIdx),K=v(x,this.location.staffIdx);return(0,r.A)(K,S,this.targetTimePos)!==null},p.getTargetMeasure=function(){return this.scoreData.getMeasure(this.location.partIdx,this.location.measureIdx)};const v=function(x,S){return d.default.hasLeftPedal(x,S)?d.default.getLeftPedal(x,S):null};p.get=function(){this.searchSides(),this.convertSidesToNoteIdx(),this.fetchPedalsIdx();const x={placement:this.placement,startPedalIdx:this.startPedalIdx,stopPedalIdx:this.stopPedalIdx};return this.addLocationData(x),x},p.addLocationData=function(x){const S=this.location.partIdx,K=this.scoreData.voiceIdxToIdxInMainStaff(S,this.startVoiceIdx),H=this.scoreData.voiceIdxToIdxInMainStaff(S,this.stopVoiceIdx);x.startMeasureIdx=this.startMeasureIdx,x.startVoiceIdx=this.startVoiceIdx,x.startIdxInStaff=K,x.startNoteIdx=this.startNoteIdx,x.stopMeasureIdx=this.stopMeasureIdx,x.stopVoiceIdx=this.stopVoiceIdx,x.stopIdxInStaff=H,x.stopNoteIdx=this.stopNoteIdx},p.searchSides=function(){const x=this.getMeasures(),S=(0,n.A)(x,this.location.measureIdx,this.location.staffIdx,this.targetTimePos);this.startMeasureIdx=S.startMeasureIdx,this.startTimePos=S.startTimePos,this.stopMeasureIdx=S.stopMeasureIdx,this.stopTimePos=S.stopTimePos,this.placement=S.placement},p.getMeasures=function(){const x=this.scoreData.getPartContent(this.location.partIdx);return i.A.getMeasures(x)},p.convertSidesToNoteIdx=function(){this.convertLeftSide(),this.convertRightSide()},p.convertLeftSide=function(){const x=this.getLeftVoice(),S=1;this.startNoteIdx=(0,u.A)(x,S,this.startTimePos)},p.getLeftVoice=function(){const x=this.getMeasureData(this.startMeasureIdx);if(x.hasVoice(this.location.voiceIdx))this.startVoiceIdx=this.location.voiceIdx;else{let K=this.scoreData.getPartStaffVoicesIndexes(this.location.partIdx,this.location.staffIdx);K=K.filter(x.hasVoice,x),this.startVoiceIdx=K[0]}return x.getVoice(this.startVoiceIdx)},p.convertRightSide=function(){const x=this.getRightVoice(),S=1;this.stopNoteIdx=(0,l.A)(x,S,this.stopTimePos)},p.getRightVoice=function(){const x=this.getMeasureData(this.stopMeasureIdx);if(x.hasVoice(this.location.voiceIdx))this.stopVoiceIdx=this.location.voiceIdx;else{let K=this.scoreData.getPartStaffVoicesIndexes(this.location.partIdx,this.location.staffIdx);K=K.filter(x.hasVoice,x),this.stopVoiceIdx=K[0]}return x.getVoice(this.stopVoiceIdx)},p.getMeasureData=function(x){return this.getMeasuresScroller().getMeasureData(x)},p.getMeasuresScroller=function(){if(this.measuresScroller===null){const x=this.location.partIdx,S=this.scoreData.getPartContent(x),K=i.A.getMeasures(S);this.measuresScroller=new h.A(K,x,this.scoreData)}return this.measuresScroller},p.fetchPedalsIdx=function(){this.fetchLeftPedalIdx(),this.fetchRightPedalIdx()},p.fetchLeftPedalIdx=function(){this.pedalIdx=null;const x=this.scoreData.getMeasure(this.location.partIdx,this.startMeasureIdx),S=d.default.getPedals(x,this.location.staffIdx);this.startPedalIdx=S.findIndex(function(K){const H=o.A.getTimePos(K),Y=o.A.getType(K);return H===this.startTimePos&&Y===E.A.START},this)},p.fetchRightPedalIdx=function(){this.pedalIdx=null;const x=this.scoreData.getMeasure(this.location.partIdx,this.stopMeasureIdx),S=d.default.getPedals(x,this.location.staffIdx);this.stopPedalIdx=S.findIndex(function(K){const H=o.A.getTimePos(K),Y=o.A.getType(K);return H===this.stopTimePos&&Y===E.A.STOP},this)};const U=D},442805:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(c){super(`The harmony uuid "${c} is invalid."`),Object.defineProperty(this,"harmonyUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadHarmonyUuidError",this.harmonyUuid=c}}},446944:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(210888),e=t(601770),s=t(446921),c=t(701387),d=t(368495);function i(r,n){const u={partContent:r,measuresHeaders:n,pluckedRangeUuidByStaff:{}};s.A.getMeasures(r).forEach(a,u)}function a(r,n,u){const l=this,h=c.default.getNbStaves(r);l.measureUuid=e.A.getUuid(l.measuresHeaders[n]);for(let I=0;I<h;I++){let P=c.default.getPluckedRanges(r,I);if(P=P.filter(d.A.isStart),P.forEach(o,l),c.default.hasRightPluckedRange(r,I)){const T=l.pluckedRangeUuidByStaff[I],_=c.default.getRightPluckedRange(r,I);d.A.setPluckedRangeUuid(_,T);const g=u[n+1],E=c.default.getLeftPluckedRange(g,I);d.A.setPluckedRangeUuid(E,T)}}}function o(r){const n=this,u=f.default.generate(),l={pluckedRangeUuid:u,measureUuid:n.measureUuid};s.A.addPluckedRange(n.partContent,l);const h=d.A.getStaffIdx(r);d.A.setPluckedRangeUuid(r,u),n.pluckedRangeUuidByStaff[h]=u}},447856:(O,A,t)=>{t.d(A,{A:()=>s});const f=function(c){return c.replace(/-([a-z])/g,e)},e=function(c){return c[1].toUpperCase()},s=f},454366:(O,A,t)=>{t.d(A,{A:()=>T});var f=t(273885),e=t(493596),s=t(250769);function c(_){const g=_.getNbMeasures();for(let E=0;E<g;E++)if(_.hasSystemBreak(E)&&_.getSystemBreak(E)===s.A.YES||_.hasPageBreak(E)&&_.getPageBreak(E)===s.A.YES)return!0;return!1}function d(_){return c(_)}var i=t(843678);function a(_){const g=[];let E=0;const D=_.getNbMeasures();for(let M=0;M<D;M++)o(_,M)&&(E>0&&g.push(E),E=0),E++;return E>0&&g.push(E),g}function o(_,g){return!!(_.hasSystemBreak(g)&&_.getSystemBreak(g)===s.A.YES||_.hasPageBreak(g)&&_.getPageBreak(g)===s.A.YES)}function r(_){const g=[];return _.forEach(n,g),g}function n(_){const g=this;typeof g[_]=="undefined"&&(g[_]={size:_,occurences:0}),g[_].occurences++}function u(_){const g=a(_),E=r(g);let D=i.default.getValues(E);return D=D.filter(l),D.sort(h),D.length===0?null:{maxNbMeasuresPerLine:D[0].size,forbiddenCounts:{}}}function l(_){return _.occurences>3}function h(_,g){return g.size-_.size}function I(_,g){const E=g.maxNbMeasuresPerLine;let D=0;const M=_.getNbMeasures();for(let p=0;p<M;p++)D>=E?(D=0,P(_,p)&&_.removeSystemBreak(p)):P(_,p)&&(D=0),D++}function P(_,g){return!!(_.hasSystemBreak(g)&&_.getSystemBreak(g)===s.A.YES)}function T(_){const g=_.getDefaults();if(f.A.hasSystemBreakPolicy(g))return;const E=_.getCommonContent(_);if(!c(E)){const M=e.A.createDefault();_.setSystemBreakPolicy(M);return}d(E)&&_.setNotesSpacingCoeff(1);const D=u(E);if(D!==null)_.setSystemBreakPolicy(D),I(E,D);else{const M=e.A.createDefault();_.setSystemBreakPolicy(M);return}}},457652:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(692148),e=t(511872),s=t(143200),c=t(259563),d=t(515819);const i=function(r){if(!c.default.isValid(r.durationType))throw new f.default(r.durationType);if(!d.default.isNbDotsValid(r.nbDots))throw new e.A(r.nbDots);a(r)},a=function(r){const n=r.durationType,u=c.default.toRoomForDots(n);if((r.nbDots||0)>u)throw new s.A},o=i},460284:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(614653);const c=function(d){f.default.getAllHarmonies(d).forEach(e.default.cleanRaw)}},460328:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(701387),e=t(721247);function s(d,i,a){if(i+1===a.length)return;const o=a[i+1],r=f.default.getNbStaves(d),n=f.default.getWrappedOwnClef(o),u=f.default.getWrappedClef(o);for(let h=0;h<r;h++){const I=c(d,h);if(I===null)continue;const P=u.getEntry(h);if(e.default.isSame(I,P))n.setEntry(null,h);else{const T=e.default.copy(P);n.setEntry(T,h)}}const l=n.dumpAttribute();f.default.setOwnClef(o,l)}function c(d,i){if(!f.default.hasMiddleClefs(d,i))return f.default.getWrappedClef(d).getEntry(i);const a=f.default.getMiddleClefs(d,i),o=a.length;return a[o-1]}},461169:(O,A,t)=>{t.d(A,{A:()=>u});var f=t(443749),e=t(706900),s=t(21738),c=t(131220),d=t(665280),i=t(726042),a=t(701387),o=t(496819);const r=function(l,h){(0,s.default)(l,h),(0,c.default)(l,h),(0,d.default)(l,h),l.checkPartIdx(h.partIdx),l.checkMeasureIdx(h.measureIdx);const I=l.getMeasure(h.partIdx,h.measureIdx),P=h.staffIdx,T=a.default.getNbStaves(I);if(!i.default.isInteger(P)||P<0||P>=T)throw new f.default(P);const _=a.default.getDynamics(I,h.staffIdx),g=_.length,E=h.dynamicIdx;if(!i.default.isInteger(E)||E<0||E>=g)throw new e.A(E);const D=_[E],M=o.A.getStyle(D),p=n(D);return{style:M,sound:p}},n=function(l){return o.A.hasSound(l)?o.A.getSound(l):null},u=r},463663:(O,A,t)=>{t.d(A,{A:()=>Y});var f=t(701387),e=t(123491),s=t(50060);const c=function(C,y){return f.default.getNotes(y).reduce(d,C),C},d=function(C,y){return e.default.getLyrics(y).reduce(i,C),C},i=function(C,y){const F=s.default.getRawLevel(y);return C[F]=!0,C},a=c,r=function(C){const y={};return C.reduce(a,y),y};var n=t(890439),u=t(726042);const h=function(C){return C=parseInt(C,10),u.default.isInteger(C)?C<1:!0},P=function(C){return n.Ay.toList(C).some(h)},T=function(C){const y={};let F=n.Ay.toList(C);F=F.filter(h);const N={updateMap:y,levelsSet:C,level:1};return F.forEach(_,N),y},_=function(C){const y=this;let F=y.level;F=g(F,y.levelsSet),y.updateMap[C]=F.toString(),y.level=F+1},g=function(C,y){for(;typeof y[C]!="undefined";)C++;return C},E=T,D=function(C,y){e.default.getLyrics(C).forEach(M,y)},M=function(C){const y=this;let F=s.default.getRawLevel(C);if(typeof y[F]!="undefined"){F=y[F];const N=parseInt(F,10)-1;s.default.setLevel(C,N)}},p=D,m=function(C,y){f.default.getNotes(C).forEach(v,y)},v=function(C){p(C,this)},U=m,x=function(C,y){C.forEach(S,y)},S=function(C){U(C,this)},K=x,Y=function(C){const y=r(C);if(P(y)){const F=E(y);K(C,F)}}},468852:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(364842);const e={LEFT:"left",RIGHT:"right"};e.values=[e.LEFT,e.RIGHT],e.isValid=function(c){return e.values.includes(c)},e.assert=function(c){e.isValid(c)||e.raiseError(c)},e.isLeft=function(c){return c===e.LEFT},e.isRight=function(c){return c===e.RIGHT},e.raiseError=function(c){const d=`The octave shift location [${c}] is invalid.`;throw new f.default("BadPedalLocation",d)};const s=e},469019:(O,A,t)=>{t.d(A,{A:()=>T});var f=t(364842),e=t(259563),s=t(123491),c=t(515819),d=t(799855),i=t(343568),a=t(759240),o=t(209175),r=t(721370);const n=function(_,g,E,D){this.init(_,g,E,D)},u=n.prototype;u.init=function(_,g,E,D){this.timeToDispatch=_,this.timePerBeat=g,this.divisionsPerQuarter=E,this.timeModif=D,this.shards=[]},u.dispatch=function(){for(;this.timeToDispatch>0;)this.insertShard()},u.insertShard=function(){let _=this.timePerBeat;if(_>this.timeToDispatch)for(_=this.timeToDispatch;_>0;){const g=this.extractBaseSpace(_);_-=g,this.storeSpaceShard(g)}else this.storeSpaceShard(_)},u.extractBaseSpace=function(_){const g=c.default.actualToNormal(_,this.timeModif),E=c.default.divisionsToQuarter(g,this.divisionsPerQuarter),D=c.default.extractBaseDuration(E),M=c.default.quarterToDuration(D,this.divisionsPerQuarter);let p=c.default.normalToActual(M,this.timeModif);const m=this.getSubBeat();return p=Math.min(p,m),p},u.getSubBeat=function(){return this.isCompound()?this.timePerBeat/3:this.timePerBeat/2},u.isCompound=function(){if(!o.default.isNormal(this.timeModif))return!1;const _=new r.default(this.timePerBeat,this.divisionsPerQuarter);return _.simplify(),_.getNumerator()%3===0},u.storeSpaceShard=function(_){this.timeToDispatch-=_,this.timePos+=_,this.shards.unshift(_)},u.getDispatchedRests=function(){return this.shards};const l=n;var h=t(80353);const I=function(_,g,E){this.init(_,g,E)};I.NAME="composite.AddRests";const P=I.prototype;P.name=I.NAME,P.initMeasureData=i.A,P.init=function(_,g,E){this.initMeasureData(_,g),this.cancelStack=E,this.opts=g},P.perform=function(){if(this.cancelStack=this.cancelStack.createSubstack(this.name),this.opts.insertMode===d.default.INSERT)this.addAtEnd();else if(this.opts.insertMode===d.default.REPLACE)this.addAtIdx();else{const _=`Unexpected insert mode: [${this.opts.insertMode}].`;throw new f.default("Unexpected",_)}},P.addAtEnd=function(){const _=this.getVoiceOrTuplet(),g=this.opts.duration,E=this.getDivisionsPerBeat(),D=this.getDpq(),M=this.getAbsoluteTimeModif(),p=new l(g,E,D,M);p.dispatch();const m=p.getDispatchedRests();this.insertionIdx=_.getStopNoteIdx()+1,this.addRests(m)},P.addAtIdx=function(){const _=this.getTimePosition(),g=this.opts.duration,E=this.getDivisionsPerBeat(),D=this.getDpq(),M=this.getAbsoluteTimeModif(),p=new a.A(_,g,E,D,M);p.dispatch();const m=p.getDispatchedRests();this.insertionIdx=this.opts.noteIdx,this.addRests(m)},P.getTimePosition=function(){const _=this.getVoiceOrTuplet();let g=0;for(let E=_.getStartNoteIdx();E<this.opts.noteIdx;E++){const D=_.getNote(E),M=s.default.getDuration(D);g+=M}return g},P.getDivisionsPerBeat=function(){const _=this.getVoiceOrTuplet();return _.isTuplet()?this.getDivPerBeatFromTimeModif(_):this.getDivPerBeatFromTimeSignature()},P.getDivPerBeatFromTimeSignature=function(){const _=this.measureData.getAnyTime(),g=c.default.getBeatQuarterDuration(_),E=this.getDpq();return c.default.quarterToDuration(g,E)},P.getDivPerBeatFromTimeModif=function(_){const g=_.getAbsoluteTimeModif(),E=_.getDurationType(),D=this.getDpq(),M=e.default.toQuarterDuration(E),p=c.default.quarterToDuration(M,D);return c.default.normalToActual(p,g)},P.getDpq=function(){return this.measureData.getDpqValue()},P.getVoiceOrTuplet=function(){const _=this.opts.voiceIdx,g=this.opts.noteIdx;return this.measureData.getVoiceOrTupletForInsert(_,g)},P.getVoice=function(){return this.measureData.getVoice(this.opts.voiceIdx)},P.addRests=function(_){_.forEach(this.addRest,this)},P.addRest=function(_,g){const E=g+this.insertionIdx,D=this.getDurationOpts(_),M={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx,staffIdx:this.opts.staffIdx,noteIdx:E,durationType:D.durationType,nbDots:D.nbDots};new h.A(this.measureData,M,this.cancelStack).perform()},P.getDurationOpts=function(_){const g=this.getAbsoluteTimeModif(),E=this.getDpq();return c.default.actualDivisionsToDurationOpts(_,E,g)},P.getAbsoluteTimeModif=function(){return this.getVoiceOrTuplet().getAbsoluteTimeModif()};const T=I},471303:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(951066);function e(c){return`The beat [${c}] is invalid. It should be a positive integer.`}class s extends f.A{constructor(d){const i=e(d);super(i),Object.defineProperty(this,"beat",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadBeatItemError",this.beat=d}}},471347:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(364842),e=t(701387),s=t(123491);const c=function(a){e.default.getNotes(a).reduce(d,null)},d=function(a,o){let r;if(s.default.isChord(o)){if(s.default.hasVoiceIdx(o))return r=s.default.getVoiceIdx(o),r;if(a!==null)return s.default.setVoiceIdx(o,a),a;{const n="Cannot have a chord note without former voice idx indication.";throw new f.default("Unexpected",n)}}else return r=s.default.getVoiceIdx(o),r},i=c},474765:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(891921),e=t(125911),s=t(701387),c=t(726042);const d=function(n,u,l){const h=i(n,u,l);if(h===null)return null;const I=a(n,u,l);return I===null||o(h,I)?null:{voiceIdx:l,startMeasureIdx:h.measureIdx,startNoteIdx:h.noteIdx,stopMeasureIdx:I.measureIdx,stopNoteIdx:I.noteIdx}},i=function(n,u,l){let h=u.startMeasureIdx,I=n.getMeasureData(h);if(I.hasVoice(l)){const T=I.getVoice(l),_=I.getDpqValue(),g=c.default.lcm(_,u.startDpq),E=u.startTimePos*g/u.startDpq,D=g/_;let M=(0,f.A)(T,D,E);(0,e.A)(T,D,E)||M++;const p=T.getNbNotes();if(M<p)return{measureIdx:h,noteIdx:M}}h++;const P=n.getNbMeasures();for(;h<P&&h<=u.stopMeasureIdx;h++)if(I=n.getMeasureData(h),I.hasVoice(l))return{measureIdx:h,noteIdx:0};return null},a=function(n,u,l){let h=u.stopMeasureIdx,I=n.getMeasureData(h),P;if(I.hasVoice(l)){const T=I.getMeasure(),_=I.getDpqValue(),g=c.default.lcm(_,u.stopDpq),E=u.stopTimePos*g/u.stopDpq,D=g/_,M=s.default.getNbDivisions(T)*D;if(P=I.getVoice(l),E===M)return{measureIdx:h,noteIdx:P.getNbNotes()-1};let p=(0,f.A)(P,D,E);if((0,e.A)(P,D,E)&&p--,p>=0)return{measureIdx:h,noteIdx:p}}for(h--;h>=0&&h>=u.startMeasureIdx;h--)if(I=n.getMeasureData(h),I.hasVoice(l)){P=I.getVoice(l);const T=P.getNbNotes();return{measureIdx:h,noteIdx:T-1}}return null},o=function(n,u){return n.measureIdx<u.measureIdx?!1:n.measureIdx>u.measureIdx?!0:n.noteIdx>u.noteIdx},r=d},477849:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(726042),e=t(701387),s=t(952818);const c=function(a,o,r){this.init(a,o,r)},d=c.prototype;d.init=function(a,o,r){this.scoreData=a,this.location=o,this.utils=r,this.entities=[]},d.get=function(){this.initTimePos(),this.measureIdx=this.location.startMeasureIdx;const a=this.location.stopMeasureIdx;for(;this.measureIdx<=a;this.measureIdx++){this.adaptDpq();const o=this.getMeasure(this.measureIdx);let r=this.utils.getEntities(o,this.location.staffIdx);r=r.filter(this.positionPredicate,this),r.forEach(this.addEntity,this),this.moveForward()}return this.entities},d.initTimePos=function(){const a=this.getMeasure(this.location.startMeasureIdx),o=e.default.getDpq(a);this.dpq=f.default.lcm(o,this.location.startDpq);const r=this.location.startTimePos*this.dpq/this.location.startDpq;this.timePos=-r},d.adaptDpq=function(){const a=this.getMeasure(this.measureIdx),o=e.default.getDpq(a),r=f.default.lcm(this.dpq,o),n=r/this.dpq;this.timePos*=n,this.dpq=r},d.getDpq=function(a){const o=this.getMeasure(a);return e.default.getDpq(o)},d.getMeasure=function(a){return this.scoreData.getMeasure(this.location.partIdx,a)},d.positionPredicate=function(a){const o=s.A.getTimePos(a);if(this.measureIdx===this.location.startMeasureIdx){const r=this.getMeasureDpq(this.location.startMeasureIdx);if(o*this.location.startDpq/r<this.location.startTimePos)return!1}if(this.measureIdx===this.location.stopMeasureIdx){const r=this.getMeasureDpq(this.location.stopMeasureIdx);if(o*this.location.stopDpq/r>=this.location.stopTimePos)return!1}return!0},d.addEntity=function(a){const o=this.getMeasureDpq(this.measureIdx),r=this.dpq/o;let n=s.A.getTimePos(a);n*=r,n+=this.timePos;const u={timePos:n,dpq:this.dpq};this.utils.fillEntity(a,u),this.entities.push(u)},d.getMeasureDpq=function(a){const o=this.getMeasure(a);return e.default.getDpq(o)},d.moveForward=function(){const a=this.getMeasure(this.measureIdx),o=e.default.getDpq(a);let r=e.default.getNbDivisions(a);r*=this.dpq/o,this.timePos+=r};const i=c},479400:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(701387),e=t(74446),s=t(518558),c=t(813263);const i=function(r){let n;const u=f.default.getAnyTime(r);if(f.default.hasBeatsList(r)){n=f.default.getBeatsList(r);const l=s.default.getNbBeats(u);e.default.isValid(n,l)?n=e.default.copy(n):n=(0,c.default)(u)}else n=(0,c.default)(u);return n},o=function(r,n,u){const l=i(r);u.setBeatsList(n,l)}},480317:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(364842),e=t(601770);const c=function(d,i){let a=-1;for(let o=0;o<d.length;o++)if(e.A.getUuid(d[o])===i){a=o;break}if(a<0){const o=`There is no measureIdx for measureUuid [${i}].`;throw new f.default("Unexpected",o)}return a}},480699:(O,A,t)=>{t.d(A,{A:()=>p});var f=t(364842),e=t(701387),s=t(123491),c=t(203066),d=t(94622),i=t(21738),a=t(779146),o=t(409200),r=t(665280),n=t(118824);const u=function(m,v){(0,i.default)(m,v),(0,a.default)(m,v),(0,o.default)(m,v),(0,r.default)(m,v);const U={hasLeftContinue:l,searchLeftStart:h,getEntities:I,createStart:_,createStop:g,hasRightContinue:E,searchRightStop:D,createEntry:M,isEntityStart:P,isEntityStop:T},x=new n.A(m,v,U);return x.checkPreconditions(),x.get()},l=function(){const m=this.getMeasure(this.location.startMeasureIdx);return e.default.hasLeftSlur(m,this.location.voiceIdx)},h=function(){const m=this.getMeasuresScroller(),v={measureIdx:this.location.startMeasureIdx,noteIdx:0,voiceIdx:this.location.voiceIdx},U=(0,c.A)(m,v);if(U===null)throw new f.default("Unexpected","There should be a slur start.");return{measureIdx:U.measureIdx,noteIdx:U.noteIdx}},I=function(m){const v=this.getMeasureData(m);if(!v.hasVoice(this.location.voiceIdx))return[];const U=[],x=v.getVoice(this.location.voiceIdx),S=x.getNbNotes();for(let K=0;K<S;K++){const H=x.getNote(K);s.default.hasSlurStart(H)?U.push({start:!0,noteIdx:K}):s.default.hasSlurStop(H)&&U.push({stop:!0,noteIdx:K})}return U},P=function(m){return m.start===!0},T=function(m){return m.stop===!0},_=function(m,v){return{measureIdx:v,noteIdx:m.noteIdx}},g=function(m,v){return{measureIdx:v,noteIdx:m.noteIdx}},E=function(){const m=this.getMeasure(this.location.stopMeasureIdx);return e.default.hasRightSlur(m,this.location.voiceIdx)},D=function(){const m=this.getMeasuresScroller(),v={measureIdx:this.location.stopMeasureIdx+1,noteIdx:0,voiceIdx:this.location.voiceIdx},U=(0,d.A)(m,v);if(U===null)throw new f.default("Unexpected","There should be a slur start.");return{measureIdx:U.measureIdx,noteIdx:U.noteIdx}},M=function(m,v){const U=this.location.voiceIdx,x=this.scoreData.getPartVoiceUuid(this.location.partIdx,U),S=this.location.partIdx,K={startMeasureIdx:m.measureIdx,startMeasureUuid:this.scoreData.getMeasureUuid(m.measureIdx),startNoteIdx:m.noteIdx,startVoiceIdx:U,startVoiceUuid:x,stopMeasureIdx:v.measureIdx,stopMeasureUuid:this.scoreData.getMeasureUuid(v.measureIdx),stopNoteIdx:v.noteIdx,stopVoiceIdx:U,stopVoiceUuid:x},H=this.getMeasure(m.measureIdx);K.startDpq=e.default.getDpq(H);const Y=this.getVoice(m.measureIdx);K.startTimePos=Y.getRangeSpace(0,m.noteIdx),K.startIdxInStaff=this.scoreData.voiceIdxToIdxInMainStaff(S,K.startVoiceIdx);const C=this.getMeasure(v.measureIdx);K.stopDpq=e.default.getDpq(C);const y=this.getVoice(v.measureIdx);return K.stopTimePos=y.getRangeSpace(0,v.noteIdx),K.stopIdxInStaff=K.startIdxInStaff,K},p=u},485037:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(657032),e=t(343568),s=t(852363);const c=function(a,o,r){this.init(a,o,r)};c.NAME="composite.ShowMeasureVoice";const d=c.prototype;d.name=c.NAME,d.initMeasureData=e.A,d.init=function(a,o,r){this.initMeasureData(a,o),this.cancelStack=r,this.opts=o},d.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.createVoice(),this.addRests(),this.updateStack()},d.createVoice=function(){this.measureData.getVoicesList().insertVoice(this.opts.voiceIdx)},d.addRests=function(){const a={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,voiceIdx:this.opts.voiceIdx};new f.A(this.measureData,a).perform()},d.updateStack=function(){const a={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx}};this.cancelStack.push(a),(0,s.default)(this.cancelStack,this.measureData,this.opts)};const i=c},486809:(O,A,t)=>{t.d(A,{A:()=>D});var f=t(348742),e=t(259563),s=t(701387),c=t(123491),d=t(515819),i=t(518558),a=t(726042);const o=[e.default.QUARTER,e.default.EIGHT,e.default.SIXTEENTH,e.default.THIRTY_SECOND,e.default.SIXTY_FOURTH],r=function(M){let p=n(M);p===null&&(p=l(M)),g(M,p)},n=function(M){const p={time:null};return M.some(u,p),p.time},u=function(M){if(s.default.hasOwnTime(M)){const p=s.default.getAnyOwnTime(M);return this.time=i.default.copy(p),!0}else return!1},l=function(M){const m=M.map(h).reduce(a.default.max2);if(m===0){const S="Cannot infer a time signature from an empty measure.";throw new f.A("InferFirstOwnTimeSignature",S)}const v=T(m),U=_(m,v);return i.default.create(U,v)},h=function(M){const p=new I(M);return p.extract(),p.getQuarterDuration()},I=function(M){this.init(M)},P=I.prototype;P.init=function(M){this.maxLength=0,this.timePos=0,this.divisionsPerQuarter=s.default.getOwnDivisions(M),this.notes=s.default.getNotes(M)},P.extract=function(){this.searchMeasureSize()},P.searchMeasureSize=function(){this.notes.forEach(this.addNote,this)},P.addNote=function(M){if(!c.default.isChord(M)&&(this.applyTimeShifts(M),c.default.hasDuration(M))){const p=c.default.getDuration(M);this.addDuration(p)}},P.applyTimeShifts=function(M){if(c.default.hasBackup(M)){const p=c.default.getBackupDuration(M);this.timePos-=p}if(c.default.hasForward(M)){const p=c.default.getForwardDuration(M);this.timePos+=p}this.recordMax()},P.recordMax=function(){this.maxLength=Math.max(this.timePos,this.maxLength)},P.addDuration=function(M){this.timePos+=M,this.recordMax()},P.getQuarterDuration=function(){return this.maxLength/this.divisionsPerQuarter};const T=function(M){const p=o.length;for(let v=0;v<p;v++){const U=o[v],x=e.default.toQuarterDuration(U),S=M/x;if(a.default.isInteger(S))return d.default.quarterToBeatType(x)}const m=`Cannot infer a time signature from the total quarter duration [${M}].`;throw new f.A("InferFirstOwnTimeSignature",m)},_=function(M,p){const m=d.default.beatTypeToQuarter(p);return M/m},g=function(M,p){M.forEach(E,p)},E=function(M){let p=this;p=i.default.copy(p),s.default.setOwnTime(M,[p])},D=r},487454:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(701387),e=t(589501);const s=function(n){return n=new c(n).filter(),n},c=function(n){this.init(n)},d=c.prototype;d.init=function(n){this.sourceFiguedBasses=n,this.filtered=[],this.stack=[]},d.filter=function(){return this.sourceFiguedBasses.forEach(this.filterFiguredBass,this),this.isStackEmpty()||this.flushStack(),this.filtered},d.filterFiguredBass=function(n){this.canPushInStack(n)||this.flushStack(),this.stack.push(n)},d.canPushInStack=function(n){if(this.isStackEmpty())return!0;const u=e.A.getTimePos(n),l=this.getStackTimePos();return u===l},d.isStackEmpty=function(){return this.stack.length===0},d.getStackTimePos=function(){const n=this.stack[0];return e.A.getTimePos(n)},d.flushStack=function(){const n=this.stack[0];this.stack=[],this.filtered.push(n)};const i=s,a=function(n){let u=f.default.getFiguredBasses(n);u=u.filter(e.A.isSupported),u=u.filter(o),u.sort(e.A.compareTimePos),u=i(u),u.forEach(e.A.normalize),f.default.setFiguredBasses(n,u)};function o(n){return!(!e.A.has$adagioLocation(n)||typeof e.A.getTimePos(n)!="number")}const r=a},488592:(O,A,t)=>{t.d(A,{A:()=>e});const f={};f.hasLock=function(s){return!(typeof s.$adagio=="undefined"||typeof s.$adagio.lock=="undefined")},f.createLock=function(s){typeof s.$adagio=="undefined"&&(s.$adagio={}),s.$adagio.lock={date:Date.now()}};const e=f},490157:(O,A,t)=>{t.d(A,{A:()=>g});var f=t(558280),e=t(995677);const s=function(E){return E=new c(E).group(),E},c=function(E){this.init(E)},d=c.prototype;d.init=function(E){this.wrappedDirections=E,this.ongoingWedges={},this.grouppedDirections=[]},d.group=function(){return this.wrappedDirections.forEach(this.analyzeWedge,this),this.grouppedDirections},d.analyzeWedge=function(E){const D=E.direction,M=f.A.getRawType(D);M===e.A.CONTINUE||(M===e.A.CRESCENDO||M===e.A.DIMINUENDO?this.startWedge(E):M===e.A.STOP?this.stopWedge(E):e.A.raiseError(M))},d.startWedge=function(E){const D=E.direction,M=f.A.getNumber(D),p=f.A.getStaffIdx(D);this.addWedgeStart(p,M,E)},d.addWedgeStart=function(E,D,M){typeof this.ongoingWedges[E]=="undefined"&&(this.ongoingWedges[E]={}),this.ongoingWedges[E][D]=M},d.stopWedge=function(E){const D=E.direction,M=f.A.getNumber(D),p=f.A.getStaffIdx(D);if(this.hasWedgeStart(p,M)){const m=this.getWrappedStart(p,M),v=m.direction;!i(v,D)||a(m,E)?this.discardDirection(p,M):(this.ongoingWedges[p]={},this.addCompleteWedge(m,E))}},d.hasWedgeStart=function(E,D){return typeof this.ongoingWedges[E]=="undefined"?!1:typeof this.ongoingWedges[E][D]!="undefined"},d.getWrappedStart=function(E,D){return this.ongoingWedges[E][D]},d.discardDirection=function(E,D){delete this.ongoingWedges[E][D]};const i=function(E,D){const M=f.A.getPlacement(E),p=f.A.getPlacement(D),m=f.A.getStaffIdx(E),v=f.A.getStaffIdx(D);return M===p&&m===v},a=function(E,D){return E.timePos===D.timePos&&E.measureIdx===D.measureIdx};d.addCompleteWedge=function(E,D){this.grouppedDirections.push(E),this.grouppedDirections.push(D)};const o=s;var r=t(805793),n=t(817066),u=t(537920),l=t(701387),h=t(364842);const I=function(E){const D=E.length;let M=(0,r.A)(E),p=M.map(P);p=p.map(o),M=p.map(function(m){return(0,u.A)(m,D)}),M.forEach(_,E)};function P(E){return(0,n.A)(E,T)}function T(E,D){const M=E.measureIdx-D.measureIdx;return M!==0?M:f.A.compare(E.direction,D.direction)}const _=function(E,D){const M=this;if(M.length!==E.length){const p="Array size should be the same.";throw new h.default("NotSameSize",p)}M.forEach(function(p,m){const v=E[m];l.default.setWedges(p,D,v)})},g=I},490617:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(869607),e=t(813864);const c=function(d,i){if(d=(0,e.A)(d),!d.getPartVoiceMapping(i.partIdx)[i.voiceIdx].includes(i.staffIdx))throw new f.A(i.voiceIdx,i.staffIdx,i.partIdx)}},493822:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(724095),e=t(701387),s=t(365340),c=t(123491),d=t(706650);function i(o){e.default.getNotes(o).forEach(a)}function a(o){if(!c.default.hasOrnamentType(o,f.A.TREMOLO))return;const r=c.default.getNotations(o),n=d.A.getOrnaments(r),u=s.default.getSingle(n,f.A.TREMOLO);let l=s.default.stringOrContent(u);l=parseInt(l,10),l===0&&(d.A.removeOrnament(r,f.A.TREMOLO),c.default.setNotations(o,r))}},497930:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(515819);const s=function(c,d){const i=f.default.getBeatQuarterDurationBeam(c);return f.default.quarterToDuration(i,d)}},501756:(O,A,t)=>{t.d(A,{A:()=>l});var f=t(701387),e=t(35802),s=t(721247),c=t(104907);const d="G",i=function(h,I,P){const T=f.default.getClef(h),_=f.default.getOwnAttributes(h),g=e.default.getClef(_);if(!(!T.some(s.default.isTab)&&!g.some(s.default.isTab))){if(I===0)a(h);else{const E=P[I-1];n(E,h)}if(I+1<P.length){const E=P[I+1];u(h,E)}}},a=function(h){const I=f.default.getAttributes(h),P=f.default.getOwnAttributes(h);o(I,I),o(P,I)},o=function(h,I){if(e.default.getClef(h).some(s.default.isTab)){const T=e.default.getWrappedClef(h);for(let _=0;_<T.getNbStaves();_++)if(T.hasEntry(_)){let g=T.getEntry(_);g=r(g,_,I),T.setEntry(g,_)}e.default.setClef(h,T.dumpAttribute())}},r=function(h,I,P){if(s.default.isTab(h)){const _=e.default.getWrappedStaffDetailsOrDefault(P).getEntry(I);c.default.hasStaffTuning(_)?h=c.default.toClef(_):h=s.default.create(d)}return h},n=function(h,I){const P=f.default.getWrappedClef(h),T=f.default.getWrappedClef(I),_=f.default.getWrappedOwnClef(I),g=f.default.getNbStaves(I);for(let M=0;M<g;M++){let p=T.getEntry(M);if(s.default.isTab(p)){const m=P.getEntry(M);p=s.default.copy(m),T.setEntry(p,M),_.setEntry(null,M)}}const E=T.dumpAttribute();f.default.setClef(I,E);const D=_.dumpAttribute();f.default.setOwnClef(I,D)},u=function(h,I){const P=f.default.getWrappedClef(h),T=f.default.getWrappedClef(I),_=f.default.getWrappedOwnClef(I),g=f.default.getNbStaves(h);for(let D=0;D<g;D++){const M=T.getEntry(D),p=P.getEntry(D);s.default.isSame(p,M)&&_.setEntry(null,D)}const E=_.dumpAttribute();f.default.setOwnClef(I,E)},l=i},505564:(O,A,t)=>{t.d(A,{A:()=>P});var f=t(364842),e=t(123491),s=t(351277),c=t(292681),d=t(832560);let i=null;const a=function(T){new d.A(T).forEachVoice(o)},o=function(T){const _=T.size();for(let g=0;g<_;g++)T.isChord(g)&&r(T,g)},r=function(T,_){n().filter(T,_)},n=function(){return i===null&&(i=new u),i},u=function(){},l=u.prototype;l.filter=function(T,_){this.reset(T,_);let g=this.voice.getChord(this.noteIdx);g=g.slice(),g.forEach(this.processHead,this)},l.reset=function(T,_){this.voice=T,this.noteIdx=_,this.headIdx=0,this.map={}},l.processHead=function(T){const _=I(T);this.hasDuplicate(_)?this.removeHead(_,T):(this.addHead(_,T),this.headIdx++)},l.hasDuplicate=function(T){return typeof this.map[T]!="undefined"},l.getHead=function(T){return this.map[T]},l.removeHead=function(T,_){const g=this.map[T];h(g,_)&&(e.default.hasTieStart(_)&&!e.default.hasTieStart(g)&&e.default.addTieStart(g),e.default.hasTieStop(_)&&!e.default.hasTieStop(g)&&e.default.addTieStop(g)),this.voice.removeNoteFromChord(this.noteIdx,this.headIdx)};const h=function(T,_){if(e.default.hasPitch(T)){const g=e.default.getPitch(T),E=e.default.getPitch(_);return s.default.isSamePitch(g,E)}else if(e.default.hasUnpitched(T)){const g=e.default.getUnpitched(T),E=e.default.getUnpitched(_);return c.default.isSame(g,E)&&e.default.getHead(T)===e.default.getHead(_)}else throw new f.default("Unexpected")},I=function(T){let _;if(e.default.hasPitch(T)){const g=e.default.getPitch(T);return _=`${s.default.getOctave(g)}/${s.default.getStep(g)}`,_}else if(e.default.hasUnpitched(T)){const g=e.default.getUnpitched(T);return _=c.default.stringify(g),_}else throw new f.default("Unexpected")};l.addHead=function(T,_){this.map[T]=_};const P=a},507004:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(891921);function e(c,d){const i=c.getMeasureData(d.measureIdx),a={};a.voiceIdx=s(i,d.searchedVoiceIdx,d.staffVoicesIndexes);const o=i.getVoice(a.voiceIdx),n=i.getDpqValue()/d.dpq;return a.noteIdx=(0,f.A)(o,n,d.timePos),a}function s(c,d,i){return c.hasVoice(d)?d:i.filter(c.hasVoice,c)[0]}},508828:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(446921),e=t(701387),s=t(123491),c=t(474072);function d(n){return n.every(i)}function i(n){return f.A.getMeasures(n).every(a)}function a(n){let u;return u=!e.default.getNotes(n).some(o),!(!u||(u=!e.default.getAllRawAttributes(n).some(r),!u))}function o(n){return!s.default.hasTimePos(n)}function r(n){return!c.A.hasTimePos(n)}},510601:(O,A,t)=>{t.d(A,{A:()=>e});const f="Guitar Pro";function e(s){const{identification:c}=s;if(typeof c=="undefined")return!1;const{encoding:d}=c;if(typeof d=="undefined")return!1;const{software:i}=d;return typeof i!="string"?!1:i.startsWith(f)}},511084:(O,A,t)=>{t.d(A,{A:()=>F});var f=t(843678),e=t(383279),s=t(446921),c=t(701387),d=t(123491),i=t(292681);const a=function(N,G){const nt=s.A.getMeasures(N),J={},V={},W={pitchMapping:J,header:G,frequencies:V};nt.forEach(o,W);const Z=l(V);return P(J,Z),J},o=function(N){c.default.getNotes(N).forEach(r,this)},r=function(N){if(!d.default.hasUnpitched(N)||!d.default.hasInstrumentId(N))return;const G=d.default.getInstrumentId(N);if(!e.default.hasInstrumentId(this.header,G))return;const nt=d.default.getUnpitched(N),J=d.default.getHead(N);n(this.pitchMapping,nt,J,G),u(this.frequencies,nt,J)},n=function(N,G,nt,J){const V=i.default.stringify(G);typeof N[V]=="undefined"&&(N[V]={}),N[V][nt]=J},u=function(N,G,nt){const J=i.default.stringify(G);typeof N[J]=="undefined"&&(N[J]={}),typeof N[J][nt]=="undefined"?N[J][nt]=1:N[J][nt]++},l=function(N){const G={};for(const nt in N){const J=N[nt],V=h(J);G[nt]=V}return G},h=function(N){const G=f.default.toPairs(N);return G.sort(I),G[0].key},I=function(N,G){return G.value-N.value},P=function(N,G){for(const nt in N){const J=G[nt];N[nt].default=J}},T=a;var _=t(364842),g=t(402119),E=t(759972),D=t(886190);const M=function(N,G){const nt=e.default.getMIDIInstruments(N),J=(0,g.A)(nt);let V=K();x(V,J),V=(0,E.A)(V,J);const W=U(G);S(V,W),v(V,G),p(G,V)},p=function(N,G){for(const nt in G){const J=G[nt];for(const V in J)if(V!=="default"){const W=J[V];typeof N[nt]=="undefined"&&(N[nt]={}),N[nt][V]=W}if(typeof N[nt]!="undefined"){const V=N[nt];let W=J.default;typeof V[W]!="undefined"?V.default=W:typeof V.default=="undefined"&&(W=m(V),V.default=W)}}},m=function(N){for(const G in N)return G;throw new _.default("Unexpected, heads should not be empty.")},v=function(N,G){for(const nt in N)if(typeof G[nt]!="undefined"){const J=N[nt],V=G[nt];for(const W in J)W!=="default"&&typeof V[W]!="undefined"&&delete J[W]}},U=function(N){const G={};for(const nt in N){const J=N[nt];for(const V in J)if(V!=="default"){const W=J[V];G[W]=!0}}return G},x=function(N,G){for(const nt in N){const J=N[nt];for(const V in J)if(V!=="default"){const{midiUnpitched:W,midiProgram:Z}=J[V];(typeof G[W]=="undefined"||typeof G[W][Z]=="undefined")&&delete J[V]}}},S=function(N,G){for(const nt in N){const J=N[nt];for(const V in J)if(V!=="default"){const W=J[V];typeof G[W]!="undefined"&&delete J[V]}}},K=function(){return{"uD/4":{x:{midiUnpitched:"45",midiProgram:D.default.UNPITCHED_PROGRAM},default:"x"},"uF/4":{normal:{midiUnpitched:"36",midiProgram:D.default.UNPITCHED_PROGRAM},default:"normal"},"uA/4":{normal:{midiUnpitched:"44",midiProgram:D.default.UNPITCHED_PROGRAM},default:"normal"},"uC/5":{normal:{midiUnpitched:"39",midiProgram:D.default.UNPITCHED_PROGRAM},x:{midiUnpitched:"38",midiProgram:D.default.UNPITCHED_PROGRAM},default:"normal"},"uD/5":{normal:{midiUnpitched:"46",midiProgram:D.default.UNPITCHED_PROGRAM},default:"normal"},"uE/5":{normal:{midiUnpitched:"48",midiProgram:D.default.UNPITCHED_PROGRAM},x:{midiUnpitched:"47",midiProgram:D.default.UNPITCHED_PROGRAM},default:"normal"},"uF/5":{normal:{midiUnpitched:"51",midiProgram:D.default.UNPITCHED_PROGRAM},x:{midiUnpitched:"52",midiProgram:D.default.UNPITCHED_PROGRAM},diamond:{midiUnpitched:"54",midiProgram:D.default.UNPITCHED_PROGRAM},default:"normal"},"uG/5":{x:{midiUnpitched:"43",midiProgram:D.default.UNPITCHED_PROGRAM},default:"x"},"uA/5":{x:{midiUnpitched:"50",midiProgram:D.default.UNPITCHED_PROGRAM},default:"x"},"uB/5":{x:{midiUnpitched:"56",midiProgram:D.default.UNPITCHED_PROGRAM},default:"x"}}},H=M;var Y=t(319330);function C(N){const G=e.default.getLegacyPitchMapping(N),nt=e.default.getMIDIInstruments(N),J=(0,g.A)(nt);(0,Y.A)(G,J);const V=(0,E.A)(G,J);e.default.setUnpitchedMapping(N,V),e.default.removeLegacyPitchMapping(N)}const F=function(N,G){N.forEach(function(nt,J){if(e.default.hasUnpitched(nt)&&!e.default.hasUnpitchedMapping(nt))if(e.default.hasLegacyPitchMapping(nt))C(nt);else{const V=G[J],W=T(V,nt);H(nt,W),e.default.setUnpitchedMapping(nt,W)}})}},512034:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(701387),e=t(721247),s=t(35802),c=t(104907),d=t(819795);function i(a){const o=f.default.getOwnAttributes(a);if(s.default.getNbStaves(o)!==2)return;const n=s.default.getStaffDetails(o);if(n.length!==2)return;const[u,l]=n;c.default.isSame(u,l)&&(d.A.removeStaffIdx(u),s.default.setStaffDetails(o,[u]));const h=s.default.getWrappedClef(o);let I=h.getEntry(0);const P=h.getEntry(1);if(!e.default.isSame(I,P)||!e.default.isTab(I))return!1;I=c.default.toClef(u),h.setEntry(I,0);const T=h.dumpAttribute();s.default.setClef(o,T)}},512476:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(586745),e=t(635120),s=t(832560),c=t(364842);const i=function(a){if(a instanceof f.A)return a;if(a instanceof e.default)return a.getCommonContent();if(a instanceof s.A)return a.getScoreData().getCommonContent();throw new c.default("Unexpected")}},521255:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(35802),e=t(579102),s=t(701387),c=t(187694),d=t(123491),i=t(446921);function a(u){const l=i.A.getMeasures(u[0]),h=l.length;for(let I=h-1;I>=0;I--){const P=l[I],T=o(P);T!==null&&r(u,I,T)&&n(u,I,T)}}function o(u){const l=s.default.getAllRawAttributes(u);for(const h of l){const I=f.default.getMeasureStyle(h);for(const P of I)if(e.A.hasMultiMeasureRest(P)){const T=e.A.getMultiMeasureRest(P);if(c.A.isValid(T))return c.A.getNbMeasures(T)}}return null}function r(u,l,h){return u.every(I=>{const P=i.A.getMeasures(I);return P.length-l<h?!1:P.slice(l+1,l+h).every(g=>s.default.getNotes(g).every(D=>d.default.isRest(D)&&!d.default.needRestLock(D)))})}function n(u,l,h){u.forEach(I=>{const P=i.A.getMeasures(I),_=P.splice(l+1,h-1).pop(),g=P[l];if(s.default.hasRightBarline(_)){const E=s.default.getRightBarline(_);s.default.removeRightBarline(g),s.default.addBarline(g,E)}})}},522117:(O,A,t)=>{t.d(A,{A:()=>X});var f=t(701387),e=t(123491),s=t(726042),c=t(512476),d=t(515819),i=t(518558);function a(k,L,$){const ut=i.default.getBeatType(L),w=d.default.beatTypeToDivisions(ut,$);return k.map(o,w)}function o(k){const L=this.valueOf();return k*L}const r=function(k){const L=[],$=k.getNbNotes();for(let ut=0;ut<$;ut++){const w=k.getNote(ut);let st;if(e.default.hasTupletStart(w)){const tt=n(k,ut);st=tt.duration,ut=tt.noteIdx}else st=e.default.getDuration(w);L.push(st)}return L},n=function(k,L){let $=0,ut=k.getNote(L),w;for(;!e.default.hasTupletStop(ut);)w=e.default.getDuration(ut),$+=w,L++,ut=k.getNote(L);return w=e.default.getDuration(ut),$+=w,{duration:$,noteIdx:L}},u=r;var l=t(364842);const h=function(k,L){return new I(k,L).split()},I=function(k,L){this.init(k,L)},P=I.prototype;P.init=function(k,L){this.notesDurations=k,this.beatsDurations=L,this.beatsNotesDurations=[],this.noteIdx=0,this.currentNoteDuration=null},P.split=function(){return this.beatsDurations.forEach(this.fillBeat,this),this.beatsNotesDurations},P.fillBeat=function(k){for(this.expectedBeatDuration=k,this.beatNotesDurations=[],this.actualBeatDuration=0;this.actualBeatDuration<this.expectedBeatDuration;)this.consumeNoteDuration();this.beatsNotesDurations.push(this.beatNotesDurations)},P.consumeNoteDuration=function(){let k=this.getNoteDuration();const L=this.expectedBeatDuration-this.actualBeatDuration,$=Math.min(L,k);this.beatNotesDurations.push($),this.actualBeatDuration+=$,k-=$,this.setNoteDuration(k)},P.getNoteDuration=function(){if(this.currentNoteDuration===null){const k=this.notesDurations.length;if(this.noteIdx>=k){const L="There is a mismatch between the beats durations and the notes durations";throw new l.default("Unexpected",L)}this.currentNoteDuration=this.notesDurations[this.noteIdx]}return this.currentNoteDuration},P.setNoteDuration=function(k){k===0?(this.currentNoteDuration=null,this.noteIdx++):this.currentNoteDuration=k};const T=h,_=function(k,L){const $=k.getAnyTime(),ut=k.getVoice(L),w=k.getDpqValue(),st=(0,c.A)(k),tt=k.getIdx(),it=st.getBeatsList(tt),It=a(it,$,w),xt=u(ut);return T(xt,It).map(g)},g=function(k){return k.reduce(s.default.add)},E=_,M=function(k,L){let $=0;const ut=k.length;for(let st=0;st<ut;st++){const tt=k[st];if(L>=$&&L<$+tt)return st;$+=tt}const w=`The time position \`${L}\` is not inside the beats boundaries.`;throw new l.default("Unexpected",w)};var p=t(748049);function m(k,L){return new v(k,L).group()}class v{constructor(L,$){this.measureData=L,this.voice=$,this.beats=null,this.timePosPerNoteIdx=null,this.hasRestsInsideBeamsValue=null,this.groups=[],this.currentGroup=null}group(){const L=this.voice.getNbNotes();for(let $=0;$<L-1;$++)this.processNote($);return this.groups}processNote(L){this.canGroupWithNext(L)?this.addNote(L):this.currentGroup=null}canGroupWithNext(L){const $=this.voice.getNote(L),ut=this.voice.getNote(L+1),w=this.measureData.getDpqValue();if(!e.default.isNormalBelowQuarter($,w)||!e.default.isNormalBelowQuarter(ut,w)||!this.hasRestsInsideBeam()&&(e.default.isRest($)||e.default.isRest(ut))||e.default.hasTremoloStop($)||e.default.hasTremoloStart(ut))return!1;const st=e.default.getBeamStatus($);if(st===p.A.YES)return!0;if(st===p.A.NO||(st!==p.A.AUTO&&p.A.raiseError(st),e.default.hasTupletStop($)||e.default.hasTupletStart(ut)))return!1;if(e.default.hasTimeModif($)&&e.default.hasTimeModif(ut))return!0;const tt=this.getBeatIdx(L),it=this.getBeatIdx(L+1);return tt===it}hasRestsInsideBeam(){if(this.hasRestsInsideBeamsValue===null){const L=this.measureData.getScoreData().getCommonContent(),$=this.measureData.getIdx();this.hasRestsInsideBeamsValue=L.hasRestsInsideBeams($)}return this.hasRestsInsideBeamsValue}getBeatIdx(L){const $=this.getTimePos(L),ut=this.getBeats();return M(ut,$)}getTimePos(L){return this.timePosPerNoteIdx===null&&this.loadTimePositions(L),this.timePosPerNoteIdx[L]}loadTimePositions(){this.timePosPerNoteIdx=[];const L=this.voice.getNbNotes();let $=0;for(let ut=0;ut<L;ut++){this.timePosPerNoteIdx.push($);const w=this.voice.getNote(ut),st=e.default.getDuration(w);$+=st}}getBeats(){return this.beats===null&&(this.beats=E(this.measureData,this.voice.getVoiceIdx())),this.beats}addNote(L){this.currentGroup===null&&(this.currentGroup=[{noteIdx:L,note:this.voice.getNote(L)}],this.groups.push(this.currentGroup)),L++,this.currentGroup.push({noteIdx:L,note:this.voice.getNote(L)})}}var U=t(17236);function x(k){return k=S(k),k=K(k),k}function S(k){const L=k.findIndex($=>!e.default.isRest($.note));return L<0?[]:k.slice(L)}function K(k){const L=k.findLastIndex($=>!e.default.isRest($.note));return L<0?[]:k.slice(0,L+1)}function H(k,L){let $=0;const ut=[];for(k.forEach(w=>{const st=w[0].noteIdx;for(;$<st;$++)ut.push(!1);for(let tt=0;tt<w.length-1;tt++)ut.push(!0),$++});$<L-1;$++)ut.push(!1);return ut}var Y=t(832560);const y=function(k,L,$){const w={nbBeams:e.default.calcNbBeams(k,L),left:[],right:[]};return typeof $=="number"&&(w.position=$,w.duration=e.default.getDuration(k)),w};var F=t(816679),N=t(73925);const G=function(k,L,$,ut,w,st){nt(k,L,$,w,st);const tt=e.default.getDuration(L);nt(L,$,ut,w,st+tt)},nt=function(k,L,$,ut,w){const st=k===null?null:y(k,ut),tt=y(L,ut,w),it=$===null?null:y($,ut);J(L,st,tt,it)},J=function(k,L,$,ut){(0,F.A)(L,$,ut);const w=(0,N.A)($);e.default.setBeams(k,w)},V=G;var W=t(961214),Z=t(898439);const dt={};dt.canShape=function(k){return at(k)};const at=function(k){const L=f.default.getDpq(k);return f.default.getNotes(k).filter(e.default.hasDuration).some(ut=>e.default.isNormalBelowQuarter(ut,L))};dt.shapeMeasure=function(k,L,$){const ut={getCommonContent(){return this.commonContent},commonContent:$},w=new Y.A(k,L,null,ut);w.getVoicesIndexes().forEach(tt=>{const it=w.getVoice(tt);B(w,it)})};function B(k,L){let $=m(k,L);$=$.map(x),$=$.filter(tt=>tt.length>1);const ut=L.getNbNotes(),w=H($,ut),st=k.getDpqValue();w.forEach((tt,it)=>{if(tt){const It=it>0&&w[it-1]?L.getNote(it-1):null,xt=L.getNote(it),Ot=L.getNote(it+1),St=it<ut-2&&w[it+1]?L.getNote(it+2):null,Nt=gt(L,it);V(It,xt,Ot,St,st,Nt)}})}function gt(k,L){const $=(0,W.A)(k,L),ut=(0,Z.A)(k,L);if($===0)return ut;const w=lt(k,L),st=(0,Z.A)(k,w);return ut-st}function lt(k,L){for(;L>=0;L--){const $=k.getNote(L);if(e.default.hasTupletStart($))return L}throw new Error("There should be a tuplet start there")}const X=dt},524533:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(443749),e=t(726042),s=t(123491),c=t(701387),d=t(496819),i=t(832560);const a=function(n,u){const l=n.getMeasure(u.partIdx,u.measureIdx),h=c.default.getNbStaves(l),I=u.staffIdx;if(!e.default.isInteger(I)||I<0||I>=h)throw new f.default(I);const P=new i.A(l);P.checkVoiceIdx(u.voiceIdx);const T=P.getVoice(u.voiceIdx);T.checkNoteIdx(u.noteIdx);let _=0;for(let D=0;D<u.noteIdx;D++){const M=T.getNote(D),p=s.default.getDuration(M);_+=p}return c.default.getDynamics(l,u.staffIdx).some(o,_)},o=function(n){const u=this.valueOf();return d.A.getTimePos(n)===u},r=a},525205:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(737903),e=t(726042),s=t(614653),c=t(701387),d=t(21738),i=t(131220),a=t(902630);function o(I,P,T){var _,g;T=(0,f.default)(T),(0,d.default)(I,T),(0,i.default)(I,T);const E=(g=(_=r(I,P,T))!=null?_:u(I,P,T))!=null?g:null;if(E===null)return null;let D=s.default.getFrame(E);return D=a.default.copy(D),D}function r(I,P,T){for(let _=T.measureIdx;_>=0;_--){const g=I.getMeasure(T.partIdx,_);let E=c.default.getJazzHarmonies(g).slice();if(E.reverse(),_===T.measureIdx){const M=c.default.getDpq(g);E=n(E,M,T)}const D=E.find(h,P);if(D)return D}return null}function n(I,P,T){const _=e.default.lcm(P,T.dpq),g=T.timePos*_/T.dpq,E=_/P;return I.filter(D=>{let M=s.default.getTimePos(D);return M*=E,M<=g})}function u(I,P,T){const _=I.getNbMeasures();for(let g=T.measureIdx;g<_;g++){const E=I.getMeasure(T.partIdx,g);let D=c.default.getJazzHarmonies(E);if(g===T.measureIdx){const p=c.default.getDpq(E);D=l(D,p,T)}const M=D.find(h,P);if(M)return M}return null}function l(I,P,T){const _=e.default.lcm(P,T.dpq),g=T.timePos*_/T.dpq,E=_/P;return I.filter(D=>{let M=s.default.getTimePos(D);return M*=E,M>=g})}function h(I){const P=this;return s.default.hasFrame(I)?s.default.isSameJazz(I,P):!1}},526988:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(210888),e=t(601770),s=t(446921),c=t(701387),d=t(558280);function i(r,n){const u={partContent:r,measuresHeaders:n,wedgeUuidByStaff:{}};s.A.getMeasures(r).forEach(a,u)}function a(r,n,u){const l=this,h=c.default.getNbStaves(r);l.measureUuid=e.A.getUuid(l.measuresHeaders[n]);for(let I=0;I<h;I++){let P=c.default.getWedges(r,I);if(P=P.filter(d.A.isRawStart),P.forEach(o,l),c.default.hasRightWedge(r,I)){const T=l.wedgeUuidByStaff[I],_=c.default.getRightWedge(r,I);d.A.setWedgeUuid(_,T);const g=u[n+1],E=c.default.getLeftWedge(g,I);d.A.setWedgeUuid(E,T)}}}function o(r){const n=this,u=f.default.generate(),l={wedgeUuid:u,measureUuid:n.measureUuid};s.A.addWedge(n.partContent,l);const h=d.A.getStaffIdx(r);d.A.setWedgeUuid(r,u),n.wedgeUuidByStaff[h]=u}},531074:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(443749),e=t(566519),s=t(726042),c=t(701387),d=t(788220),i=t(21738),a=t(131220),o=t(665280);const n=function(u,l){(0,i.default)(u,l),(0,a.default)(u,l),(0,o.default)(u,l),u.checkPartIdx(l.partIdx),u.checkMeasureIdx(l.measureIdx);const h=u.getMeasure(l.partIdx,l.measureIdx),I=l.staffIdx,P=c.default.getNbStaves(h);if(!s.default.isInteger(I)||I<0||I>=P)throw new f.default(I);const T=c.default.getWords(h,l.staffIdx),_=T.length,g=l.wordIdx;if(!s.default.isInteger(g)||g<0||g>=_)throw new e.A(g);const E=T[g],D=d.A.getText(E),M=d.A.getPlacement(E);return{text:D,placement:M}}},532835:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(952818),s=t(717434);const c=function(o){let r=f.default.getRawDirections(o);r.forEach(d),r=r.filter(e.A.hasContent),f.default.setDirections(o,r)},d=function(o){let r=e.A.getEntries(o);r=r.filter(i),e.A.setEntries(o,r)},i=function(o){return!s.A.isMetronome(o)},a=c},533343:(O,A,t)=>{t.d(A,{A:()=>e});const e={SUS_4:"sus-4",SUS_2:"sus-2",SUS_24:"sus-2-4"}},534634:(O,A,t)=>{t.d(A,{A:()=>p});var f=t(701387),e=t(956112),s=t(952818),c=t(882934);const i=function(m){if(!s.A.hasSound(m))return!1;const v=s.A.getSound(m);if(!c.A.hasMute(v))return!1;const U=c.A.getMute(v);return e.A.isValid(U)};var a=t(447819);function o(m){const v=s.A.getStaffIdx(m),U=s.A.getTimePos(m),x=s.A.getPlacement(m),S=r(m);return a.A.create(v,x,U,S)}function r(m){const v=s.A.getSound(m);return c.A.getMute(v)}const n=o;function u(m){return T().extract(m)}class l{constructor(){this.mutesByStaff=null}extract(v){this.reset(),v.forEach(this.processDirection,this);const U=this.mutesByStaff;return this.mutesByStaff=null,U}reset(){this.mutesByStaff={}}processDirection(v){if(i(v)){const U=n(v);this.addMute(U)}}addMute(v){const U=s.A.getStaffIdx(v),x=this.getStaffMutes(U),S=s.A.getTimePos(v);h(x,S),x.push(v)}getStaffMutes(v){return typeof this.mutesByStaff[v]=="undefined"&&(this.mutesByStaff[v]=[]),this.mutesByStaff[v]}}function h(m,v){I(m,v)&&m.pop()}function I(m,v){if(m.length===0)return!1;{const U=m.length-1,x=m[U];return s.A.getTimePos(x)===v}}let P=null;function T(){return P===null&&(P=new l),P}var _=t(843678),g=t(726042);function E(m,v){_.default.forEach(v,D,m)}function D(m,v){m=g.default.intPart(m);const U=this;f.default.setMutes(U,m,v)}const p=function(m){const v=f.default.getRawDirections(m),U=u(v);E(m,U)}},536863:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387);const e=function(d,i){const a=d.dpq,o=d.timePos,r=s(i);return o*r/a},s=function(d){return f.default.getDpq(d)},c=e},537920:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(364842);const e=function(i,a){return new s(i,a).unwrappDirections()},s=function(i,a){this.init(i,a)},c=s.prototype;c.init=function(i,a){this.wrappedDirections=i,this.nbMeasures=a,this.directionsByMeasures=[]},c.unwrappDirections=function(){return this.wrappedDirections.forEach(this.unwrappDirection,this),this.fillEmptyMeasuresDirections(),this.directionsByMeasures},c.unwrappDirection=function(i){const a=i.measureIdx;this.getMeasureDirections(a).push(i.direction)},c.getMeasureDirections=function(i){if(i>=this.nbMeasures||i<0){const a=`Invalid measure index: [${i}].`;throw new f.default("BadMeasureIdx",a)}return this.createMeasuresDirections(i),this.directionsByMeasures[i]},c.fillEmptyMeasuresDirections=function(){this.createMeasuresDirections(this.nbMeasures-1)},c.createMeasuresDirections=function(i){const a=this.directionsByMeasures.length;for(let o=a;o<=i;o++)this.directionsByMeasures.push([])};const d=e},539203:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(364842),e=t(446921),s=t(635120),c=t(189247),d=t(832560);const a=function(o,r){let n;if(o instanceof c.A)n=o;else if(o instanceof d.A)n=o.getMeasuresScroller();else if(o instanceof s.default){const u=o,l=r.partIdx,h=u.getPartContent(l),I=e.A.getMeasures(h);n=new c.A(I,l,u)}else{const u="Unsupported data type.";throw new f.default("BadDataType",u)}return n.hasScoreData()&&n.getScoreData().checkPartIdx(r.partIdx),n}},542220:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(343568);const s=function(c,d){const i={};f.A.call(i,c,d);const a=i.measureData;return a.checkVoiceIdx(d.voiceIdx),a.getVoice(d.voiceIdx).getNbNotes()}},542530:(O,A,t)=>{t.d(A,{A:()=>jt});var f=t(446921),e=t(701387),s=t(882934),c=t(110976);const d=function(ct){const ft=ct.getPartContent(0),_t=f.A.getMeasures(ft),Dt=ct.getCommonContent();_t.forEach(i,Dt)},i=function(ct,ft){const _t=this;if(_t.hasOwnTempo(ft)){const Dt=_t.getOwnTempo(ft),Wt=c.default.getQpm(Dt);a(ct,Wt)}},a=function(ct,ft){const _t=e.default.getSounds(ct),Dt={};s.A.setTempo(Dt,ft);const Wt=e.default.getDpq(ct);s.A.setNoteBefore(Dt,-1),s.A.setTimePos(Dt,0),s.A.setDpq(Dt,Wt),_t.unshift(Dt),e.default.setSounds(ct,_t)},o=d,r=function(ct){const ft=ct.getPartContent(0),_t=f.A.getMeasures(ft),Dt=ct.getCommonContent();_t.forEach(n,Dt)},n=function(ct,ft){const _t=this;if(_t.hasOwnSwing(ft)){const Dt=_t.getOwnSwing(ft);u(ct,Dt)}},u=function(ct,ft){const _t=e.default.getSounds(ct),Dt={};s.A.setSwing(Dt,ft);const Wt=e.default.getDpq(ct);s.A.setNoteBefore(Dt,-1),s.A.setTimePos(Dt,0),s.A.setDpq(Dt,Wt),_t.unshift(Dt),e.default.setSounds(ct,_t)},l=r,I={START:"start",STOP:"stop",DISCONTINUE:"discontinue"};var P=t(555172),T=t(719476);const _=function(ct){const ft=ct.getCommonContent();ct.getPartsContents().forEach(g,ft)},g=function(ct){const ft=this;f.A.getMeasures(ct).forEach(E,ft)},E=function(ct,ft){const _t=this;if(_t.hasEnding(ft)){const Dt=_t.getEnding(ft);D(_t,ft)&&p(ct,Dt),M(_t,ft)&&m(ct,Dt)}};function D(ct,ft){if(ft===0||!ct.hasEnding(ft-1))return!0;const _t=ct.getEnding(ft),Dt=ct.getEnding(ft-1);return!T.A.isSame(_t,Dt)}function M(ct,ft){const _t=ct.getNbMeasures();if(ft+1===_t||!ct.hasEnding(ft+1))return!0;const Dt=ct.getEnding(ft),Wt=ct.getEnding(ft+1);return!T.A.isSame(Dt,Wt)}const p=function(ct,ft){let _t;e.default.hasLeftBarline(ct)||(_t=P.A.create(P.A.LEFT,P.A.DEFAULT_STYLE),e.default.addBarline(ct,_t)),_t=e.default.getLeftBarline(ct);const Dt=T.A.create(I.START,ft);P.A.setEnding(_t,Dt)},m=function(ct,ft){let _t;e.default.hasRightBarline(ct)||(_t=P.A.create(P.A.RIGHT,P.A.DEFAULT_STYLE),e.default.addBarline(ct,_t)),_t=e.default.getRightBarline(ct);const Dt=v(ct),Wt=T.A.create(Dt,ft);P.A.setEnding(_t,Wt)},v=function(ct){return e.default.hasRightSpecificBarline(ct)?I.STOP:I.DISCONTINUE},U=_;var x=t(364842),S=t(607801);const K=function(ct){const ft=ct.getCommonContent(),_t=ct.getPartContent(0);f.A.getMeasures(_t).forEach(H,ft)},H=function(ct,ft){const _t=this;_t.hasJumpTag(ft)&&Y(ct,_t.getJumpTag(ft)),_t.hasJumpCall(ft)&&y(ct,_t.getJumpCall(ft))},Y=function(ct,ft){const _t=C(ct);if(ft===S.A.SEGNO)s.A.createSegno(_t);else if(ft===S.A.CODA)s.A.createCoda(_t);else throw new x.default("unexpected","Bad Jump Tag type");N(ct,_t)};function C(ct){const ft={},_t=e.default.getDpq(ct);return s.A.setDpq(ft,_t),s.A.setTimePos(ft,0),s.A.setNoteBefore(ft,-1),ft}const y=function(ct,ft){const _t=F(ct);if(ft===S.A.DALSEGNO)s.A.createDalsegno(_t);else if(ft===S.A.DACAPO)s.A.createDacapo(_t);else if(ft===S.A.FINE)s.A.createFine(_t);else if(ft===S.A.TOCODA)s.A.createToCoda(_t);else throw new x.default("unexpected","Bad Jump Call type");N(ct,_t)};function F(ct){const ft={},_t=e.default.getDpq(ct),Dt=e.default.getNbDivisions(ct),Wt=e.default.getNbNotes(ct);return s.A.setDpq(ft,_t),s.A.setTimePos(ft,Dt),s.A.setNoteBefore(ft,Wt-1),ft}function N(ct,ft){const _t=e.default.getSounds(ct);_t.push(ft),e.default.setSounds(ct,_t)}const G=K;var nt=t(737903);const J=function(ct){const ft=ct.getCommonContent(),_t=ct.getPartContent(0);f.A.getMeasures(_t).forEach(V,ft)},V=function(ct,ft){const _t=this;_t.hasTempoChanges(ft)&&W(ct,_t.getTempoChanges(ft))},W=function(ct,ft){ft.forEach(function(_t){_t=(0,nt.default)(_t),e.default.addDirection(ct,_t)})},Z=J;var dt=t(319731),at=t(561248),B=t(958625);const gt=function(ct){const ft=ct.getCommonContent(),_t=ct.getPartContent(0);f.A.getMeasures(_t).forEach(lt,ft)},lt=function(ct,ft){const _t=this;if(_t.hasRehearsal(ft)){const Dt=_t.getRehearsal(ft);X(ct,Dt,ft)}},X=function(ct,ft,_t){const Dt=at.A.getType(ft);let Wt;Dt===dt.A.MEASURE_NUMBER?Wt=(1+_t).toString():Wt=at.A.getText(ft);const wt=B.A.create(Wt,Dt);e.default.addDirection(ct,wt)},k=gt;var L=t(657335);const $=function(ct){const ft=ct.getCommonContent(),_t=ct.getPartContent(0);f.A.getMeasures(_t).forEach(ut,ft)},ut=function(ct,ft){const _t=this;if(_t.hasOwnTempo(ft)){const Dt=_t.getOwnTempo(ft),Wt=c.default.getDurationType(Dt),wt=c.default.getNbDots(Dt),z=c.default.getBpm(Dt);w(ct,z,Wt,wt)}},w=function(ct,ft,_t,Dt){const Wt=L.A.create(ft,_t,Dt);e.default.addDirection(ct,Wt)},st=$,tt=function(ct){const ft=ct.getCommonContent(),_t=ct.getPartContent(0);f.A.getMeasures(_t).forEach(it,ft)},it=function(ct,ft){const _t=this;if(_t.hasSystemBreak(ft)){const Dt=_t.getSystemBreak(ft);e.default.setOwnNewSystem(ct,Dt)}},It=tt,xt=function(ct){const ft=ct.getCommonContent(),_t=ct.getPartContent(0);f.A.getMeasures(_t).forEach(Ot,ft)},Ot=function(ct,ft){const _t=this;if(_t.hasPageBreak(ft)){const Dt=_t.getPageBreak(ft);e.default.setOwnNewPage(ct,Dt)}},St=xt;var Nt=t(74446);const j=function(ct){const ft=ct.getCommonContent(),_t=ct.getPartContent(0);f.A.getMeasures(_t).forEach(ot,ft)},ot=function(ct,ft){let Dt=this.getBeatsList(ft);Dt=Nt.default.copy(Dt),e.default.setBeatsList(ct,Dt)},et=j,Tt=function(ct){const ft=ct.getCommonContent(),_t=ct.getPartContent(0);f.A.getMeasures(_t).forEach(Lt,ft)},Lt=function(ct,ft){const Dt=this.hasRestsInsideBeams(ft);e.default.setRestsInsideBeams(ct,Dt)},Vt=Tt,Ut=function(ct){e.default.getBarlines(ct).forEach(P.A.removeEnding)},Jt=function(ct){e.default.hasOwnPrint(ct)&&e.default.deleteOwnPrint(ct)};var Zt=t(388907),kt=t(958537);const b=function(ct){let ft=e.default.getSounds(ct);ft.forEach(s.A.deleteSegno),ft.forEach(s.A.deleteCoda),ft.forEach(s.A.deleteDalsegno),ft.forEach(s.A.deleteDacapo),ft.forEach(s.A.deleteFine),ft.forEach(s.A.deleteToCoda),ft=ft.filter(s.A.isNotEmpty),e.default.setSounds(ct,ft)};var rt=t(735178);const At=function(ct){e.default.getDirectionsWithType(ct,rt.A.TEMPO_CHANGE).forEach(function(_t){e.default.eraseDirection(ct,_t)})};var Ct=t(914734),Rt=t(532835);const jt=function(ct){ct.forEachMeasure(Zt.A),ct.forEachMeasure(kt.A),ct.forEachMeasure(Ut),ct.forEachMeasure(b),ct.forEachMeasure(At),ct.forEachMeasure(Ct.A),ct.forEachMeasure(Rt.A),ct.forEachMeasure(Jt),ct.forEachMeasure(e.default.removeBeatsList),o(ct),l(ct),U(ct),G(ct),Z(ct),k(ct),st(ct),It(ct),St(ct),et(ct),Vt(ct)}},544342:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(364842),e=t(612040),s=t(558280);const c=function(o,r,n){const u=new d(o,r,n);return u.search(),u.getWedgeType()},d=function(o,r,n){this.init(o,r,n)},i=d.prototype;i.init=function(o,r,n){this.currentWedge=o,this.wedges=r,this.searchedTimePosition=n},i.search=function(){this.wedges.some(this.analyzeWedge,this)},i.analyzeWedge=function(o){const r=s.A.getTimePos(o);if(r>this.searchedTimePosition)return!0;const n=s.A.getLocation(o);return n===e.A.LEFT&&this.startWedge(o),n===e.A.RIGHT&&(this.stopWedge(),r===this.searchedTimePosition)?!1:r===this.searchedTimePosition},i.startWedge=function(o){if(this.currentWedge!==null)throw new f.default("Unexpected","There is already a wedge");this.currentWedge=o},i.stopWedge=function(){if(this.currentWedge===null){const o="There is no wedge to stop.";throw new f.default("Unexpected",o)}else this.currentWedge=null},i.getWedgeType=function(){return this.currentWedge===null?null:s.A.getType(this.currentWedge)};const a=c},544896:(O,A,t)=>{t.d(A,{A:()=>st});var f=t(446921),e=t(388907),s=t(958537),c=t(914734),d=t(532835),i=t(701387),a=t(777345),o=t(110976),r=t(657335);const n=function(tt){const it=i.default.getRawDirections(tt),It={metronome:null};return it.some(u,It),It.metronome},u=function(tt){if(r.A.isInstanceOf(tt)){const it=r.A.getMetronome(tt),It=this;return It.metronome=it,!0}else return!1},l=n;var h=t(882934);const I=function(tt){const it={tempo:null};return tt.some(P,it),it.tempo},P=function(tt){const it=this;if(h.A.hasTempo(tt)){const It=h.A.getTempo(tt);return it.tempo=It,!0}},T=I;var _=t(952818);const E=function(tt){tt=tt.filter(_.A.hasSound);const it=tt.map(_.A.getSound);return T(it)},M=function(tt){let it=null;const It=i.default.getSounds(tt);if(it=T(It),it!==null)return it;const xt=i.default.getRawDirections(tt);return it=E(xt),it};var p=t(68990);const v=function(tt){const it=l(tt);let It=M(tt),xt,Ot,St;if(it!==null)Ot=p.A.getNbDots(it),St=p.A.getDurationType(it),xt=p.A.getBpm(it);else if(It!==null)Ot=o.default.DEFAULT_NB_DOTS,St=o.default.DEFAULT_DURATION_TYPE,xt=o.default.qpmToBpm(It,St,Ot);else return null;return It===null&&(It=o.default.bpmToQpm(xt,St,Ot)),o.default.createWithNote(It,St,Ot,xt)},U=function(tt){const it={swing:null};return tt.some(x,it),it.swing},x=function(tt){const it=this;if(h.A.hasSwing(tt)){const It=h.A.getSwing(tt);return it.swing=It,!0}},S=U,H=function(tt){tt=tt.filter(_.A.hasSound);const it=tt.map(_.A.getSound);return S(it)},C=function(tt){let it=null;const It=i.default.getSounds(tt);if(it=S(It),it!==null)return it;const xt=i.default.getRawDirections(tt);return it=H(xt),it};var y=t(958625);const N=function(tt){const it=tt.find(y.A.isInstanceOf);return typeof it=="undefined"?null:y.A.getRehearsal(it)},nt=function(tt){const it=i.default.getRawDirections(tt);return N(it)};function J(tt,it){const It=it.length;let xt=null;for(let Ot=0;Ot<It;Ot++){const St=it[Ot];if(i.default.hasLeftEnding(St)&&(xt=i.default.getLeftEndingNumbers(St)),xt!==null){const Nt=xt.slice();tt.setEnding(Ot,Nt)}i.default.hasRightEnding(St)&&(xt=null)}}var V=t(607801),W=t(250769),Z=t(780192);const dt=function(tt,it){it.forEach(at,tt),J(tt,it)},at=function(tt,it){const It=this,xt=B(It,it),Ot=gt(It,it);let St=v(tt);St===null&&(St=xt);let Nt=C(tt);Nt===null&&(Nt=Ot),It.addMeasure(it,o.default.copy(St),Nt);const j=nt(tt);if(j!==null&&It.setRehearsal(it,j),(!o.default.isSame(St,xt)||it===0)&&It.setOwnTempo(it,o.default.copy(St)),(!a.default.isSame(Nt,Ot)||it===0)&&It.setOwnSwing(it,Nt),i.default.hasSegno(tt)&&It.setJumpTag(it,V.A.SEGNO),i.default.hasCoda(tt)&&It.setJumpTag(it,V.A.CODA),i.default.hasDalsegno(tt)&&It.setJumpCall(it,V.A.DALSEGNO),i.default.hasDacapo(tt)&&It.setJumpCall(it,V.A.DACAPO),i.default.hasFine(tt)&&It.setJumpCall(it,V.A.FINE),i.default.hasToCoda(tt)&&It.setJumpCall(it,V.A.TOCODA),i.default.hasOwnNewSystem(tt)){const ot=i.default.getOwnNewSystem(tt);ot===W.A.YES&&It.setSystemBreak(it,ot)}Z.A.hasNewPage(i.default.getOwnPrint(tt))&&It.setPageBreak(it,W.A.YES)},B=function(tt,it){return it===0?o.default.createDefault():tt.getTempo(it-1)},gt=function(tt,it){return it===0?a.default.createDefault():tt.getSwing(it-1)},lt=dt;var X=t(35802),k=t(579102),L=t(187694);function $(tt,it){it.forEach(ut,tt)}function ut(tt,it){const It=this,xt=i.default.getAllRawAttributes(tt);for(const Ot of xt){const St=X.default.getMeasureStyle(Ot);for(const Nt of St)if(k.A.hasMultiMeasureRest(Nt)){const j=k.A.getMultiMeasureRest(Nt);if(L.A.isValid(j)){const ot=L.A.getNbMeasures(j);It.setMultiMeasureRest(it,ot)}}}}const st=function(tt){const it=tt.getPartContent(0),It=f.A.getMeasures(it),xt=tt.getCommonContent();lt(xt,It),$(xt,It),tt.forEachMeasure(e.A),tt.forEachMeasure(s.A),tt.forEachMeasure(c.A),tt.forEachMeasure(d.A)}},545606:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(701387),e=t(123491),s=t(712947);const c=function(a){let o=f.default.getNotes(a);o=o.filter(e.default.hasSlur),o.forEach(d)},d=function(a){const o=e.default.getVoiceIdx(a),r=e.default.getSlur(a),n=o+1;s.default.setLevel(r,n)},i=c},546513:(O,A,t)=>{t.d(A,{A:()=>E});var f=t(378432),e=t(701387),s=t(518558),c=t(377180),d=t(364596),i=t(721247),a=t(54949),o=t(104907),r=t(128001),n=t(123491),u=t(351277),l=t(737903),h=t(476943);const I={};I.canShape=function(D){if(e.default.getNbStaves(D)>1)return!1;const p=e.default.getStaffDetails(D)[0];return!!o.default.hasKodaly(p)},I.shapeMeasure=function(D,M){const p=e.default.getNbStaves(D),m=0,v=e.default.getWrappedStaffDetailsOrDefault(D);return M.hideNonKodaly?P(D,v):T(D,p,m,v),D};function P(D,M){let m=M.getEntry(0);o.default.setNbStaffLines(m,7),m=M.dumpAttribute()[0],e.default.setStaffDetails(D,[m]);const[v]=e.default.getKey(D);let U=e.default.getNotes(D);U=U.filter(g);const x=a.A.groupStaves(U)[0];U=h.default.isArray(x)?x.map(_,{staffIdx:0,staffDetails:m,key:v}):[],e.default.setNotes(D,U)}const T=function(D,M,p,m){const v=m.getEntry(p),U=o.default.copy(v);o.default.removeKodaly(v),o.default.setNbStaffLines(U,7),m.insertEntry(U,p+1);const x=m.dumpAttribute();e.default.setStaffDetails(D,x);const S=e.default.getWrappedTime(D);let K=S.getEntry(p);K=s.default.copy(K),S.insertEntry(K,p+1);const H=S.dumpAttribute();e.default.setTime(D,H);const Y=e.default.getWrappedTranspose(D);let C=Y.getEntry(p);C=c.default.copy(C),Y.insertEntry(C,p+1);const y=Y.dumpAttribute();e.default.setTranspose(D,y);const F=e.default.getWrappedKey(D);let N=F.getEntry(p);N=d.default.copy(N),F.insertEntry(N,p+1);const G=F.dumpAttribute();e.default.setKey(D,G);const nt=e.default.getWrappedClef(D);let J=nt.getEntry(p);J=i.default.copy(J),nt.insertEntry(J,p+1);const V=nt.dumpAttribute();e.default.setClef(D,V);let W=e.default.getNotes(D),Z=W.filter(g);Z=a.A.groupStaves(Z)[p],Z=h.default.isArray(Z)?Z.map(_,{staffIdx:p+1,staffDetails:U,key:F.getEntry(p+1)}):[],W=W.concat(Z),e.default.setNotes(D,W),e.default.setNbStaves(D,M+1)},_=function(D){const{staffIdx:M,staffDetails:p,key:m}=this;if(D=(0,l.default)(D),n.default.setStaffIdx(D,M),n.default.hasPitch(D)){let v=n.default.getPitch(D);const U=o.default.getKodaly(p),x=r.A.getTranspose(U,m);try{v=u.default.transpose(v,x),n.default.setPitch(D,v)}catch(S){if(S instanceof f.A)delete D.pitch,D.rest={};else throw S}}return D};function g(D){return!n.default.isChord(D)&&!n.default.isGraceNote(D)}const E=I},546522:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(364842),e=t(868743),s=t(701387),c=t(584416);const d=function(n,u,l,h){const I=new i(n,u,l,h);return I.search(),I.getResult()},i=function(n,u,l,h){this.init(n,u,l,h)},a=i.prototype;a.init=function(n,u,l,h){this.measures=n,this.entryMeasureIdx=u,this.entryTimePos=h,this.entryStaffIdx=l,this.candidateMeasureIdx=null,this.directionsByMeasures={},this.startTimePos=null,this.startMeasureIdx=null,this.stopTimePos=null,this.stopMeasureIdx=null,this.placement=null},a.search=function(){this.searchStart(),this.isStartAtEntry()&&this.shiftEntryTimePos(),this.searchStop()},a.searchStart=function(){for(this.candidateMeasureIdx=this.entryMeasureIdx;this.candidateMeasureIdx>=0&&!this.hasFoundStart();this.candidateMeasureIdx--)this.searchStartMeasure();if(!this.hasFoundStart()){const n="We were not able to find the pedal left side.";throw new f.default("PedalStartNotFound",n)}},a.searchStartMeasure=function(){let n=this.getPedalDirectionsAtCandidateMeasure();this.isEntryMeasure()&&(n=this.filterLowerOrEqual(n)),this.searchStartTimePos(n)},a.filterLowerOrEqual=function(n){const u=[],l=n.length;for(let h=0;h<l;h++){const I=n[h];if(c.A.getTimePos(I)>this.entryTimePos)return u;u.push(I)}return u},a.searchStartTimePos=function(n){const u=n.length;for(let l=u-1;l>=0&&!this.hasFoundStart();l--){const h=n[l];c.A.getType(h)===e.A.START&&this.startFound(h,h)}},a.hasFoundStart=function(){return this.startMeasureIdx!==null},a.startFound=function(n){const u=c.A.getTimePos(n);this.startTimePos=u,this.startMeasureIdx=this.candidateMeasureIdx,this.placement=c.A.getPlacement(n)},a.isStartAtEntry=function(){return this.startMeasureIdx===this.entryMeasureIdx&&this.startTimePos===this.entryTimePos},a.shiftEntryTimePos=function(){this.entryTimePos++},a.searchStop=function(){const n=this.measures.length;for(this.candidateMeasureIdx=this.entryMeasureIdx;this.candidateMeasureIdx<n&&!this.hasFoundStop();this.candidateMeasureIdx++)this.searchStopMeasure();if(!this.hasFoundStop()){const u="We were not able to find the pedal right side.";throw new f.default("PedalStopNotFound",u)}},a.searchStopMeasure=function(){let n=this.getPedalDirectionsAtCandidateMeasure();this.isEntryMeasure()&&(n=this.filterGreaterOrEqual(n)),this.searchStopTimePos(n)},a.getPedalDirectionsAtCandidateMeasure=function(){if(typeof this.directionsByMeasures[this.candidateMeasureIdx]=="undefined"){const n=this.measures[this.candidateMeasureIdx],u=s.default.getPedals(n,this.entryStaffIdx);u.sort(o),this.directionsByMeasures[this.candidateMeasureIdx]=u}return this.directionsByMeasures[this.candidateMeasureIdx]};const o=function(n,u){const l=c.A.getTimePos(n),h=c.A.getTimePos(u);return l-h};a.isEntryMeasure=function(){return this.candidateMeasureIdx===this.entryMeasureIdx},a.filterGreaterOrEqual=function(n){const u=[],l=n.length;for(let h=l-1;h>=0;h--){const I=n[h];if(c.A.getTimePos(I)<this.entryTimePos)return u;u.unshift(I)}return u},a.searchStopTimePos=function(n){const u=n.length;for(let l=0;l<u&&!this.hasFoundStop();l++){const h=n[l];c.A.getType(h)===e.A.STOP&&this.stopFound(h)}},a.hasFoundStop=function(){return this.stopMeasureIdx!==null},a.stopFound=function(n){const u=c.A.getTimePos(n);this.stopTimePos=u,this.stopMeasureIdx=this.candidateMeasureIdx},a.getResult=function(){return{startMeasureIdx:this.startMeasureIdx,startTimePos:this.startTimePos,stopMeasureIdx:this.stopMeasureIdx,stopTimePos:this.stopTimePos,placement:this.placement}};const r=d},548042:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(123491),e=t(209175),s=t(364842);const c=function(a,o){a.checkVoiceIdx(o.voiceIdxRef);const r=a.getVoice(o.voiceIdxRef);r.checkNoteIdx(o.noteIdxRef);const n=d(r,o.noteIdxRef);o.divisions=a.getDpqValue(),o.timePos=r.getRangeSpace(0,n),o.timeModif=e.default.createDefault(),delete o.voiceIdxRef,delete o.noteIdxRef},d=function(a,o){for(;o>=0;){const r=a.getNote(o);if(!f.default.hasTimeModif(r)||f.default.hasTupletStart(r))return o;o--}throw new s.default("Unexpected","Tuplet start tag missing at begining of voice.")},i=c},548830:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(886190),e=t(476943),s=t(383279);const c={};c.updateMIDIChannels=function(a){let o=f.default.getPitchedChannelsMap();const r=c.getUsedMIDIChannels(a);o=e.default.filterObjectBlackMap(o,r),c.fillMIDIChannels(a,o)},c.getUsedMIDIChannels=function(a){return a.map(s.default.getUsedMIDIChannels).reduce(e.default.fillObject,{})},c.fillMIDIChannels=function(a,o){a.forEach(d,o)},c.getGroups=function(a){const o=[];let r=null;return a.forEach((n,u)=>{u!==0&&(s.default.isGroupedWithPrevious(n)?(r===null&&(r=[u-1],o.push(r)),r.push(u)):r=null)}),o};const d=function(a){const o=this;s.default.fillMIDIChannels(a,o)},i=c},549447:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(856219),e=t(383279);const s=48,c=1;function d(o,r){r>=s||o.forEach(i)}function i(o){e.default.getMIDIInstruments(o).forEach(a)}function a(o){f.default.hasUnpitched(o)&&(f.default.hasMIDIProgram(o)||f.default.setMIDIProgram(o,c))}},550759:(O,A,t)=>{t.d(A,{A:()=>T});var f=t(442805),e=t(883782),s=t(701387),c=t(614653),d=t(529355),i=t(681670),a=t(377180),o=t(902630),r=t(244240),n=t(184469),u=t(21738),l=t(131220),h=t(409200),I=t(507004),P=t(189247);function T(M,p){if((0,u.default)(M,p),(0,l.default)(M,p),(0,h.default)(M,p),M.checkPartIdx(p.partIdx),M.checkMeasureIdx(p.measureIdx),!M.hasPartVoiceIdx(p.partIdx,p.voiceIdx))throw new e.default(p.voiceIdx);const m=M.getMeasure(p.partIdx,p.measureIdx),U=s.default.getJazzHarmonies(m).find(_,p);if(!U)throw new f.A(p.harmonyUuid);const x=(0,r.A)(U),S=c.default.getAdagioKind(U),K=(0,n.A)(S,x),H=s.default.getDpq(m),Y=c.default.getTimePos(U);let C=c.default.getRoot(U);C=d.A.copy(C);let y=null;c.default.hasBass(U)&&(y=c.default.getBass(U),y=i.A.copy(y));let F=null;c.default.hasFrame(U)&&(F=c.default.getFrame(U),F=o.default.copy(F));const N=c.default.getType(U),G={partIdx:p.partIdx,measureIdx:p.measureIdx,dpq:H,timePos:Y,root:C,kind:S,bass:y,degrees:K,frame:F,isConcertPitch:!!p.isConcertPitch,type:N};g(G,m,p.isConcertPitch);const nt=E(M,p,G);return Object.assign(G,nt),D(G,M),G}function _(M){return c.default.getHarmonyUuid(M)===this.harmonyUuid}function g(M,p,m){if(!m)return;const v=s.default.getTranspose(p)[0];a.default.isUnison(v)||(M.root=d.A.transpose(M.root,v),M.bass!==null&&(M.bass=i.A.transpose(M.bass,v)))}function E(M,p,m){const v=M.getPartVoiceMainStaffIdx(p.partIdx,p.voiceIdx),U={searchedVoiceIdx:p.voiceIdx,staffVoicesIndexes:M.getPartStaffVoicesIndexes(p.partIdx,v),measureIdx:p.measureIdx,timePos:m.timePos,dpq:m.dpq},x=M.getPartMeasures(p.partIdx),S=new P.A(x,p.partIdx,M);return(0,I.A)(S,U)}function D(M,p){M.measureUuid=p.getMeasureUuid(M.measureIdx),M.voiceUuid=p.getPartVoiceUuid(M.partIdx,M.voiceIdx),M.partUuid=p.getPartUuid(M.partIdx)}},551690:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(364842),e=t(123491),s=t(852363),c=t(161733),d=t(343568);const i=function(r,n,u){this.init(r,n,u)};i.NAME="primitive.RemoveGraceAccidental";const a=i.prototype;a.initMeasureData=d.A,a.name=i.NAME,a.init=function(r,n,u){this.initMeasureData(r,n),this.cancelStack=u,this.opts=n},a.perform=function(){const r=this.getGraceAtPitch();e.default.removeAccidental(r),this.updateStack()},a.getGraceAtPitch=function(){const r=this.measureData.getVoice(this.opts.voiceIdx),n=(0,c.A)(r,this.opts.noteIdx,this.opts.graceIdx,this.opts.pitch);if(typeof n=="undefined")throw new f.default("NoGraceAtPitch");return n},a.updateStack=function(){const r={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx}};this.cancelStack.push(r),(0,s.default)(this.cancelStack,this.measureData,this.opts)};const o=i},556324:(O,A,t)=>{t.d(A,{A:()=>Y});var f=t(701387),e=t(952818),s=t(717434),c=t(889113),d=t(735178),i=t(372585);const a=function(C){return e.A.getEntries(C).some(o)},o=function(C){if(s.A.getType(C)!==d.A.OCTAVE_SHIFT)return!1;const F=s.A.getOctaveShift(C),N=c.A.getType(F);return i.A.isValid(N)},r=a;var n=t(345912);const u=function(C){const y=e.A.getStaffIdx(C),F=e.A.getTimePos(C),N=e.A.getPlacement(C),G=l(C),nt=h(C),J=I(C),V=P(C);return n.A.create(y,N,F,G,nt,J,V)},l=function(C){const F=e.A.getEntries(C).find(T),N=s.A.getOctaveShift(F);return c.A.getType(N)},h=function(C){const F=e.A.getEntries(C).find(T),N=s.A.getOctaveShift(F);return c.A.getSize(N)},I=function(C){const F=e.A.getEntries(C).find(T),N=s.A.getOctaveShift(F);return c.A.getLocation(N)},P=function(C){const F=e.A.getEntries(C).find(T),N=s.A.getOctaveShift(F);return c.A.getNumber(N)},T=function(C){if(s.A.getType(C)!==d.A.OCTAVE_SHIFT)return!1;const F=s.A.getOctaveShift(C),N=c.A.getType(F);return i.A.isValid(N)},_=u,g=function(C){return p().extract(C)},E=function(){this.octaveShiftsByStaff=null},D=E.prototype;D.extract=function(C){this.reset(),C.forEach(this.processDirection,this);const y=this.octaveShiftsByStaff;return this.octaveShiftsByStaff=null,y},D.reset=function(){this.octaveShiftsByStaff={}},D.processDirection=function(C){if(r(C)){const y=_(C);this.addOctaveShift(y)}},D.addOctaveShift=function(C){const y=e.A.getStaffIdx(C);this.getStaffOctaveShifts(y).push(C)},D.getStaffOctaveShifts=function(C){return typeof this.octaveShiftsByStaff[C]=="undefined"&&(this.octaveShiftsByStaff[C]=[]),this.octaveShiftsByStaff[C]};let M=null;const p=function(){return M===null&&(M=new E),M},m=g;var v=t(843678),U=t(726042);const x=function(C,y){v.default.forEach(y,S,C)},S=function(C,y){C=U.default.intPart(C);const F=this;f.default.setOctaveShifts(F,C,y)},K=x,Y=function(C){const y=f.default.getRawDirections(C),F=m(y);K(C,F)}},558885:(O,A,t)=>{t.d(A,{A:()=>ns});var f=t(701387),e=t(35802),s=t(843678),c=t(726042),d=t(348742),i=t(364842),a=t(123491);let o=function(){};const r={};r.setWarn=function(R){o=R},r.getWarn=function(){return o};const n=r,u="ERR_CHORD_MISSING_FORMER",l="ERR_TIME_NEGATIVE",h="ERR_TIME_COLLISION",I="ERR_GRACE_CLOSED",P="ERR_NULL_DURATION",T="ERR_GRACE_REST",_=function(){this.init()},g=_.prototype;g.init=function(){this.entries={},this.hasContentValue=null,this.purifiedContent=null,this.lastTimePos=0},g.getLastTimePos=function(){return this.lastTimePos},g.addEntity=function(R,Q){if(Q<0){const ht=n.getWarn(),pt="The time position is negative.",vt=new d.A(l,pt);ht(vt);return}a.default.isGraceNote(R)?a.default.isChord(R)?this.addChordGrace(R,Q):this.addGrace(R,Q):a.default.isChord(R)?this.addChordNote(R,Q):this.addNote(R,Q),this.lastTimePos=Q},g.addNote=function(R,Q){const ht=this.getEntry(Q);let pt,vt;if(ht.note.length>0){const yt=n.getWarn();ht.locked=!0,vt="Cannot have two notes at the same time position.",pt=new d.A(h,vt),yt(pt)}else if(a.default.getDuration(R)===0){const yt=n.getWarn();vt="Cannot have note with null duration.",pt=new d.A(P,vt),yt(pt)}else{if(a.default.isRest(R)&&ht.graces.length>0){const yt=n.getWarn();vt="Cannot have grace note before a rest.",pt=new d.A(T,vt),yt(pt),ht.graces=[]}ht.note.push(R)}},g.addChordNote=function(R,Q){const ht=this.getEntry(Q);if(!ht.locked)if(ht.note.length===0){const pt=n.getWarn(),vt="Cannot have a chord note without note before.",yt=new d.A(u,vt);pt(yt);return}else a.default.removeTimeJumps(R),ht.note.push(R)},g.addGrace=function(R,Q){const ht=this.getEntry(Q);if(ht.note.length>0){const pt=n.getWarn(),vt="Cannot add a grace after adding the base note.",yt=new d.A(I,vt);pt(yt)}else ht.graces.push([R])},g.addChordGrace=function(R,Q){const ht=this.getEntry(Q);let pt,vt;if(ht.note.length>0){const yt=n.getWarn();pt="Cannot add a grace after adding the base note.",vt=new d.A(I,pt),yt(vt)}else if(ht.graces.length===0){const yt=n.getWarn();pt="Cannot have a chord note without note before.",vt=new d.A(u,pt),yt(vt)}else{const yt=ht.graces.length-1;ht.graces[yt].push(R)}},g.getEntry=function(R){return typeof this.entries[R]=="undefined"&&(this.entries[R]={note:[],graces:[]}),this.entries[R]},g.hasContent=function(){if(this.hasContentValue===null){const R=this.getPurifiedContent();this.hasContentValue=R.length>0}return this.hasContentValue},g.getPurifiedContent=function(){if(this.purifiedContent===null){let R=s.default.toPairs(this.entries);R=R.filter(E),this.purifiedContent=R.map(D),this.purifiedContent.sort(M)}return this.purifiedContent};const E=function(R){return R.value.note.length>0},D=function(R){const Q=c.default.intPart(R.key),ht=R.value;ht.timePos=Q;const pt=a.default.getDuration(ht.note[0]);return ht.duration=pt,ht},M=function(R,Q){return R.timePos-Q.timePos},p=_,m="ERR_CHORD_BACKUP",v="ERR_CHORD_FORWARD",U=function(R){return F().index(R)},x=function(){},S=x.prototype;S.index=function(R){this.voicesIndexers={},this.timePos=0,this.previousVoiceIdx=null,R.forEach(this.addNote,this);let Q=this.voicesIndexers;return this.voicesIndexers=null,Q=s.default.filter(Q,K),s.default.map(Q,H)};const K=function(R,Q){return Q.hasContent()},H=function(R,Q){return Q.getPurifiedContent()};S.addNote=function(R){let Q=this.timePos,ht,pt;if(a.default.isChord(R)?(Y(R),ht=this.getChordVoiceIdx(R),pt=this.getVoice(ht),Q=pt.getLastTimePos()):(ht=a.default.getVoiceIdx(R),pt=this.getVoice(ht),Q=C(R,Q),this.updateTimePos(Q)),this.previousVoiceIdx=ht,pt.addEntity(R,Q),!a.default.isChord(R)&&!a.default.isGraceNote(R)){const vt=a.default.getDuration(R);this.updateTimePos(Q+vt)}},S.getChordVoiceIdx=function(R){if(a.default.hasVoiceIdx(R))return a.default.getVoiceIdx(R);if(this.previousVoiceIdx!==null)return a.default.setVoiceIdx(R,this.previousVoiceIdx),this.previousVoiceIdx;throw new i.default("Unexpected")};const Y=function(R){let Q,ht;if(a.default.hasBackup(R)){const pt=n.getWarn();Q="a chord note shoud not have backup data.",ht=new d.A(m,Q),pt(ht)}if(a.default.hasForward(R)){const pt=n.getWarn();Q="a chord note shoud not have forward data.",ht=new d.A(v,Q),pt(ht)}a.default.removeTimeJumps(R)},C=function(R,Q){let ht;return a.default.hasBackup(R)&&(ht=a.default.getBackupDuration(R),Q-=ht),a.default.hasForward(R)&&(ht=a.default.getForwardDuration(R),Q+=ht),Q};S.getVoice=function(R){return typeof this.voicesIndexers[R]=="undefined"&&(this.voicesIndexers[R]=new p),this.voicesIndexers[R]},S.updateTimePos=function(R){this.timePos=R};let y=null;const F=function(){return y===null&&(y=new x),y},N=U,nt=function(R){let Q=0,ht=0;for(;ht<R.length;){let pt=R[ht];const vt=pt.timePos-Q;if(vt>0)pt={duration:vt,timePos:Q,isEmptySpace:!0},R.splice(ht,0,pt);else if(vt<0){R.splice(ht,1);continue}Q+=pt.duration,ht++}};var J=t(259563);const W=Math.pow(2,2),Z=J.default.toQuarterDuration(J.default.SIXTY_FOURTH),at=function(R){if(R<=0)return 0;let Q=0,ht=c.default.log(R,2);ht=Math.floor(ht);let pt=Math.pow(2,ht);pt=Math.max(pt,Z);const vt=pt/W,yt=Math.max(vt,Z);for(;pt>=yt;){if(R<pt/2)return Q;if(R<pt)return R-=pt,Q+=pt,Q;R-=pt,Q+=pt,pt/=2}return R<yt&&R>=yt/2&&(Q+=yt),Q};var B=t(515819);const gt="breve",lt=function(R,Q){R=R.filter(X),R.forEach(k,Q)},X=function(R){return!R.isEmptySpace},k=function(R){const Q=this.valueOf(),ht=R.note[0],pt=a.default.getNormalQuarterDuration(ht,Q),vt=at(pt);if(!a.default.hasDurationType(ht)||vt!==pt||a.default.isRest(ht))R.quarterDuration=vt;else{let yt=1,zt;ht.type===gt?(yt=2,zt=J.default.FULL):zt=a.default.getDurationType(ht),a.default.hasTremoloSide(ht)&&zt++;const le={nbDots:a.default.getNbDots(ht),durationType:zt},as=B.default.durationOptsToQuarter(le);R.quarterDuration=as*yt}},L=lt,$=J.default.toQuarterDuration(J.default.SIXTY_FOURTH),ut=function(R,Q){R.forEach(w,Q)},w=function(R,Q,ht){if(st(R,Q,ht)){const pt=this.valueOf();tt(R,pt)}},st=function(R,Q,ht){if(!R.isEmptySpace)return!1;if(Q>0){const yt=ht[Q-1].note[0];if(!a.default.hasNormalTimeModif(yt))return!1}const pt=ht.length;if(Q<pt-1){const yt=ht[Q+1].note[0];if(!a.default.hasNormalTimeModif(yt))return!1}return!0},tt=function(R,Q){let ht=B.default.divisionsToQuarter(R.duration,Q);const pt=ht/$;if(!c.default.isInteger(pt)){const vt=Math.floor(pt)*$,yt=Math.ceil(pt)*$;ht-vt<yt-ht?ht=vt:ht=yt}R.quarterDuration=ht},it=ut,It=function(R){return R=R.filter(xt),R},xt=function(R){return typeof R.quarterDuration=="number"&&R.quarterDuration>0},Ot=It;var St=t(209175);const Nt=function(R){const Q=j(R);return B.default.getQuarterRequiredDpq(R.quarterDuration,Q)},j=function(R){if(R.isEmptySpace)return St.default.createDefault();{const Q=R.note[0];return a.default.getTimeModif(Q)}},ot=Nt,Tt=function(R){return R.map(ot).reduce(c.default.lcm,1)},Lt=function(R,Q){const ht=Vt(R);let pt=B.default.quarterToDivisions(R.quarterDuration,Q);pt=B.default.normalToActual(pt,ht),R.duration=pt,R.isEmptySpace||R.note.forEach(bt,pt)},Vt=function(R){if(R.isEmptySpace)return St.default.createDefault();{const Q=R.note[0];return a.default.getTimeModif(Q)}},bt=function(R){const Q=this.valueOf();a.default.setDuration(R,Q)},Ut=Lt,Xt=function(R,Q){R.forEach(Jt,Q)},Jt=function(R){const Q=this.valueOf();Ut(R,Q)},Zt=Xt,kt=function(R){const Q={timePos:0,jump:0,notes:[]};return R.forEach(te,Q),Q.notes},te=function(R){const Q=this;Q.jump=-Q.timePos,Q.timePos=0,R.forEach(b,Q)},b=function(R){const Q=this;if(Q.timePos+=R.duration,R.isEmptySpace)Q.jump+=R.duration;else{const ht=rt(R);a.default.removeTimeJumps(ht),Q.jump<0?a.default.addBackup(ht,-Q.jump):Q.jump>0&&a.default.addForward(ht,Q.jump),Q.jump=0,Et(Q.notes,R)}},rt=function(R){return R.graces.length>0?(a.default.removeTimeJumps(R.note[0]),R.graces[0][0]):R.note[0]},Et=function(R,Q){Q.graces.forEach(At,R),Q.note.forEach(Ct,R)},At=function(R){const Q=this;R.forEach(Ct,Q)},Ct=function(R){this.push(R)},Rt=kt,Kt=function(R){return Wt().group(R)},jt=function(){},ct=jt.prototype;ct.group=function(R){this.entities=[],this.tuplet=null,R.forEach(this.addNote,this),this.hasTuplet()&&this.closeTuplet();const Q=this.entities;return this.entities=null,Q},ct.addNote=function(R){ft(R)?this.addNoteToTuplet(R):this.addSingleNote(R)};const ft=function(R){return!R.isEmptySpace&&!a.default.hasNormalTimeModif(R.note[0])};ct.addSingleNote=function(R){this.hasTuplet()&&this.closeTuplet(),this.entities.push(R)},ct.addNoteToTuplet=function(R){this.hasTupletDifferent(R)&&this.closeTuplet(),this.getTuplet(R.note[0]).notes.push(R)},ct.hasTupletDifferent=function(R){if(this.hasTuplet()){const Q=this.getTuplet(),ht=_t(R);return!!(!St.default.isSame(ht,Q.timeModif)||a.default.hasTupletStart(R.note[0]))}else return!1};const _t=function(R){return a.default.getTimeModif(R.note[0])};ct.getTuplet=function(R){if(!this.hasTuplet()){const Q=a.default.getStaffIdx(R),ht=a.default.getVoiceIdx(R);let pt=a.default.getTimeModif(R);pt=St.default.copy(pt),this.tuplet={timeModif:pt,notes:[],staffIdx:Q,voiceIdx:ht}}return this.tuplet},ct.hasTuplet=function(){return this.tuplet!==null},ct.closeTuplet=function(){this.entities.push(this.tuplet),this.tuplet=null};let Dt=null;const Wt=function(){return Dt===null&&(Dt=new jt),Dt},wt=Kt,z=function(R){return R.notes.map(q).reduce(c.default.add,0)},q=function(R){return R.quarterDuration},mt=z,Pt=function(R){const Q=mt(R),ht=B.default.normalToActual(Q,R.timeModif);R.actualQuarterDuration=ht,R.isValid=Mt(R)},Mt=function(R){const Q=R.actualQuarterDuration;return!(!B.default.isValidQuarter(Q)||!B.default.isValidTupletDuration(Q,R.timeModif))},Bt=Pt,Ft=function(R){return ee().split(R)},Ht=function(){},Gt=Ht.prototype;Gt.split=function(R){this.timeModif=R.timeModif,this.voiceIdx=R.voiceIdx,this.staffIdx=R.staffIdx,this.tuplets=[],this.tuplet=null,R.notes.forEach(this.addNote,this),this.hasTuplet()&&this.closeTuplet();const Q=this.tuplets;return this.tuplets=null,Q},Gt.addNote=function(R){const Q=this.getTuplet();Q.notes.push(R),this.updateTuplet(),Q.isValid&&this.closeTuplet()},Gt.updateTuplet=function(){const R=this.getTuplet();Bt(R)},Gt.getTuplet=function(){if(!this.hasTuplet()){const R=St.default.copy(this.timeModif);this.tuplet={voiceIdx:this.voiceIdx,staffIdx:this.staffIdx,timeModif:R,notes:[]}}return this.tuplet},Gt.hasTuplet=function(){return this.tuplet!==null},Gt.closeTuplet=function(){this.tuplets.push(this.tuplet),this.tuplet=null};let $t=null;const ee=function(){return $t===null&&($t=new Ht),$t},qt=Ft,Qt=function(R){return fe().split(R)},ne=function(){},Yt=ne.prototype;Yt.split=function(R){this.timeModif=R.timeModif,this.voiceIdx=R.voiceIdx,this.staffIdx=R.staffIdx,this.tuplets=[],this.tuplet=null;const Q=R.notes.slice();Q.reverse(),Q.forEach(this.addNote,this),this.hasTuplet()&&this.closeTuplet();const ht=this.tuplets;return this.tuplets=null,ht},Yt.addNote=function(R){const Q=this.getTuplet();Q.notes.unshift(R),this.updateTuplet(),Q.isValid&&this.closeTuplet()},Yt.updateTuplet=function(){const R=this.getTuplet();Bt(R)},Yt.getTuplet=function(){if(!this.hasTuplet()){const R=St.default.copy(this.timeModif);this.tuplet={voiceIdx:this.voiceIdx,staffIdx:this.staffIdx,timeModif:R,notes:[]}}return this.tuplet},Yt.hasTuplet=function(){return this.tuplet!==null},Yt.closeTuplet=function(){this.tuplets.unshift(this.tuplet),this.tuplet=null};let se=null;const fe=function(){return se===null&&(se=new ne),se},he=Qt,me=function(R){const Q=qt(R),ht=Q.length;let pt=Q[ht-1];if(!pt.isValid){pt=Q.pop();const vt=he(pt);Q.push.apply(Q,vt)}return Q},_e=function(R,Q){let ht=B.default.normalToActual(R,Q);const pt=St.default.getBinaryCoeff(Q);ht/=pt;const vt=c.default.log(ht,2),yt=Math.ceil(vt);let zt=Math.pow(2,yt);return zt*=pt,B.default.actualToNormal(zt,Q)-R},ge=function(R){const Q=[];for(;R>0;){const ht=B.default.extractBaseDuration(R);Q.push(ht),R-=ht}return Q.reverse(),Q},pe=function(R){const Q=mt(R),ht=_e(Q,R.timeModif),vt=ge(ht).map(Ee,R);R.notes.push.apply(R.notes,vt),Bt(R)},Ee=function(R){const Q=this,ht=St.default.copy(Q.timeModif),pt={rest:{}};return a.default.setVoiceIdx(pt,Q.voiceIdx),a.default.setStaffIdx(pt,Q.staffIdx),a.default.setTimeModif(pt,ht),{quarterDuration:R,graces:[],note:[pt]}},Ie=pe,Pe=function(R){const Q=R.notes[0].note[0];if(!a.default.hasTupletStart(Q))return!1;const ht=R.notes.length,pt=R.notes[ht-1].note[0];return!!a.default.hasTupletStop(pt)};var ie=t(870437);const De=function(R){R.notes.forEach(Me),R.locked=!0},Me=function(R,Q,ht){const pt=R.note[0];if(R.note.forEach(a.default.removeTupletBounds),Q===0){const yt=ie.A.createNakedStart();a.default.addTupletBounds(pt,[yt])}const vt=ht.length;if(Q===vt-1){const yt=ie.A.createStop();a.default.addTupletBounds(pt,[yt])}},re=De,Ae=function(R){R=R.filter(Pe),R.forEach(re)},Te=function(R){const Q=R[0];if(Q.locked)return{merged:[Q],remaining:R.slice(1)};let ht=Q.actualQuarterDuration;const pt=R.length;let vt;for(vt=1;vt<pt;vt++){const yt=R[vt];if(yt.locked)return ce(ht,Q.timeModif)?{merged:R.slice(0,vt),remaining:R.slice(vt)}:{merged:[Q],remaining:R.slice(1)};if(ht+=yt.actualQuarterDuration,ce(ht,Q.timeModif))return{merged:R.slice(0,vt+1),remaining:R.slice(vt+1)}}return{merged:[Q],remaining:R.slice(1)}},ce=function(R,Q){const ht=St.default.getBinaryCoeff(Q);return R/=ht,c.default.isFloatPowerOfTwo(R)},ve=Te,Ue=function(R){if(R.length===1)return R[0];const Q=R.map(xe),ht=Array.prototype.concat.apply([],Q),pt=St.default.copy(R[0].timeModif),vt={notes:ht,timeModif:pt};return Bt(vt),vt},xe=function(R){return R.notes},Oe=Ue,ue=function(R){if(R.length===0)return R;const Q=ve(R),ht=Q.merged,pt=Oe(ht);let vt=Q.remaining;return vt=ue(vt),vt.unshift(pt),vt},Se=ue,Ce=function(R){let Q,ht=R.length;do{Ae(R),R=Se(R);const pt=R.length;Q=ht-pt,ht=pt}while(Q!==0);return R},ye=function(R){R=R.filter(Re),R.forEach(re)},Re=function(R){return!R.locked},Be=ye,Le=function(R){const Q=R.timeModif,ht=St.default.getActual(Q),pt=St.default.getNormal(Q);return c.default.isPowerOfTwo(ht)&&c.default.isPowerOfTwo(pt)},Ne=function(R){Le(R)&&We(R)},We=function(R){R.notes.forEach(Ke)},Ke=function(R){R.note.forEach(je)},je=function(R){const Q=St.default.createDefault();a.default.setTimeModif(R,Q),a.default.removeTupletBounds(R)},Ve=Ne,Fe=function(R){Bt(R);let Q;return R.isValid?Q=[R]:(Q=me(R),be(Q),Q=Ce(Q)),Be(Q),Q.forEach(Ve),Q},be=function(R){R=R.filter(Ge),R.forEach(Ie)},Ge=function(R){return!R.isValid},we=Fe,He=function(R){return R=Xe().process(R),R},de=function(){},oe=de.prototype;oe.process=function(R){this.entities=[],R.forEach(this.addEntity,this);const Q=this.entities;return this.entities=null,Q},oe.addEntity=function(R){ze(R)?this.addTuplet(R):this.entities.push(R)};const ze=function(R){return typeof R.timeModif!="undefined"};oe.addTuplet=function(R){const Q=we(R);this.entities.push.apply(this.entities,Q)};let ae=null;const Xe=function(){return ae===null&&(ae=new de),ae},$e=He,Qe=function(R){const Q=[];return R.forEach(Ye,Q),Q},Ye=function(R){const Q=this;Je(R)?Q.push.apply(Q,R.notes):Q.push(R)},Je=function(R){return typeof R.timeModif!="undefined"},Ze=Qe,ke=function(R){let Q=wt(R);return Q=$e(Q),R=Ze(Q),R},qe=function(R){let Q=f.default.getNotes(R);const ht=f.default.getDpq(R);let pt=N(Q);pt=s.default.getValues(pt),pt.forEach(nt),pt.forEach(ts,ht),pt.forEach(es,ht),pt=pt.map(Ot),pt=pt.map(ke);const yt=pt.map(Tt).reduce(c.default.lcm,ht);pt.forEach(ss,yt),Q=Rt(pt),f.default.setNotes(R,Q);const zt=f.default.getAttributes(R);e.default.setDpq(zt,yt)},ts=function(R){const Q=this.valueOf();L(R,Q)},es=function(R){const Q=this.valueOf();it(R,Q)},ss=function(R){const Q=this.valueOf();Zt(R,Q)},ns=qe},560015:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(123491),e=t(292681),s=t(852363),c=t(980641),d=t(343568);const i=function(r,n,u){this.init(r,n,u)};i.NAME="primitive.RemoveSingleNotePercu";const a=i.prototype;a.name=i.NAME,a.initMeasureData=d.A,a.init=function(r,n,u){this.initMeasureData(r,n),this.cancelStack=u,this.opts=n},a.perform=function(){const r=this.getVoice(),n=r.getNote(this.opts.noteIdx);r.removeNote(this.opts.noteIdx),this.updateStack(n)},a.getVoice=function(){const r=this.opts.voiceIdx,n=this.opts.noteIdx;return this.measureData.getVoiceOrTupletForGet(r,n)},a.updateStack=function(r){const n=this.getDurationType(r),u=f.default.getUnpitched(r),l={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,noteIdx:this.opts.noteIdx,voiceIdx:this.opts.voiceIdx,staffIdx:f.default.getStaffIdx(r),durationType:n,nbDots:f.default.getNbDots(r),notehead:f.default.getHead(r),unpitched:e.default.copy(u)}};this.cancelStack.push(l),(0,s.default)(this.cancelStack,this.measureData,this.opts)},a.getDurationType=function(r){const n=this.measureData.getDivisionsPerQuarterValue();return(0,c.A)(r,n)};const o=i},561264:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(123491),s=t(712947);function c(i){const a=this.valueOf();let o=f.default.getNotes(i);o=o.filter(e.default.hasSlur),o.forEach(d,a)}function d(i){const a=this.valueOf();let o=e.default.getSlurs(i);o=o.filter(r=>s.default.getLevel(r)!==a),e.default.setSlurs(i,o)}},562124:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(555172),s=t(269032);const c=32;function d(a){const o=a.getFormatVersion();o>0&&o<c&&a.forEachMeasure(i)}function i(a){if(!f.default.hasRightBarline(a))return;const o=f.default.getRightBarline(a);if(!e.A.hasRepeat(o))return;const r=e.A.getRepeat(o),n=s.A.getRawTimes(r),u=s.A.nbRepeatToNbPlay(n);s.A.setTimes(r,u)}},562621:(O,A,t)=>{t.d(A,{A:()=>y});var f=t(446921),e=t(297805),s=t(701387),c=t(952818);function d(F){s.default.getRawDirections(F).forEach(i)}function i(F){c.A.setStaffIdx(F,0)}var a=t(35802);const o=2;function r(F){const N=s.default.getAttributes(F);a.default.setNbStaves(N,1),s.default.getAllRawAttributes(F).forEach(n)}function n(F){a.default.setNbStaves(F,1);const N=a.default.getWrappedClef(F,o);N.removeEntry(1);const G=N.dumpAttribute();a.default.setClef(F,G);const nt=a.default.getWrappedKey(F,o);nt.removeEntry(1);const J=nt.dumpAttribute();a.default.setKey(F,J);const V=a.default.getWrappedTime(F,o);V.removeEntry(1);const W=V.dumpAttribute();a.default.setTime(F,W);const Z=a.default.getWrappedTranspose(F,o);Z.removeEntry(1);const dt=Z.dumpAttribute();a.default.setTranspose(F,dt);const at=a.default.getWrappedStaffDetails(F,o);if(at.hasEntry(1)){const gt=at.getEntry(1);at.setEntry(gt,0)}at.removeEntry(1);const B=at.dumpAttribute();a.default.setStaffDetails(F,B)}var u=t(123491),l=t(364842),h=t(843678),I=t(515819),P=t(351277);function T(F,N){return F.length!==N.length?!1:F.every((G,nt)=>{const J=N[nt];return _(G,J)})}function _(F,N){return F.length!==N.length?!1:F.length===0?!0:F.every((G,nt)=>{const J=N[nt];return g(G,J)})}function g(F,N){const G=u.default.isGraceNote(F),nt=u.default.isGraceNote(N);if(G!==nt)return!1;if(!G){const W=u.default.getDuration(F),Z=u.default.getDuration(N),dt=u.default.getNbDots(N),at=u.default.getNbDots(F);if(at>0&&dt===0){const B=I.default.applyDotsToDuration(Z,at);if(W!==B)return!1}else if(dt>0&&at===0){if(I.default.applyDotsToDuration(W,dt)!==Z)return!1}else if(W!==Z)return!1}const J=u.default.isRest(F),V=u.default.isRest(N);if(J!==V)return!1;if(!J){const W=u.default.getPitch(F),Z=u.default.getPitch(N),dt=P.default.getStep(W),at=P.default.getStep(Z);if(dt!==at)return!1}return!0}var E=t(964845),D=t(359932);function M(F,N){F.forEach((G,nt)=>{const J=N[nt];G.forEach((V,W)=>{const Z=J[W];p(V,Z)})})}function p(F,N){if(u.default.hasFretData(N)){const G=u.default.getFretData(N),nt=E.A.getTechnicalOpts(G,D.default.FRET);u.default.addTechnical(F,D.default.FRET,nt);const J=E.A.getTechnicalOpts(G,D.default.STRING);u.default.addTechnical(F,D.default.STRING,J)}}function m(F){new v(F).match()}class v{constructor(N){this.measures=N,this.topVoices={},this.bottomVoices={}}match(){this.mapMeasures(),this.matchVoices(),this.mergeMatchedVoices(),this.restoreNotes()}mapMeasures(){this.measures.forEach(this.mapMeasure,this)}mapMeasure(N,G){this.measureIdx=G,s.default.getNotes(N).forEach(this.mapNote,this)}mapNote(N){const G=u.default.getVoiceIdx(N),nt=u.default.getStaffIdx(N);this.getVoiceMeasureNotes(G,nt).push(N)}getVoiceMeasureNotes(N,G){const nt=this.getStaffVoices(G);typeof nt[N]=="undefined"&&(nt[N]={startMeasureIdx:this.measureIdx,measures:[],voiceIdx:N});const J=nt[N],{measures:V}=J;for(;V.length<=this.measureIdx;)V.push([]);return V[this.measureIdx]}getStaffVoices(N){if(N===0)return this.topVoices;if(N===1)return this.bottomVoices;throw new l.default("Unexpected",`The staffIdx ${N} is invalid. 
      It should be 0 or 1.`)}matchVoices(){const N=h.default.shallowCopy(this.topVoices);h.default.forEach(this.bottomVoices,U,N)}mergeMatchedVoices(){h.default.forEach(this.topVoices,S)}restoreNotes(){this.measures.forEach(K),h.default.forEach(this.topVoices,H,this.measures)}}function U(F,N){const G=this;h.default.some(G,x,N)}function x(F,N,G){const nt=this;return nt.measureIdx!==N.measureIdx?!1:T(nt.measures,N.measures)?(N.bottomVoice=nt,delete G[F],!0):!1}function S(F,N){typeof N.bottomVoice!="undefined"&&M(N.measures,N.bottomVoice.measures)}function K(F){s.default.setNotes(F,[])}function H(F,N){const G=this;N.measures.forEach(Y,G)}function Y(F,N){const nt=this[N],J=s.default.getNotes(nt);Array.prototype.push.apply(J,F)}function C(F){const N=f.A.getMeasures(F);N.forEach(d),N.forEach(r),m(N)}function y(F){const N=f.A.getFirstMeasure(F);(0,e.A)(N)&&C(F)}},562628:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(123491);const e=function(i){return new s(i).group(i)},s=function(i){this.init(i)},c=s.prototype;c.init=function(i){this.notes=i,this.tmpChord=null,this.chords=[]},c.group=function(){return this.notes.forEach(this.addNote,this),this.dumpChord(),this.chords},c.addNote=function(i){f.default.isRest(i)?(this.dumpChord(),this.addRest()):f.default.isChord(i)?this.addToChord(i):(this.dumpChord(),this.addSingleNote(i))},c.dumpChord=function(){this.tmpChord!==null&&(this.chords.push(this.tmpChord),this.tmpChord=null)},c.addRest=function(){this.chords.push([])},c.addToChord=function(i){this.tmpChord.push(i)},c.addSingleNote=function(i){this.tmpChord=[i]};const d=e},563549:(O,A,t)=>{t.d(A,{A:()=>wt});var f=t(378432),e=t(343568),s=t(886766),c=t(162621),d=t(245770),i=t(809650),a=t(476943),o=t(123491),r=t(712947),n=t(351277),u=t(35802),l=t(209175),h=t(414787),I=t(515819),P=t(292681),T=t(701387),_=t(589501),g=t(614653),E=t(529355),D=t(681670),M=t(50060),p=t(377180),m=t(104907),v=t(345912),U=t(346797),x=t(584416),S=t(368495),K=t(595382),H=t(724926),Y=t(860716),C=t(244240),y=t(184469),F=t(601277),N=t(702868),G=t(359932),nt=t(369790),J=t(259563),V=t(952818),W=t(496819),Z=t(536949),dt=t(447819),at=t(788220),B=t(544342);const gt=function(z,q){const mt=q.partIdx,Pt=q.measureIdx,Mt=z.getMeasure(mt,Pt),Bt=T.default.getWedges(Mt,q.staffIdx),Ft=lt(Mt,q.voiceIdx,q.staffIdx),Ht=(0,B.A)(Ft,Bt,q.timePosition),Gt=T.default.getDynamics(Mt,q.staffIdx),$t=X(Gt,q.timePosition),ee=T.default.getPizzicatos(Mt,q.staffIdx),qt=k(ee,q.timePosition),Qt=T.default.getMutes(Mt,q.staffIdx),ne=L(Qt,q.timePosition),Yt=T.default.getWords(Mt,q.staffIdx),se=$(Yt,q.timePosition);return{wedgeType:Ht,dynamicData:$t,pizzicatoData:qt,wordData:se,muteData:ne}},lt=function(z,q,mt){return T.default.hasLeftWedge(z,mt)?T.default.getLeftWedge(z,mt):null},X=function(z,q){const mt=z.findIndex(ut,q);if(mt>=0){const Pt=z[mt];return{style:W.A.getStyle(Pt),idx:mt}}else return null},k=function(z,q){const mt=z.findIndex(ut,q);if(mt>=0){const Pt=z[mt];return{type:Z.A.getType(Pt),idx:mt}}else return null};function L(z,q){const mt=z.findIndex(ut,q);if(mt>=0){const Pt=z[mt];return{type:dt.A.getType(Pt),idx:mt}}else return null}const $=function(z,q){const mt=z.findIndex(ut,q);if(mt>=0){const Pt=z[mt],Mt=at.A.getText(Pt),Bt=at.A.getPlacement(Pt),Ft=at.A.getWordUuid(Pt);return{text:Mt,idx:mt,uuid:Ft,placement:Bt}}else return null},ut=function(z){const q=this.valueOf();return V.A.getTimePos(z)===q},w=gt;var st=t(21738),tt=t(131220),it=t(409200),It=t(203066),xt=t(856219),Ot=t(967104),St=t(721247),Nt=t(999970);const j=function(z,q){return new ot(z,q).get()},ot=function(z,q){this.init(z,q)},et=ot.prototype;et.init=function(z,q){this.scoreData=z,(0,st.default)(z,q),(0,tt.default)(z,q),(0,it.default)(z,q),this.location=q,this.pitch=null,this.unpitched=null,this.octaveShifts={},this.timePos=null,this.actualDuration=null,this.availableDuration=null},et.get=function(){this.noteData={};const z={};e.A.call(z,this.scoreData,this.location),this.measureData=z.measureData,this.measureData.checkVoiceIdx(this.location.voiceIdx);const q=this.getVoice(),mt=this.location.noteIdx;return q.checkNoteIdx(mt),q.isRest(mt)?this.extractRest():q.isUnpitched(mt)?this.extractUnpitchedInstrument():this.extractPitched(),this.extractDirections(),this.extractSlurData(),this.extractJazzHarmony(),this.extractClassicHarmony(),this.extractFiguredBass(),this.noteData.nbGraces=q.getNbGraces(this.location.noteIdx),this.extractOctaveShift(),this.extractPedal(),this.extractPluckedRange(),this.extractTempoChange(),this.noteData},et.getVoice=function(){return this.measureData.getVoice(this.location.voiceIdx)},et.extractRest=function(){this.noteData.isRest=!0;const z=this.getVoice();this.baseNote=z.getNote(this.location.noteIdx),this.extractDuration(),this.extractArticulations(),this.noteData.technical=[],this.noteData.ornaments=[],this.extractLyrics(),this.noteData.restColor=Ut(this.baseNote)},et.extractUnpitchedInstrument=function(){this.noteData.isRest=!1;let q=this.getVoice().getChord(this.location.noteIdx);q=a.default.makeArray(q).slice(),this.baseNote=q[0],q.sort(Vt),this.noteData.beamStatus=o.default.getBeamStatus(this.baseNote),this.noteData.hasGraceSlur=o.default.hasGraceSlur(this.baseNote),this.noteData.isTied=q.some(o.default.hasTieStart),this.noteData.noteheads=q.map(o.default.getHead),this.noteData.lines=q.map(this.extractUnpitchedLine,this),this.noteData.accidentals=q.map(Tt),this.noteData.courtesyAccidentals=q.map(Lt),this.noteData.ghostNotes=q.map(o.default.hasHeadParentheses),this.noteData.colors=q.map(Ut),this.noteData.tieDirections=q.map(o.default.getTieDirection),this.noteData.ties=q.map(o.default.hasTieStart),this.noteData.isChord=q.length>1,this.getUnpitchedInstruments(q),this.extractDuration(),this.extractArticulations(),this.extractTechnical(),this.extractOrnaments(),this.extractLyrics()};const Tt=function(){return null},Lt=function(){return!1},Vt=function(z,q){const mt=o.default.getUnpitched(z),Pt=o.default.getUnpitched(q);return P.default.compare(mt,Pt)};et.extractUnpitchedLine=function(z){const q=o.default.getUnpitched(z),mt=o.default.getStaffIdx(z),Pt=this.measureData.getStaffDetails(mt),Mt=m.default.getNbStaffLines(Pt);return h.A.pitchToLine(q,Mt)},et.getUnpitchedInstruments=function(z){this.noteData.unpitched=z.map(function(q){const mt=o.default.getInstrumentId(q),Pt=this.location.partIdx,Mt=this.scoreData.getMIDIInstrumentById(Pt,mt),Bt=xt.default.getMIDIProgram(Mt);return{MIDIUnpitched:xt.default.getUnpitched(Mt),MIDIProgram:Bt}},this)},et.extractPitched=function(){this.noteData.isRest=!1;let q=this.getVoice().getChord(this.location.noteIdx);q=a.default.makeArray(q).slice(),this.baseNote=q[0],q.sort(bt),this.noteData.isChord=q.length>1,this.noteData.beamStatus=o.default.getBeamStatus(this.baseNote),this.noteData.isTied=q.some(o.default.hasTieStart),this.noteData.hasGlissando=q.some(o.default.hasGlissandoStart),this.noteData.hasGraceSlur=o.default.hasGraceSlur(this.baseNote),this.noteData.ghostNotes=q.map(o.default.hasHeadParentheses),this.noteData.colors=q.map(Ut),this.noteData.noteheads=q.map(o.default.getHead),this.noteData.bends=q.map(Xt),this.noteData.harmonics=q.map(Jt),this.noteData.preBends=q.map(Zt),this.noteData.tieDirections=q.map(o.default.getTieDirection),this.noteData.ties=q.map(o.default.hasTieStart),this.extractStaffIndexes(q),this.getPitches(q),this.isTab(q)&&this.getTabsData(q),this.getLines(q),this.extractAccidentals(q),this.extractCourtesyAccidentals(q),this.extractFingerings(q),this.extractArticulations(),this.extractTechnical(),this.extractOrnaments(),this.extractDuration(),this.extractLyrics(),this.extractHasArpeggio(),this.extractHammerOnPullOffs(q),this.extractSlideStarts(q),this.shiftLinesIfNeeded()};const bt=function(z,q){const mt=o.default.getPitch(z),Pt=o.default.getPitch(q);return n.default.compareLine(mt,Pt)};function Ut(z){return o.default.hasColor(z)?o.default.getColor(z):null}function Xt(z){if(o.default.hasBend(z)){const q=o.default.getBend(z),mt=Ot.A.getAlter(q),Pt=Ot.A.getType(q);return{alter:mt,type:Pt}}else return null}function Jt(z){if(o.default.hasHarmonic(z)){const q=o.default.getHarmonic(z);return Y.default.getType(q)}else return null}function Zt(z){if(o.default.hasPreBend(z)){const q=o.default.getPreBend(z);return{alter:Ot.A.getAlter(q)}}else return null}et.extractStaffIndexes=function(z){this.staffIndexes=z.map(o.default.getStaffIdx)},et.getPitches=function(z){let q=z.map(o.default.getPitch);const mt={};q.forEach(kt,mt),this.noteData.canTryEnharmonicSwitch=q.map(rt,{getter:this,pitchesSet:mt}),q=q.map(this.transposePitchIfNeeded,this),this.noteData.pitches=q.map(b)};function kt(z){z=n.default.copyWithoutAlter(z);const q=n.default.stringify(z),mt=this;mt[q]=!0}et.getTabsData=function(z){const q=z.map(te);this.noteData.tabsData=q};const te=function(z){return o.default.hasTabData(z)?o.default.getTabData(z):null},b=function(z){return{step:n.default.getStep(z),octave:n.default.getOctave(z),alter:n.default.getAlter(z)}};et.isTab=function(z){const q=z[0],mt=o.default.getStaffIdx(q),Pt=this.measureData.getStaffDetails(mt);return m.default.hasTab(Pt)},et.transposePitchIfNeeded=function(z,q){if(!this.location.isConcertPitch)return z;const mt=this.staffIndexes[q],Pt=this.getTranspose(mt);return p.default.isIdentity(Pt)||(z=n.default.transpose(z,Pt,!0)),z},et.getTranspose=function(z){return this.measureData.getTranspose(z)};function rt(z,q){const{getter:mt,pitchesSet:Pt}=this,Mt=mt.staffIndexes[q],Bt=mt.getKey(Mt);try{const Ft=K.A.switchEnharmonic(z,Bt);if(n.default.isSamePitch(z,Ft))return!1;const Ht=n.default.stringify(n.default.copyWithoutAlter(Ft));return Pt[Ht]!==!0}catch(Ft){if(Ft instanceof f.A)return!1;throw Ft}}et.getKey=function(z){return this.measureData.getKey(z)},et.getLines=function(){this.noteData.lines=this.noteData.pitches.map(this.pitchToLine,this)},et.pitchToLine=function(z,q){const mt=this.staffIndexes[q],Pt=this.getClef(mt);return n.default.pitchToLine(z,Pt)},et.getClef=function(z){const q=this.measureData.getClef(z),mt=this.measureData.getMeasure();if(!T.default.hasMiddleClefs(mt,z))return q;const Pt=T.default.getMiddleClefs(mt,z),Mt=this.getTimePosition(),Bt={clef:q,timePos:Mt};return Pt.some(Et,Bt),Bt.clef};function Et(z){const q=this;if(St.default.getTimePos(z)<=q.timePos)q.clef=z;else return!0}et.extractAccidentals=function(z){this.noteData.accidentals=z.map(this.extractAccidental,this)},et.extractAccidental=function(z,q){if(o.default.hasAccidental(z)){let mt=o.default.getPitch(z);mt=this.transposePitchIfNeeded(mt,q);const Pt=n.default.getAlter(mt);return n.default.alterToAccidental(Pt)}else return null},et.extractCourtesyAccidentals=function(z){this.noteData.courtesyAccidentals=z.map(o.default.hasCourtesyAccidental)},et.extractFingerings=function(z){this.noteData.fingerings=z.map(At)};const At=function(z){return o.default.hasFingering(z)?o.default.getFingering(z):null};et.extractArticulations=function(){o.default.hasArticulations(this.baseNote)?this.noteData.articulations=o.default.getArticulationsList(this.baseNote):this.noteData.articulations=[],o.default.hasNotation(this.baseNote,F.default.FERMATA)&&this.noteData.articulations.push(F.default.FERMATA)},et.extractTechnical=function(){o.default.hasTechnicals(this.baseNote)?this.noteData.technical=o.default.getTechnicalList(this.baseNote):this.noteData.technical=[]},et.extractOrnaments=function(){o.default.hasOrnaments(this.baseNote)?this.noteData.ornaments=o.default.getOrnamentsWithOpts(this.baseNote):this.noteData.ornaments=[]},et.extractDuration=function(){const z=this.getAttributes(),q=u.default.getDivisions(z),mt=o.default.getNormalQuarterDuration(this.baseNote,q),Pt=I.default.quarterToDurationOpts(mt),Mt=o.default.getTimeModif(this.baseNote);l.default.isNormal(Mt)?this.noteData.tupletType=null:this.noteData.tupletType=N.A.fromTimeModif(Mt),this.noteData.nbDots=Pt.nbDots,this.noteData.durationType=Pt.durationType,this.extractPossibleTuplet()},et.extractPossibleTuplet=function(){if(this.noteData.tupletType!==null){this.noteData.possibleTuplets=[],this.noteData.possibleExpandedTuplets=[];return}const z=N.A.getValues();this.noteData.possibleTuplets=z.filter(this.isTupletPossible,this),this.noteData.possibleExpandedTuplets=z.filter(this.isExpandedTupletPossible,this)},et.isTupletPossible=function(z){const q=N.A.getTimeModif(z);if(l.default.getWholeNbDots(q)!==this.noteData.nbDots)return!1;const Pt=l.default.getShiftToShardDurationType(q),Mt=this.noteData.durationType+Pt;return!!J.default.isValid(Mt)},et.isExpandedTupletPossible=function(z){const q=this.getAvailableDuration(),mt=this.getExpandedTupletRequiredDuration(z);return mt>J.default.toQuarterDuration(J.default.FULL)*1.5?!1:mt<=q},et.getAvailableDuration=function(){if(this.availableDuration===null){const q=this.getVoice().getSpaceToEnd(this.location.noteIdx),mt=this.measureData.getDpqValue();this.availableDuration=I.default.divisionsToQuarter(q,mt)}return this.availableDuration},et.getExpandedTupletRequiredDuration=function(z){const q=this.getActualQuarterDuration(),mt=N.A.getTimeModif(z),Pt=l.default.getNormal(mt);return q*Pt},et.getActualQuarterDuration=function(){if(this.actualDuration===null){const z=this.measureData.getDpqValue(),q=o.default.getQuarterDuration(this.baseNote,z);this.actualDuration=I.default.extractBaseDuration(q)}return this.actualDuration},et.extractLyrics=function(){const z=o.default.getLyrics(this.baseNote).slice();z.sort(M.default.compare),this.noteData.lyrics=z.map(Ct)};const Ct=function(z){const mt={level:M.default.getLevel(z)};if(M.default.hasLeftMelisma(z))mt.isMelisma=!0,mt.text="_";else{const Pt=M.default.getText(z),Mt=M.default.hasRightConnection(z),Bt=M.default.hasRightMelisma(z);mt.text=Pt,mt.hasRightConnection=Mt,mt.hasRightMelisma=Bt}return mt};et.getAttributes=function(){return this.measureData.getAttributes()},et.extractDirections=function(){const z=o.default.getStaffIdx(this.baseNote),q=this.getTimePosition(),mt=this.getDpq(),Pt={partIdx:this.location.partIdx,measureIdx:this.location.measureIdx,voiceIdx:this.location.voiceIdx,staffIdx:z,timePosition:q,dpq:mt},Mt=w(this.scoreData,Pt);this.noteData.wedgeType=Mt.wedgeType,Mt.dynamicData!==null?(this.noteData.dynamicStyle=Mt.dynamicData.style,this.noteData.dynamicIdx=Mt.dynamicData.idx):this.noteData.dynamicStyle=null,Mt.pizzicatoData!==null&&(this.noteData.pizzicatoData=Mt.pizzicatoData),Mt.wordData!==null&&(this.noteData.wordData=Mt.wordData),Mt.muteData!==null&&(this.noteData.muteData=Mt.muteData)},et.getTimePosition=function(){const z=this.getVoice();let q=0;for(let mt=0;mt<this.location.noteIdx;mt++){const Pt=z.getNote(mt),Mt=o.default.getDuration(Pt);q+=Mt}return q},et.getDpq=function(){return this.measureData.getDpqValue()},et.extractSlurData=function(){this.noteData.isInSlur=!1;const z=this.measureData.scroller,q=(0,It.A)(z,this.location);if(q){const Mt=z.getMeasureData(q.measureIdx).getVoice(this.location.voiceIdx).getNote(q.noteIdx),Bt=o.default.getSlur(Mt);this.noteData.slurPlacement=r.default.getPlacement(Bt),this.noteData.isInSlur=!0}},et.extractJazzHarmony=function(){const z=this.getTimePosition(),q=this.measureData.getMeasure(),mt=T.default.getJazzHarmonies(q),Pt=mt.findIndex(Kt,z);if(Pt!==-1){const Mt=mt[Pt],{suspension:Bt}=(0,Nt.A)(Mt),Ft=g.default.getHarmonyUuid(Mt),Ht=g.default.getType(Mt),Gt=g.default.getAdagioKind(Mt),$t=(0,C.A)(Mt),ee=(0,y.A)(Gt,$t);let qt=g.default.getRoot(Mt);qt=E.A.copy(qt);let Qt=null;g.default.hasBass(Mt)&&(Qt=g.default.getBass(Mt),Qt=D.A.copy(Qt)),this.noteData.harmony={idx:Pt,uuid:Ft,kind:Gt,type:Ht,root:qt,bass:Qt,suspension:Bt||null,degrees:ee},Rt(this.noteData.harmony,this.measureData,this.location.isConcertPitch)}else this.noteData.harmony=null};const Rt=function(z,q,mt){if(!mt)return;const Pt=q.getTranspose(0);p.default.isUnison(Pt)||(z.root=E.A.transpose(z.root,Pt),z.bass!==null&&(z.bass=D.A.transpose(z.bass,Pt)))};et.extractClassicHarmony=function(){const z=this.getTimePosition(),q=this.measureData.getMeasure(),mt=T.default.getClassicHarmonies(q),Pt=mt.findIndex(Kt,z);if(Pt!==-1){const Mt=mt[Pt],Bt=g.default.getKindValue(Mt),Ft=g.default.getFunction(Mt),Ht=g.default.getInversion(Mt),Gt=g.default.getAlter(Mt),$t=g.default.getHarmonyUuid(Mt);this.noteData.classicHarmony={uuid:$t,chordFunction:Ft,alter:Gt,kind:Bt,inversion:Ht,idx:Pt},g.default.hasSecondaryFunction(Mt)&&(this.noteData.classicHarmony.secondaryFunction=g.default.getSecondaryFunction(Mt),this.noteData.classicHarmony.secondaryAlter=g.default.getSecondaryAlter(Mt),this.noteData.classicHarmony.secondaryKind=g.default.getSecondaryKind(Mt),this.noteData.classicHarmony.secondaryInversion=g.default.getSecondaryInversion(Mt))}else this.noteData.classicHarmony=null};const Kt=function(z){const q=this.valueOf();return g.default.getTimePos(z)===q};et.extractFiguredBass=function(){const z=this.getTimePosition(),q=this.measureData.getMeasure(),mt=T.default.getFiguredBasses(q),Pt=mt.findIndex(jt,z);if(Pt!==-1){const Mt=mt[Pt],Bt=_.A.getUuid(Mt),Ft=_.A.getFiguresData(Mt);this.noteData.figuredBass={figuresData:Ft,idx:Pt,uuid:Bt}}else this.noteData.figuredBass=null};const jt=function(z){const q=this.valueOf();return _.A.getTimePos(z)===q};et.extractHasArpeggio=function(){this.noteData.hasArpeggio=o.default.hasArpeggiate(this.baseNote)},et.extractHammerOnPullOffs=function(z){this.noteData.hammerOnPullOffs=z.map(ct)},et.extractSlideStarts=function(z){this.noteData.slideStarts=z.map(o.default.hasSlideStart)};const ct=function(z){const mt={hammerOnPullOff:H.A.create(nt.A.START)};return o.default.hasTechnical(z,G.default.HAMMER_ON,mt)||o.default.hasTechnical(z,G.default.PULL_OFF,mt)};et.shiftLinesIfNeeded=function(){typeof this.noteData.lines!="undefined"&&(this.noteData.lines=this.noteData.lines.map(this.shiftLineIfNeeded,this))},et.shiftLineIfNeeded=function(z,q){const mt=this.staffIndexes[q],Pt=this.getOctaveShift(mt);return Pt!==null&&(z=v.A.applyShiftToLine(Pt,z)),z},et.extractOctaveShift=function(){const z=this.getAnyOctaveShift();if(z!==null){const q=v.A.getStaffIdx(z),mt=v.A.getType(z),Pt=v.A.getSize(z);this.noteData.octaveShift={staffIdx:q,type:mt,size:Pt}}},et.getAnyOctaveShift=function(){const z=o.default.getStaffIdx(this.baseNote);return this.getOctaveShift(z)},et.getOctaveShift=function(z){return typeof this.octaveShifts[z]=="undefined"&&this.initOctaveShift(z),this.octaveShifts[z]},et.initOctaveShift=function(z){const q=this.measureData.getMeasure(),mt=ft(q,z);if(mt===null&&!T.default.hasOctaveShifts(q,z))this.octaveShifts[z]=null;else{const Pt=this.getTimePos(),Mt=T.default.getOctaveShifts(q,z),Bt=(0,s.A)(mt,Mt,Pt,!0);this.octaveShifts[z]=Bt}};const ft=function(z,q){return T.default.hasLeftOctaveShift(z,q)?T.default.getLeftOctaveShift(z,q):null};et.extractPedal=function(){const z=this.getPedal();if(z!==null){const q=x.A.getStaffIdx(z);this.noteData.pedal={staffIdx:q}}},et.getPedal=function(){return typeof this.pedal=="undefined"&&this.initPedal(),this.pedal},et.initPedal=function(){const z=o.default.getStaffIdx(this.baseNote),q=this.measureData.getMeasure(),mt=_t(q,z);if(mt===null&&!T.default.hasPedals(q,z))this.pedal=null;else{const Pt=this.getTimePos(),Mt=T.default.getPedals(q,z);this.pedal=(0,c.A)(mt,Mt,Pt,!0)}};const _t=function(z,q){return T.default.hasLeftPedal(z,q)?T.default.getLeftPedal(z,q):null};et.extractPluckedRange=function(){const z=this.getPluckedRange();if(z!==null){const q=S.A.getStaffIdx(z),mt=S.A.getPluckedRangeUuid(z),Pt=S.A.getType(z),Mt=S.A.getPlacement(z);this.noteData.pluckedRange={staffIdx:q,uuid:mt,type:Pt,placement:Mt}}},et.getPluckedRange=function(){return typeof this.pluckedRange=="undefined"&&this.initPluckedRange(),this.pluckedRange},et.initPluckedRange=function(){const z=o.default.getStaffIdx(this.baseNote),q=this.measureData.getMeasure(),mt=Dt(q,z);if(mt===null&&!T.default.hasPluckedRanges(q,z))this.pluckedRange=null;else{const Pt=this.getTimePos(),Mt=T.default.getPluckedRanges(q,z);this.pluckedRange=(0,i.A)(mt,Mt,Pt,!0)}};const Dt=function(z,q){return T.default.hasLeftPluckedRange(z,q)?T.default.getLeftPluckedRange(z,q):null};et.extractTempoChange=function(){const z=this.getTempoChange();if(z!==null){const q=U.A.getType(z);this.noteData.tempoChange={type:q}}},et.getTempoChange=function(){return typeof this.tempoChange=="undefined"&&this.initTempoChange(),this.tempoChange},et.initTempoChange=function(){const z=this.scoreData.getCommonContent(),q=this.location.measureIdx,mt=Wt(z,q);if(mt===null&&!z.hasTempoChanges(q))this.tempoChange=null;else{const Pt=this.getTimePos(),Mt=this.measureData.getDpqValue(),Bt=z.getTempoChanges(q);this.tempoChange=(0,d.A)(mt,Bt,Pt,Mt)}};const Wt=function(z,q){return z.hasLeftTempoChange(q)?z.getLeftTempoChange(q):null};et.getTimePos=function(){if(this.timePos===null){const z=this.measureData.getVoice(this.location.voiceIdx);this.timePos=z.getRangeSpace(0,this.location.noteIdx)}return this.timePos};const wt=j},566519:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(c){const d=`There is no word at the index [${c}].`;super(d),Object.defineProperty(this,"wordIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadWordIdxError",this.wordIdx=c}}},570345:(O,A,t)=>{t.d(A,{A:()=>P});var f=t(195446),e=t(21738),s=t(131220),c=t(409200),d=t(290087),i=t(476943),a=t(123491),o=t(351277),r=t(721247),n=t(377180);const u=function(T,_){return(0,e.default)(T,_),(0,s.default)(T,_),(0,c.default)(T,_),new l(T,_).get()},l=function(T,_){this.init(T,_)},h=l.prototype;h.init=function(T,_){this.scoreData=T,this.location=_,this.pitch=null,this.done=!1,this.noteIdx=null},h.get=function(){if(this.scoreData.checkPartIdx(this.location.partIdx),this.scoreData.checkMeasureIdx(this.location.measureIdx),this.measureData=(0,d.A)(this.scoreData,this.location.partIdx,this.location.measureIdx),this.initialMeasureData=this.measureData,this.noteIdx=this.location.noteIdx,this.measureData.isUnpitched())throw new f.default;this.measureData.checkVoiceIdx(this.location.voiceIdx),this.getVoice().checkNoteIdx(this.location.noteIdx),this.seekRoot(),this.pitch===null&&this.getClefPitch();const _=o.default.getStep(this.pitch),g=o.default.getOctave(this.pitch);return{step:_,octave:g}},h.seekRoot=function(){for(this.moveToPreviousNote();!this.done;){const T=this.getVoice();if(!T.isRest(this.noteIdx)){let _=T.getChord(this.noteIdx);_=i.default.makeArray(_);const g=_.reduce(I);let E=a.default.getPitch(g);E=this.transposeIfNeeded(E),this.pitch=o.default.copy(E),this.done=!0}this.moveToPreviousNote()}},h.transposeIfNeeded=function(T){if(!this.location.isConcertPitch)return T;const _=this.measureData.getTranspose(0);return n.default.isIdentity(_)||(T=o.default.transpose(T,_,!0)),T};const I=function(T,_){const g=a.default.getPitch(T),E=a.default.getPitch(_);return o.default.naiveComparePitch(g,E)>0?_:T};h.moveToPreviousNote=function(){this.noteIdx>0?this.noteIdx--:this.moveToPreviousMeasure()},h.moveToPreviousMeasure=function(){do if(this.measureData.hasPreviousMeasure())this.measureData=this.measureData.getPreviousMeasure();else{this.done=!0;return}while(!this.measureData.hasVoice(this.location.voiceIdx));const T=this.getVoice();this.noteIdx=T.getNbNotes()-1},h.getVoice=function(){return this.measureData.getVoice(this.location.voiceIdx)},h.getClefPitch=function(){const T=this.scoreData.getPartVoiceMainStaffIdx(this.location.partIdx,this.location.voiceIdx),_=this.initialMeasureData.getClef(T),g=r.default.getStep(_),E=r.default.getOctave(_);this.pitch=o.default.create(E,g)};const P=u},575914:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(442805),e=t(883782),s=t(701387),c=t(614653),d=t(21738),i=t(131220),a=t(409200),o=t(507004),r=t(189247);function n(I,P){if((0,d.default)(I,P),(0,i.default)(I,P),(0,a.default)(I,P),I.checkPartIdx(P.partIdx),I.checkMeasureIdx(P.measureIdx),!I.hasPartVoiceIdx(P.partIdx,P.voiceIdx))throw new e.default(P.voiceIdx);const T=I.getMeasure(P.partIdx,P.measureIdx),g=s.default.getClassicHarmonies(T).find(u,P);if(!g)throw new f.A(P.harmonyUuid);const E=s.default.getDpq(T),D=c.default.getTimePos(g),M=c.default.getFunction(g),p=c.default.getAlter(g),m=c.default.getKindValue(g),v=c.default.getInversion(g),U={partIdx:P.partIdx,measureIdx:P.measureIdx,dpq:E,timePos:D,chordFunction:M,alter:p,kind:m,inversion:v};c.default.hasSecondaryFunction(g)&&(U.secondaryFunction=c.default.getSecondaryFunction(g),U.secondaryAlter=c.default.getSecondaryAlter(g),U.secondaryKind=c.default.getSecondaryKind(g),U.secondaryInversion=c.default.getSecondaryInversion(g));const x=l(I,P,U);return Object.assign(U,x),h(U,I),U}function u(I){return c.default.getHarmonyUuid(I)===this.harmonyUuid}function l(I,P,T){const _=I.getPartVoiceMainStaffIdx(P.partIdx,P.voiceIdx),g={searchedVoiceIdx:P.voiceIdx,staffVoicesIndexes:I.getPartStaffVoicesIndexes(P.partIdx,_),measureIdx:P.measureIdx,timePos:T.timePos,dpq:T.dpq},E=I.getPartMeasures(P.partIdx),D=new r.A(E,P.partIdx,I);return(0,o.A)(D,g)}function h(I,P){I.measureUuid=P.getMeasureUuid(I.measureIdx),I.voiceUuid=P.getPartVoiceUuid(I.partIdx,I.voiceIdx),I.partUuid=P.getPartUuid(I.partIdx)}},576106:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(701387),e=t(496819),s=t(477849);const c=function(r,n){n.sound=d(r),n.style=e.A.getStyle(r),n.placement=e.A.getPlacement(r)},d=function(r){return e.A.hasSound(r)?e.A.getSound(r):null},i={getEntities:f.default.getDynamics,fillEntity:c},o=function(r,n){return new s.A(r,n,i).get()}},576910:(O,A,t)=>{t.d(A,{A:()=>T});var f=t(432712),e=t(364842),s=t(819795);class c{constructor(g,E){Object.defineProperty(this,"nbStaves",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"utils",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"map",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.nbStaves=g,this.utils=E,this.map=new Map}addSpecificEntry(g,E){if(this.nbStaves.checkStaffIdx(E),this.hasEntry(E)){const D="cannot add two times the same entry";throw new e.default("OperationImpossible",D)}else g!==null&&this.setSpecificEntry(g,E)}setSpecificEntry(g,E){this.nbStaves.checkStaffIdx(E),s.A.setStaffIdx(g,E),this.map.set(E,g)}removeSpecificEntry(g){this.nbStaves.checkStaffIdx(g),this.hasEntry(g)&&this.map.delete(g)}getEntry(g){return this.nbStaves.checkStaffIdx(g),this.map.get(g)||null}getAnyEntry(){return this.getEntry(0)}insertEntry(g,E){this.nbStaves.checkStaffInsertionIdx(E),this.nbStaves.increase(),this.increaseEntriesAfter(E-1),this.addSpecificEntry(g,E)}setEntry(g,E){this.nbStaves.checkStaffIdx(E),g===null?this.removeSpecificEntry(E):this.setSpecificEntry(g,E)}canHandleEntry(){return!0}removeEntry(g){this.nbStaves.checkStaffIdx(g),this.nbStaves.checkRemoveLast(),this.removeSpecificEntry(g),this.decreaseEntriesAfter(g),this.nbStaves.decrease()}dumpAttribute(){const g=[];for(let E=0;E<this.getNbStaves();E++)if(this.hasEntry(E)){const D=this.getEntry(E);g.push(D)}return g}isAllSame(){if(this.isEmpty())return!1;let g=null;for(const E of this.map.values())if(g===null)g=E;else if(!this.utils.isSame(E,g))return!1;return!0}increaseEntriesAfter(g){for(let E=this.getNbStaves()-1;E>g;E--)if(this.hasEntry(E)){const D=this.getEntry(E);this.removeSpecificEntry(E),this.addSpecificEntry(D,E+1)}}decreaseEntriesAfter(g){for(let E=g+1;E<this.getNbStaves();E++)if(this.hasEntry(E)){const D=this.getEntry(E);this.removeSpecificEntry(E),this.addSpecificEntry(D,E-1)}}hasEntry(g){return this.nbStaves.checkStaffIdx(g),this.map.has(g)}isEmpty(){return this.map.size===0}getNbStaves(){return this.nbStaves.get()}}var d=t(746641),i=t(35802),a=t(701387),o=t(721247),r=t(518558),n=t(364596),u=t(377180),l=t(104907),h=t(579102);const I=function(_){let g=a.default.getNbStaves(_);if(g=new f.A(g),a.default.hasOwnAttributes(_)){const E=a.default.getOwnAttributes(_);if(i.default.hasClef(E)){let D=i.default.getClef(E);D=P(D,g,o.default),i.default.setClef(E,D)}if(i.default.hasKey(E)){let D=i.default.getKey(E);D=P(D,g,n.default),i.default.setKey(E,D)}if(i.default.hasTime(E)){let D=i.default.getTime(E);D=P(D,g,r.default),i.default.setTime(E,D)}if(i.default.hasTranspose(E)){let D=i.default.getTranspose(E);D=P(D,g,u.default),i.default.setTranspose(E,D)}if(i.default.hasStaffDetails(E)){let D=i.default.getStaffDetails(E);D=P(D,g,l.default),i.default.setStaffDetails(E,D)}if(i.default.hasMeasureStyle(E)){let D=i.default.getMeasureStyle(E);D=P(D,g,h.A),i.default.setMeasureStyle(E,D)}a.default.setOwnAttributes(_,E)}},P=function(_,g,E){const D=new c(g,E);let M;return _.forEach(function(m){if(s.A.hasStaffIdx(m))M=s.A.getStaffIdx(m),M<g.get()&&D.setSpecificEntry(m,M);else for(M=0;M<g.get();M++){const v=E.copy(m);D.setSpecificEntry(v,M)}}),_=D.dumpAttribute(),_=new d.A(_,g.get(),E).dumpAttribute(),_},T=I},584339:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(383279);const s=function(c){c["part-abbreviation"]===null&&f.default.removeAbbreviation(c)}},584839:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(701387),e=t(345912),s=t(432149),c=t(817066),d=t(258780);const i=function(n){(0,s.A)(n).map(c.A).forEach(function(h){new a(h,n).fillOctaveShifts()})},a=function(n,u){this.init(n,u)},o=a.prototype;o.init=function(n,u){this.wrappedOctaveShifts=n,this.measures=u,this.measuresScroller=null},o.fillOctaveShifts=function(){const n=this.wrappedOctaveShifts.length;for(let u=0;u<n-1;u+=2){const l=this.wrappedOctaveShifts[u],h=this.wrappedOctaveShifts[u+1];this.fillOctaveShift(l,h)}},o.fillOctaveShift=function(n,u){const l=n.measureIdx,h=u.measureIdx;this.addContinues(l,h,n)},o.addContinues=function(n,u,l){for(let h=n;h<u;h++)this.addContinue(h,l)},o.addContinue=function(n,u){const l=e.A.getStaffIdx(u.direction),h=e.A.getPlacement(u.direction),I=e.A.getTimePos(u.direction),P=e.A.getType(u.direction),T=e.A.getSize(u.direction),_=e.A.getNumber(u.direction),g=this.measures[n],E=e.A.create(l,h,I,P,T,d.A.RIGHT,_);f.default.setRightOctaveShift(g,l,E);const D=this.measures[n+1],M=e.A.create(l,h,I,P,T,d.A.LEFT,_);f.default.setLeftOctaveShift(D,l,M)};const r=i},586745:(O,A,t)=>{t.d(A,{A:()=>p});var f=t(364842),e=t(726042);const s=function(){this.init()},c=s.prototype;c.init=function(){this.measures=[],this.scoreData=null,this.tempoChangesMap={}},c.getNbMeasures=function(){return this.measures.length},c.addMeasure=function(m,v,U){this.checkInsertionIdx(m),d(v),d(U);const x={tempo:v,swing:U,ownTempo:null,ownSwing:null,ending:null,jumpTag:null,jumpCall:null,multiMeasureRest:null,tempoChanges:[],leftTempoChange:null,rightTempoChange:null,rehearsal:null,systemBreak:null,pageBreak:null};this.measures.splice(m,0,x)};const d=function(m){if(m===null||typeof m=="undefined")throw new f.default("Invalid Value","The common content value is invalid.")};c.removeMeasure=function(m){this.checkMeasureIdx(m),this.measures.splice(m,1)},c.checkInsertionIdx=function(m){const v=this.getNbMeasures();if(!e.default.isInteger(m)||m<0||m>v){const U=`The insertion measure index [${m}] is out of bounds.`;throw new f.default("BadMeasureInsertionIdx",U)}},c.getMeasure=function(m){return this.checkMeasureIdx(m),this.measures[m]},c.checkMeasureIdx=function(m){const v=this.getNbMeasures(m);if(!e.default.isInteger(m)||m<0||m>=v){const U=`The measure index [${m}] is out of bounds.`;throw new f.default("BadMeasureIdx",U)}},c.setScoreData=function(m){this.scoreData=m},c.getScoreData=function(){return this.scoreData};const i=s,a=i.prototype;a.getTempo=function(m){return this.getMeasure(m).tempo},a.setTempo=function(m,v){const U=this.getMeasure(m);U.tempo=v},a.hasOwnTempo=function(m){return this.getMeasure(m).ownTempo!==null},a.getOwnTempo=function(m){return this.getMeasure(m).ownTempo},a.setOwnTempo=function(m,v){const U=this.getMeasure(m);U.ownTempo=v},a.removeOwnTempo=function(m){const v=this.getMeasure(m);v.ownTempo=null},a.getNextOwnTempo=function(m){this.checkMeasureIdx(m),this.hasOwnTempo(m)&&m++;const v=this.getNbMeasures();for(;m<v;m++)if(this.hasOwnTempo(m))return m;return null};const o=i.prototype;o.getSwing=function(m){return this.getMeasure(m).swing},o.setSwing=function(m,v){const U=this.getMeasure(m);U.swing=v},o.hasSwing=function(m){return this.getMeasure(m).swing!==null},o.hasOwnSwing=function(m){return this.getMeasure(m).ownSwing!==null},o.getOwnSwing=function(m){return this.getMeasure(m).ownSwing},o.setOwnSwing=function(m,v){const U=this.getMeasure(m);U.ownSwing=v},o.removeOwnSwing=function(m){const v=this.getMeasure(m);v.ownSwing=null},o.getNextOwnSwing=function(m){this.checkMeasureIdx(m),this.hasOwnSwing(m)&&m++;const v=this.getNbMeasures();for(;m<v;m++)if(this.hasOwnSwing(m))return m;return null};const r=i.prototype;r.hasEnding=function(m){return this.getMeasure(m).ending!==null},r.getEnding=function(m){return this.getMeasure(m).ending},r.setEnding=function(m,v){const U=this.getMeasure(m);U.ending=v},r.removeEnding=function(m){const v=this.getMeasure(m);v.ending=null};const n=i.prototype;n.hasDisplayedTime=function(m){return this.getMeasure(m).displayedTime!==null},n.getDisplayedTime=function(m){return this.getMeasure(m).displayedTime},n.setDisplayedTime=function(m,v){const U=this.getMeasure(m);U.displayedTime=v},n.removeDisplayedTime=function(m){const v=this.getMeasure(m);v.displayedTime=null};const u=i.prototype;u.hasJumpTag=function(m){return this.getMeasure(m).jumpTag!==null},u.setJumpTag=function(m,v){const U=this.getMeasure(m);U.jumpTag=v},u.getJumpTag=function(m){return this.getMeasure(m).jumpTag},u.removeJumpTag=function(m){const v=this.getMeasure(m);v.jumpTag=null};const l=i.prototype;l.hasJumpCall=function(m){return this.getMeasure(m).jumpCall!==null},l.setJumpCall=function(m,v){const U=this.getMeasure(m);U.jumpCall=v},l.getJumpCall=function(m){return this.getMeasure(m).jumpCall},l.removeJumpCall=function(m){const v=this.getMeasure(m);v.jumpCall=null};const h=i.prototype;h.hasPageBreak=function(m){return this.getMeasure(m).pageBreak!==null},h.setPageBreak=function(m,v){const U=this.getMeasure(m);U.pageBreak=v},h.getPageBreak=function(m){return this.getMeasure(m).pageBreak},h.removePageBreak=function(m){const v=this.getMeasure(m);v.pageBreak=null};var I=t(346797);const P=i.prototype;P.tempoChangesMap={},P.hasTempoChanges=function(m){return this.getMeasure(m).tempoChanges.length>0},P.setTempoChanges=function(m,v){const U=this.getMeasure(m);U.tempoChanges=v},P.addTempoChange=function(m,v){this.getTempoChanges(m).push(v)},P.removeTempoChange=function(m,v){const U=this.getTempoChanges(m),x=U.findIndex(function(S){return I.A.isSame(S,v)});x!==-1&&U.splice(x,1)},P.getTempoChanges=function(m){return this.getMeasure(m).tempoChanges},P.getLeftTempoChange=function(m){return this.getMeasure(m).leftTempoChange},P.hasLeftTempoChange=function(m){return this.getMeasure(m).leftTempoChange!==null},P.setLeftTempoChange=function(m,v){const U=this.getMeasure(m);U.leftTempoChange=v},P.removeLeftTempoChange=function(m){const v=this.getMeasure(m);v.leftTempoChange=null},P.getRightTempoChange=function(m){return this.getMeasure(m).rightTempoChange},P.hasRightTempoChange=function(m){return this.getMeasure(m).rightTempoChange!==null},P.setRightTempoChange=function(m,v){const U=this.getMeasure(m);U.rightTempoChange=v},P.removeRightTempoChange=function(m){const v=this.getMeasure(m);v.rightTempoChange=null},P.hasTempoChangeUuid=function(m){return typeof this.tempoChangesMap[m]!="undefined"},P.setTempoChangeAtUuid=function(m){this.tempoChangesMap[m.tempoChangeUuid]=m},P.removeTempoChangeAtUuid=function(m){delete this.tempoChangesMap[m]},P.getTempoChangeAtUuid=function(m){return this.tempoChangesMap[m]};var T=t(561248);const _=i.prototype;_.hasRehearsalAuto=function(m){if(!this.hasRehearsal(m))return!1;const v=this.getRehearsal(m);return!!T.A.isAuto(v)},_.hasRehearsal=function(m){return this.getMeasure(m).rehearsal!==null},_.getRehearsal=function(m){return this.getMeasure(m).rehearsal},_.setRehearsal=function(m,v){const U=this.getMeasure(m);U.rehearsal=v},_.removeRehearsal=function(m){const v=this.getMeasure(m);v.rehearsal=null};const g=i.prototype;g.hasSystemBreak=function(m){return this.getMeasure(m).systemBreak!==null},g.setSystemBreak=function(m,v){const U=this.getMeasure(m);U.systemBreak=v},g.getSystemBreak=function(m){return this.getMeasure(m).systemBreak},g.removeSystemBreak=function(m){const v=this.getMeasure(m);v.systemBreak=null};const E=i.prototype;E.getBeatsList=function(m){return this.getMeasure(m).beatsList},E.setBeatsList=function(m,v){const U=this.getMeasure(m);U.beatsList=v};const D=i.prototype;D.hasRestsInsideBeams=function(m){return!!this.getMeasure(m).restsInsideBeams},D.setRestsInsideBeams=function(m,v){const U=this.getMeasure(m);U.restsInsideBeams=v};const M=i.prototype;M.hasMultiMeasureRest=function(m){return this.getMeasure(m).multiMeasureRest!==null},M.getMultiMeasureRest=function(m){return this.getMeasure(m).multiMeasureRest},M.setMultiMeasureRest=function(m,v){const U=this.getMeasure(m);U.multiMeasureRest=v},M.removeMultiMeasureRest=function(m){const v=this.getMeasure(m);v.multiMeasureRest=null};const p=i},588335:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(614653),s=t(309357);const c=function(o){let r=f.default.getRawHarmonies(o);r=r.filter(e.default.isSupported);const n=f.default.getImportMapping(o);r=r.filter(d,n),r.forEach(i,n),f.default.setRawHarmonies(o,r)},d=function(o){const r=this,u=e.default.getNoteBefore(o)+1;return typeof r[u]!="undefined"||typeof r[u-1]!="undefined"},i=function(o){const r=this;(0,s.A)(o,r,e.default)},a=c},589405:(O,A,t)=>{t.d(A,{A:()=>te});var f=t(857552),e=t(443749),s=t(92078),c=t(607682);function d(b){return`The range of ${b} is not contiguous.`}class i extends c.default{constructor(rt){const Et=d(rt);super(Et),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="NonContiguousError",this.type=rt}}Object.defineProperty(i,"STAFF",{enumerable:!0,configurable:!0,writable:!0,value:"staff"}),Object.defineProperty(i,"PART",{enumerable:!0,configurable:!0,writable:!0,value:"part"});const a=i;var o=t(364842),r=t(891921),n=t(125911),u=t(726042),l=t(123491);const h=function(b,rt,Et,At){return b.getMeasureData(Et.measureIdx).hasVoice(rt)?I(b,rt,Et):T(b,rt,Et,At)},I=function(b,rt,Et,At){const Ct=b.getMeasureData(Et.measureIdx),Rt=Ct.getVoice(rt),Kt=Ct.getDpqValue(),jt=Et.dpq,ct=u.default.lcm(jt,Kt),ft=ct/Kt,_t=Et.timePos*ct/jt;let Dt=(0,r.A)(Rt,ft,_t);(0,n.A)(Rt,ft,_t)||Dt++;const Wt=Rt.getNbNotes();if(Dt>=Wt)return T(b,rt,Et,At);Dt=P(Rt,Dt);const wt=Rt.getRangeSpace(0,Dt);return{measureIdx:Et.measureIdx,noteIdx:Dt,timePos:wt,dpq:Kt}},P=function(b,rt){let Et=b.getNote(rt);if(!l.default.hasNormalTimeModif(Et))for(;!l.default.hasTupletStart(Et);)rt--,Et=b.getNote(rt);return rt},T=function(b,rt,Et,At){let Ct=Et.measureIdx+1;const Rt=b.getNbMeasures();for(;Ct<Rt;){if(At!==null&&Ct>At)return null;if(b.getMeasureData(Ct).hasVoice(rt))return{measureIdx:Ct,noteIdx:0,timePos:0,dpq:1};Ct++}return null},_=h;var g=t(701387);const E=function(b,rt,Et,At){return b.getMeasureData(Et.measureIdx).hasVoice(rt)?D(b,rt,Et):m(b,rt,Et,At)},D=function(b,rt,Et){const At=b.getMeasureData(Et.measureIdx),Ct=At.getVoice(rt);let Rt;if(M(At,Et)){const z=Ct.getNbNotes();return Rt={measureIdx:Et.measureIdx,noteIdx:z-1,timePos:Et.timePos,dpq:Et.dpq},Rt}const Kt=At.getDpqValue(),jt=Et.dpq,ct=u.default.lcm(Kt,jt),ft=ct/Kt,_t=Et.timePos*ct/jt;let Dt=(0,r.A)(Ct,ft,_t);(0,n.A)(Ct,ft,_t)||Dt++,Dt--,Dt=p(Ct,Dt);let Wt=Ct.getRangeSpace(0,Dt);const wt=Ct.getNote(Dt);return Wt+=l.default.getDuration(wt),Rt={measureIdx:Et.measureIdx,noteIdx:Dt,timePos:Wt,dpq:Kt},Rt},M=function(b,rt){const Et=b.getDpqValue(),At=b.getMeasure();let Ct=g.default.getNbDivisions(At);const Rt=rt.dpq,Kt=u.default.lcm(Rt,Et),jt=rt.timePos*Kt/Rt;return Ct*=Kt/Et,jt===Ct},p=function(b,rt){let Et=b.getNote(rt);if(!l.default.hasNormalTimeModif(Et))for(;!l.default.hasTupletStop(Et);)rt++,Et=b.getNote(rt);return rt},m=function(b,rt,Et,At){let Ct=Et.measureIdx-1;for(;Ct>=0;){if(At!==null&&Ct<At)return null;const Rt=b.getMeasureData(Ct);if(Rt.hasVoice(rt)){const jt=Rt.getVoice(rt).getNbNotes(),ct=Rt.getDpqValue(),ft=Rt.getMeasure(),_t=g.default.getNbDivisions(ft);return{measureIdx:Ct,noteIdx:jt-1,timePos:_t,dpq:ct}}Ct--}return null},v=E;var U=t(985046),x=t(576106),S=t(297115),K=t(536949),H=t(477849);const Y=function(b,rt){rt.type=K.A.getType(b),rt.placement=K.A.getPlacement(b)},C={getEntities:g.default.getPizzicatos,fillEntity:Y},F=function(b,rt){return new H.A(b,rt,C).get()};var N=t(447819);const G=function(b,rt){rt.type=N.A.getType(b),rt.placement=N.A.getPlacement(b)},nt={getEntities:g.default.getMutes,fillEntity:G},V=function(b,rt){return new H.A(b,rt,nt).get()};var W=t(694219),Z=t(984223),dt=t(368495),at=t(963062);const B=function(b,rt){rt.placement=dt.A.getPlacement(b),rt.type=dt.A.getType(b)},gt=function(b){const rt=this.getMeasure(b);return g.default.getPluckedRanges(rt,this.location.staffIdx)},lt=function(b,rt){return this.getMeasureDpq(rt)},X={getEntities:gt,isStart:dt.A.isStart,isStop:dt.A.isStop,fillEntity:B,getDpq:lt},L=function(b,rt){return new at.A(b,rt,X).get()};var $=t(44703),ut=t(666506),w=t(614653);const st=function(b,rt){rt.chordFunction=w.default.getFunction(b),rt.kind=w.default.getKindValue(b),rt.inversion=w.default.getInversion(b),w.default.hasSecondaryFunction(b)&&(rt.secondaryFunction=w.default.getSecondaryFunction(b),rt.secondaryKind=w.default.getSecondaryKind(b),rt.secondaryInversion=w.default.getSecondaryInversion(b))},tt={getEntities:g.default.getClassicHarmonies,fillEntity:st},It=function(b,rt){return new H.A(b,rt,tt).get()};var xt=t(539203),Ot=t(903302),St=t(275408),Nt=t(21738),j=t(665280),ot=t(843678),et=t(919973),Tt=t(377180);const Lt=function(b,rt){return(0,Ot.A)(b,rt),(0,St.A)(b,rt),rt.content.forEach(Vt,b),new bt(b,rt).get()},Vt=function(b){const rt=this;(0,Nt.default)(rt,b),(0,j.default)(rt,b)},bt=function(b,rt){this.init(b,rt)},Ut=bt.prototype;Ut.init=function(b,rt){this.scoreData=b,this.location=rt,this.startTimePos=null,this.startDpq=null,this.stopTimePos=null,this.stopDpq=null,this.firstLocation=null,this.measuresScrollersByPart={}},Ut.get=function(){return this.check(),this.createVoices(),this.fillVoicesBoundaries(),this.removeEmptyVoices(),this.extractFirstLocation(),this.fillVoicesTimePosShift(),this.fillVoicesData(),this.computeStaffOffset(),this.fillStavesData(),this.fillPartsData(),this.generateData()},Ut.check=function(){this.convertStartLocation(),this.convertStopLocation(),this.checkLocation(),this.checkContiguous(),this.checkRevertRange()},Ut.convertStartLocation=function(){this.scoreData.checkPartIdx(this.location.startPartIdx),this.scoreData.checkMeasureIdx(this.location.startMeasureIdx);const b=this.getMeasureData(this.location.startPartIdx,this.location.startMeasureIdx);b.checkVoiceIdx(this.location.startVoiceIdx);const rt=b.getDpqValue(),Et=b.getVoice(this.location.startVoiceIdx);Et.checkNoteIdx(this.location.startNoteIdx);const At=Et.getRangeSpace(0,this.location.startNoteIdx);this.startTimePos=At,this.startDpq=rt},Ut.convertStopLocation=function(){this.scoreData.checkPartIdx(this.location.stopPartIdx),this.scoreData.checkMeasureIdx(this.location.stopMeasureIdx);const b=this.getMeasureData(this.location.stopPartIdx,this.location.stopMeasureIdx);b.checkVoiceIdx(this.location.stopVoiceIdx);const rt=b.getDpqValue(),Et=b.getVoice(this.location.stopVoiceIdx);Et.checkNoteIdx(this.location.stopNoteIdx);let At=Et.getRangeSpace(0,this.location.stopNoteIdx);const Ct=Et.getNote(this.location.stopNoteIdx);At+=l.default.getDuration(Ct),this.stopTimePos=At,this.stopDpq=rt},Ut.checkLocation=function(){const b={};this.location.content.forEach(function(rt){this.scoreData.checkPartIdx(rt.partIdx),typeof b[rt.partIdx]=="undefined"&&(b[rt.partIdx]={});const Et=this.scoreData.getMeasure(rt.partIdx,0),At=g.default.getNbStaves(Et);if(Xt(rt.staffIdx,At),typeof b[rt.partIdx][rt.staffIdx]=="undefined")b[rt.partIdx][rt.staffIdx]=!0;else throw new s.A(s.A.STAFF,rt.staffIdx)},this)};const Xt=function(b,rt){if(!u.default.isInteger(b)||b<0||b>=rt)throw new e.default(b)};Ut.checkRevertRange=function(){const b=this.location.startMeasureIdx,rt=this.location.stopMeasureIdx,Et=rt-b;if(Et<0)throw new f.default(f.default.MEASURE,b,rt);if(Et===0){const At=u.default.lcm(this.startDpq,this.stopDpq),Ct=this.startTimePos*At/this.startDpq,Rt=this.stopTimePos*At/this.stopDpq;if(Ct>=Rt)throw new f.default(f.default.TIME_POS,Ct,Rt)}},Ut.checkContiguous=function(){this.location.content.sort(Jt);const b=this.location.content.length;for(let rt=0;rt<b-1;rt++){const Et=this.location.content[rt],At=this.location.content[rt+1];if(At.partIdx-Et.partIdx>1)throw new a(a.PART);if(At.partIdx===Et.partIdx){if(At.staffIdx-Et.staffIdx>1)throw new a(a.STAFF)}else if(At.partIdx-Et.partIdx===1){const Ct=this.scoreData.getPartNbStaves(Et.partIdx);if(Et.staffIdx!==Ct-1||At.staffIdx!==0)throw new a(a.STAFF)}else throw new o.default("Unexpected")}};const Jt=function(b,rt){return b.partIdx!==rt.partIdx?b.partIdx-rt.partIdx:b.staffIdx!==rt.staffIdx?b.staffIdx-rt.staffIdx:0};Ut.createVoices=function(){this.voices=[],this.staves=[],this.parts={},this.location.content.forEach(this.createStaffVoices,this),this.parts=ot.default.getValues(this.parts)},Ut.createStaffVoices=function(b){this.partIdx=b.partIdx;const rt={partIdx:this.partIdx,staffIdx:b.staffIdx};if(b.staffIdx===0&&typeof this.parts[this.partIdx]=="undefined"){const At={partIdx:this.partIdx};this.parts[this.partIdx]=At}this.staves.push(rt),this.scoreData.getPartStaffVoicesIndexes(this.partIdx,b.staffIdx).forEach(this.createVoice,this)},Ut.createVoice=function(b){const rt=this.partIdx,Et=this.scoreData.getPartVoiceMainStaffIdx(rt,b),At=this.scoreData.voiceIdxToIdxInMainStaff(rt,b),Ct={partIdx:rt,staffIdx:Et,idxInStaff:At,voiceIdx:b};this.voices.push(Ct)},Ut.fillVoicesBoundaries=function(){this.voices.forEach(this.fillVoiceBoundaries,this)},Ut.fillVoiceBoundaries=function(b){this.fillLeftBoundary(b),!b.isEmpty&&this.fillRightBoundary(b)},Ut.fillLeftBoundary=function(b){const rt=this.getMeasuresScroller(b.partIdx),Et={measureIdx:this.location.startMeasureIdx,timePos:this.startTimePos,dpq:this.startDpq},At=_(rt,b.voiceIdx,Et,this.location.stopMeasureIdx);At!==null?(b.startMeasureIdx=At.measureIdx,b.startNoteIdx=At.noteIdx,b.startTimePos=At.timePos,b.startDpq=At.dpq):b.isEmpty=!0},Ut.fillRightBoundary=function(b){const rt=this.getMeasuresScroller(b.partIdx),Et={measureIdx:this.location.stopMeasureIdx,timePos:this.stopTimePos,dpq:this.stopDpq},At=v(rt,b.voiceIdx,Et,this.location.startMeasureIdx);if(At!==null)b.stopMeasureIdx=At.measureIdx,b.stopNoteIdx=At.noteIdx,b.stopTimePos=At.timePos,b.stopDpq=At.dpq;else{b.isEmpty=!0;return}b.startMeasureIdx===b.stopMeasureIdx&&b.stopNoteIdx<b.startNoteIdx&&(b.isEmpty=!0),b.stopMeasureIdx<b.startMeasureIdx&&(b.isEmpty=!0)},Ut.removeEmptyVoices=function(){this.voices=this.voices.filter(Zt)};const Zt=function(b){return!b.isEmpty};Ut.extractFirstLocation=function(){const b=this.voices.reduce(kt);this.firstLocation={measureIdx:b.startMeasureIdx,timePos:b.startTimePos,dpq:b.startDpq}};const kt=function(b,rt){if(b.startMeasureIdx<rt.startMeasureIdx)return b;if(b.startMeasureIdx>rt.startMeasureIdx)return rt;const Et=u.default.lcm(b.startDpq,rt.startDpq),At=b.startTimePos*Et/b.startDpq,Ct=rt.startTimePos*Et/rt.startDpq;return At<Ct?b:rt};Ut.fillVoicesTimePosShift=function(){this.voices.forEach(this.fillVoiceTimePosShift,this)},Ut.fillVoiceTimePosShift=function(b){let rt=et.A.create(0,1),Et=this.firstLocation.measureIdx;for(;Et<=b.startMeasureIdx;){const At=this.scoreData.getMeasure(b.partIdx,Et),Ct=g.default.getDpq(At),Rt=g.default.getNbDivisions(At),Kt=et.A.create(Rt,Ct);if(rt=et.A.add(rt,Kt),Et===this.firstLocation.measureIdx){const jt=et.A.create(this.firstLocation.timePos,this.firstLocation.dpq);rt=et.A.sub(rt,jt)}if(Et===b.startMeasureIdx){const jt=et.A.create(b.startTimePos,b.startDpq),ct=et.A.sub(Kt,jt);rt=et.A.sub(rt,ct)}Et++}b.timePosShift=et.A.getNumerator(rt),b.dpq=et.A.getDenominator(rt)},Ut.fillVoicesData=function(){this.voices.forEach(this.fillVoiceData,this)},Ut.fillVoiceData=function(b){const rt={partIdx:b.partIdx,voiceIdx:b.voiceIdx,startMeasureIdx:b.startMeasureIdx,startNoteIdx:b.startNoteIdx,stopMeasureIdx:b.stopMeasureIdx,stopNoteIdx:b.stopNoteIdx},Et=(0,U.A)(this.scoreData,rt,this.measuresScroller);b.data=Et},Ut.computeStaffOffset=function(){const b={startTimePos:this.startTimePos,startDpq:this.startDpq,startMeasureIdx:this.location.startMeasureIdx,partIdx:0};this.fillVoiceTimePosShift(b),this.staffTimePosShift=b.timePosShift,this.staffDpq=b.dpq},Ut.fillStavesData=function(){this.staves.length>0&&this.staves.forEach(this.fillStaffData,this)},Ut.fillStaffData=function(b){b.timePosShift=this.staffTimePosShift,b.dpq=this.staffDpq,b.data={},this.fillDynamics(b),this.fillWords(b),this.fillPizzicatos(b),this.fillMutes(b),this.fillOctaveShifts(b),this.fillPedals(b),this.fillWedges(b),this.fillPluckedRanges(b)},Ut.fillDynamics=function(b){const rt={partIdx:b.partIdx,staffIdx:b.staffIdx,startMeasureIdx:this.location.startMeasureIdx,startTimePos:this.startTimePos,startDpq:this.startDpq,stopMeasureIdx:this.location.stopMeasureIdx,stopTimePos:this.stopTimePos,stopDpq:this.stopDpq};b.data.dynamics=(0,x.A)(this.scoreData,rt)},Ut.fillWords=function(b){const rt={partIdx:b.partIdx,staffIdx:b.staffIdx,startMeasureIdx:this.location.startMeasureIdx,startTimePos:this.startTimePos,startDpq:this.startDpq,stopMeasureIdx:this.location.stopMeasureIdx,stopTimePos:this.stopTimePos,stopDpq:this.stopDpq};b.data.words=(0,S.A)(this.scoreData,rt)},Ut.fillPizzicatos=function(b){const rt={partIdx:b.partIdx,staffIdx:b.staffIdx,startMeasureIdx:this.location.startMeasureIdx,startTimePos:this.startTimePos,startDpq:this.startDpq,stopMeasureIdx:this.location.stopMeasureIdx,stopTimePos:this.stopTimePos,stopDpq:this.stopDpq};b.data.pizzicatos=F(this.scoreData,rt)},Ut.fillMutes=function(b){const rt={partIdx:b.partIdx,staffIdx:b.staffIdx,startMeasureIdx:this.location.startMeasureIdx,startTimePos:this.startTimePos,startDpq:this.startDpq,stopMeasureIdx:this.location.stopMeasureIdx,stopTimePos:this.stopTimePos,stopDpq:this.stopDpq};b.data.mutes=V(this.scoreData,rt)},Ut.fillOctaveShifts=function(b){const rt={partIdx:b.partIdx,staffIdx:b.staffIdx,startMeasureIdx:this.location.startMeasureIdx,startTimePos:this.startTimePos,startDpq:this.startDpq,stopMeasureIdx:this.location.stopMeasureIdx,stopTimePos:this.stopTimePos,stopDpq:this.stopDpq};b.data.octaveShifts=(0,W.A)(this.scoreData,rt)},Ut.fillPedals=function(b){const rt={partIdx:b.partIdx,staffIdx:b.staffIdx,startMeasureIdx:this.location.startMeasureIdx,startTimePos:this.startTimePos,startDpq:this.startDpq,stopMeasureIdx:this.location.stopMeasureIdx,stopTimePos:this.stopTimePos,stopDpq:this.stopDpq};b.data.pedals=(0,Z.A)(this.scoreData,rt)},Ut.fillPluckedRanges=function(b){const rt={partIdx:b.partIdx,staffIdx:b.staffIdx,startMeasureIdx:this.location.startMeasureIdx,startTimePos:this.startTimePos,startDpq:this.startDpq,stopMeasureIdx:this.location.stopMeasureIdx,stopTimePos:this.stopTimePos,stopDpq:this.stopDpq};b.data.pluckedRanges=L(this.scoreData,rt)},Ut.fillWedges=function(b){const rt={partIdx:b.partIdx,staffIdx:b.staffIdx,startMeasureIdx:this.location.startMeasureIdx,startTimePos:this.startTimePos,startDpq:this.startDpq,stopMeasureIdx:this.location.stopMeasureIdx,stopTimePos:this.stopTimePos,stopDpq:this.stopDpq};b.data.wedges=(0,$.A)(this.scoreData,rt)},Ut.fillPartsData=function(){this.parts.length>0&&this.parts.forEach(this.fillPartData,this)},Ut.fillPartData=function(b){if(b.timePosShift=this.staffTimePosShift,b.dpq=this.staffDpq,b.data={},this.scoreData.isPartUnpitched(b.partIdx))b.data.isUnpitched=!0;else{b.data.isUnpitched=!1;const Et=this.scoreData.getMeasure(b.partIdx,0);let Ct=g.default.getWrappedTranspose(Et).getEntry(0);Ct=Tt.default.copy(Ct),b.data.attributes={transpose:Ct}}this.fillJazzHarmonies(b),this.fillClassicHarmonies(b)},Ut.fillJazzHarmonies=function(b){const rt={partIdx:b.partIdx,startMeasureIdx:this.location.startMeasureIdx,startTimePos:this.startTimePos,startDpq:this.startDpq,stopMeasureIdx:this.location.stopMeasureIdx,stopTimePos:this.stopTimePos,stopDpq:this.stopDpq};b.data.jazzHarmonies=(0,ut.A)(this.scoreData,rt)},Ut.fillClassicHarmonies=function(b){const rt={partIdx:b.partIdx,startMeasureIdx:this.location.startMeasureIdx,startTimePos:this.startTimePos,startDpq:this.startDpq,stopMeasureIdx:this.location.stopMeasureIdx,stopTimePos:this.stopTimePos,stopDpq:this.stopDpq};b.data.classicHarmonies=It(this.scoreData,rt)},Ut.generateData=function(){return{voices:this.voices.map(this.filterVoice,this),staves:this.staves.map(this.filterStaff,this),parts:this.parts.map(this.filterPart,this)}},Ut.filterVoice=function(b){const rt=this.location.content[0].partIdx,Et=b.partIdx-rt;let At=b.staffIdx;if(Et===0){const Rt=this.location.content[0].staffIdx;At-=Rt}return{partIdx:Et,staffIdx:At,idxInStaff:b.idxInStaff,timePosShift:b.timePosShift,dpq:b.dpq,data:b.data}},Ut.filterStaff=function(b){const rt=this.location.content[0].partIdx,Et=b.partIdx-rt;let At=b.staffIdx;if(Et===0){const Rt=this.location.content[0].staffIdx;At-=Rt}return{partIdx:Et,staffIdx:At,timePosShift:b.timePosShift,dpq:b.dpq,data:b.data}},Ut.filterPart=function(b){const rt=this.location.content[0].partIdx;return{partIdx:b.partIdx-rt,timePosShift:b.timePosShift,dpq:b.dpq,data:b.data}},Ut.getMeasureData=function(b,rt){return this.getMeasuresScroller(b).getMeasureData(rt)},Ut.getMeasuresScroller=function(b){return typeof this.measuresScrollersByPart[b]=="undefined"&&(this.measuresScrollersByPart[b]=(0,xt.A)(this.scoreData,{partIdx:b})),this.measuresScrollersByPart[b]};const te=Lt},590794:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(537546),e=t(210888),s=t(383279);const c=function(o){const r=s.default.getStaffMapping(o),n={};r.forEach(d,n)},d=function(o){const r=this;i(o,r)&&(o.staffUuid=e.default.generate()),r[o.staffUuid]=!0},i=function(o,r){return!f.default.isValid(o.staffUuid)||typeof r[o.staffUuid]!="undefined"},a=c},593282:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(123491),s=t(712947);function c(r){let n=f.default.getNotes(r);n=n.filter(d),new i(n).process()}function d(r){return!e.default.isChord(r)}class i{constructor(n){this.notes=n,this.voicesMap=new Map}process(){this.notes.forEach(this.processNote,this)}processNote(n){const u=e.default.getVoiceIdx(n);this.getVoice(u).processNote(n)}getVoice(n){let u;return this.voicesMap.has(n)?u=this.voicesMap.get(n):(u=new o,this.voicesMap.set(n,u)),u}}const a={NOTE:"note",GRACE:"grace"};class o{constructor(){this.state=null,this.firstGrace=null}processNote(n){e.default.isGraceNote(n)?this.addGrace(n):e.default.isRest(n)?this.addRest(n):this.addNote(n)}addGrace(n){this.state!==a.GRACE&&(this.firstGrace=n),this.state=a.GRACE}addNote(n){this.state===a.GRACE&&this.processCouple(this.firstGrace,n),this.firstGrace=null,this.state=a.NOTE}addRest(){this.firstGrace=null,this.state=null}processCouple(n,u){let l=e.default.getSlurs(n),h=e.default.getSlurs(u);const I=new Set(l.filter(s.default.isStart).map(s.default.getLevel)),P=h.filter(s.default.isStop).map(s.default.getLevel).find(T=>I.has(T));typeof P!="undefined"&&(e.default.setGraceSlur(u,!0),l=l.filter(T=>s.default.getLevel(T)!==P),e.default.setSlurs(n,l),h=h.filter(T=>s.default.getLevel(T)!==P),e.default.setSlurs(u,h))}}},595794:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(788220),e=t(701387);function s(c){const d=e.default.getNbDivisions(c),i=e.default.getNbStaves(c);for(let a=0;a<i;a++){let o=e.default.getWords(c,a);o=o.filter(r=>f.A.getTimePos(r)<d),e.default.setWords(c,a,o)}}},596380:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(614653);const s=function(i){const a=f.default.getNbDivisions(i);let o=f.default.getJazzHarmonies(i);o=o.filter(c,a),f.default.setJazzHarmonies(i,o);let r=f.default.getClassicHarmonies(i);r=r.filter(c,a),f.default.setClassicHarmonies(i,r)},c=function(i){const a=this.valueOf(),o=e.default.getTimePos(i);return o<0?!1:!(o>=a)},d=s},597032:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(701387),e=t(35802),s=t(721247);const c="percussion",d=function(r){f.default.getAllRawAttributes(r).forEach(i)},i=function(r){e.default.getClef(r).forEach(a)},a=function(r){s.default.getSign(r).toLowerCase()===c&&s.default.setSign(r,c)},o=d},601202:(O,A,t)=>{t.d(A,{A:()=>u});var f=t(381216),e=t(359363),s=t(74957),c=t(464173),d=t(533343);const i=[{suspension:d.A.SUS_24,degrees:[{number:2,present:!0},{number:4,present:!0},{number:3,present:!1}]},{suspension:d.A.SUS_2,degrees:[{number:2,present:!0},{number:3,present:!1}]},{suspension:d.A.SUS_4,degrees:[{number:4,present:!0},{number:3,present:!1}]}];function a(l,h){return l.present?h.some(I=>s.A.getValue(I)===l.number&&s.A.getAlter(I)===0):h.every(I=>s.A.getValue(I)!==l.number)}function o(l,h){return h.degrees.every(I=>a(I,l))}function r(l){return[c.A.SUS_2,c.A.SUS_4,c.A.SUS_24].includes(l)?c.A.MAJOR:l}function n(l){return l=l.filter(h=>s.A.getAlter(h)!==0||![2,4].includes(s.A.getValue(h))),l.push(s.A.create(3,f.A.ADD,0)),e.A.sort(l),l}function u({chordKind:l,allDegrees:h}){const I=i.find(T=>o(h,T));if(!I)return{chordKind:l,allDegrees:h};const P=I.suspension;return h=n(h),l=r(l),{allDegrees:h,chordKind:l,suspension:P}}},601585:(O,A,t)=>{t.d(A,{A:()=>l});var f=t(702544),e=t(153271),s=t(443749),c=t(726042),d=t(446921),i=t(782540),a=t(832560),o=t(21738),r=t(131220),n=t(665280);const l=function(h,I){(0,o.default)(h,I),(0,r.default)(h,I),(0,n.default)(h,I);const P=I.partIdx,T=h.getNbParts();if(!c.default.isInteger(T)||P<0||P>=T)throw new f.default(P,f.default.GET);const _=h.getNbMeasures(),g=I.measureIdx;if(!c.default.isInteger(g)||g<0||g>=_)throw new e.default(g,e.default.GET);const E=h.getPartContent(I.partIdx),D=d.A.getNbStaves(E),M=I.staffIdx;if(!c.default.isInteger(M)||M<0||M>=D)throw new s.default(M,s.default.GET);const p=h.getMeasure(P,g),m=h.getPartStaffVoicesIndexes(I.partIdx,I.staffIdx),v=new a.A(p);return m.map(function(x){if(!v.hasVoice(x))return null;const S=v.getVoice(x),K={partIdx:I.partIdx,measureIdx:I.measureIdx,voiceIdx:x,startNoteIdx:S.getStartNoteIdx(),stopNoteIdx:S.getStopNoteIdx()};return(0,i.A)(h,K,v)})}},601770:(O,A,t)=>{t.d(A,{A:()=>e});const f={};f.create=function(s){return{uuid:s}},f.setUuid=function(s,c){s.uuid=c},f.getUuid=function(s){return s.uuid},f.hasUuid=function(s){return typeof s.uuid!="undefined"};const e=f},602e3:(O,A,t)=>{t.d(A,{A:()=>u});var f=t(383279),e=t(364842),s=t(226804),c=t(856219);const d=function(l,h){const I=l.map(s.default.getId);let P=0;const T=I.length,_=h.length;for(let g=0;g<T&&P<_;g++){const E=I[g];P=i(E,P,h)}},i=function(l,h,I){if(c.default.getId(I[h])!==l){const T=I.findIndex(a,l);if(T>h){const _=I.splice(T,1)[0];return I.splice(h,0,_),h+1}else{if(T===-1)return h;throw new e.default("unreachable")}}else return h+1},a=function(l){const h=this.valueOf();return c.default.getId(l)===h},o=d,r=function(l){l.forEach(n)},n=function(l){const h=f.default.getScoreInstruments(l),I=f.default.getMIDIInstruments(l);o(h,I)},u=r},603504:(O,A,t)=>{t.d(A,{A:()=>E});var f=t(346797),e=t(180289),s=t(891921),c=t(26698),d=t(21738),i=t(779146),a=t(409200),o=t(665280),r=t(118824);const n=function(D,M){(0,d.default)(D,M),(0,i.default)(D,M),(0,a.default)(D,M),(0,o.default)(D,M);const p={hasLeftContinue:u,searchLeftStart:l,getEntities:h,createStart:I,createStop:P,hasRightContinue:T,searchRightStop:_,createEntry:g,isEntityStart:f.A.isStart,isEntityStop:f.A.isStop},m=new r.A(D,M,p);return m.checkPreconditions(),m.get()},u=function(){return this.scoreData.getCommonContent().hasLeftTempoChange(this.location.startMeasureIdx)},l=function(){const D=this.scoreData.getCommonContent(),m=(0,e.A)(D,this.location.startMeasureIdx,0,1);return{measureIdx:m.startMeasureIdx,timePos:m.startTimePos,dpq:m.startDpq,type:m.type}},h=function(D){return this.scoreData.getCommonContent().getTempoChanges(D)},I=function(D,M){const p=f.A.getTimePos(D),m=f.A.getType(D),v=f.A.getDpq(D);return{measureIdx:M,timePos:p,dpq:v,type:m}},P=function(D,M){const p=f.A.getTimePos(D),m=f.A.getDpq(D);return{measureIdx:M,timePos:p,dpq:m}},T=function(){return this.scoreData.getCommonContent().hasRightTempoChange(this.location.stopMeasureIdx)},_=function(){const D=this.scoreData.getCommonContent(),m=(0,e.A)(D,this.location.stopMeasureIdx+1,0,1);return{measureIdx:m.stopMeasureIdx,timePos:m.stopTimePos,dpq:m.stopDpq}},g=function(D,M){const p={startMeasureIdx:D.measureIdx,startMeasureUuid:this.scoreData.getMeasureUuid(D.measureIdx),startTimePos:D.timePos,startDpq:D.dpq,stopMeasureIdx:M.measureIdx,stopMeasureUuid:this.scoreData.getMeasureUuid(M.measureIdx),stopTimePos:M.timePos,stopDpq:M.dpq,type:D.type},m=this.location.partIdx,v=1;p.startVoiceIdx=this.getVoiceIdx(D.measureIdx),p.startVoiceUuid=this.scoreData.getPartVoiceUuid(this.location.partIdx,p.startVoiceIdx);const U=this.getVoice(D.measureIdx);p.startNoteIdx=(0,s.A)(U,v,D.timePos),p.startIdxInStaff=this.scoreData.voiceIdxToIdxInMainStaff(m,p.startVoiceIdx),p.stopVoiceIdx=this.getVoiceIdx(M.measureIdx),p.stopVoiceUuid=this.scoreData.getPartVoiceUuid(this.location.partIdx,p.stopVoiceIdx);const x=this.getVoice(M.measureIdx);return p.stopNoteIdx=(0,c.A)(x,v,M.timePos),p.stopIdxInStaff=this.scoreData.voiceIdxToIdxInMainStaff(m,p.stopVoiceIdx),p},E=n},603966:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(852363),e=t(980641),s=t(343568);const c=function(a,o,r){this.init(a,o,r)};c.NAME="primitive.RemoveSingleNote";const d=c.prototype;d.name=c.NAME,d.initMeasureData=s.A,d.init=function(a,o,r){this.initMeasureData(a,o),this.cancelStack=r,this.opts=o},d.perform=function(){this.getVoice().removeNote(this.opts.noteIdx),this.updateStack()},d.getVoice=function(){const a=this.opts.voiceIdx,o=this.opts.noteIdx;return this.measureData.getVoiceOrTupletForGet(a,o)},d.updateStack=function(){const a={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx}};this.cancelStack.push(a),(0,f.default)(this.cancelStack,this.measureData,this.opts)},d.getDurationType=function(a){const o=this.measureData.getDivisionsPerQuarterValue();return(0,e.A)(a,o)};const i=c},604674:(O,A,t)=>{t.d(A,{A:()=>I});var f=t(476943),e=t(726042),s=t(843678),c=t(210888);const d=function(P){return!(!f.default.isObject(P.voiceIdxToUuidMapping)||!f.default.isObject(P.voiceUuidToIdxMapping)||!s.default.every(P.voiceMapping,i,P.voiceIdxToUuidMapping)||!s.default.every(P.voiceIdxToUuidMapping,a,P)||!s.default.every(P.voiceUuidToIdxMapping,o,P.voiceIdxToUuidMapping))},i=function(P){return typeof this[P]!="undefined"},a=function(P,T){if(!c.default.isValid(T))return!1;const _=this;return!(typeof _.voiceMapping[P]=="undefined"||(P=e.default.intPart(P),_.voiceUuidToIdxMapping[T]!==P))},o=function(P,T){return this[T]===P},r=d,n=function(P){P.voiceIdxToUuidMapping=s.default.map(P.voiceMapping,c.default.generate),P.voiceUuidToIdxMapping={},s.default.forEach(P.voiceIdxToUuidMapping,u,P.voiceUuidToIdxMapping)},u=function(P,T){const _=this;P=e.default.intPart(P),_[T]=P},l=n,I=function(P){r(P)||l(P)}},606744:(O,A,t)=>{t.d(A,{A:()=>D});var f=t(952818),e=t(234421),s=t(868743);const c=function(M){return M=new d(M).group(),M},d=function(M){this.init(M)},i=d.prototype;i.init=function(M){this.wrappedDirections=M,this.ongoingPedals={},this.previousLocation={},this.grouppedDirections=[]},i.group=function(){return this.wrappedDirections.forEach(this.analyzePedal,this),this.grouppedDirections},i.analyzePedal=function(M){const p=M.direction,m=f.A.getPedal(p),v=e.A.getType(m);s.A.assert(v),v===s.A.CONTINUE||v===s.A.CHANGE||(v===s.A.START?this.startPedal(M):v===s.A.STOP&&this.stopPedal(M))},i.startPedal=function(M){const p=M.direction,m=f.A.getStaffIdx(p);this.addPedalStart(m,M)},i.addPedalStart=function(M,p){this.ongoingPedals[M]=p},i.stopPedal=function(M){const p=M.direction,m=f.A.getStaffIdx(p);if(this.hasPedalStart(m)){const v=this.getWrappedStart(m),U=v.direction;if(a(U,p)&&!o(v,M)){this.addCompletePedal(v,M);const x=f.A.getTimePos(p);this.previousLocation[m]={timePos:x,measureIdx:v.measureIdx}}this.discardDirection(m)}},i.hasPedalStart=function(M){return typeof this.ongoingPedals[M]!="undefined"},i.getWrappedStart=function(M){return this.ongoingPedals[M]},i.discardDirection=function(M){delete this.ongoingPedals[M]};const a=function(M,p){const m=f.A.getPlacement(M),v=f.A.getPlacement(p),U=f.A.getStaffIdx(M),x=f.A.getStaffIdx(p);return m===v&&U===x},o=function(M,p){return M.timePos===p.timePos&&M.measureIdx===p.measureIdx};i.addCompletePedal=function(M,p){this.grouppedDirections.push(M),this.grouppedDirections.push(p)};const r=c;var n=t(245689),u=t(817066),l=t(537920),h=t(701387),I=t(584416),P=t(364842);const T=function(M){const p=M.length;let m=(0,n.A)(M),v=m.map(_);v=v.map(r),m=v.map(function(U){return(0,l.A)(U,p)}),m.forEach(E,M)};function _(M){return(0,u.A)(M,g)}function g(M,p){const m=M.measureIdx-p.measureIdx;return m!==0?m:I.A.compare(M.direction,p.direction)}const E=function(M,p){const m=this;if(m.length!==M.length){const v="Array size should be the same.";throw new P.default("NotSameSize",v)}m.forEach(function(v,U){const x=M[U];h.default.setPedals(v,p,x)})},D=T},606903:(O,A,t)=>{t.d(A,{A:()=>u});var f=t(446921);function e(l){const h={nbMeasures:null};return l.some(s,h)}function s(l){const h=this,I=f.A.getNbMeasures(l);return h.nbMeasures===null?(h.nbMeasures=I,!1):h.nbMeasures!==I}var c=t(726042);function d(l){return l.map(f.A.getNbMeasures).reduce(c.default.max2)}var i=t(364842);function a(l,h){const I={referencePart:null,partsToUpdate:[]},P={partsData:I,measureIdx:h};if(l.forEach(o,P),I.referencePart===null)throw new i.default("Unexpected");return I}function o(l,h){const I=this,P=f.A.getNbMeasures(l);I.measureIdx<P?I.partsData.referencePart===null&&(I.partsData.referencePart=h):I.partsData.partsToUpdate.push(h)}function r(l){const h=d(l);for(let I=0;I<h;I++)a(l,I).partsToUpdate.forEach(n,l)}function n(l){const I=this[l],P=f.A.getMeasures(I),T={};P.push(T)}function u(l){e(l)&&r(l)}},607132:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(210888),e=t(601770),s=t(446921),c=t(701387),d=t(345912);function i(r,n){const u={partContent:r,measuresHeaders:n,octaveShiftUuidByStaff:{}};s.A.getMeasures(r).forEach(a,u)}function a(r,n,u){const l=this,h=c.default.getNbStaves(r);l.measureUuid=e.A.getUuid(l.measuresHeaders[n]);for(let I=0;I<h;I++){let P=c.default.getOctaveShifts(r,I);if(P=P.filter(d.A.isStart),P.forEach(o,l),c.default.hasRightOctaveShift(r,I)){const T=l.octaveShiftUuidByStaff[I],_=c.default.getRightOctaveShift(r,I);d.A.setOctaveShiftUuid(_,T);const g=u[n+1],E=c.default.getLeftOctaveShift(g,I);d.A.setOctaveShiftUuid(E,T)}}}function o(r){const n=this,u=f.default.generate(),l={octaveShiftUuid:u,measureUuid:n.measureUuid};s.A.addOctaveShift(n.partContent,l);const h=d.A.getStaffIdx(r);d.A.setOctaveShiftUuid(r,u),n.octaveShiftUuidByStaff[h]=u}},607960:(O,A,t)=>{t.d(A,{A:()=>u});var f=t(701387),e=t(123491),s=t(209175),c=t(726042);const d=[{src:s.default.create(4,3),dest:s.default.create(2,3)},{src:s.default.create(2,12),dest:s.default.create(2,3)},{src:s.default.create(8,6),dest:s.default.create(4,6)},{src:s.default.create(3,4),dest:s.default.create(3,2)},{src:s.default.create(9,6),dest:s.default.create(3,2)},{src:s.default.create(6,9),dest:s.default.create(2,3)},{src:s.default.create(3,1),dest:s.default.create(3,2)},{src:s.default.create(6,8),dest:s.default.create(6,4)},{src:s.default.create(6,2),dest:s.default.create(6,4)},{src:s.default.create(36,4),dest:s.default.create(9,8)},{src:s.default.create(18,8),dest:s.default.create(9,8)},{src:s.default.create(5,1),dest:s.default.create(5,4)},{src:s.default.create(5,2),dest:s.default.create(5,4)},{src:s.default.create(10,2),dest:s.default.create(5,4)},{src:s.default.create(7,8),dest:s.default.create(7,4)},{src:s.default.create(7,2),dest:s.default.create(7,4)},{src:s.default.create(7,1),dest:s.default.create(7,4)},{src:s.default.create(14,4),dest:s.default.create(7,4)},{src:s.default.create(14,12),dest:s.default.create(7,6)},{src:s.default.create(9,4),dest:s.default.create(9,8)},{src:s.default.create(9,2),dest:s.default.create(9,8)},{src:s.default.create(5,3),dest:s.default.create(5,6)},{src:s.default.create(10,6),dest:s.default.create(5,6)},{src:s.default.create(10,12),dest:s.default.create(5,6)},{src:s.default.create(30,24),dest:s.default.create(5,4)},{src:s.default.create(10,8),dest:s.default.create(5,4)},{src:s.default.create(10,4),dest:s.default.create(5,4)},{src:s.default.create(24,16),dest:s.default.create(6,4)},{src:s.default.create(12,16),dest:s.default.create(6,4)},{src:s.default.create(16,12),dest:s.default.create(4,6)},{src:s.default.create(12,9),dest:s.default.create(4,6)},{src:s.default.create(15,12),dest:s.default.create(5,4)},{src:s.default.create(12,8),dest:s.default.create(6,4)},{src:s.default.create(14,8),dest:s.default.create(7,4)},{src:s.default.create(8,12),dest:s.default.create(4,6)},{src:s.default.create(3,48),dest:s.default.create(1,1)},{src:s.default.create(3,24),dest:s.default.create(1,1)},{src:s.default.create(11,4),dest:s.default.create(11,8)}],i=function(l){f.default.getNotes(l).forEach(a)},a=function(l){if(!e.default.hasTimeModif(l))return;let h=e.default.getTimeModif(l);h=o(h),e.default.setTimeModif(l,h)},o=function(l){const h=s.default.getActual(l),I=s.default.getNormal(l),P=h/I;if(c.default.isInteger(P)&&P%2===0)return s.default.createDefault();let T=r(l);return T!==null?(T=s.default.copy(T),T):l},r=function(l){const h=d.find(n,l);return typeof h!="undefined"?h.dest:null},n=function(l){const h=this;return s.default.isSame(l.src,h)},u=i},608857:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(794799),e=t(701387),s=t(123491),c=t(712947);const d=function(n){const u=n.map(e.default.getNotes),l=Array.prototype.concat.apply([],u);new i(l).filter()},i=function(n){this.init(n)},a=i.prototype;a.init=function(n){this.notes=n,this.slurNotes={}},a.filter=function(){this.notes.forEach(this.analyzeNote,this),this.discardPendingSlurs()},a.analyzeNote=function(n){s.default.hasSlur(n)&&(o(n)?this.addNote(n):s.default.removeSlur(n))};function o(n){return!s.default.isChord(n)&&!s.default.isRest(n)&&!s.default.isGraceNote(n)}a.addNote=function(n){const u=s.default.getVoiceIdx(n),l=s.default.getSlur(n),h=c.default.getType(l);h===f.A.START?this.startSlur(u,n):h===f.A.STOP?this.stopSlur(u,n):h===f.A.CONTINUE?s.default.removeSlur(n):f.A.raiseError(h)},a.startSlur=function(n,u){this.hasNote(n)&&this.discardPendingSlur(n),this.slurNotes[n]=u},a.stopSlur=function(n,u){if(!this.hasNote(n)){s.default.removeSlur(u);return}const l=s.default.getSlur(u),h=c.default.getLevel(l);if(this.getSlurLevel(n)!==h){s.default.removeSlur(u);return}this.closePendingSlur(n)},a.hasNote=function(n){return typeof this.slurNotes[n]!="undefined"},a.getSlurLevel=function(n){const u=this.slurNotes[n],l=s.default.getSlur(u);return c.default.getLevel(l)},a.closePendingSlur=function(n){delete this.slurNotes[n]},a.discardPendingSlurs=function(){Object.keys(this.slurNotes).forEach(this.discardPendingSlur,this)},a.discardPendingSlur=function(n){const u=this.slurNotes[n];s.default.removeSlur(u),delete this.slurNotes[n]};const r=d},610293:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(383279),e=t(856219),s=t(123491);const c=function(o,r){o.checkPartIdx(r.partIdx);const n=o.getPartHeader(r.partIdx),u=f.default.getName(n),l=d(n),h=f.default.hasUnpitched(n),P=f.default.getMIDIInstruments(n).map(i),T=f.default.isGroupedWithPrevious(n),_=s.default.isTemplateLocked(n);return{partName:u,partAbbreviation:l,isUnpitched:h,instrumentsData:P,isGroupedWithPrevious:T,isTemplateLocked:_}},d=function(o){return f.default.hasAbbreviation(o)?f.default.getAbbreviation(o):null},i=function(o){return e.default.hasUnpitched(o)?{MIDIUnpitched:e.default.getUnpitched(o)}:{MIDIProgram:e.default.getMIDIProgram(o)}},a=c},613323:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(607801),e=t(250769);const s=37;function c(d){const i=d.getFormatVersion();if(i===0||i>=s)return;const a=d.getCommonContent(),o=a.getNbMeasures();for(let r=0;r<o;r++)!a.hasJumpTag(r)||a.getJumpTag(r)!==f.A.CODA||a.hasSystemBreak(r)&&a.getSystemBreak(r)===e.A.YES||a.setSystemBreak(r,e.A.YES)}},624782:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(701387),e=t(123491),s=t(109708);const c=function(u){d().clean(u)},d=function(){return i===null&&(i=new a),i};let i=null;const a=function(){},o=a.prototype;o.clean=function(u){this.reset(),f.default.getNotes(u).forEach(this.addNote,this),this.analyzeChord()},o.reset=function(){this.currentChord=null},o.addNote=function(u){e.default.isChord(u)?this.addToChord(u):(this.hasCurrentChord()&&this.analyzeChord(),this.createChord(u))},o.addToChord=function(u){this.currentChord.push(u)},o.hasCurrentChord=function(){return this.currentChord!==null},o.createChord=function(u){this.currentChord=[u]},o.analyzeChord=function(){!this.currentChord.some(e.default.hasArpeggiate)||this.currentChord.length===1?this.removeArpeggio():this.cleanArpeggio(),this.currentChord=null},o.removeArpeggio=function(){this.currentChord.forEach(e.default.removeArpeggiate)},o.cleanArpeggio=function(){this.currentChord.forEach(r)};const r=function(u){const l=s.A.create();e.default.setArpeggiate(u,l),e.default.removeTieStop(u)},n=c},628473:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(35802),e=t(701387),s=t(721247);const c="none",d="G",i=2;function a(n){e.default.getAllRawAttributes(n).forEach(o)}function o(n){f.default.getClef(n).forEach(r)}function r(n){s.default.getSign(n)===c&&(s.default.setSign(n,d),s.default.setLine(n,i))}},630006:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(123491),s=t(967104);function c(i){f.default.getNotes(i).forEach(d)}function d(i){if(!e.default.hasFretData(i)){e.default.setRawBends(i,[]);return}let a=e.default.getRawBends(i);const o=[];if(a=a.filter(s.A.isValid),a.length>0){const[r]=a;s.A.isPreBend(r)&&(o.push(r),a.shift())}if(a.length>0){const[r]=a;s.A.isNotPreBend(r)&&o.push(r)}e.default.hasTieStop(i)&&o.length===2&&o.shift(),e.default.setRawBends(i,o)}},646319:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(365340);const e={};e.getPartsIds=function(c){return f.default.getArray(c,"score-part")},e.create=function(c){return{$number:"1","score-part":c,"group-symbol":{content:"bracket"},"group-barline":"yes"}};const s=e},646456:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(607682);function e(c,d){return`The quarter time position [${c}/${d}] is out of the measure range.`}class s extends f.default{constructor(d,i){const a=e(d,i);super(a),Object.defineProperty(this,"timePos",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dpq",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="TimePosOutOfRangeError",this.timePos=d,this.dpq=i}}},650051:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(123491),s=t(915033);const c="tied",d=function(o){f.default.getNotes(o).forEach(i)},i=function(o){e.default.hasNotation(o,c)&&!e.default.hasTie(o)&&e.default.getTieds(o).forEach(n=>{s.A.isStart(n)&&e.default.addTieStart(o),s.A.isStop(n)&&e.default.addTieStop(o)})},a=d},653945:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(123491),s=t(244616);function c(i){f.default.getNotes(i).forEach(d)}function d(i){if(e.default.hasColor(i)){const a=e.default.getColor(i);s.default.isValid(a)||e.default.removeColor(i)}}},657032:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(515819),e=t(209175),s=t(799855),c=t(673817),d=t(343568),i=t(157158),a=t(469019);const o=function(u,l){this.init(u,l)};o.NAME="composite.FillVoiceWithRests";const r=o.prototype;r.name=o.NAME,r.initMeasureData=d.A,r.init=function(u,l){this.initMeasureData(u,l),this.cancelStack=new c.A,this.opts=l,this.durationOpts=null},r.perform=function(){this.cancelStack=this.cancelStack.createSubstack(this.name),this.adaptDpqToDuration(),this.addRests()},r.adaptDpqToDuration=function(){const u=this.getDurationOpts(),l=e.default.createDefault(),h={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,durationType:u.durationType,nbDots:u.nbDots,timeModif:l};new i.A(this.measureData,h,this.cancelStack).perform()},r.getDurationOpts=function(){if(this.durationOpts===null){const u=this.measureData.getAnyTime(),l=f.default.getBeatQuarterDuration(u);this.durationOpts=f.default.quarterToDurationOpts(l)}return this.durationOpts},r.addRests=function(){const u=this.opts.voiceIdx;this.measureData.initTupletCacheWithVoice(u);const l=this.measureData.getAnyTime(),h=f.default.timeToQuarter(l),I=this.measureData.getDpqValue(),P=f.default.quarterToDuration(h,I),T=this.getStaffIdx(),_={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,staffIdx:T,voiceIdx:u,noteIdx:0,insertMode:s.default.INSERT,duration:P};new a.A(this.measureData,_,this.cancelStack).perform()},r.getStaffIdx=function(){return typeof this.opts.staffIdx!="undefined"?this.opts.staffIdx:this.measureData.getVoiceMainStaffIdx(this.opts.voiceIdx)};const n=o},658175:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(123491);const s=function(i){f.default.getNotes(i).forEach(c)},c=function(i){e.default.hasNormalTimeModif(i)&&e.default.removeTupletBounds(i)},d=s},665444:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(383279);const s=function(c,d){return c.some(function(i){return f.default.getUuid(i)===d})}},666506:(O,A,t)=>{t.d(A,{A:()=>l});var f=t(701387),e=t(614653),s=t(529355),c=t(681670),d=t(902630),i=t(244240),a=t(184469),o=t(477849);const r=function(h,I){const P=e.default.getRoot(h),T=(0,i.A)(h);if(I.kind=e.default.getAdagioKind(h),I.degrees=(0,a.A)(I.kind,T),I.root=s.A.copy(P),I.bass=null,I.frame=null,e.default.hasBass(h)){const _=e.default.getBass(h);I.bass=c.A.copy(_)}if(e.default.hasFrame(h)){const _=e.default.getFrame(h);I.frame=d.default.copy(_)}I.type=e.default.getType(h)},n={getEntities:f.default.getJazzHarmonies,fillEntity:r},l=function(h,I){return new o.A(h,I,n).get()}},673817:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(364842);const e="This is a fake cancel stack, that do not hold information used for undo and display update. use a `CancelStack` instead for such purposes. ",s=function(){this.init()};s.DEFAULT_NAME="FakeStack";const c=s.prototype;c.init=function(){this.name=s.DEFAULT_NAME},c.push=function(){},c.createSubstack=function(){return this},c.getLast=function(){this.throwNotReal()},c.stateNeedCompleteRedraw=function(){},c.needCompleteRedraw=function(){this.throwNotReal()},c.storePosition=function(){},c.getPosition=function(){this.throwNotReal()},c.hasAction=function(){this.throwNotReal()},c.resetAction=function(){this.redrawList.resetAction()},c.storeAddAction=function(){},c.storeAction=function(){},c.storeActionIfFirst=function(){},c.getAction=function(){this.throwNotReal()},c.getActions=function(){this.throwNotReal()},c.stateCompleteRedrawDone=function(){this.throwNotReal()},c.setPayload=function(){this.throwNotReal()},c.getPayload=function(){this.throwNotReal()},c.hasPayload=function(){return!1},c.throwNotReal=function(){throw new f.default(e)};const d=s},676969:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(737903),e=t(701387),s=t(35802);const c=function(o){const r=o[0],n=d(r);o.slice(1).reduce(i,(0,f.default)(n))},d=function(o){const r=e.default.getAttributes(o),n=e.default.getWrappedOwnClef(o),u=(0,f.default)(n.dumpAttribute());s.default.setClef(r,u);const l=e.default.getWrappedOwnKey(o),h=(0,f.default)(l.dumpAttribute());s.default.setKey(r,h);const I=e.default.getWrappedOwnTransposeOrDefault(o),P=(0,f.default)(I.dumpAttribute());s.default.setTranspose(r,P);const T=e.default.getWrappedOwnStaffDetailsOrDefault(o),_=(0,f.default)(T.dumpAttribute());return s.default.setStaffDetails(r,_),(0,f.default)(r)},i=function(o,r){const n=e.default.getAttributes(r),u=e.default.getNbStaves(r),l=e.default.getOwnAttributes(r),h=s.default.getWrappedClef(l,u),I=s.default.getWrappedClef(o);I.replaceWith(h);const P=I.dumpAttribute();s.default.setClef(n,P);const T=s.default.getWrappedKey(l,u),_=s.default.getWrappedKey(o);_.replaceWith(T);const g=_.dumpAttribute();s.default.setKey(n,g);const E=s.default.getWrappedTranspose(l,u),D=s.default.getWrappedTranspose(o);D.replaceWith(E);const M=D.dumpAttribute();s.default.setTranspose(n,M),s.default.removeStaffDetails(l);const p=s.default.getWrappedStaffDetailsOrDefault(o),m=(0,f.default)(p.dumpAttribute());return s.default.setStaffDetails(n,m),(0,f.default)(n)},a=c},680839:(O,A,t)=>{t.d(A,{A:()=>v});var f=t(701387),e=t(952818),s=t(717434),c=t(501696),d=t(735178),i=t(909748);const a=function(U){return e.A.getEntries(U).some(o)},o=function(U){if(s.A.getType(U)!==d.A.TEMPO_CHANGE)return!1;const S=s.A.getTempoChange(U),K=c.A.getType(S);return i.A.isValidInternal(K)},r=a;var n=t(346797);const u=function(U,x){const S=e.A.getTimePos(U),K=l(U);return n.A.create(S,x,K)},l=function(U){const S=e.A.getEntries(U).find(h),K=s.A.getTempoChange(S);return c.A.getType(K)},h=function(U){if(s.A.getType(U)!==d.A.TEMPO_CHANGE)return!1;const S=s.A.getTempoChange(U),K=c.A.getType(S);return i.A.isValidInternal(K)},I=u,P=function(U,x){return M().extract(U,x)},T=function(){this.tempoChanges=null},_=T.prototype;_.extract=function(U,x){return this.reset(x),U.forEach(this.processDirection,this),this.tempoChanges},_.reset=function(U){this.dpq=U,this.tempoChanges=[]},_.processDirection=function(U){if(r(U)){const x=I(U,this.dpq);this.addTempoChange(x)}},_.addTempoChange=function(U){const x=e.A.getTimePos(U);g(this.tempoChanges,x),this.tempoChanges.push(U)};const g=function(U,x){E(U,x)&&U.pop()},E=function(U,x){if(U.length===0)return!1;{const S=U.length-1,K=U[S];return e.A.getTimePos(K)===x}};let D=null;const M=function(){return D===null&&(D=new T),D},p=P,v=function(U,x){const S=f.default.getRawDirections(U),K=f.default.getDpq(U),H=p(S,K);this.getCommonContent().setTempoChanges(x,H)}},682279:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(364842),e=t(383279),s=t(446921),c=t(701387),d=t(123491);const i=function(u,l){u.forEach(a,l)},a=function(u,l){const I=this[l],P=e.default.getVoiceMapping(u);s.A.getMeasures(I).forEach(o,P)},o=function(u){const l=this;c.default.getNotes(u).forEach(r,l)},r=function(u){let l=d.default.getStaffIdx(u);if(Number.isNaN(l)){const h=this,I=d.default.getVoiceIdx(u);if(l=h[I][0],typeof l=="undefined")throw new f.default("Unexpected","Was not able to fix a staffIdx");d.default.setStaffIdx(u,l)}},n=i},691502:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(364842),e=t(701387),s=t(123491),c=t(712947);const d=function(r){new i(r).fill()},i=function(r){this.init(r)},a=i.prototype;a.init=function(r){this.measures=r,this.voices={}},a.fill=function(){this.measures.forEach(this.fillMeasure,this)},a.fillMeasure=function(r,n){this.measureIdx=n,e.default.getNotes(r).forEach(this.analyzeNote,this)},a.analyzeNote=function(r){s.default.hasSlurStart(r)?this.startSlur(r):s.default.hasSlurStop(r)&&this.stopSlur(r)},a.startSlur=function(r){const n=s.default.getVoiceIdx(r);if(this.hasOngoingSlur(n)){const l=`There is already an ongoing slur for the voice [${n}].`;throw new f.default("AlreadyOngoingSlur",l)}const u={note:r,measureIdx:this.measureIdx};this.voices[n]=u},a.stopSlur=function(r){const n=s.default.getVoiceIdx(r);if(!this.hasOngoingSlur(n)){const u=`There is no ongoing slur for the voice [${n}].`;throw new f.default("NoOngoingSlur",u)}this.closePendingSlur(r)},a.hasOngoingSlur=function(r){return typeof this.voices[r]!="undefined"},a.closePendingSlur=function(r){const n=s.default.getVoiceIdx(r),u=this.voices[n];u.measureIdx!==this.measureIdx&&this.fillCrossMeasures(u,r),delete this.voices[n]},a.fillCrossMeasures=function(r,n){const u=r.note,l=s.default.getSlur(u);c.default.addCrossMeasure(l);const h=s.default.getSlur(n);c.default.addCrossMeasure(h);const I=s.default.getStaffIdx(u),P=s.default.getVoiceIdx(u),T=r.measureIdx,_=this.measureIdx;for(let g=T;g<_;g++){const E=this.measures[g],D={staffIdx:I};e.default.setRightSlur(E,P,D);const M=this.measures[g+1],p={staffIdx:I};e.default.setLeftSlur(M,P,p)}};const o=d},694219:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(701387),e=t(345912),s=t(963062);const c=function(n,u){u.size=e.A.getSize(n),u.placement=e.A.getPlacement(n)},d=function(n){const u=this.getMeasure(n);return f.default.getOctaveShifts(u,this.location.staffIdx)},i=function(n,u){return this.getMeasureDpq(u)},a={getEntities:d,isStart:e.A.isStart,isStop:e.A.isStop,fillEntity:c,getDpq:i},r=function(n,u){return new s.A(n,u,a).get()}},696761:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(476943),e=t(351277),s=t(123491);const c=function(o,r,n,u){let l=d(o,r,u);return l=f.default.makeArray(l),l.find(i,n)},d=function(o,r,n){return typeof n=="number"?o.getGraceChord(r,n):o.getChord(r)},i=function(o){const r=this,n=s.default.getPitch(o);return e.default.isSameLine(n,r)},a=c},700288:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(123491);const s=function(i){f.default.getNotes(i).forEach(c)},c=function(i){e.default.isRest(i)&&e.default.setFullMeasureRest(i,!1)},d=s},700368:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(443749),e=t(832560),s=t(891921),c=t(125911),d=t(701387),i=t(726042);const a=function(u,l){u.checkPartIdx(l.partIdx);let h=l.measureIdx;u.checkMeasureIdx(h);let I,P,T;if(l.noteIdx===0){if(h===0)return null;h--,P=u.getMeasure(l.partIdx,h),I=d.default.getNbDivisions(P),T=new e.A(P)}else{P=u.getMeasure(l.partIdx,h),T=new e.A(P),T.checkVoiceIdx(l.voiceIdx);const v=T.getVoice(l.voiceIdx);v.checkNoteIdx(l.noteIdx),I=v.getRangeSpace(0,l.noteIdx)}const _=d.default.getNbStaves(P),g=l.staffIdx;if(!i.default.isInteger(g)||g<0||g>=_)throw new f.default(g);let E=u.getPartStaffVoicesIndexes(l.partIdx,l.staffIdx);E=E.filter(T.hasVoice,T);const D={timePos:I,measureData:T},p=E.map(o,D).reduce(r);return{partIdx:l.partIdx,measureIdx:h,staffIdx:l.staffIdx,voiceIdx:p.voiceIdx,noteIdx:p.noteIdx}},o=function(u){u=parseInt(u,10);const l=this,h=l.measureData.getVoice(u),I=l.timePos;let P;const T=h.getNbNotes();I===h.getRangeSpace(0,T)?P=T-1:(P=(0,s.A)(h,1,I),(0,c.A)(h,1,I)&&P--);const _=h.getRangeSpace(0,P);return{voiceIdx:u,noteIdx:P,timePos:_}},r=function(u,l){return u.timePos>l.timePos?u:l},n=a},702868:(O,A,t)=>{t.d(A,{A:()=>u});var f=t(364842),e=t(951066);function s(l){return`The tuplet type [${l}] is invalid.`}class c extends e.A{constructor(h){const I=s(h);super(I),Object.defineProperty(this,"tupletType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadTupletTypeError",this.tupletType=h}}var d=t(476943),i=t(209175);const a={DUPLET:"duplet",TRIPLET:"triplet",QUADRUPLET:"quadruplet",QUINTUPLET:"quintuplet",QUINTUPLET_COMPOUND:"quintuplet_compound",SEXTUPLET:"sextuplet",SEPTUPLET:"septuplet",SEPTUPLET_COMPOUND:"septuplet_compound",NONUPLET:"nonuplet",TUPLET_11:"tuplet_11"},o=d.default.pairsToMap([{key:a.DUPLET,value:{timeModif:i.default.create(2,3)}},{key:a.TRIPLET,value:{timeModif:i.default.create(3,2)}},{key:a.QUADRUPLET,value:{timeModif:i.default.create(4,6)}},{key:a.QUINTUPLET,value:{timeModif:i.default.create(5,4)}},{key:a.QUINTUPLET_COMPOUND,value:{timeModif:i.default.create(5,6)}},{key:a.SEXTUPLET,value:{timeModif:i.default.create(6,4)}},{key:a.SEPTUPLET,value:{timeModif:i.default.create(7,4)}},{key:a.SEPTUPLET_COMPOUND,value:{timeModif:i.default.create(7,6)}},{key:a.NONUPLET,value:{timeModif:i.default.create(9,8)}},{key:a.TUPLET_11,value:{timeModif:i.default.create(11,8)}}]),r=[a.DUPLET,a.TRIPLET,a.QUADRUPLET,a.QUINTUPLET,a.QUINTUPLET_COMPOUND,a.SEXTUPLET,a.SEPTUPLET,a.SEPTUPLET_COMPOUND,a.NONUPLET,a.TUPLET_11];a.check=function(l){if(!a.isValid(l))throw new c(l)},a.getValues=function(){return r.slice()},a.isValid=function(l){return r.includes(l)},a.getTimeModif=function(l){if(typeof o[l]=="undefined")n(l);else{const h=o[l].timeModif;return i.default.copy(h)}},a.fromTimeModif=function(l){for(const I in o){const P=o[I].timeModif;if(i.default.isSame(l,P))return I}const h=`This time modification [${i.default.stringify(l)}]is not supported.`;throw new f.default("Unexpected",h)},a.isTimeModifSupported=function(l){for(const h in o){const I=o[h].timeModif;if(i.default.isSame(l,I))return!0}return!1};const n=function(l){const h=`Invalid tuplet type: [${l}].`;throw new f.default("Unexpected",h)},u=a},705405:(O,A,t)=>{t.d(A,{A:()=>lt});var f=t(348742),e=t(701387),s=t(35802),c=t(123491),d=t(515819),i=t(870437),a=t(259563);const o=function(X){return new r(X).group(X)},r=function(X){this.init(X)},n=r.prototype;n.init=function(X){this.notes=X,this.tmpChord=null,this.chords=[]},n.group=function(){return this.notes.forEach(this.addNote,this),this.dumpChord(),this.chords},n.addNote=function(X){c.default.isRest(X)?(this.dumpChord(),this.addRest(X)):c.default.isChord(X)?this.addToChord(X):(this.dumpChord(),this.addSingleNote(X))},n.dumpChord=function(){this.tmpChord!==null&&(this.chords.push(this.tmpChord),this.tmpChord=null)},n.addRest=function(X){this.addSingleNote(X),this.dumpChord()},n.addToChord=function(X){this.tmpChord.push(X)},n.addSingleNote=function(X){this.tmpChord=[X]};const u=o;var l=t(737903),h=t(724926),I=t(359932),P=t(369790),T=t(129283),_=t(601277);const g=function(X,k){let L=c.default.getDuration(X);L/=k,c.default.setDuration(X,L);const $=E(X,k);return $.forEach(D),$},E=function(X,k){const L=[];for(let $=0;$<k;$++){const ut=(0,l.default)(X);L.push(ut)}return L},D=function(X,k,L){const $=k===0,ut=k===L.length-1;$||M(X),ut||H(X)},M=function(X){!c.default.hasTieStop(X)&&!c.default.isRest(X)&&c.default.addTieStop(X),p(X),m(X),x(X)},p=function(X){c.default.removeAllArticulations(X),c.default.removeAllOrnaments(X),c.default.removeAllTechnicals(X,[I.default.STRING,I.default.FRET,I.default.HAMMER_ON,I.default.PULL_OFF]),c.default.removeLyrics(X),c.default.removeNotation(X,_.default.FERMATA),c.default.removeArpeggiate(X)},m=function(X){v(X),U(X)},v=function(X){const k={hammerOnPullOff:h.A.create(P.A.STOP)};c.default.hasTechnical(X,I.default.HAMMER_ON,k)&&c.default.removeTechnical(X,I.default.HAMMER_ON,k),c.default.hasTechnical(X,I.default.PULL_OFF,k)&&c.default.removeTechnical(X,I.default.PULL_OFF,k)},U=function(X){c.default.getGlissandosType(X,T.default.STOP).forEach(function(L){c.default.removeGlissando(X,L)})},x=function(X){K(X),S(X)},S=function(X){c.default.hasSlurStart(X)&&c.default.removeSlur(X)},K=function(X){if(c.default.hasTupletStart(X)){const k=c.default.getTupletStartLevel(X);c.default.removeTupletStartsWithin(X,k)}},H=function(X){!c.default.hasTieStart(X)&&!c.default.isRest(X)&&c.default.addTieStart(X),Y(X),F(X)},Y=function(X){C(X),y(X)},C=function(X){const k={hammerOnPullOff:h.A.create(P.A.START)};c.default.hasTechnical(X,I.default.HAMMER_ON,k)&&c.default.removeTechnical(X,I.default.HAMMER_ON,k),c.default.hasTechnical(X,I.default.PULL_OFF,k)&&c.default.removeTechnical(X,I.default.PULL_OFF,k)},y=function(X){c.default.getGlissandosType(X,T.default.START).forEach(function(L){c.default.removeGlissando(X,L)})},F=function(X){G(X),N(X)},N=function(X){c.default.hasSlurStop(X)&&c.default.removeSlur(X)},G=function(X){if(c.default.hasTupletStop(X)){const k=c.default.getTupletStopLevel(X);c.default.removeTupletStopsWithin(X,k)}},nt=g,J=4,V="BIG_NOTE_TUPLET",W=function(X){let k=e.default.getNotes(X),L=u(k);const $=e.default.getAttributes(X);L=Z(L,$),k=Array.prototype.concat.apply([],L),e.default.setNotes(X,k)},Z=function(X,k){const L=X.map(dt,k);return X=Array.prototype.concat.apply([],L),X},dt=function(X){const k=this,L=s.default.getDpq(k),$=X[0];if(c.default.hasTupletStart($)&&at($),c.default.isGraceNote($))return[X];const ut=c.default.getNormalQuarterDuration($,L),w=d.default.extractBaseDuration(ut);if(w<=J)return[X];if(!c.default.hasNormalTimeModif($)){const It="A note inside a tuplet has a duration over the whole note.";throw new f.A(V,It)}const st=w/J,tt=X.map(B,st),it=gt(tt);return it.forEach(c.default.removeDurationType),it},at=function(X){const k=c.default.getTupletStartLevel(X),L=c.default.getTupletStart(X,k),$=i.A.getDurationType(L),ut=a.default.toQuarterDuration($),w=i.A.getNbNormal(L);if(ut*w>J*1.5){const tt="A note inside a tuplet has a duration over the whole note.";throw new f.A(V,tt)}},B=function(X){const k=this.valueOf();return nt(X,k)},gt=function(X){const k=[],L=X[0].length,$=X.length;for(let ut=0;ut<L;ut++){const w=[];for(let st=0;st<$;st++){const tt=X[st][ut];w.push(tt)}k.push(w)}return k},lt=W},705440:(O,A,t)=>{t.d(A,{A:()=>l});var f=t(476943),e=t(383279),s=t(446921),c=t(701387),d=t(123491),i=t(292681),a=t(189247),o=t(673817),r=t(44229),n=t(119634),u=t(14302);function l(v,U){const x=I(v,U),S=new h(v,U);x.forEach(E,S)}class h{constructor(U,x){this.contents=x,this.headers=U,this.map=new Map}getMeasureData(U,x){return this.getPartMeasuresScroller(U).getMeasureData(x)}getPartMeasuresScroller(U){return this.getPartCached(U).measuresScroller}getPartUnpitchedSet(U){return this.getPartCached(U).unpitchedSet}getPartCached(U){if(!this.map.has(U)){const S=s.A.getMeasures(this.contents[U]),K=new a.A(S,U,null),H=this.headers[U],Y=e.default.getUnpitchedMapping(H),C=P(Y);this.map.set(U,{unpitchedSet:C,measuresScroller:K})}return this.map.get(U)}}function I(v,U){const x=[];return U.forEach((S,K)=>{const H=v[K];if(!e.default.hasUnpitched(H))return;const Y=s.A.getMeasures(S),C=e.default.getUnpitchedMapping(H),y=P(C);Y.forEach((F,N)=>{_(F,y)&&x.push({partIdx:K,measureIdx:N})})}),x}function P(v){const U=new Set;return Object.values(v).forEach(x=>{Object.values(x).filter(T).forEach(S=>U.add(S))}),U}function T(v){return v!=="default"}function _(v,U){return c.default.getNotes(v).some(g,U)}function g(v){return p(v,this)}function E({partIdx:v,measureIdx:U}){const x=this,S=x.getMeasureData(v,U),K=S.getVoicesIndexes(),H=x.getPartUnpitchedSet(v);K.forEach(D,{measureData:S,unpitchedSet:H})}function D(v){const{measureData:U,unpitchedSet:x}=this,S=U.getVoice(v),K=S.getNbNotes();for(let H=K-1;H>=0;H--){if(S.isRest(H))continue;const Y=S.getNbGraces(H);for(let F=Y-1;F>=0;F--){let N=S.getGraceChord(H,F);N=f.default.makeArray(N),N=N.slice();let G=0;N.forEach(nt=>{if(p(nt,x)){if(G===N.length-1){const J={partIdx:null,measureIdx:U.getIdx(),voiceIdx:v,noteIdx:H,graceIdx:F},V=new o.A;new n.A(U,J,V).perform()}else{const J=d.default.getUnpitched(nt),V={partIdx:null,measureIdx:U.getIdx(),voiceIdx:v,noteIdx:H,graceIdx:F,unpitched:i.default.copy(J)},W=new o.A;new u.A(U,V,W).perform()}G++}})}let C=0,y=S.getChord(H);y=f.default.makeArray(y),y=y.slice(),y.forEach(F=>{if(p(F,x)){if(C===y.length-1)M(U,v,H),m(F);else{const N=d.default.getUnpitched(F),G={partIdx:null,measureIdx:U.getIdx(),voiceIdx:v,noteIdx:H,unpitched:i.default.copy(N)},nt=new o.A;new r.A(U,G,nt).perform()}C++}})}}function M(v,U,x){const S=v.getVoice(U),K=S.getNbGraces(x);for(let H=K-1;H>=0;H--){let Y=S.getGraceChord(x,H);Y=f.default.makeArray(Y),Y=Y.slice();let C=0;Y.forEach(y=>{if(C===Y.length-1){const F={partIdx:null,measureIdx:v.getIdx(),voiceIdx:U,noteIdx:x,graceIdx:H},N=new o.A;new n.A(v,F,N).perform()}else{const F=d.default.getUnpitched(y),N={partIdx:null,measureIdx:v.getIdx(),voiceIdx:U,noteIdx:x,graceIdx:H,unpitched:i.default.copy(F)},G=new o.A;new u.A(v,N,G).perform()}C++})}}function p(v,U){if(d.default.isRest(v))return!1;if(d.default.hasInstrumentId(v)){const x=d.default.getInstrumentId(v);if(U.has(x))return!1}return!0}function m(v){v.rest={},delete v.unpitched,delete v.notehead,delete v.articulations,delete v.tie,v.notations&&(delete v.notations.ornaments,delete v.notations.technical,delete v.notations.articulations,delete v.notations.arpeggiate,delete v.notations.slur,delete v.notations.tied,delete v.notations.glissando,delete v.notations.tied)}},706900:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(c){const d=`There is no dynamic at the index [${c}].`;super(d),Object.defineProperty(this,"dynamicIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadDynamicIdxError",this.dynamicIdx=c}}},707165:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(259563),e=t(515819);const c=function(d,i,a){const o=e.default.actualToNormal(d,a),r=e.default.divisionsToQuarter(o,i),n=e.default.extractBaseDuration(r);return f.default.quarterToDurationType(n)}},707438:(O,A,t)=>{t.d(A,{A:()=>J});var f=t(702544),e=t(153271),s=t(869607),c=t(857552),d=t(985046),i=t(576106),a=t(297115),o=t(694219),r=t(346797),n=t(963062);const u=function(V,W){W.type=r.A.getType(V)},l=function(V){return this.scoreData.getCommonContent().getTempoChanges(V)},h=function(V){return r.A.getDpq(V)},I={getEntities:l,isStart:r.A.isStart,isStop:r.A.isStop,fillEntity:u,getDpq:h},T=function(V,W){return new n.A(V,W,I).get()};var _=t(984223),g=t(44703),E=t(666506),D=t(539203),M=t(474765),p=t(123491);const m=function(V,W){const Z=v(V,W),dt=U(V,W);return{startNoteIdx:Z,stopNoteIdx:dt}},v=function(V,W){let Z=W.startNoteIdx;const at=V.getMeasureData(W.startMeasureIdx).getVoice(W.voiceIdx);let B=at.getNote(Z);if(!p.default.hasNormalTimeModif(B))for(;!p.default.hasTupletStart(B);)Z--,B=at.getNote(Z);return Z},U=function(V,W){let Z=W.stopNoteIdx;const at=V.getMeasureData(W.stopMeasureIdx).getVoice(W.voiceIdx);let B=at.getNote(Z);if(!p.default.hasNormalTimeModif(B))for(;!p.default.hasTupletStop(B);)Z++,B=at.getNote(Z);return Z},x=m;var S=t(726042),K=t(843678),H=t(701387);const Y=function(V,W){return new C(V,W).get()},C=function(V,W){this.init(V,W)},y=C.prototype;y.init=function(V,W){this.scoreData=V,this.location=W,this.startTimePos=null,this.startDpq=null,this.stopTimePos=null,this.stopDpq=null,this.firstLocation=null,this.voicesMap={}},y.get=function(){return this.check(),this.fillVoices(),this.searchVoicesTupletBounds(),this.fillVoicesTimePos(),this.searchFirstLocation(),this.searchLastLocation(),this.fillVoicesData(),this.fillVoicesTimePosShift(),this.fillDynamics(),this.fillWords(),this.fillOctaveShifts(),this.fillTempoChanges(),this.fillPedals(),this.fillWedges(),this.fillHarmonies(),this.generateData()},y.check=function(){this.checkLocation(),this.checkRevertRange(),this.checkStaffConsistent()},y.checkLocation=function(){const V=this.location.partIdx,W=this.scoreData.getNbParts();if(V<0||V>=W)throw new f.default(V,f.default.GET);this.measuresScroller=(0,D.A)(this.scoreData,this.location);const Z=this.location.startMeasureIdx,dt=this.location.stopMeasureIdx,at=this.scoreData.getNbMeasures();let B;if(B=Z,B<0||B>=at)throw new e.default(B,e.default.GET);if(B=dt,B<0||B>=at)throw new e.default(B,e.default.GET);const gt=this.location.startNoteIdx,lt=this.location.stopNoteIdx;let X,k,L,$;B=Z,$=this.location.startVoiceIdx,L=gt,X=this.measuresScroller.getMeasureData(B),X.checkVoiceIdx($),k=X.getVoice($),k.checkNoteIdx(L),B=dt,L=lt,$=this.location.stopVoiceIdx,X=this.measuresScroller.getMeasureData(B),X.checkVoiceIdx($),k=X.getVoice($),k.checkNoteIdx(L)},y.checkRevertRange=function(){const V=this.location.startMeasureIdx,W=this.location.stopMeasureIdx,Z=W-V;if(Z<0)throw new c.default(c.default.MEASURE,V,W);if(Z===0){const dt=this.getStartTimePos(),at=this.getStopNoteTimePos();if(dt>at)throw new c.default(c.default.NOTE,this.location.startNoteIdx,this.location.stopNoteIdx)}},y.getStopNoteTimePos=function(){return this.measuresScroller.getMeasureData(this.location.stopMeasureIdx).getVoice(this.location.stopVoiceIdx).getRangeSpace(0,this.location.stopNoteIdx)},y.checkStaffConsistent=function(){const V=this.location.partIdx;if(this.staffIdx=this.scoreData.getPartVoiceMainStaffIdx(V,this.location.startVoiceIdx),this.scoreData.getPartVoiceMainStaffIdx(V,this.location.stopVoiceIdx)!==this.staffIdx)throw new s.A(this.location.stopVoiceIdx,this.staffIdx,V)},y.fillVoices=function(){this.scoreData.getPartVoicesIndexes(this.location.partIdx).forEach(this.fillVoice,this)},y.fillVoice=function(V){const W=this.getStartTimePos(),Z=this.getStopTimePos(),dt=this.getStartDpq(),at=this.getStopDpq(),B={startMeasureIdx:this.location.startMeasureIdx,startTimePos:W,startDpq:dt,stopMeasureIdx:this.location.stopMeasureIdx,stopTimePos:Z,stopDpq:at},gt=(0,M.A)(this.measuresScroller,B,V);gt!==null&&(this.voicesMap[V]=gt)},y.getStartTimePos=function(){if(this.startTimePos===null){const W=this.measuresScroller.getMeasureData(this.location.startMeasureIdx).getVoice(this.location.startVoiceIdx);this.startTimePos=W.getRangeSpace(0,this.location.startNoteIdx)}return this.startTimePos},y.getStopTimePos=function(){if(this.stopTimePos===null){const W=this.measuresScroller.getMeasureData(this.location.stopMeasureIdx).getVoice(this.location.stopVoiceIdx),Z=W.getNote(this.location.stopNoteIdx),dt=p.default.getDuration(Z);this.stopTimePos=W.getRangeSpace(0,this.location.stopNoteIdx)+dt}return this.stopTimePos},y.getStartDpq=function(){if(this.startDpq===null){const V=this.measuresScroller.getMeasureData(this.location.startMeasureIdx);this.startDpq=V.getDpqValue()}return this.startDpq},y.getStopDpq=function(){if(this.stopDpq===null){const V=this.measuresScroller.getMeasureData(this.location.stopMeasureIdx);this.stopDpq=V.getDpqValue()}return this.stopDpq},y.searchVoicesTupletBounds=function(){K.default.forEach(this.voicesMap,this.searchVoiceTupletBounds,this)},y.searchVoiceTupletBounds=function(V,W){if(W!==null){const Z=x(this.measuresScroller,W);W.startNoteIdx=Z.startNoteIdx,W.stopNoteIdx=Z.stopNoteIdx}},y.fillVoicesTimePos=function(){K.default.forEach(this.voicesMap,this.fillVoiceTimePos,this)},y.fillVoiceTimePos=function(V,W){V=parseInt(V,0);const dt=this.measuresScroller.getMeasureData(W.startMeasureIdx).getVoice(V);W.startTimePos=dt.getRangeSpace(0,W.startNoteIdx);const B=this.measuresScroller.getMeasureData(W.stopMeasureIdx).getVoice(V),gt=B.getNote(W.stopNoteIdx),lt=p.default.getDuration(gt);W.stopTimePos=B.getRangeSpace(0,W.stopNoteIdx)+lt},y.searchFirstLocation=function(){const W=K.default.getValues(this.voicesMap).map(F);this.firstLocation=W.reduce(N)};const F=function(V){return{measureIdx:V.startMeasureIdx,timePos:V.startTimePos}},N=function(V,W){return V.measureIdx<W.measureIdx?V:W.measureIdx<V.measureIdx?W:V.timePos<W.timePos?V:W};y.searchLastLocation=function(){const W=K.default.getValues(this.voicesMap).map(G);this.lastLocation=W.reduce(nt)};const G=function(V){return{measureIdx:V.stopMeasureIdx,timePos:V.stopTimePos}},nt=function(V,W){return V.measureIdx>W.measureIdx?V:W.measureIdx>V.measureIdx?W:V.timePos>W.timePos?V:W};y.fillVoicesTimePosShift=function(){K.default.forEach(this.voicesMap,this.fillVoiceTimePosShift,this)},y.fillVoiceTimePosShift=function(V,W){let Z=0,dt=1,at=this.firstLocation.measureIdx;for(;at<=W.startMeasureIdx;){const B=this.measuresScroller.getMeasureData(at),gt=B.getDpqValue(),lt=S.default.lcm(dt,gt);Z*=lt/dt,dt=lt;const X=B.getMeasure();let k=H.default.getNbDivisions(X);if(k*=lt/gt,Z+=k,at===this.firstLocation.measureIdx){const L=this.firstLocation.timePos*lt/gt;Z-=L}if(at===W.startMeasureIdx){const L=W.startTimePos*lt/gt;Z-=k-L}at++}W.timePosShift=Z,W.dpq=dt},y.fillVoicesData=function(){K.default.forEach(this.voicesMap,this.fillVoiceData,this)},y.fillVoiceData=function(V,W){V=parseInt(V,0);const Z={partIdx:this.location.partIdx,voiceIdx:W.voiceIdx,startMeasureIdx:W.startMeasureIdx,startNoteIdx:W.startNoteIdx,stopMeasureIdx:W.stopMeasureIdx,stopNoteIdx:W.stopNoteIdx},dt=(0,d.A)(this.scoreData,Z,this.measuresScroller);W.data=dt},y.fillDynamics=function(){const V={partIdx:this.location.partIdx,staffIdx:this.staffIdx,startMeasureIdx:this.firstLocation.measureIdx,startTimePos:this.firstLocation.timePos,stopMeasureIdx:this.lastLocation.measureIdx,stopTimePos:this.lastLocation.timePos};V.startDpq=this.getMeasureDpq(V.startMeasureIdx),V.stopDpq=this.getMeasureDpq(V.stopMeasureIdx),this.dynamics=(0,i.A)(this.scoreData,V)},y.fillWords=function(){const V={partIdx:this.location.partIdx,staffIdx:this.staffIdx,startMeasureIdx:this.firstLocation.measureIdx,startTimePos:this.firstLocation.timePos,stopMeasureIdx:this.lastLocation.measureIdx,stopTimePos:this.lastLocation.timePos};V.startDpq=this.getMeasureDpq(V.startMeasureIdx),V.stopDpq=this.getMeasureDpq(V.stopMeasureIdx),this.words=(0,a.A)(this.scoreData,V)},y.fillOctaveShifts=function(){const V={partIdx:this.location.partIdx,staffIdx:this.staffIdx,startMeasureIdx:this.firstLocation.measureIdx,startTimePos:this.firstLocation.timePos,stopMeasureIdx:this.lastLocation.measureIdx,stopTimePos:this.lastLocation.timePos};V.startDpq=this.getMeasureDpq(V.startMeasureIdx),V.stopDpq=this.getMeasureDpq(V.stopMeasureIdx),this.octaveShifts=(0,o.A)(this.scoreData,V)},y.fillTempoChanges=function(){const V={partIdx:this.location.partIdx,staffIdx:this.staffIdx,startMeasureIdx:this.firstLocation.measureIdx,startTimePos:this.firstLocation.timePos,stopMeasureIdx:this.lastLocation.measureIdx,stopTimePos:this.lastLocation.timePos};V.startDpq=this.getMeasureDpq(V.startMeasureIdx),V.stopDpq=this.getMeasureDpq(V.stopMeasureIdx),this.tempoChanges=T(this.scoreData,V)},y.fillPedals=function(){const V={partIdx:this.location.partIdx,staffIdx:this.staffIdx,startMeasureIdx:this.firstLocation.measureIdx,startTimePos:this.firstLocation.timePos,stopMeasureIdx:this.lastLocation.measureIdx,stopTimePos:this.lastLocation.timePos};V.startDpq=this.getMeasureDpq(V.startMeasureIdx),V.stopDpq=this.getMeasureDpq(V.stopMeasureIdx),this.pedals=(0,_.A)(this.scoreData,V)},y.fillWedges=function(){const V={partIdx:this.location.partIdx,staffIdx:this.staffIdx,startMeasureIdx:this.firstLocation.measureIdx,startTimePos:this.firstLocation.timePos,stopMeasureIdx:this.lastLocation.measureIdx,stopTimePos:this.lastLocation.timePos};V.startDpq=this.getMeasureDpq(V.startMeasureIdx),V.stopDpq=this.getMeasureDpq(V.stopMeasureIdx),this.wedges=(0,g.A)(this.scoreData,V)},y.fillHarmonies=function(){if(this.staffIdx===0){const V={partIdx:this.location.partIdx,startMeasureIdx:this.firstLocation.measureIdx,startTimePos:this.firstLocation.timePos,stopMeasureIdx:this.lastLocation.measureIdx,stopTimePos:this.lastLocation.timePos};V.startDpq=this.getMeasureDpq(V.startMeasureIdx),V.stopDpq=this.getMeasureDpq(V.stopMeasureIdx),this.harmonies=(0,E.A)(this.scoreData,V)}else this.harmonies=[]},y.getMeasureDpq=function(V){const W=this.getMeasure(V);return H.default.getDpq(W)},y.getMeasure=function(V){return this.scoreData.getMeasure(this.location.partIdx,V)},y.generateData=function(){return{voices:this.generateVoices(),dynamics:this.dynamics,words:this.words,octaveShifts:this.octaveShifts,tempoChanges:this.tempoChanges,pedals:this.pedals,wedges:this.wedges,jazzHarmonies:this.harmonies}},y.generateVoices=function(){return this.scoreData.getPartStaffVoicesIndexes(this.location.partIdx,this.staffIdx).map(this.getVoiceData,this)},y.getVoiceData=function(V){if(typeof this.voicesMap[V]!="undefined"){const W=this.voicesMap[V];return{data:W.data,timePosShift:W.timePosShift,dpq:W.dpq}}else return null};const J=Y},707926:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(35802),s=t(104907),c=t(627300);function d(r){f.default.getAllRawAttributes(r).forEach(i)}function i(r){e.default.getStaffDetails(r).forEach(a)}function a(r){if(!s.default.hasStaffTuning(r))return;const n=s.default.getStaffTunings(r);n&&(n.sort(o),s.default.setStaffTunings(r,n))}function o(r,n){const u=c.default.getLine(r),l=c.default.getLine(n);return u-l}},718477:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(c){const d=`There is no harmony at the index [${c}].`;super(d),Object.defineProperty(this,"harmonyIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadHarmonyIdxError",this.harmonyIdx=c}}},723777:(O,A,t)=>{t.d(A,{A:()=>h});var f=t(365340),e=t(701387),s=t(123491),c=t(706650);const d="notations",i="technical",a="ornaments",o="articulations",r=["glissando","slide","slur","tuplet"],n=["arpeggiate","fermata"],u=["down-bow","fingering","fret","open-string","snap-pizzicato","string","up-bow"],l=["bend","hammer-on","harmonic","pull-off"];function h(U){e.default.getNotes(U).forEach(I)}function I(U){const x=f.default.getArray(U,d);if(x.length===0)return;const S=x.reduce(P),K=E(x);if(K.length>0){const C=K.reduce(_);c.A.setTechnical(S,C)}const H=M(x);if(H.length>0){const C=H.reduce(g);c.A.setOrnaments(S,C)}const Y=m(x);if(Y.length>0){const C=Y.reduce(T);c.A.setArticulations(S,C)}s.default.setNotations(U,S)}function P(U,x){return r.forEach(S=>{const K=f.default.getArray(U,S),H=f.default.getArray(x,S),Y=K.concat(H);f.default.setArray(U,S,Y)}),n.forEach(S=>{const K=f.default.getArray(U,S),H=f.default.getArray(x,S),Y=K.concat(H);Y.length>0&&(U[S]=Y[0])}),U}function T(U,x){return Object.assign(U,x),U}function _(U,x){return l.forEach(S=>{const K=f.default.getArray(U,S),H=f.default.getArray(x,S),Y=K.concat(H);f.default.setArray(U,S,Y)}),u.forEach(S=>{const K=f.default.getArray(U,S),H=f.default.getArray(x,S),Y=K.concat(H);Y.length>0&&(U[S]=Y[0])}),U}function g(U,x){return Object.assign(U,x),U}function E(U){const x=U.map(D);return Array.prototype.concat.apply([],x)}function D(U){return f.default.getArray(U,i)}function M(U){const x=U.map(p);return Array.prototype.concat.apply([],x)}function p(U){return f.default.getArray(U,a)}function m(U){const x=U.map(v);return Array.prototype.concat.apply([],x)}function v(U){return f.default.getArray(U,o)}},727629:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(35802),e=t(721247),s=t(701387),c=t(446921),d=t(383279);function i(r,n){r.forEach(function(u,l){if(!d.default.hasUnpitched(u))return;const h=n[l];c.A.getMeasures(h).forEach(a)})}function a(r){s.default.getAllRawAttributes(r).forEach(o)}function o(r){let n=f.default.getClef(r);n=n.map(u=>e.default.isPercussion(u)?u:e.default.createPercussion()),f.default.setClef(r,n)}},730260:(O,A,t)=>{t.d(A,{A:()=>nt});var f=t(348742),e=t(383279),s=t(446921),c=t(701387),d=t(35802),i=t(721247),a=t(123491);const o=function(J){const V={instrumentsIds:[],unpitchedMap:{}};return s.A.getMeasures(J).forEach(r,V),V.instrumentsIds},r=function(J){const V=this;c.default.getNotes(J).forEach(n,V)},n=function(J){const V=this;if(!a.default.hasUnpitched(J))return;const W=a.default.getUnpitchedStr(J);typeof V.unpitchedMap[W]=="undefined"&&(V.unpitchedMap[W]={});const Z=a.default.getHead(J);typeof V.unpitchedMap[W][Z]=="undefined"&&(V.unpitchedMap[W][Z]=u(V.instrumentsIds));const dt=V.unpitchedMap[W][Z];a.default.setInstrumentId(J,dt)},u=function(J){const V=`I${J.length}`;return J.push(V),V},l=o;var h=t(226804),I=t(856219),P=t(886190);const T="Woodblock",_="77",g=function(J,V){const W=E(V);e.default.setScoreInstruments(J,W);const Z=M(V);e.default.setMIDIInstruments(J,Z)},E=function(J){return J.map(D)},D=function(J){const V=h.default.create(T);return h.default.setId(V,J),V},M=function(J){return J.map(p)},p=function(J){const V=I.default.createMIDIInstrument(P.default.UNPITCHED_PROGRAM);return I.default.setId(V,J),I.default.setMIDIChannel(V,P.default.PERCUSSION_CHANNEL),I.default.setUnpitched(V,_),V},m=g;var v=t(351277),U=t(292681);const x=function(J){s.A.getMeasures(J).forEach(S)},S=function(J){c.default.getNotes(J).forEach(K)},K=function(J){if(a.default.hasPitch(J)){const V=a.default.getPitch(J),W=v.default.getStep(V),Z=v.default.getOctave(V),dt=U.default.create(Z,W);J.unpitched=dt,delete J.pitch}},H=x,Y=function(J,V){let W=0;for(;W<J.length;){const Z=V[W],dt=J[W];C(dt,Z)?G(dt,Z)?W++:(J.splice(W,1),V.splice(W,1)):W++}if(J.length===0)throw new f.A("NoPartRemaining")},C=function(J,V){return y(V)&&!e.default.hasUnpitched(J)},y=function(J){const V=s.A.getFirstMeasure(J),W=c.default.getOwnAttributes(V),Z=d.default.getClef(W);if(Z.length===0)return F(J);const dt=Z[0];return i.default.getSign(dt)==="percussion"},F=function(J){return s.A.getMeasures(J).some(N)},N=function(J){return c.default.getNotes(J).some(a.default.hasUnpitched)},G=function(J,V){H(V);const W=l(V);return W.length>0?(m(J,W),!0):!1},nt=Y},733982:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(852363),e=t(343568);const s=function(i,a,o){this.init(i,a,o)};s.NAME="primitive.IncreaseDivisions";const c=s.prototype;c.name=s.NAME,c.initMeasureData=e.A,c.init=function(i,a,o){this.initMeasureData(i,a),this.cancelStack=o},c.perform=function(){this.measureData.getDivisions().multiplyDivisions(this.opts.coeff),this.updateStack()},c.updateStack=function(){const i={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,coeff:this.opts.coeff}};this.cancelStack.push(i),(0,f.default)(this.cancelStack,this.measureData,this.opts)};const d=s},734246:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(c){super(`Bad index in staff [${c}] for voice insertion.`),Object.defineProperty(this,"idxInStaff",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadIdxInStaffError",this.idxInStaff=c}}},739071:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(952818),s=t(309357);const c=function(o){if(f.default.hasDirections(o)){const r=f.default.getImportMapping(o);let n=f.default.getRawDirections(o);n=n.filter(d,r),n.forEach(i,r),f.default.setDirections(o,n)}},d=function(o){const r=this,u=e.A.getNoteBefore(o)+1;return typeof r[u]!="undefined"||typeof r[u-1]!="undefined"},i=function(o){const r=this;(0,s.A)(o,r,e.A)},a=c},742153:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(701387),e=t(746641),s=t(579102),c=t(838603),d=t(35802);function i(n){n.forEach(a)}function a(n,u,l){if(u===0)o(n);else{const h=l[u-1];r(n,h)}}function o(n){const u=f.default.getNbStaves(n),l=new e.A([],u,s.A);for(let P=0;P<u;P++)if(f.default.hasMeasureRepeat(n,P)){let T=f.default.getMeasureRepeat(n,P);T=c.A.copy(T),c.A.makeStart(T);const _={};s.A.setMeasureRepeat(_,T),l.setEntry(_,P)}const h=l.dumpAttribute(),I=f.default.getOwnAttributes(n);d.default.setMeasureStyle(I,h),f.default.setOwnAttributes(n,I)}function r(n,u){const l=f.default.getNbStaves(n),h=new e.A([],l,s.A);for(let T=0;T<l;T++)if(f.default.hasMeasureRepeat(u,T)&&!f.default.hasMeasureRepeat(n,T)){const _=c.A.createStop(),g={};s.A.setMeasureRepeat(g,_),h.setEntry(g,T)}else if(!f.default.hasMeasureRepeat(u,T)&&f.default.hasMeasureRepeat(n,T)){let _=f.default.getMeasureRepeat(n,T);_=c.A.copy(_),c.A.makeStart(_);const g={};s.A.setMeasureRepeat(g,_),h.setEntry(g,T)}const I=h.dumpAttribute(),P=f.default.getOwnAttributes(n);d.default.setMeasureStyle(P,I),f.default.setOwnAttributes(n,P)}},742862:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(343818),e=t(883782),s=t(539203),c=t(203066),d=t(94622);const a=function(o,r){o.checkPartIdx(r.partIdx),o.checkMeasureIdx(r.measureIdx);const n=(0,s.A)(o,r),u=n.getMeasureData(r.measureIdx);if(!o.hasPartVoiceIdx(r.partIdx,r.voiceIdx))throw new e.default(r.voiceIdx);u.hasVoice(r.voiceIdx)&&u.getVoice(r.voiceIdx).checkNoteIdx(r.noteIdx);const l={},h=(0,c.A)(n,r);if(h===null)throw new f.A;l.startMeasureIdx=h.measureIdx,l.startNoteIdx=h.noteIdx;const I=(0,d.A)(n,r);if(I===null)throw new f.A;return l.stopMeasureIdx=I.measureIdx,l.stopNoteIdx=I.noteIdx,l}},742956:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(248670);function e(u,l){if(typeof u.indexedRefs[l]!="undefined")return u.indexedRefs[l];{const h={timePos:l},I=f.A.searchFirstInsertionIdx(u.orderedRefs,h,s),{noteBefore:P}=u.orderedRefs[I];return P}}const s=function(u,l){return u.timePos-l.timePos};var c=t(701387),d=t(721247),i=t(35802),a=t(819795),o=t(474072);function r(u,l){const h=c.default.getNbStaves(u),I=c.default.getExportMapping(u,l),P=c.default.getAllRawAttributes(u),T=c.default.getDpq(u);for(let _=0;_<h;_++){const E=c.default.getMiddleClefs(u,_).map(n,{exportMapping:I,staffIdx:_,dpq:T});Array.prototype.push.apply(P,E)}c.default.setRawAttributes(u,P)}const n=function(u){const{exportMapping:l,staffIdx:h,dpq:I}=this,P=d.default.getTimePos(u),T=e(l[h],P),_={},g=d.default.copy(u);return a.A.setStaffIdx(g,h),i.default.setClef(_,[g]),o.A.setTimePos(_,P),o.A.setDpq(_,I),o.A.setIsFirst(_,!1),o.A.setNoteBeforeIdx(_,T),_}},743377:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(951066);class e extends f.A{constructor(d){const i=s(d);super(i),Object.defineProperty(this,"nbMeasures",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadNbMeasuresError",this.nbMeasures=d}}const s=function(c){return`The number of measures [${c}] is invalid. It has to be a positive non null integer`}},744103:(O,A,t)=>{t.d(A,{A:()=>D});var f=t(701387),e=t(558280),s=t(956722),c=t(891921),d=t(26698),i=t(21738),a=t(779146),o=t(409200),r=t(665280),n=t(118824);const u=function(M,p){(0,i.default)(M,p),(0,a.default)(M,p),(0,o.default)(M,p),(0,r.default)(M,p);const m={hasLeftContinue:l,searchLeftStart:h,getEntities:I,createStart:P,createStop:T,hasRightContinue:_,searchRightStop:g,createEntry:E,isEntityStart:e.A.isLeft,isEntityStop:e.A.isRight},v=new n.A(M,p,m);return v.checkPreconditions(),v.get()},l=function(){const M=this.getMeasure(this.location.startMeasureIdx);return f.default.hasLeftWedge(M,this.location.staffIdx)},h=function(){const M=this.getMeasures(),p=(0,s.A)(M,this.location.startMeasureIdx,this.location.staffIdx,0),m=this.getMeasure(p.startMeasureIdx),v=f.default.getDpq(m);return{measureIdx:p.startMeasureIdx,timePos:p.startTimePos,dpq:v,placement:p.placement,type:p.type}},I=function(M){const p=this.getMeasure(M);return f.default.getWedges(p,this.location.staffIdx)},P=function(M,p){const m=e.A.getTimePos(M),v=e.A.getPlacement(M),U=e.A.getType(M),x=this.getMeasure(p),S=f.default.getDpq(x);return{measureIdx:p,timePos:m,dpq:S,placement:v,type:U}},T=function(M,p){const m=e.A.getTimePos(M),v=this.getMeasure(p),U=f.default.getDpq(v);return{measureIdx:p,timePos:m,dpq:U}},_=function(){const M=this.getMeasure(this.location.stopMeasureIdx);return f.default.hasRightWedge(M,this.location.staffIdx)},g=function(){const M=this.getMeasures(),p=(0,s.A)(M,this.location.stopMeasureIdx+1,this.location.staffIdx,0),m=this.getMeasure(p.stopMeasureIdx),v=f.default.getDpq(m);return{measureIdx:p.stopMeasureIdx,timePos:p.stopTimePos,dpq:v}},E=function(M,p){const m={startMeasureIdx:M.measureIdx,startMeasureUuid:this.scoreData.getMeasureUuid(M.measureIdx),startTimePos:M.timePos,startDpq:M.dpq,stopMeasureIdx:p.measureIdx,stopMeasureUuid:this.scoreData.getMeasureUuid(p.measureIdx),stopTimePos:p.timePos,stopDpq:p.dpq,placement:M.placement,type:M.type},v=this.location.partIdx,U=1;m.startVoiceIdx=this.getVoiceIdx(M.measureIdx),m.startVoiceUuid=this.scoreData.getPartVoiceUuid(this.location.partIdx,m.startVoiceIdx);const x=this.getVoice(M.measureIdx);m.startNoteIdx=(0,c.A)(x,U,M.timePos),m.startIdxInStaff=this.scoreData.voiceIdxToIdxInMainStaff(v,m.startVoiceIdx),m.stopVoiceIdx=this.getVoiceIdx(p.measureIdx),m.stopVoiceUuid=this.scoreData.getPartVoiceUuid(this.location.partIdx,m.stopVoiceIdx);const S=this.getVoice(p.measureIdx);return m.stopNoteIdx=(0,d.A)(S,U,p.timePos),m.stopIdxInStaff=this.scoreData.voiceIdxToIdxInMainStaff(v,m.stopVoiceIdx),m},D=u},747164:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(365340),e=t(548830),s=t(383279),c=t(646319);function d(o){const r=o.getPartsHeaders(),u=e.A.getGroups(r).map(i,r),l=o.getScorePartWise();f.default.setArray(l["part-list"],"part-group",u)}function i(o){const r=this,n=o.map(a,r);return c.A.create(n)}function a(o){const n=this[o];return s.default.getId(n)}},749138:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(364842),e=t(123491),s=t(852363),c=t(161733),d=t(343568);const i=function(r,n,u){this.init(r,n,u)};i.NAME="primitive.SetGraceAccidental";const a=i.prototype;a.initMeasureData=d.A,a.name=i.NAME,a.init=function(r,n,u){this.initMeasureData(r,n),this.cancelStack=u,this.opts=n},a.perform=function(){const r=this.getGraceAtPitch();e.default.setAccidental(r,this.opts.accidental),this.updateStack()},a.getGraceAtPitch=function(){const r=this.measureData.getVoice(this.opts.voiceIdx),n=(0,c.A)(r,this.opts.noteIdx,this.opts.graceIdx,this.opts.pitch);if(typeof n=="undefined")throw new f.default("NoGraceAtPitch");return n},a.updateStack=function(){const r={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx}};this.cancelStack.push(r),(0,s.default)(this.cancelStack,this.measureData,this.opts)};const o=i},750002:(O,A,t)=>{t.d(A,{A:()=>I});var f=t(443749),e=t(607682);class s extends e.default{constructor(D){super(`The dynamic uuid "${D} is invalid."`),Object.defineProperty(this,"dynamicUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadDynamicUuidError",this.dynamicUuid=D}}var c=t(883782),d=t(496819),i=t(701387),a=t(726042),o=t(21738),r=t(131220),n=t(665280),u=t(409200),l=t(507004),h=t(189247);function I(E,D){if((0,o.default)(E,D),(0,r.default)(E,D),(0,u.default)(E,D),(0,n.default)(E,D),E.checkPartIdx(D.partIdx),E.checkMeasureIdx(D.measureIdx),!E.hasPartVoiceIdx(D.partIdx,D.voiceIdx))throw new c.default(D.voiceIdx);const M=E.getMeasure(D.partIdx,D.measureIdx),p=D.staffIdx,m=i.default.getNbStaves(M);if(!a.default.isInteger(p)||p<0||p>=m)throw new f.default(p);const U=i.default.getDynamics(M,D.staffIdx).find(P,D);if(!U)throw new s(D.dynamicUuid);const x=d.A.getStyle(U),S=i.default.getDpq(M),K=g(U),H=d.A.getTimePos(U),Y=d.A.getPlacement(U),C={partIdx:D.partIdx,staffIdx:p,measureIdx:D.measureIdx,dpq:S,timePos:H,style:x,sound:K,placement:Y},y=T(E,D,C);return Object.assign(C,y),_(C,E),C}function P(E){return d.A.getDynamicUuid(E)===this.dynamicUuid}function T(E,D,M){const p={searchedVoiceIdx:D.voiceIdx,staffVoicesIndexes:E.getPartStaffVoicesIndexes(D.partIdx,D.staffIdx),measureIdx:D.measureIdx,timePos:M.timePos,dpq:M.dpq},m=E.getPartMeasures(D.partIdx),v=new h.A(m,D.partIdx,E);return(0,l.A)(v,p)}function _(E,D){E.measureUuid=D.getMeasureUuid(E.measureIdx),E.voiceUuid=D.getPartVoiceUuid(E.partIdx,E.voiceIdx),E.partUuid=D.getPartUuid(E.partIdx),E.staffUuid=D.getPartStaffUuid(E.partIdx,E.staffIdx)}function g(E){return d.A.hasSound(E)?d.A.getSound(E):null}},751117:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(701387),e=t(123491);function s(d){f.default.getNotes(d).forEach(c)}function c(d){if(!e.default.hasFingering(d))return;if(e.default.getFingerings(d).length>0){const a=e.default.getFingering(d);e.default.setFingering(d,a)}else e.default.removeFingering(d)}},756042:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(364842),e=t(372585),s=t(701387),c=t(345912);const d=function(n,u,l,h){const I=new i(n,u,l,h);return I.search(),I.getResult()},i=function(n,u,l,h){this.init(n,u,l,h)},a=i.prototype;a.init=function(n,u,l,h){this.measures=n,this.entryMeasureIdx=u,this.entryTimePos=h,this.entryStaffIdx=l,this.candidateMeasureIdx=null,this.directionsByMeasures={},this.startTimePos=null,this.startMeasureIdx=null,this.stopTimePos=null,this.stopMeasureIdx=null,this.placement=null},a.search=function(){this.searchStart(),this.isStartAtEntry()&&this.shiftEntryTimePos(),this.searchStop()},a.searchStart=function(){for(this.candidateMeasureIdx=this.entryMeasureIdx;this.candidateMeasureIdx>=0&&!this.hasFoundStart();this.candidateMeasureIdx--)this.searchStartMeasure();if(!this.hasFoundStart()){const n="We were not able to find the octave shift left side.";throw new f.default("OctaveShiftStartNotFound",n)}},a.searchStartMeasure=function(){let n=this.getOctaveShiftDirectionsAtCandidateMeasure();this.isEntryMeasure()&&(n=this.filterLowerOrEqual(n)),this.searchStartTimePos(n)},a.filterLowerOrEqual=function(n){const u=[],l=n.length;for(let h=0;h<l;h++){const I=n[h];if(c.A.getTimePos(I)>this.entryTimePos)return u;u.push(I)}return u},a.searchStartTimePos=function(n){const u=n.length;for(let l=u-1;l>=0&&!this.hasFoundStart();l--){const h=n[l],I=c.A.getType(h);(I===e.A.UP||I===e.A.DOWN)&&this.startFound(h,h)}},a.hasFoundStart=function(){return this.startMeasureIdx!==null},a.startFound=function(n){const u=c.A.getTimePos(n);this.startTimePos=u,this.startMeasureIdx=this.candidateMeasureIdx,this.placement=c.A.getPlacement(n),this.type=c.A.getType(n),this.size=c.A.getSize(n)},a.isStartAtEntry=function(){return this.startMeasureIdx===this.entryMeasureIdx&&this.startTimePos===this.entryTimePos},a.shiftEntryTimePos=function(){this.entryTimePos++},a.searchStop=function(){const n=this.measures.length;for(this.candidateMeasureIdx=this.entryMeasureIdx;this.candidateMeasureIdx<n&&!this.hasFoundStop();this.candidateMeasureIdx++)this.searchStopMeasure();if(!this.hasFoundStop()){const u="We were not able to find the octave shift right side.";throw new f.default("OctaveShiftStopNotFound",u)}},a.searchStopMeasure=function(){let n=this.getOctaveShiftDirectionsAtCandidateMeasure();this.isEntryMeasure()&&(n=this.filterGreaterOrEqual(n)),this.searchStopTimePos(n)},a.getOctaveShiftDirectionsAtCandidateMeasure=function(){if(typeof this.directionsByMeasures[this.candidateMeasureIdx]=="undefined"){const n=this.measures[this.candidateMeasureIdx],u=s.default.getOctaveShifts(n,this.entryStaffIdx);u.sort(o),this.directionsByMeasures[this.candidateMeasureIdx]=u}return this.directionsByMeasures[this.candidateMeasureIdx]};const o=function(n,u){const l=c.A.getTimePos(n),h=c.A.getTimePos(u);return l-h};a.isEntryMeasure=function(){return this.candidateMeasureIdx===this.entryMeasureIdx},a.filterGreaterOrEqual=function(n){const u=[],l=n.length;for(let h=l-1;h>=0;h--){const I=n[h];if(c.A.getTimePos(I)<this.entryTimePos)return u;u.unshift(I)}return u},a.searchStopTimePos=function(n){const u=n.length;for(let l=0;l<u&&!this.hasFoundStop();l++){const h=n[l];c.A.getType(h)===e.A.STOP&&this.stopFound(h)}},a.hasFoundStop=function(){return this.stopMeasureIdx!==null},a.stopFound=function(n){const u=c.A.getTimePos(n);this.stopTimePos=u,this.stopMeasureIdx=this.candidateMeasureIdx},a.getResult=function(){return{startMeasureIdx:this.startMeasureIdx,startTimePos:this.startTimePos,stopMeasureIdx:this.stopMeasureIdx,stopTimePos:this.stopTimePos,placement:this.placement,type:this.type,size:this.size}};const r=d},759972:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(364842),e=t(843678);function s(c,d){return e.default.map(c,function(a,o){return e.default.map(o,function(n,u){if(n==="default")return u;{const{midiUnpitched:l,midiProgram:h}=u;if(typeof d[l]=="undefined")throw new f.default("Unxpected",`The midiUnpitched ${l} is not in the mapping.`);if(typeof d[l][h]=="undefined")throw new f.default("Unxpected",`The midiUnpitched/midiProgram ${l}/${h} is not in the mapping.`);return d[l][h]}})})}},760016:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(555172);const s=function(i){f.default.getBarlines(i).forEach(c)},c=function(i){if(e.A.hasRepeat(i)){const a=e.A.getRepeat(i);delete a.winged,delete a.$time}},d=s},760447:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(701387),e=t(555172);function s(i){const a=c(i),o=d(i),r=[];a&&r.push(a),o&&r.push(o),f.default.setBarlines(i,r)}function c(i){return f.default.getBarlines(i).find(e.A.isLeft)}function d(i){const a=f.default.getBarlines(i).slice();return a.reverse(),a.find(e.A.isRight)}},765135:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(443749),e=t(410114),s=t(536949),c=t(701387),d=t(726042),i=t(21738),a=t(131220),o=t(665280);const n=function(u,l){(0,i.default)(u,l),(0,a.default)(u,l),(0,o.default)(u,l),u.checkPartIdx(l.partIdx),u.checkMeasureIdx(l.measureIdx);const h=u.getMeasure(l.partIdx,l.measureIdx),I=l.staffIdx,P=c.default.getNbStaves(h);if(!d.default.isInteger(I)||I<0||I>=P)throw new f.default(I);const T=c.default.getPizzicatos(h,l.staffIdx),_=T.length,g=l.pizzicatoIdx;if(!d.default.isInteger(g)||g<0||g>=_)throw new e.A(g);const E=T[g];return{type:s.A.getType(E)}}},765851:(O,A,t)=>{t.d(A,{A:()=>g});var f=t(952818),e=t(375950),s=t(97324);const c=function(E){return E=new d(E).group(),E},d=function(E){this.init(E)},i=d.prototype;i.init=function(E){this.wrappedDirections=E,this.ongoingPluckedRanges={},this.previousLocation={},this.grouppedDirections=[]},i.group=function(){return this.wrappedDirections.forEach(this.analyzePluckedRange,this),this.grouppedDirections},i.analyzePluckedRange=function(E){const D=E.direction,M=f.A.getPluckedRange(D),p=e.A.getType(M);s.A.assert(p),p===s.A.CONTINUE||(s.A.isStart(p)?this.startPluckedRange(E):s.A.isStop(p)&&this.stopPluckedRange(E))},i.startPluckedRange=function(E){const D=E.direction,M=f.A.getTimePos(D),p=f.A.getStaffIdx(D),m=this.previousLocation[p];(!m||!a(m,E.measureIdx,M))&&this.addPluckedRangeStart(p,E)};const a=function(E,D,M){return E.measureIdx===D&&E.timePos===M};i.addPluckedRangeStart=function(E,D){this.ongoingPluckedRanges[E]=D},i.stopPluckedRange=function(E){const D=E.direction,M=f.A.getStaffIdx(D);if(this.hasPluckedRangeStart(M)){const p=this.getWrappedStart(M),m=p.direction;if(o(m,D)&&!r(p,E)){this.addCompletePluckedRange(p,E);const v=f.A.getTimePos(D);this.previousLocation[M]={timePos:v,measureIdx:p.measureIdx}}this.discardDirection(M)}},i.hasPluckedRangeStart=function(E){return typeof this.ongoingPluckedRanges[E]!="undefined"},i.getWrappedStart=function(E){return this.ongoingPluckedRanges[E]},i.discardDirection=function(E){delete this.ongoingPluckedRanges[E]};const o=function(E,D){const M=f.A.getPlacement(E),p=f.A.getPlacement(D),m=f.A.getStaffIdx(E),v=f.A.getStaffIdx(D);return M===p&&m===v},r=function(E,D){return E.timePos===D.timePos&&E.measureIdx===D.measureIdx};i.addCompletePluckedRange=function(E,D){this.grouppedDirections.push(E),this.grouppedDirections.push(D)};const n=c;var u=t(101341),l=t(817066),h=t(537920),I=t(701387),P=t(364842);const T=function(E){const D=E.length;let M=(0,u.A)(E),p=M.map(l.A);p=p.map(n),M=p.map(function(m){return(0,h.A)(m,D)}),M.forEach(_,E)},_=function(E,D){const M=this;if(M.length!==E.length){const p="Array size should be the same.";throw new P.default("NotSameSize",p)}M.forEach(function(p,m){const v=E[m];I.default.setPluckedRanges(p,D,v)})},g=T},770011:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(701387),e=t(614653),s=t(141624);const c=function(u){return u=new d(u).filter(),u},d=function(u){this.init(u)},i=d.prototype;i.init=function(u){this.sourceHarmonies=u,this.filtered=[],this.stack=[]},i.filter=function(){return this.sourceHarmonies.forEach(this.filterHarmony,this),this.isStackEmpty()||this.flushStack(),this.filtered},i.filterHarmony=function(u){this.canPushInStack(u)||this.flushStack(),this.stack.push(u)},i.canPushInStack=function(u){if(this.isStackEmpty())return!0;const l=e.default.getTimePos(u),h=this.getStackTimePos();return l===h},i.isStackEmpty=function(){return this.stack.length===0},i.getStackTimePos=function(){const u=this.stack[0];return e.default.getTimePos(u)},i.flushStack=function(){const u=this.stack.reduce(a);this.stack=[],this.filtered.push(u)};const a=function(u,l){const h=e.default.getStaffIdx(u),I=e.default.getStaffIdx(l);if(h<I)return u;if(I<h)return l;const P=e.default.getPlacement(u),T=e.default.getPlacement(l);return P===s.A.ABOVE&&T===s.A.BELOW?u:l},o=c,n=function(u){let l=f.default.getRawHarmonies(u);l=l.filter(e.default.isSupported),l.sort(e.default.compareTimePos);let h=l.filter(e.default.isJazz);h=o(h),f.default.setJazzHarmonies(u,h);let I=l.filter(e.default.isClassic);I=o(I),I.forEach(e.default.normalizeClassic),f.default.setClassicHarmonies(u,I)}},770649:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(589501),s=t(309357);const c=function(o){let r=f.default.getFiguredBasses(o);r=r.filter(e.A.isSupported);const n=f.default.getImportMapping(o);r=r.filter(d,n),r.forEach(i,n),f.default.setFiguredBasses(o,r)},d=function(o){const r=this,u=e.A.getNoteBefore(o)+1;return typeof r[u]!="undefined"||typeof r[u-1]!="undefined"},i=function(o){const r=this;(0,s.A)(o,r,e.A)},a=c},771539:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(701387),e=t(123491),s=t(712947),c=t(794799),d=t(832560);function i(r){const n=this.valueOf();if(!f.default.getNotes(r).some(e.default.hasGraceSlur))return;new d.A(r).forEachVoice(h=>{const I=h.getNbNotes();for(let P=0;P<I;P++){const T=h.getNote(P);if(!e.default.hasGraceSlur(T)||!h.hasGrace(P))continue;const g=h.getGrace(P,0);a(g,n),o(T,n)}})}function a(r,n){const u=s.default.create(c.A.START);s.default.setLevel(u,n);const l=e.default.getSlurs(r);l.push(u),e.default.setSlurs(r,l)}function o(r,n){const u=s.default.create(c.A.STOP);s.default.setLevel(u,n);const l=e.default.getSlurs(r);l.push(u),e.default.setSlurs(r,l)}},782540:(O,A,t)=>{t.d(A,{A:()=>v});var f=t(702544),e=t(153271),s=t(857552),c=t(476943),d=t(123491),i=t(351277),a=t(209175),o=t(515819),r=t(292681),n=t(50060),u=t(377180),l=t(104907),h=t(890439),I=t(737903),P=t(364596),T=t(870437),_=t(832560);const g=function(U,x,S){const K=p(),H=K.get(U,x,S);return K.cleanUp(),H},E=function(){},D=E.prototype;D.get=function(U,x,S){return this.reset(U,x),this.checkLocation(S),this.searchTupletStart(),this.searchTupletStop(),this.extractAttributes(),this.isUnpitched=this.scoreData.isPartUnpitched(this.location.partIdx),this.extractNotes(),this.extractSlurs(),{isUnpitched:this.isUnpitched,notes:this.notes,ties:this.ties,slurs:this.slurs,attributes:this.attributes}},D.reset=function(U,x){this.scoreData=U,this.location=x,this.measureData=null,this.voice=null,this.dpq=null,this.attributes={},this.notes=[],this.ties=[],this.slurs=[],this.noteIdx=null,this.noteData=null,this.headData=null},D.checkLocation=function(U){if(typeof U=="undefined"){const H=this.location.partIdx,Y=this.scoreData.getNbParts();if(H<0||H>=Y)throw new f.default(H,f.default.GET);const C=this.scoreData.getNbMeasures(),y=this.location.measureIdx;if(y<0||y>=C)throw new e.default(y,e.default.GET);const F=this.scoreData.getMeasure(H,y);U=new _.A(F),U.checkVoiceIdx(this.location.voiceIdx)}this.measureData=U;const x=U.getVoice(this.location.voiceIdx),S=this.location.startNoteIdx,K=this.location.stopNoteIdx;if(x.checkNoteIdx(S),x.checkNoteIdx(K),K<S)throw new s.default(s.default.NOTE,S,K);this.voice=x,this.dpq=U.getDpqValue()},D.searchTupletStart=function(){let U=this.location.startNoteIdx,x=this.voice.getNote(U);if(!d.default.hasNormalTimeModif(x)){for(;!d.default.hasTupletStart(x);)U--,x=this.voice.getNote(U);this.location.startNoteIdx=U}},D.searchTupletStop=function(){let U=this.location.stopNoteIdx,x=this.voice.getNote(U);if(!d.default.hasNormalTimeModif(x)){for(;!d.default.hasTupletStop(x);)U++,x=this.voice.getNote(U);this.location.stopNoteIdx=U}},D.extractAttributes=function(){const U=this.scoreData.getPartVoiceMainStaffIdx(this.location.partIdx,this.location.voiceIdx);this.attributes.transpose=u.default.copy(this.measureData.getTranspose(U)),this.attributes.staffDetails=l.default.copy(this.measureData.getStaffDetails(U)),this.attributes.key=P.default.copy(this.measureData.getKey(U))},D.extractNotes=function(){const U=this.location.startNoteIdx,x=this.location.stopNoteIdx;for(let S=U;S<=x;S++)this.noteIdx=S,this.voice.isRest(S)?this.extractRest():this.extractChord()},D.extractRest=function(){const U={isRest:!0},x=this.voice.getNote(this.noteIdx);this.extractDuration(x,U),this.notes.push(U)},D.extractChord=function(){const U=this.voice.getNote(this.noteIdx);this.noteData={heads:[]},this.extractDuration(U,this.noteData),this.extractNoteLyrics(U),(d.default.hasNotations(U)||d.default.hasArticulations(U))&&(this.noteData.articulations=h.Ay.fromList(d.default.getFullArticulationsList(U))),d.default.hasOrnaments(U)&&(this.noteData.ornaments=d.default.getOrnamentsWithOpts(U)),d.default.hasTechnicals(U)&&(this.noteData.technicals=h.Ay.fromList(d.default.getTechnicalList(U))),c.default.makeArray(this.voice.getChord(this.noteIdx)).forEach(this.extractNoteHead,this),this.notes.push(this.noteData)},D.extractNoteLyrics=function(U){const x=d.default.getLyrics(U).slice();x.sort(n.default.compare);const S=x.map(M);this.noteData.lyrics=S};const M=function(U){const x=n.default.getText(U),S=n.default.hasRightConnection(U),K=n.default.getLevel(U);return{text:x,hasRightConnection:S,level:K}};D.extractDuration=function(U,x){const S=d.default.getNormalQuarterDuration(U,this.dpq),K=o.default.quarterToDurationOpts(S);if(x.nbDots=K.nbDots,x.durationType=K.durationType,d.default.hasTupletStart(U)){const Y=d.default.getTupletStart(U,1),C=d.default.getTimeModif(U),y=T.A.getDurationType(Y);x.tuplet={durationType:y,timeModif:a.default.copy(C)}}},D.extractNoteHead=function(U){this.headData={},this.isUnpitched?this.extractUnpitchedHead(U):this.extractPitchedHead(U),this.noteData.heads.push(this.headData)},D.extractUnpitchedHead=function(U){const x=d.default.getUnpitched(U);this.headData.unpitched=r.default.copy(x),this.headData.notehead=d.default.getHead(U);const S=d.default.getInstrumentId(U);this.headData.MIDIUnpitched=this.scoreData.searchInstrumentMIDIUnpitched(this.location.partIdx,S)},D.extractPitchedHead=function(U){const x=d.default.getPitch(U);this.headData.pitch=i.default.copy(x);let S;this.isFirstNote(this.noteIdx)&&d.default.hasTieStop(U)&&(S=i.default.copy(x),S.noteIdx=this.noteIdx-(1+this.location.startNoteIdx),this.ties.push(S)),!this.isLastNote()&&d.default.hasTieStart(U)&&(S=i.default.copy(x),S.noteIdx=this.noteIdx-this.location.startNoteIdx,this.ties.push(S)),d.default.hasTabData(U)&&(this.headData.fretData=d.default.getTabData(U))},D.isLastNote=function(){return this.noteIdx===this.location.stopNoteIdx},D.isFirstNote=function(){return this.noteIdx===this.location.startNoteIdx},D.extractSlurs=function(){let U=null;const x=this.location.startNoteIdx,S=this.location.stopNoteIdx;for(let K=x;K<=S;K++){const H=this.voice.getNote(K);d.default.hasSlurStart(H)?(U=(0,I.default)(this.location),U.startNoteIdx=K-this.location.startNoteIdx):d.default.hasSlurStop(H)&&U!==null&&(U.stopNoteIdx=K-this.location.startNoteIdx,this.slurs.push(U),U=null)}},D.cleanUp=function(){this.scoreData=null,this.location=null,this.measureData=null,this.voice=null,this.dpq=null,this.attributes=null,this.notes=null,this.ties=null,this.slurs=null,this.noteIdx=null,this.noteData=null,this.headData=null};const p=function(){return m===null&&(m=new E),m};let m=null;const v=g},783265:(O,A,t)=>{t.d(A,{A:()=>D});var f=t(862790),e=t(916502),s=t(607682);class c extends s.default{constructor(p){const m=`There is no wedge at the index [${p}].`;super(m),Object.defineProperty(this,"wedgeIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadWedgeIdxError",this.wedgeIdx=p}}var d=t(726042),i=t(123491),a=t(701387),o=t(558280),r=t(446921),n=t(544342),u=t(956722),l=t(891921),h=t(26698),I=t(189247);const P=function(M,p){const m=new T(M,p);return m.checkPreconditions(),m.get()},T=function(M,p){this.init(M,p)},_=T.prototype;_.init=function(M,p){this.scoreData=M,this.location=p,this.measuresScroller=null,this.targetTimePos=null},_.checkPreconditions=function(){this.checkLocation(),this.sanitize(),this.checkExistence()},_.checkLocation=function(){this.scoreData.checkPartIdx(this.location.partIdx),this.scoreData.checkMeasureIdx(this.location.measureIdx),this.getMeasureData(this.location.measureIdx).checkVoiceIdx(this.location.voiceIdx)},_.sanitize=function(){if(typeof this.location.wedgeIdx!="undefined"){const M=this.getTargetMeasure(),p=a.default.getWedges(M,this.location.staffIdx);if(!d.default.isInteger(this.location.wedgeIdx)||this.location.wedgeIdx>=p.length)throw new c(this.location.wedgeIdx);const m=p[this.location.wedgeIdx];this.targetTimePos=o.A.getTimePos(m)}else if(typeof this.location.noteIdx!="undefined"){const M=this.getTargetVoice();M.checkNoteIdx(this.location.noteIdx),this.targetTimePos=g(M,this.location.noteIdx)}else throw new e.default("noteIdx OR wedgeIdx")};const g=function(M,p){let m=0;for(let v=0;v<p;v++){const U=M.getNote(v),x=i.default.getDuration(U);m+=x}return m};_.getTargetVoice=function(){return this.getMeasureData(this.location.measureIdx).getVoice(this.location.voiceIdx)},_.checkExistence=function(){if(!this.hasWedge())throw new f.A},_.hasWedge=function(){const M=this.getTargetMeasure(),p=a.default.getWedges(M,this.location.staffIdx),m=E(M,this.location.staffIdx);return(0,n.A)(m,p,this.targetTimePos)!==null},_.getTargetMeasure=function(){return this.scoreData.getMeasure(this.location.partIdx,this.location.measureIdx)};const E=function(M,p){return a.default.hasLeftWedge(M,p)?a.default.getLeftWedge(M,p):null};_.get=function(){this.searchSides(),this.convertSidesToNoteIdx();const M={type:this.type,placement:this.placement};return this.addLocationData(M),M},_.addLocationData=function(M){const p=this.location.partIdx,m=this.scoreData.voiceIdxToIdxInMainStaff(p,this.startVoiceIdx),v=this.scoreData.voiceIdxToIdxInMainStaff(p,this.stopVoiceIdx);M.startMeasureIdx=this.startMeasureIdx,M.startVoiceIdx=this.startVoiceIdx,M.startIdxInStaff=m,M.startNoteIdx=this.startNoteIdx,M.stopMeasureIdx=this.stopMeasureIdx,M.stopVoiceIdx=this.stopVoiceIdx,M.stopIdxInStaff=v,M.stopNoteIdx=this.stopNoteIdx},_.searchSides=function(){const M=this.getMeasures(),p=(0,u.A)(M,this.location.measureIdx,this.location.staffIdx,this.targetTimePos);this.startMeasureIdx=p.startMeasureIdx,this.startTimePos=p.startTimePos,this.stopMeasureIdx=p.stopMeasureIdx,this.stopTimePos=p.stopTimePos,this.type=p.type,this.placement=p.placement},_.getMeasures=function(){const M=this.scoreData.getPartContent(this.location.partIdx);return r.A.getMeasures(M)},_.convertSidesToNoteIdx=function(){this.convertLeftSide(),this.convertRightSide()},_.convertLeftSide=function(){const M=this.getLeftVoice(),p=1;this.startNoteIdx=(0,l.A)(M,p,this.startTimePos)},_.getLeftVoice=function(){const M=this.getMeasureData(this.startMeasureIdx);if(M.hasVoice(this.location.voiceIdx))this.startVoiceIdx=this.location.voiceIdx;else{let m=this.scoreData.getPartStaffVoicesIndexes(this.location.partIdx,this.location.staffIdx);m=m.filter(M.hasVoice,M),this.startVoiceIdx=m[0]}return M.getVoice(this.startVoiceIdx)},_.convertRightSide=function(){const M=this.getRightVoice(),p=1;this.stopNoteIdx=(0,h.A)(M,p,this.stopTimePos)},_.getRightVoice=function(){const M=this.getMeasureData(this.stopMeasureIdx);if(M.hasVoice(this.location.voiceIdx))this.stopVoiceIdx=this.location.voiceIdx;else{let m=this.scoreData.getPartStaffVoicesIndexes(this.location.partIdx,this.location.staffIdx);m=m.filter(M.hasVoice,M),this.stopVoiceIdx=m[0]}return M.getVoice(this.stopVoiceIdx)},_.getMeasureData=function(M){return this.getMeasuresScroller().getMeasureData(M)},_.getMeasuresScroller=function(){if(this.measuresScroller===null){const M=this.location.partIdx,p=this.scoreData.getPartContent(M),m=r.A.getMeasures(p);this.measuresScroller=new I.A(m,M,this.scoreData)}return this.measuresScroller};const D=P},783417:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(701387),e=t(368495),s=t(101341),c=t(817066),d=t(231189);const i=function(n){(0,s.A)(n).map(c.A).forEach(function(h){new a(h,n).fillPluckedRanges()})},a=function(n,u){this.init(n,u)},o=a.prototype;o.init=function(n,u){this.wrappedPluckedRanges=n,this.measures=u,this.measuresScroller=null},o.fillPluckedRanges=function(){const n=this.wrappedPluckedRanges.length;for(let u=0;u<n-1;u+=2){const l=this.wrappedPluckedRanges[u],h=this.wrappedPluckedRanges[u+1];this.fillPluckedRange(l,h)}},o.fillPluckedRange=function(n,u){const l=n.measureIdx,h=u.measureIdx;this.addContinues(l,h,n)},o.addContinues=function(n,u,l){for(let h=n;h<u;h++)this.addContinue(h,l)},o.addContinue=function(n,u){const l=e.A.getStaffIdx(u.direction),h=e.A.getPlacement(u.direction),I=e.A.getTimePos(u.direction),P=e.A.getType(u.direction),T=this.measures[n],_=e.A.create(l,h,I,P,d.A.RIGHT);f.default.setRightPluckedRange(T,l,_);const g=this.measures[n+1],E=e.A.create(l,h,I,P,d.A.LEFT);f.default.setLeftPluckedRange(g,l,E)};const r=i},783751:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(364842),s=t(555172);function c(d){const i=f.default.getDpq(d),a=f.default.getNbNotes(d),o=f.default.getNbDivisions(d);f.default.getBarlines(d).forEach(n=>{if(s.A.setDpq(n,i),s.A.isLeft(n))s.A.setTimePos(n,0),s.A.setNoteBefore(n,-1);else if(s.A.isRight(n))s.A.setTimePos(n,o),s.A.setNoteBefore(n,a-1);else throw new e.default})}},784435:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(348742),e=t(701387),s=t(123491),c=t(209175);const d=function(n){const u=e.default.getNotes(n),l={duration:null,voiceIdx:null};u.forEach(i,l)},i=function(n){const u=this;if(s.default.isChord(n)){const{duration:l,timeModif:h}=a(u,n);s.default.isGraceNote(n)||s.default.setDuration(n,l),s.default.setTimeModif(n,h)}else o(u,n)},a=function(n,u){const l=s.default.getVoiceIdx(u);let h;if(n.duration===null)throw h="No former duration for the chord.",new f.A("NoFormerDuration",h);if(l!==n.voiceIdx)throw h=`Previous duration voiceIdx [${n.voiceIdx}] is different from the chord voiceIdx [${l}].`,new f.A("BadVoiceIdx",h);return{timeModif:c.default.copy(n.timeModif),duration:n.duration}},o=function(n,u){s.default.isRest(u)?(n.voiceIdx=null,n.duration=null,n.timeModif=null):(n.voiceIdx=s.default.getVoiceIdx(u),n.duration=s.default.getDuration(u),n.timeModif=s.default.getTimeModif(u))},r=d},788220:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(952818),e=t(717434);const s={};s.create=function(d,i,a,o){const r={};f.A.setPlacement(r,i),f.A.setStaffIdx(r,d),f.A.setTimePos(r,a);const n=e.A.createWord(o);return f.A.setEntry(r,n),r},s.isSame=function(d,i){const a=s.getTimePos(d),o=s.getTimePos(i),r=s.getStaffIdx(d),n=s.getStaffIdx(i),u=s.getPlacement(d),l=s.getPlacement(i),h=s.getText(d),I=s.getText(i);return a===o&&r===n&&u===l&&h===I},s.getTimePos=function(d){return f.A.getTimePos(d)},s.getStaffIdx=function(d){return f.A.getStaffIdx(d)},s.getPlacement=function(d){return f.A.getPlacement(d)},s.getText=function(d){return f.A.getWordText(d)},s.getWordUuid=function(d){return f.A.getDirectionUuid(d)},s.setWordUuid=function(d,i){f.A.setDirectionUuid(d,i)};const c=s},791981:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(724095),e=t(411993),s=t(123491),c=t(701387),d=t(562628),i=t(209175);const a=4;function o(l){new r(l).filter()}class r{constructor(h){this.measure=h,this.dpq=c.default.getDpq(h),this.tremoloStart=null}filter(){const h=c.default.getNotes(this.measure);h.forEach(this.removeIllegalTremolos,this);const I=e.A.groupVoices(h);for(const P in I){const T=I[P],_=(0,d.A)(T);this.filterNotes(_)}}removeIllegalTremolos(h){s.default.hasTremoloSide(h)&&(s.default.isRest(h)||s.default.isGraceNote(h)||s.default.isChord(h)||s.default.getNormalQuarterDuration(h,this.dpq)===a||s.default.hasUnpitched(h))&&s.default.removeOrnament(h,f.A.TREMOLO)}filterNotes(h){this.tremoloStart=null,h.forEach(this.filterChord,this),this.tremoloStart!==null&&(s.default.removeOrnament(this.tremoloStart,f.A.TREMOLO),this.tremoloStart=null)}filterChord(h){if(h.length===0){this.tremoloStart!==null&&(s.default.removeOrnament(this.tremoloStart,f.A.TREMOLO),this.tremoloStart=null);return}const[I]=h;s.default.hasTremoloStart(I)?(this.tremoloStart!==null&&(s.default.removeOrnament(this.tremoloStart,f.A.TREMOLO),this.tremoloStart=null),n(h)?s.default.removeOrnament(I,f.A.TREMOLO):this.tremoloStart=I):s.default.hasTremoloStop(I)?this.tremoloStart!==null?((s.default.getDuration(this.tremoloStart)!==s.default.getDuration(I)||!i.default.isSame(s.default.getTimeModif(this.tremoloStart),s.default.getTimeModif(I)))&&(s.default.removeOrnament(this.tremoloStart,f.A.TREMOLO),s.default.removeOrnament(I,f.A.TREMOLO)),this.tremoloStart=null):s.default.removeOrnament(I,f.A.TREMOLO):this.tremoloStart!==null&&(s.default.removeOrnament(this.tremoloStart,f.A.TREMOLO),this.tremoloStart=null)}}function n(l){return l.some(u)}function u(l){return s.default.hasTieStart(l)||s.default.hasSlideStart(l)||s.default.hasGlissandoStart(l)||s.default.hasHammerOnPullOffStart(l)}},796090:(O,A,t)=>{t.d(A,{A:()=>I});var f=t(364842),e=t(883782),s=t(607682);class c extends s.default{constructor(T){const _=`The slur uuid "${T} is invalid."`;super(_),Object.defineProperty(this,"slurUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadSlurUuidError",this.slurUuid=T}}var d=t(21738),i=t(409200),a=t(539203),o=t(94622),r=t(446921),n=t(123491),u=t(712947);const l=function(P,T){(0,d.default)(P,T),(0,i.default)(P,T),P.checkPartIdx(T.partIdx);const _=P.getPartContent(T.partIdx);if(!r.A.hasSlur(_,T.slurUuid))throw new c(T.slurUuid);const g=r.A.getSlur(_,T.slurUuid),E=P.getMeasureIdxFromUuid(g.measureUuid);P.checkMeasureIdx(E);const D=(0,a.A)(P,T),M=D.getMeasureData(E);if(!M.hasVoice(T.voiceIdx))throw new e.default(T.voiceIdx);const p=M.getVoice(T.voiceIdx),{noteIdx:m,placement:v}=h(p,T.slurUuid),U={startMeasureIdx:E,startMeasureUuid:P.getMeasureUuid(E),startNoteIdx:m,placement:v},x={measureIdx:E,noteIdx:m,voiceIdx:T.voiceIdx},S=(0,o.A)(D,x);if(S===null)throw new f.default("right slur side not found");U.stopMeasureIdx=S.measureIdx,U.stopMeasureUuid=P.getMeasureUuid(S.measureIdx),U.stopNoteIdx=S.noteIdx,U.voiceUuid=P.getPartVoiceUuid(T.partIdx,T.voiceIdx),U.partUuid=P.getPartUuid(T.partIdx);const K=P.getPartVoiceMainStaffIdx(T.partIdx,T.voiceIdx);return U.staffUuid=P.getPartStaffUuid(T.partIdx,K),U};function h(P,T){const _=P.getNbNotes();for(let g=0;g<_;g++){const E=P.getNote(g);if(n.default.hasSlurStart(E)){const D=n.default.getSlur(E);if(u.default.getUuid(D)===T){const p=u.default.getPlacement(D);return{noteIdx:g,placement:p}}}}throw new f.default("slur uuid do not match anything in the voice")}const I=l},797330:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(355832),e=t(805490),s=t(383279);function c(i){i.getPartsHeaders().forEach(d)}function d(i){if(!s.default.hasUnpitchedMapping(i))return;const a=s.default.getUnpitchedMapping(i),o=(0,e.A)(a,i),r=(0,f.default)(o);s.default.setLegacyPitchMapping(i,r)}},799761:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(446921),e=t(701387),s=t(737903);function c(d){const[i,...a]=d;f.A.getMeasures(i).forEach((r,n)=>{const u=e.default.getBarlines(r);a.forEach(l=>{const h=f.A.getMeasure(l,n),I=u.map(P=>(0,s.default)(P));e.default.setBarlines(h,I)})})}},799851:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(891921),e=t(26698);function s(a,o){const r=c(a,o),n=d(a,o);return{startVoiceIdx:r.voiceIdx,startNoteIdx:r.noteIdx,stopVoiceIdx:n.voiceIdx,stopNoteIdx:n.noteIdx}}function c(a,o){const r=a.getMeasureData(o.startMeasureIdx),n={};n.voiceIdx=i(r,o.searchedVoiceIdx,o.staffVoicesIndexes);const u=r.getVoice(n.voiceIdx),l=r.getDpqValue(),h=o.startDpq/l;return n.noteIdx=(0,f.A)(u,h,o.startTimePos),n}function d(a,o){const r=a.getMeasureData(o.stopMeasureIdx),n={};n.voiceIdx=i(r,o.searchedVoiceIdx,o.staffVoicesIndexes);const u=r.getVoice(n.voiceIdx),l=r.getDpqValue(),h=o.stopDpq/l;return n.noteIdx=(0,e.A)(u,h,o.stopTimePos),n}function i(a,o,r){return a.hasVoice(o)?o:r.filter(a.hasVoice,a)[0]}},801790:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(952818);const c=function(d){if(f.default.hasDirections(d)){const i=f.default.getRawDirections(d);i.sort(e.A.compareTimePos),f.default.setDirections(d,i)}}},803485:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(719476);function e(d){const i=d.getNbMeasures();for(let a=0;a<i;a+=1)s(d,a)}function s(d,i){const a=d.getCommonContent();if(!a.hasEnding(i))return;const o=a.getEnding(i);try{f.A.checkNumbers(o)}catch(r){a.removeEnding(i)}}const c=e},804211:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(951066);function e(c){return`The color value "${c}" is invalid.`}class s extends f.A{constructor(d){const i=e(d);super(i),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadColorError",this.color=d}}},804676:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(726042),e=t(701387),s=t(35802),c=t(377180);const d=12,i=7,a={0:0,2:1,5:3,7:4,9:5,10:6};function o(I){e.default.getAllRawAttributes(I).forEach(r)}function r(I){const P=s.default.getTranspose(I);P.forEach(n),P.forEach(u)}function n(I){let P=c.default.getChromatic(I),T=c.default.getDiatonic(I),_=c.default.getOctaveChange(I);const g=l(P),E=f.default.intPart(Math.abs(P)/d);E>0&&(_+=E*g,T=T%i,P=P%d,c.default.setChromatic(I,P),c.default.setDiatonic(I,T),c.default.setOctaveChange(I,_))}function u(I){if(!c.default.hasChromatic(I)||c.default.hasDiatonic(I))return;let P=c.default.getChromatic(I);const T=l(P);P=Math.abs(P);let _=h(P);typeof _!="undefined"&&(_*=T,c.default.setDiatonic(I,_))}function l(I){return I>=0?1:-1}function h(I){return a[I]}},805490:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(843678),e=t(383279),s=t(856219);function c(d,i){const a=e.default.getMIDIInstrumentsMap(i);return f.default.map(d,function(r,n){return n=f.default.map(n,function(u,l){if(u==="default")return l;{const h=a[l],I=s.default.getUnpitched(h),P=s.default.getMIDIProgram(h);return{midiUnpitched:I,midiProgram:P}}}),n})}},805793:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(726042);const s=function(o){const n=o.map(f.default.getStaffContentMap).reduce(c,0);return d(o,n)},c=function(o,r){return Object.keys(r).forEach(function(u){o=e.default.max2(o,e.default.toInt(u)+1)},this),o},d=function(o,r){const n=[];for(let u=0;u<r;u++){const l=o.map(i,u);n.push(l)}return n},i=function(o){const r=this.valueOf();return f.default.getWedges(o,r)},a=s},809650:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(364842),e=t(97324),s=t(368495);const c=function(n,u,l,h){u=u.sort(d);const I=new a(n,u,l,h);return I.search(),I.getPluckedRange()},d=function(n,u){const l=s.A.getTimePos(n),h=s.A.getTimePos(u),I=l-h;if(I!==0)return I;const P=s.A.getType(n),T=s.A.getType(u);return i(P,T)},i=function(n,u){return e.A.isStart(n)&&e.A.isStop(u)?1:e.A.isStop(n)&&e.A.isStart(u)?-1:0},a=function(n,u,l,h){this.init(n,u,l,h)},o=a.prototype;o.init=function(n,u,l,h){this.currentPluckedRange=n,this.pluckedRanges=u,this.searchedTimePosition=l,this.excludeBoundaries=!!h},o.search=function(){this.pluckedRanges.some(this.analyzePluckedRange,this)},o.analyzePluckedRange=function(n){const u=s.A.getTimePos(n);if(u>this.searchedTimePosition)return!0;const l=s.A.getType(n);return e.A.isStart(l)&&this.startPluckedRange(n),u===this.searchedTimePosition&&!this.excludeBoundaries?!0:(e.A.isStop(l)&&this.stopPluckedRange(),!1)},o.startPluckedRange=function(n){if(this.currentPluckedRange!==null)throw new f.default("Unexpected","There is already a octave shift");this.currentPluckedRange=n},o.stopPluckedRange=function(){if(this.currentPluckedRange===null){const n="There is no octave shift to stop.";throw new f.default("Unexpected",n)}else this.currentPluckedRange=null},o.getPluckedRange=function(){return this.currentPluckedRange};const r=c},811552:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(353922),e=t(701387),s=t(123491);function c(i){e.default.getNotes(i).forEach(d)}function d(i){if(!s.default.hasPitch(i)||!s.default.hasHead(i))return;const a=s.default.getHead(i);f.A.isValidPitched(a)||s.default.setHead(i,f.A.NORMAL)}},813864:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(364842),e=t(832560),s=t(189247),c=t(635120);const i=function(a){let o;if(a instanceof c.default)o=a;else if(a instanceof e.A||a instanceof s.A)o=a.getScoreData();else{const r="Data, MeasuresScroller or MeasureData instance expected. ";throw new f.default("Unexpected",r)}return o}},816679:(O,A,t)=>{t.d(A,{A:()=>f});function f(c,d,i){e(d,c),s(d,i)}function e(c,d){for(let i=0;i<c.nbBeams;i++)d!==null&&i<d.nbBeams?c.left.push(!0):c.left.push(!1)}function s(c,d){for(let i=0;i<c.nbBeams;i++)d!==null&&i<d.nbBeams?c.right.push(!0):c.right.push(!1)}},817066:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(952818);function e(r,n){const u=r.measureIdx-n.measureIdx;return u!==0?u:r.timePos-n.timePos}const s=function(r,n,u){const l=r.map(c,n);return typeof u!="function"&&(u=e),l.sort(u),l},c=function(r){const n=this.valueOf();return{timePos:f.A.getTimePos(r),measureIdx:n,direction:r}},d=s,i=function(r,n){const u=r.map(a,n);return Array.prototype.concat.apply([],u)};function a(r,n){return d(r,n,this)}const o=i},820686:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(446921),e=t(701387),s=t(123491);const c=function(r,n){f.A.getMeasures(r).forEach(d,n)},d=function(r){const n=this;let u=e.default.getNotes(r);u=u.filter(i,n),u.forEach(a,n),e.default.setNotes(r,u)},i=function(r){const n=this,u=s.default.getVoiceIdx(r);return typeof n[u]!="undefined"},a=function(r){const n=this,u=s.default.getVoiceIdx(r),l=n[u][0];s.default.setStaffIdx(r,l)},o=c},824573:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(348742),e=t(123491),s=t(209175),c=t(702868),d=t(832560);const i=function(r){new d.A(r).forEachVoice(a)},a=function(r){let n,u=!1;const l=r.size();for(let h=0;h<l;h++){const I=r.getNote(h);if(e.default.hasTupletStart(I)){if(e.default.getTupletStartLevel(I)>1)throw n="Nested tuplets are not supported.",new f.A("NestedTuplet",n);u=!0}const P=e.default.getTimeModif(I);if(!s.default.isNormal(P)&&!c.A.isTimeModifSupported(P))throw n=`The time modification [${s.default.stringify(P)}] is not supported.`,new f.A("TimeModif",n,s.default.copy(P));if(e.default.hasTupletStop(I))if(u)u=!1;else throw n="There is a tuplet stop without prior start.",new f.A("TupletStop",n)}},o=i},837525:(O,A,t)=>{t.d(A,{A:()=>S});var f=t(701387),e=t(952818),s=t(717434),c=t(234421),d=t(735178),i=t(868743);const a=function(K){return e.A.getEntries(K).some(o)},o=function(K){if(s.A.getType(K)!==d.A.PEDAL)return!1;const Y=s.A.getPedal(K),C=c.A.getType(Y);return i.A.isValid(C)},r=a;var n=t(584416);const u=function(K){const H=e.A.getStaffIdx(K),Y=e.A.getTimePos(K),C=e.A.getPlacement(K),y=l(K);return n.A.create(H,C,Y,y)},l=function(K){const Y=e.A.getEntries(K).find(h),C=s.A.getPedal(Y);return c.A.getType(C)},h=function(K){if(s.A.getType(K)!==d.A.PEDAL)return!1;const Y=s.A.getPedal(K),C=c.A.getType(Y);return i.A.isValid(C)},I=u,P=function(K){return E().extract(K)},T=function(){this.pedalsByStaff=null},_=T.prototype;_.extract=function(K){this.reset(),K.forEach(this.processDirection,this);const H=this.pedalsByStaff;return this.pedalsByStaff=null,H},_.reset=function(){this.pedalsByStaff={}},_.processDirection=function(K){if(r(K)){const H=I(K);this.addPedal(H)}},_.addPedal=function(K){const H=e.A.getStaffIdx(K);this.getStaffPedals(H).push(K)},_.getStaffPedals=function(K){return typeof this.pedalsByStaff[K]=="undefined"&&(this.pedalsByStaff[K]=[]),this.pedalsByStaff[K]};let g=null;const E=function(){return g===null&&(g=new T),g},D=P;var M=t(843678),p=t(726042);const m=function(K,H){M.default.forEach(H,v,K)},v=function(K,H){K=p.default.intPart(K);const Y=this;f.default.setPedals(Y,K,H)},U=m,S=function(K){const H=f.default.getRawDirections(K),Y=D(H);U(K,Y)}},838584:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(210888),e=t(701387),s=t(614653);function c(i){e.default.getAllHarmonies(i).forEach(d)}function d(i){const a=f.default.generate();s.default.setHarmonyUuid(i,a)}},844191:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(726042),e=t(701387),s=t(733982),c=t(536863);const d=function(o,r,n){this.init(o,r,n)};d.NAME="composite.AdaptDpqToPosition";const i=d.prototype;i.name=d.NAME,i.init=function(o,r,n){this.scoreData=o,this.cancelStack=n,this.opts=r,this.measure=null},i.perform=function(){this.needAdapt()&&this.adaptDpq()},i.needAdapt=function(){const o=this.getMeasure(),r=(0,c.A)(this.opts,o);return!f.default.isInteger(r)},i.adaptDpq=function(){this.cancelStack=this.cancelStack.createSubstack(this.name);const o=this.getCoeff();this.increaseDivisions(o)},i.getCoeff=function(){const o=this.getMeasure(),r=e.default.getDpq(o),n=this.opts.dpq;return f.default.lcm(r,n)/r},i.getMeasure=function(){return this.measure===null&&(this.measure=this.scoreData.getMeasure(this.opts.partIdx,this.opts.measureIdx)),this.measure},i.increaseDivisions=function(o){const r={partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx,coeff:o};new s.A(this.scoreData,r,this.cancelStack).perform()};const a=d},844342:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(123491),s=t(50060);const c=function(o){f.default.getNotes(o).forEach(d)};function d(o){let r=e.default.getLyrics(o);r=r.filter(i),e.default.setLyrics(o,r)}function i(o){return s.default.hasText(o)||s.default.hasLeftMelisma(o)}const a=c},851023:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(383279),e=t(446921),s=t(701387),c=t(104907),d=t(737903),i=t(21738),a=t(805490),o=t(99923);const n=function(u,l){l=(0,d.default)(l),(0,i.default)(u,l);const h=l.partIdx;if(u.checkPartIdx(h),!u.isPartUnpitched(h))throw new o.A;const I=u.getPartContent(h),P=0,T=0,_=e.A.getMeasure(I,P),E=s.default.getWrappedStaffDetails(_).getEntry(T),D=c.default.getNbStaffLines(E),M=u.getPartHeader(h);let p=f.default.getUnpitchedMapping(M);return p=(0,a.A)(p,M),{nbStaffLines:D,pitchMapping:(0,d.default)(p)}}},852654:(O,A,t)=>{t.d(A,{A:()=>I});var f=t(443749),e=t(607682);class s extends e.default{constructor(E){const D=`The pizzicato uuid "${E} is invalid."`;super(D),Object.defineProperty(this,"pizzicatoUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadPizzicatoUuidError",this.pizzicatoUuid=E}}var c=t(883782),d=t(536949),i=t(701387),a=t(726042),o=t(21738),r=t(131220),n=t(665280),u=t(409200),l=t(507004),h=t(189247);function I(g,E){if((0,o.default)(g,E),(0,r.default)(g,E),(0,u.default)(g,E),(0,n.default)(g,E),g.checkPartIdx(E.partIdx),g.checkMeasureIdx(E.measureIdx),!g.hasPartVoiceIdx(E.partIdx,E.voiceIdx))throw new c.default(E.voiceIdx);const D=g.getMeasure(E.partIdx,E.measureIdx),M=E.staffIdx,p=i.default.getNbStaves(D);if(!a.default.isInteger(M)||M<0||M>=p)throw new f.default(M);const v=i.default.getPizzicatos(D,E.staffIdx).find(P,E);if(!v)throw new s(E.pizzicatoUuid);const U=d.A.getType(v),x=i.default.getDpq(D),S=d.A.getTimePos(v),K=d.A.getPlacement(v),H={partIdx:E.partIdx,staffIdx:M,measureIdx:E.measureIdx,dpq:x,timePos:S,type:U,placement:K},Y=T(g,E,H);return Object.assign(H,Y),_(H,g),H}function P(g){return d.A.getPizzicatoUuid(g)===this.pizzicatoUuid}function T(g,E,D){const M={searchedVoiceIdx:E.voiceIdx,staffVoicesIndexes:g.getPartStaffVoicesIndexes(E.partIdx,E.staffIdx),measureIdx:E.measureIdx,timePos:D.timePos,dpq:D.dpq},p=g.getPartMeasures(E.partIdx),m=new h.A(p,E.partIdx,g);return(0,l.A)(m,M)}function _(g,E){g.measureUuid=E.getMeasureUuid(g.measureIdx),g.voiceUuid=E.getPartVoiceUuid(g.partIdx,g.voiceIdx),g.partUuid=E.getPartUuid(g.partIdx),g.staffUuid=E.getPartStaffUuid(g.partIdx,g.staffIdx)}},857715:(O,A,t)=>{t.d(A,{A:()=>l});var f=t(352363),e=t(773948),s=t(372585),c=t(39573),d=t(832560),i=t(476943),a=t(123491),o=t(351277),r=t(345912),n=t(701387);const u=36;function l(T){const _=T.getFormatVersion();if(_===0||_>=u||typeof T["action.RemoveNote"]=="undefined"||typeof T["action.DeleteGraceNote"]=="undefined"||typeof T["action.RemoveGraceFromChord"]=="undefined")return;new h().process(T)}class h{process(_){this.scoreData=_;const g=this.scoreData.getNbParts();this.nbMeasures=this.scoreData.getNbMeasures();for(let E=0;E<g;E++)this.processPart(E)}processPart(_){if(!this.scoreData.isPartUnpitched(_)){this.partIdx=_;for(let g=0;g<this.nbMeasures;g++)this.processMeasure(g)}}processMeasure(_){this.measureIdx=_;const g=this.scoreData.getMeasure(this.partIdx,this.measureIdx);I(g)&&(this.measureData=new d.A(g),this.measureData.forEachVoice(this.processVoice,this))}processVoice(_,g){this.voiceIdx=g,this.voice=_;const E=_.getNbNotes();for(let D=E-1;D>=0;D--)this.processNote(D)}processNote(_){if(this.noteIdx=_,this.voice.isRest(_))return;const g=this.voice.getNote(_),E=a.default.getStaffIdx(g),D=(0,c.A)(this.measureData,{partIdx:this.partIdx,measureIdx:this.measureIdx,voiceIdx:this.voiceIdx,noteIdx:_,staffIdx:E});D&&(this.octaveChange=P(D),this.processGraces(),this.processChord())}processGraces(){const _=this.voice.getNbGraces(this.noteIdx);for(let g=0;g<_;g++)this.processGraceChord(g)}processGraceChord(_){this.graceIdx=_;let g=this.voice.getGraceChord(this.noteIdx,this.graceIdx);g=i.default.makeArray(g).slice(),g.forEach(this.processGraceHead,this)}processGraceHead(_){const g=a.default.getPitch(_),D=o.default.getOctave(g)+this.octaveChange;f.default.isValid(D)||this.removeGraceHead(g)}removeGraceHead(_){const g=this.getRemoveGraceAction(),E={partIdx:this.partIdx,measureIdx:this.measureIdx,voiceIdx:this.voiceIdx,noteIdx:this.noteIdx,graceIdx:this.graceIdx,pitch:o.default.copyWithoutAlter(_)};this.scoreData[g](E)}getRemoveGraceAction(){let _=this.voice.getGraceChord(this.noteIdx,this.graceIdx);return _=i.default.makeArray(_),_.length>1?"action.RemoveGraceFromChord":"action.DeleteGraceNote"}processChord(){let _=this.voice.getChord(this.noteIdx);_=i.default.makeArray(_).slice(),_.forEach(this.processHead,this)}processHead(_){const g=a.default.getPitch(_),D=o.default.getOctave(g)+this.octaveChange;f.default.isValid(D)||this.removeHead(g)}removeHead(_){const g={partIdx:this.partIdx,measureIdx:this.measureIdx,voiceIdx:this.voiceIdx,noteIdx:this.noteIdx,pitch:o.default.copyWithoutAlter(_)};this.scoreData["action.RemoveNote"](g)}}function I(T){const _=n.default.getNbStaves(T);for(let g=0;g<_;g++)if(n.default.hasLeftOctaveShift(T,g)||n.default.hasOctaveShifts(T,g))return!0;return!1}function P(T){const _=r.A.getSize(T),g=r.A.getType(T),E=e.A.sizeToOctaveShift(_);return g===s.A.DOWN?-E:E}},861535:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(446921),e=t(701387),s=t(35802),c=t(377180),d=t(721247),i=t(104907),a=t(123491),o=t(351277);const r=1;function n(_){const g=f.A.getFirstMeasure(_);if(u(g)){const E=f.A.getMeasures(_),D={octaveChange:null};E.forEach(l,D)}}function u(_){const g=e.default.getOwnAttributes(_);if(s.default.getNbStaves(g)!==1)return!1;const D=s.default.getWrappedStaffDetailsOrDefault(g,r).getEntry(0);return!!i.default.hasStaffTuning(D)}function l(_){const g=this,E=e.default.getOwnAttributes(_);h(E,g),g.octaveChange!==0&&g.octaveChange!==null&&(I(E,g),P(_,g))}function h(_,g){const E=s.default.getWrappedTranspose(_,r);if(E.hasEntry(0)){const D=E.getEntry(0),M=c.default.getOctaveChange(D);g.octaveChange=M,M!==0&&(c.default.setOctaveChange(D,0),s.default.setTranspose(_,E.dumpAttribute()))}}function I(_,g){const E=s.default.getWrappedClef(_,r);if(E.hasEntry(0)){const D=E.getEntry(0),M=d.default.getOctaveChange(D);d.default.setOctaveChange(D,M+g.octaveChange),s.default.setClef(_,E.dumpAttribute())}}function P(_,g){e.default.getNotes(_).forEach(T,g)}function T(_){const g=this;if(!a.default.hasPitch(_))return;const E=a.default.getPitch(_);let D=o.default.getOctave(E);D+=g.octaveChange,o.default.setOctave(E,D)}},862790:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(){super("There is no wedge at this location."),this.name="NoWedgeError"}}},862870:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(737903),e=t(701387),s=t(35802);const c=function(r){const n=r[0],u=i(r),l=d(n,u);r.slice(1).reduce(a,(0,f.default)(l))},d=function(r,n){const u={};s.default.setNbStaves(u,n);const l=e.default.getOwnDivisions(r);return s.default.setDivisions(u,l),e.default.setAttributes(r,u),(0,f.default)(u)},i=function(r){let n=0;for(let u=0;u<r.length;u++){const l=e.default.getOwnNbStaves(r[u]);l>n&&(n=l)}return n},a=function(r,n){if(e.default.hasOwnDivisions(n)){const u=e.default.getOwnDivisions(n);s.default.setDivisions(r,u)}return e.default.setAttributes(n,r),(0,f.default)(r)},o=c},865349:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(359363),e=t(74957),s=t(381216),c=t(464173);const d=new Map([[c.A.POWER,[e.A.create(5,s.A.ADD,0)]],[c.A.SUS_2,[e.A.create(2,s.A.ADD,0),e.A.create(5,s.A.ADD,0)]],[c.A.SUS_4,[e.A.create(4,s.A.ADD,0),e.A.create(5,s.A.ADD,0)]],[c.A.SUS_24,[e.A.create(2,s.A.ADD,0),e.A.create(4,s.A.ADD,0),e.A.create(5,s.A.ADD,0)]],[c.A.MAJOR,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0)]],[c.A.MINOR,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,0)]],[c.A.DIMINISHED,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,-1)]],[c.A.AUGMENTED,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1)]],[c.A.MAJOR_2,[e.A.create(2,s.A.ADD,0),e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0)]],[c.A.MINOR_2,[e.A.create(2,s.A.ADD,0),e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,0)]],[c.A.MAJOR_6,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0),e.A.create(6,s.A.ADD,0)]],[c.A.MINOR_6,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,0),e.A.create(6,s.A.ADD,0)]],[c.A.SIX_NINE,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0),e.A.create(6,s.A.ADD,0),e.A.create(9,s.A.ADD,0)]],[c.A.MINOR_69,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,0),e.A.create(6,s.A.ADD,0),e.A.create(9,s.A.ADD,0)]],[c.A.DOMINANT_7,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,0)]],[c.A.MAJOR_7,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,1)]],[c.A.MINOR_7,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,0)]],[c.A.MINOR_MAJOR_7,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,1)]],[c.A.AUGMENTED_7,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1),e.A.create(7,s.A.ADD,0)]],[c.A.AUGMENTED_MAJOR_7,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1),e.A.create(7,s.A.ADD,1)]],[c.A.HALF_DIMINISHED_7,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,-1),e.A.create(7,s.A.ADD,0)]],[c.A.DIMINISHED_7,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,-1),e.A.create(7,s.A.ADD,-1)]],[c.A.DOMINANT_7_6,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0),e.A.create(6,s.A.ADD,0),e.A.create(7,s.A.ADD,0)]],[c.A.DOMINANT_9,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0)]],[c.A.MAJOR_9,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,1),e.A.create(9,s.A.ADD,0)]],[c.A.MINOR_9,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0)]],[c.A.MINOR_MAJOR_9,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,1),e.A.create(9,s.A.ADD,0)]],[c.A.AUGMENTED_9,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0)]],[c.A.AUGMENTED_MAJOR_9,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1),e.A.create(7,s.A.ADD,1),e.A.create(9,s.A.ADD,0)]],[c.A.HALF_DIMINISHED_9,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,-1),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0)]],[c.A.DIMINISHED_9,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,-1),e.A.create(7,s.A.ADD,-1),e.A.create(9,s.A.ADD,0)]],[c.A.DOMINANT_11,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0)]],[c.A.MAJOR_11,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,1),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0)]],[c.A.MINOR_11,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0)]],[c.A.MINOR_MAJOR_11,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,1),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0)]],[c.A.AUGMENTED_11,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0)]],[c.A.AUGMENTED_MAJOR_11,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1),e.A.create(7,s.A.ADD,1),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0)]],[c.A.HALF_DIMINISHED_11,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,-1),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0)]],[c.A.DIMINISHED_11,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,-1),e.A.create(7,s.A.ADD,-1),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0)]],[c.A.DOMINANT_13,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0),e.A.create(13,s.A.ADD,0)]],[c.A.MAJOR_13,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,1),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0),e.A.create(13,s.A.ADD,0)]],[c.A.MINOR_13,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0),e.A.create(13,s.A.ADD,0)]],[c.A.MINOR_MAJOR_13,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,1),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0),e.A.create(13,s.A.ADD,0)]],[c.A.AUGMENTED_13,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0),e.A.create(13,s.A.ADD,0)]],[c.A.AUGMENTED_MAJOR_13,[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1),e.A.create(7,s.A.ADD,1),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0),e.A.create(13,s.A.ADD,0)]],[c.A.HALF_DIMINISHED_13,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,-1),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0),e.A.create(13,s.A.ADD,0)]],[c.A.DIMINISHED_13,[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,-1),e.A.create(7,s.A.ADD,-1),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0),e.A.create(13,s.A.ADD,0)]]]);function i(a){const o=d.get(a);return f.A.copy(o)}},867589:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(832560);const s=function(c,d,i){const a=d.partIdx;if(c.checkPartIdx(a),c.checkMeasureIdx(d.measureIdx),c.checkMeasureIdx(i.measureIdx),d.measureIdx!==i.measureIdx)return d.measureIdx-i.measureIdx;const o=c.getMeasure(a,d.measureIdx),r=new f.A(o);r.checkVoiceIdx(d.voiceIdx),r.checkVoiceIdx(i.voiceIdx);const n=r.getVoice(d.voiceIdx),u=r.getVoice(i.voiceIdx);n.checkNoteIdx(d.noteIdx),u.checkNoteIdx(i.noteIdx);const l=n.getRangeSpace(0,d.noteIdx),h=u.getRangeSpace(0,i.noteIdx);return l-h}},868224:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(476943),e=t(364842),s=t(615898);const c={};c.isUnified=function(o){if(c.isEmpty(o))return!1;const r=o[0];return s.A.isBoth(r)},c.isEmpty=function(o){return o.length===0},c.hasEven=function(o){return c.isUnified(o)?!0:o.some(s.A.isEven)},c.getEven=function(o){return c.isUnified(o)?c.getBoth(o):o.find(s.A.isEven)},c.hasOdd=function(o){return c.isUnified(o)?!0:o.some(s.A.isOdd)},c.getOdd=function(o){return c.isUnified(o)?c.getBoth(o):o.find(s.A.isOdd)},c.getBoth=function(o){return o[0]},c.setTop=function(o,r,n){if(n=s.A.typeOrDefault(n),n===s.A.TYPE_BOTH)c.setBothTop(o,r);else if(n===s.A.TYPE_EVEN)c.setEvenTop(o,r);else if(n===s.A.TYPE_ODD)c.setOddTop(o,r);else{const u=`invalid margin type: [${n}].`;throw new e.default("BadMarginType",u)}},c.setBottom=function(o,r,n){if(n=s.A.typeOrDefault(n),n===s.A.TYPE_BOTH)c.setBothBottom(o,r);else if(n===s.A.TYPE_EVEN)c.setEvenBottom(o,r);else if(n===s.A.TYPE_ODD)c.setOddBottom(o,r);else{const u=`invalid margin type: [${n}].`;throw new e.default("BadMarginType",u)}},c.setLeft=function(o,r,n){if(n=s.A.typeOrDefault(n),n===s.A.TYPE_BOTH)c.setBothLeft(o,r);else if(n===s.A.TYPE_EVEN)c.setEvenLeft(o,r);else if(n===s.A.TYPE_ODD)c.setOddLeft(o,r);else{const u=`invalid margin type: [${n}].`;throw new e.default("BadMarginType",u)}},c.setRight=function(o,r,n){if(n=s.A.typeOrDefault(n),n===s.A.TYPE_BOTH)c.setBothRight(o,r);else if(n===s.A.TYPE_EVEN)c.setEvenRight(o,r);else if(n===s.A.TYPE_ODD)c.setOddRight(o,r);else{const u=`invalid margin type: [${n}].`;throw new e.default("BadMarginType",u)}},c.setBothTop=function(o,r){c.setBothProp(o,r,s.A.setTop)},c.setBothBottom=function(o,r){c.setBothProp(o,r,s.A.setBottom)},c.setBothLeft=function(o,r){c.setBothProp(o,r,s.A.setLeft)},c.setBothRight=function(o,r){c.setBothProp(o,r,s.A.setRight)},c.setBothProp=function(o,r,n){c.isEmpty(o)?c.createBoth(o):c.isUnified(o)||c.merge(o);const u=c.getBoth(o);n(u,r)},c.setEvenTop=function(o,r){c.setEvenProp(o,r,s.A.setTop)},c.setEvenBottom=function(o,r){c.setEvenProp(o,r,s.A.setBottom)},c.setEvenLeft=function(o,r){c.setEvenProp(o,r,s.A.setLeft)},c.setEvenRight=function(o,r){c.setEvenProp(o,r,s.A.setRight)},c.setEvenProp=function(o,r,n){const u=c.getOrCreateSide(o,c.createEven,c.getEven);n(u,r)},c.setOddTop=function(o,r){c.setOddProp(o,r,s.A.setTop)},c.setOddBottom=function(o,r){c.setOddProp(o,r,s.A.setBottom)},c.setOddLeft=function(o,r){c.setOddProp(o,r,s.A.setLeft)},c.setOddRight=function(o,r){c.setOddProp(o,r,s.A.setRight)},c.setOddProp=function(o,r,n){const u=c.getOrCreateSide(o,c.createOdd,c.getOdd);n(u,r)},c.getOrCreateSide=function(o,r,n){return c.isEmpty(o)?r(o):c.isUnified(o)&&c.split(o),n(o)},c.split=function(o){const r=o[0],n=s.A.copy(r);o.push(n),s.A.setType(r,s.A.TYPE_ODD),s.A.setType(n,s.A.TYPE_EVEN)},c.merge=function(o){const r=o[0],n=o.length===2,u=o[1];if(!s.A.hasTop(r)&&n&&s.A.hasTop(u)){const l=s.A.getTop(u);s.A.setTop(r,l)}if(!s.A.hasBottom(r)&&n&&s.A.hasBottom(u)){const l=s.A.getBottom(u);s.A.setBottom(r,l)}if(!s.A.hasLeft(r)&&n&&s.A.hasLeft(u)){const l=s.A.getLeft(u);s.A.setLeft(r,l)}if(!s.A.hasRight(r)&&n&&s.A.hasRight(u)){const l=s.A.getRight(u);s.A.setRight(r,l)}s.A.setType(r,s.A.TYPE_BOTH),n&&o.pop()},c.createOdd=function(o){const r={};s.A.setType(r,s.A.TYPE_ODD),o.push(r)},c.createEven=function(o){const r={};s.A.setType(r,s.A.TYPE_EVEN),o.push(r)},c.createBoth=function(o){const r={};s.A.setType(r,s.A.TYPE_BOTH),o.push(r)};const d=c,i={};i.hasPageSize=function(o){return i.hasPageHeight(o)&&i.hasPageWidth(o)},i.hasPageHeight=function(o){return typeof o["page-height"]!="undefined"},i.hasPageWidth=function(o){return typeof o["page-width"]!="undefined"},i.getHeight=function(o){return parseFloat(o["page-height"])},i.getWidth=function(o){return parseFloat(o["page-width"])},i.setPageSize=function(o,r,n){i.setPageWidth(o,r),i.setPageHeight(o,n)},i.setPageHeight=function(o,r){o["page-height"]=r.toString()},i.setPageWidth=function(o,r){o["page-width"]=r.toString()},i.getMargins=function(o){return f.default.isArray(o["page-margins"])?o["page-margins"]:typeof o["page-margins"]!="undefined"?[o["page-margins"]]:[]},i.setMargins=function(o,r){r.length>1?o["page-margins"]=r:r.length===1?o["page-margins"]=r[0]:delete o["page-margins"]},i.setTopMargin=function(o,r,n){const u=i.getMargins(o);d.setTop(u,r,n),i.setMargins(o,u)},i.setBottomMargin=function(o,r,n){const u=i.getMargins(o);d.setBottom(u,r,n),i.setMargins(o,u)},i.setLeftMargin=function(o,r,n){const u=i.getMargins(o);d.setLeft(u,r,n),i.setMargins(o,u)},i.setRightMargin=function(o,r,n){const u=i.getMargins(o);d.setRight(u,r,n),i.setMargins(o,u)},i.hasMargins=function(o){return typeof o["page-margins"]!="undefined"},i.getMarginsForEvenOrDefault=function(o){return i.hasMarginsForEven(o)?i.getMarginsForEven(o):[s.A.createDefaultMargin()]},i.getMarginsForEven=function(o){const r=i.getMargins(o);return d.getEven(r)},i.hasMarginsForEven=function(o){const r=i.getMargins(o);return d.hasEven(r)},i.getMarginsForOddOrDefault=function(o){return i.hasMarginsForOdd(o)?i.getMarginsForOdd(o):[s.A.createDefaultMargin()]},i.getMarginsForOdd=function(o){const r=i.getMargins(o);return d.getOdd(r)},i.hasMarginsForOdd=function(o){const r=i.getMargins(o);return d.hasOdd(r)};const a=i},869607:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(d,i,a){super(s(d,i,a)),Object.defineProperty(this,"voiceIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"staffIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partIdx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="IncompatibleVoiceStaffIdxError",this.voiceIdx=d,this.staffIdx=i,this.partIdx=a}}const s=function(c,d,i){return`voiceIdx[${c}] is not binded to staff [${d}] in the part at index [${i}].`}},869783:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(476943),e=t(701387);function s(d){e.default.getNotes(d).forEach(c)}function c(d){if(f.default.isArray(d.duration)){const i=d.duration.length,a=d.duration[i-1];d.duration=a}}},870983:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(259563),e=t(701387),s=t(123491),c=t(515819);const d=function(o){const r=e.default.getNotes(o),n=e.default.getDpq(o);r.forEach(i,n)},i=function(o){if(s.default.isGraceNote(o))return;const r=this.valueOf(),n=s.default.getNormalQuarterDuration(o,r),u=c.default.extractBaseDuration(n);let l=f.default.quarterToDurationType(u);s.default.hasTremoloSide(o)&&l--,s.default.setDurationType(o,l)},a=d},871978:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(443749),e=t(607682);class s extends e.default{constructor(I){super(`The clef uuid '${I} is invalid.'`),Object.defineProperty(this,"clefUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadClefUuidError",this.clefUuid=I}}var c=t(721247),d=t(701387),i=t(726042),a=t(21738),o=t(131220),r=t(665280);function n(h,I){(0,a.default)(h,I),(0,o.default)(h,I),(0,r.default)(h,I),h.checkPartIdx(I.partIdx),h.checkMeasureIdx(I.measureIdx);const P=h.getMeasure(I.partIdx,I.measureIdx),T=I.staffIdx,_=d.default.getNbStaves(P);if(!i.default.isInteger(T)||T<0||T>=_)throw new f.default(T);const E=d.default.getMiddleClefs(P,I.staffIdx).find(u,I);if(!E)throw new s(I.clefUuid);const D=d.default.getDpq(P),M=c.default.getTimePos(E),p={partIdx:I.partIdx,staffIdx:T,measureIdx:I.measureIdx,dpq:D,timePos:M,clef:c.default.copy(E)};return l(p,h),p}function u(h){return c.default.getClefUuid(h)===this.clefUuid}function l(h,I){h.measureUuid=I.getMeasureUuid(h.measureIdx),h.partUuid=I.getPartUuid(h.partIdx),h.staffUuid=I.getPartStaffUuid(h.partIdx,h.staffIdx)}},876176:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(443749),e=t(701387),s=t(123491),c=t(726042);const d=function(o,r){o.checkPartIdx(r.partIdx),o.checkMeasureIdx(r.measureIdx);const n=o.getMeasure(r.partIdx,r.measureIdx),u=e.default.getNbStaves(n),l=r.staffIdx;if(!c.default.isInteger(l)||l<0||l>=u)throw new f.default(l);const h=e.default.getNotes(n),I={staffIdx:l,voicesSet:{}};return h.forEach(i,I),Object.keys(I.voicesSet).length},i=function(o){const r=this;if(s.default.getStaffIdx(o)===r.staffIdx){const u=s.default.getVoiceIdx(o);r.voicesSet[u]=!0}},a=d},877146:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(123491),e=t(701387),s=t(353922);function c(i){e.default.getNotes(i).forEach(d)}function d(i){const a=f.default.getHead(i);f.default.hasPitch(i)&&s.A.isPitchShape(a)&&f.default.setHead(i,s.A.NORMAL)}},878647:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(348742),e=t(701387),s=t(123491),c=t(259563),d=t(707165);const i=function(r){const n=e.default.getDivisions(r);e.default.getNotes(r).forEach(a,n)},a=function(r){const n=this.valueOf();if(!s.default.hasDuration(r))return;const u=s.default.getDuration(r);if(u>0){const l=s.default.getTimeModif(r),h=(0,d.A)(u,n,l),I=c.default.toRoomForDots(h),P=s.default.getNbDots(r);if(P>I){const T=`The quarter duration [${c.default.toQuarterDuration(h)}] with [${P}] dots has a base duration too small.`;throw new f.A("BaseDurationTooSmall",T)}}},o=i},879322:(O,A,t)=>{t.d(A,{A:()=>m});var f=t(701387),e=t(952818),s=t(365340),c=t(782615),d=t(558280),i=t(735178);const a=function(v){const x=e.A.getEntries(v).map(o);return Array.prototype.concat.apply([],x).map(r,v)},o=function(v){return s.default.getArray(v,i.A.WEDGE)},r=function(v){const U=this,x=e.A.getStaffIdx(U),S=e.A.getTimePos(U),K=e.A.getPlacement(U),H=c.A.getRawType(v),Y=c.A.getNumber(v);return d.A.createRaw(x,K,S,H,Y)},n=a,u=function(v){return P().extract(v)},l=function(){this.wedgesByStaff=null},h=l.prototype;h.extract=function(v){this.reset(),v.forEach(this.processDirection,this);const U=this.wedgesByStaff;return this.wedgesByStaff=null,U},h.reset=function(){this.wedgesByStaff={}},h.processDirection=function(v){n(v).forEach(this.addWedge,this)},h.addWedge=function(v){const U=e.A.getStaffIdx(v);this.getStaffWedges(U).push(v)},h.getStaffWedges=function(v){return typeof this.wedgesByStaff[v]=="undefined"&&(this.wedgesByStaff[v]=[]),this.wedgesByStaff[v]};let I=null;const P=function(){return I===null&&(I=new l),I},T=u;var _=t(843678),g=t(726042);const E=function(v,U){_.default.forEach(U,D,v)},D=function(v,U){v=g.default.intPart(v);const x=this;U.sort(d.A.compare),f.default.setWedges(x,v,U)},M=E,m=function(v){const U=f.default.getRawDirections(v),x=T(U);M(v,x)}},886766:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(364842),e=t(372585),s=t(345912);const c=function(n,u,l,h){u=u.sort(d);const I=new a(n,u,l,h);return I.search(),I.getOctaveShift()},d=function(n,u){const l=s.A.getTimePos(n),h=s.A.getTimePos(u),I=l-h;if(I!==0)return I;const P=s.A.getType(n),T=s.A.getType(u);return i(P,T)},i=function(n,u){return n===e.A.UP||n===e.A.DOWN&&u===e.A.STOP?1:n===e.A.STOP&&u===e.A.UP||u===e.A.DOWN?-1:0},a=function(n,u,l,h){this.init(n,u,l,h)},o=a.prototype;o.init=function(n,u,l,h){this.currentOctaveShift=n,this.octaveShifts=u,this.searchedTimePosition=l,this.excludeBoundaries=!!h},o.search=function(){this.octaveShifts.some(this.analyzeOctaveShift,this)},o.analyzeOctaveShift=function(n){const u=s.A.getTimePos(n);if(u>this.searchedTimePosition)return!0;const l=s.A.getType(n);return(l===e.A.UP||l===e.A.DOWN)&&this.startOctaveShift(n),u===this.searchedTimePosition&&!this.excludeBoundaries?!0:(l===e.A.STOP&&this.stopOctaveShift(),!1)},o.startOctaveShift=function(n){if(this.currentOctaveShift!==null)throw new f.default("Unexpected","There is already a octave shift");this.currentOctaveShift=n},o.stopOctaveShift=function(){if(this.currentOctaveShift===null){const n="There is no octave shift to stop.";throw new f.default("Unexpected",n)}else this.currentOctaveShift=null},o.getOctaveShift=function(){return this.currentOctaveShift};const r=c},889600:(O,A,t)=>{t.d(A,{A:()=>u});var f=t(123491),e=t(726042);const s=function(l,h){let I=0;return c(h)===0?I+=d(l,h):(I+=i(l,h),I+=o(l,h),I+=a(l,h)),I},c=function(l){return l.stopMeasureIdx-l.startMeasureIdx},d=function(l,h){const I=l.getMeasureData(h.startMeasureIdx),P=h.startTimePos,T=h.stopTimePos,_=r(I);_.sort(e.default.cmp);let g=0;return _.some(function(E){if(E>=T)return!0;E>=P&&g++}),g},i=function(l,h){const I=l.getMeasureData(h.startMeasureIdx),P=h.startTimePos,T=r(I);T.sort(e.default.cmp);let _=0;return T.forEach(function(g){g>=P&&_++}),_},a=function(l,h){const I=l.getMeasureData(h.stopMeasureIdx),P=h.stopTimePos,T=r(I);T.sort(e.default.cmp);let _=0;return T.some(function(g){if(g>=P)return!0;_++}),_},o=function(l,h){let I=0;const P=h.startMeasureIdx,T=h.stopMeasureIdx;for(let _=P+1;_<T;_++){const g=l.getMeasureData(_),E=r(g);I+=E.length}return I},r=function(l){const h={};l.forEachVoice(n,h);let I=Object.keys(h);return I=I.map(e.default.intPart),I},n=function(l){const h=this;let I=0;const P=l.size();for(let T=0;T<P;T++){h[I]=0;const _=l.getNote(T),g=f.default.getDuration(_);I+=g}},u=s},890962:(O,A,t)=>{t.d(A,{A:()=>f});function f(e){if(typeof e["action.AddMultiMeasureRest"]=="undefined"||typeof e["action.RemoveMultiMeasureRest"]=="undefined")return;const s=e.getCommonContent(e),c=e.getNbMeasures();for(let d=0;d<c;d++)if(s.hasMultiMeasureRest(d)){const i=s.getMultiMeasureRest(d);e["action.RemoveMultiMeasureRest"]({measureIdx:d}),e["action.AddMultiMeasureRest"]({measureIdx:d,nbMeasures:i})}}},891295:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(443749),e=t(832560),s=t(891921),c=t(701387),d=t(726042);const i=function(u,l){u.checkPartIdx(l.partIdx),u.checkMeasureIdx(l.measureIdx);const h=u.getMeasure(l.partIdx,l.measureIdx),I=new e.A(h);I.checkVoiceIdx(l.voiceIdx);const P=I.getVoice(l.voiceIdx);P.checkNoteIdx(l.noteIdx);const T=P.getRangeSpace(0,l.noteIdx),_=c.default.getNbStaves(h),g=l.staffIdx;if(!d.default.isInteger(g)||g<0||g>=_)throw new f.default(g);let E=u.getPartStaffVoicesIndexes(l.partIdx,l.staffIdx);E=E.filter(I.hasVoice,I);const D={timePos:T,measureData:I,measureIdx:l.measureIdx,scoreData:u};let p=E.map(a,D).reduce(o);const m=u.getNbMeasures();return p.measureIdx===m?null:(p.measureIdx>l.measureIdx&&(p=r(u,l)),{partIdx:l.partIdx,measureIdx:p.measureIdx,staffIdx:l.staffIdx,voiceIdx:p.voiceIdx,noteIdx:p.noteIdx})},a=function(u){u=parseInt(u,10);const l=this,h=l.measureData.getVoice(u),I=l.timePos;let T=(0,s.A)(h,1,I)+1,_=l.measureIdx;const g=h.getNbNotes();let E;return T===g?(T=0,_++,E=0):E=h.getRangeSpace(0,T),{voiceIdx:u,measureIdx:_,noteIdx:T,timePos:E}},o=function(u,l){return u.measureIdx<l.measureIdx?u:u.measureIdx>l.measureIdx?l:u.timePos<l.timePos?u:l},r=function(u,l){const h=l.measureIdx+1,I=u.getMeasure(l.partIdx,h),P=new e.A(I);let T=u.getPartStaffVoicesIndexes(l.partIdx,l.staffIdx);return T=T.filter(P.hasVoice,P),{voiceIdx:T[0],measureIdx:h,noteIdx:0,timePos:0}},n=i},892065:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(701387),e=t(721247),s=t(35802);const c=function(a){const o=f.default.getWrappedOwnClef(a),r=d(o);let n=!1;const u=o.getNbStaves();for(let l=0;l<u;l++)if(!o.hasEntry(l)){n=!0;const h=e.default.copy(r);o.setEntry(h,l)}if(n){const l=f.default.getOwnAttributes(a),h=o.dumpAttribute();s.default.setClef(l,h),f.default.setOwnAttributes(a,l)}},d=function(a){const o=a.getNbStaves();let r;for(let n=0;n<o;n++)if(a.hasEntry(n))return r=a.getEntry(n),r;return r=e.default.create("G"),r},i=c},892853:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(515819);const s=function(c,d,i){const a=f.default.durationOptsToDuration(c,d);return f.default.normalToActual(a,i)}},893785:(O,A,t)=>{t.d(A,{A:()=>P});var f=t(737903),e=t(701387),s=t(35802),c=t(518558),d=t(746641),i=t(104907),a=t(627300);function o(T){s.default.getStaffDetails(T).forEach(r)}function r(T){if(!i.default.hasStaffTuning(T))return;i.default.getStaffTunings(T).forEach(n)}function n(T,_){a.default.setLine(T,_)}const u=function(T){const _=T.getCommonContent(),g=_.getDisplayedTime(0);T.forEachPart(function(E){const D=E.measure,M=D[0],p=e.default.getAttributes(M),m=(0,f.cloneEpure$adagio)(p),v=c.default.copy(g);let U=e.default.getAnyTime(M);U=c.default.copy(U),s.default.setTime(m,[v]),s.default.removeDefault(m),s.default.setPersistedTime(m,[U]),o(m),e.default.setOwnAttributes(M,m),D.slice(1).reduce(function(x,S,K){return K++,l(x,S,K,_)},M)})},l=function(T,_,g,E){const D={},M=e.default.getDivisions(T),p=e.default.getDivisions(_);p!==M&&s.default.setDivisions(D,p);let m=e.default.getAnyTime(_);m=c.default.copy(m),s.default.setPersistedTime(D,m);const v=E.getDisplayedTime(g-1),U=new d.A([v],1,c.default),x=E.getDisplayedTime(g),S=new d.A([x],1,c.default),K=I(U,S);s.default.setTime(D,K);const H=h(T),Y=e.default.getWrappedClef(_),C=I(H,Y);s.default.setClef(D,C);const y=e.default.getWrappedKey(T),F=e.default.getWrappedKey(_),N=I(y,F);s.default.setKey(D,N);const G=e.default.getWrappedTranspose(T),nt=e.default.getWrappedTranspose(_),J=I(G,nt);return s.default.setTranspose(D,J),e.default.setOwnAttributes(_,(0,f.cloneEpure$adagio)(D)),_};function h(T){const _=e.default.getWrappedClef(T),g=e.default.getNbStaves(T);for(let E=0;E<g;E++)if(e.default.hasMiddleClefs(T,E)){const D=e.default.getMiddleClefs(T,E),M=D.length,p=D[M-1];_.setEntry(p,E)}return _}const I=function(T,_){let g=_.getDiffWith(T);return g=new d.A(g,T.getNbStaves(),T.utils).dumpAttribute(),g},P=u},896625:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(701387);function e(s){f.default.hasLeftBarline(s)&&(f.default.hasRepeatForward(s)||f.default.removeLeftBarline(s))}},898439:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(123491);function e(s,c){let d=0;for(let i=0;i<c;i++){const a=s.getNote(i),o=f.default.getDuration(a);d+=o}return d}},899941:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(443749),e=t(734246),s=t(701387),c=t(123491),d=t(726042);const i=function(r,n){const u=n.partIdx;r.checkPartIdx(u),r.checkMeasureIdx(n.measureIdx);let l=n.voiceIdx;const h=r.getMeasure(u,n.measureIdx),I=s.default.getNbStaves(h),P=n.staffIdx;if(!d.default.isInteger(P)||P<0||P>=I)throw new f.default(P);const T=s.default.getNotes(h),_={staffIdx:P,voicesSet:{}};T.forEach(a,_);const g=Object.keys(_.voicesSet),E=g.length,D=n.idxInStaff;if(!d.default.isInteger(D)||D<0||D>=E)throw new e.A(D);return E===1?l=parseInt(g[0],10):l=r.getPartStaffVoiceAtIdx(u,P,D),l},a=function(r){const n=this;if(c.default.getStaffIdx(r)===n.staffIdx){const l=c.default.getVoiceIdx(r);n.voicesSet[l]=!0}},o=i},903302:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(669038),e=t(483139),s=t(213489),c=t(813864);const i=function(a,o){if(a=(0,c.A)(a),typeof o.startPartUuid!="undefined")if(a.hasPartUuid(o.startPartUuid))o.startPartIdx=a.getPartIdxFromUuid(o.startPartUuid),delete o.startPartUuid;else throw new f.A(o.startPartUuid,f.A.GET);if(typeof o.startMeasureUuid!="undefined")if(a.hasMeasureUuid(o.startMeasureUuid))o.startMeasureIdx=a.getMeasureIdxFromUuid(o.startMeasureUuid),delete o.startMeasureUuid;else throw new e.A(o.startMeasureUuid,e.A.GET);if(typeof o.startVoiceUuid!="undefined")if(a.hasPartVoiceUuid(o.startPartIdx,o.startVoiceUuid))o.startVoiceIdx=a.getPartVoiceIdxFromUuid(o.startPartIdx,o.startVoiceUuid),delete o.startVoiceUuid;else throw new s.default(o.startVoiceUuid,s.default.GET)}},908300:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(364842),e=t(123491),s=t(852363),c=t(343568);const d=function(o,r,n){this.init(o,r,n)};d.NAME="primitive.RemoveRest";const i=d.prototype;i.name=d.NAME,i.initMeasureData=c.A,i.init=function(o,r,n){this.initMeasureData(o,r),this.cancelStack=n,this.opts=r},i.perform=function(){this.assertUnlockedRest(),this.removeRest(),this.updateStack()},i.assertUnlockedRest=function(){const o=this.getNote();if(!e.default.isRest(o))throw new f.default("RestExpected");if(e.default.needRestLock(o))throw new f.default("LockedRest")},i.getNote=function(){return this.getVoice().getNote(this.opts.noteIdx)},i.removeRest=function(){this.getVoice().removeNote(this.opts.noteIdx)},i.getVoice=function(){const o=this.opts.voiceIdx,r=this.opts.noteIdx;return this.measureData.getVoiceOrTupletForGet(o,r)},i.updateStack=function(){const o={type:this.name,opts:{partIdx:this.opts.partIdx,measureIdx:this.opts.measureIdx}};this.cancelStack.push(o),(0,s.default)(this.cancelStack,this.measureData,this.opts)};const a=d},912894:(O,A,t)=>{t.d(A,{A:()=>T});var f=t(443749),e=t(883782),s=t(92078),c=t(990937),d=t(364842),i=t(21738),a=t(665280),o=t(409200),r=t(903302),n=t(275408),u=t(189247),l=t(726042),h=t(446921),I=t(701387),P=t(123491);function T(M,p){return new _(M,p).get()}class _{constructor(p,m){this.scoreData=p,this.opts=m,this.measuresData={},this.status=null}get(){return this.checkLocation(),this.searchStatus(),this.status}checkLocation(){this.checkStaves(),this.checkLeftBound(),this.checkRightBound()}checkStaves(){const p=this.opts.content;p.forEach(this.checkStaff,this);const m={};p.forEach(g,m),this.opts.content=p}checkStaff(p){(0,i.default)(this.scoreData,p),(0,a.default)(this.scoreData,p),(0,o.default)(this.scoreData,p);const m=p.partIdx;this.scoreData.checkPartIdx(m);const v=this.scoreData.getPartNbStaves(m),U=p.staffIdx;if(!l.default.isNumber(U)||U<0||U>=v)throw new f.default(U,f.default.GET);if(typeof p.voiceIdx=="number"&&!this.scoreData.hasPartVoiceIdx(p.partIdx,p.voiceIdx))throw new e.default(p.voiceIdx)}checkLeftBound(){(0,r.A)(this.scoreData,this.opts),this.scoreData.checkMeasureIdx(this.opts.startMeasureIdx);const m=this.scoreData.getMeasure(0,this.opts.startMeasureIdx);E(m,this.opts.startDpq,this.opts.startTimePos)}checkRightBound(){(0,n.A)(this.scoreData,this.opts),this.scoreData.checkMeasureIdx(this.opts.stopMeasureIdx);const m=this.scoreData.getMeasure(0,this.opts.stopMeasureIdx);D(m,this.opts.stopDpq,this.opts.stopTimePos)}searchStatus(){this.opts.content.some(this.searchStaff,this)}searchStaff({partIdx:p,staffIdx:m,voiceIdx:v}){if(this.status!==null)return!0;const U=this.scoreData.isPartUnpitched(p);if(!(U&&!this.opts.checkRest&&!this.opts.checkNotePercu&&!this.opts.checkGracePercu)&&!(!U&&!this.opts.checkRest&&!this.opts.checkNote&&!this.opts.checkGrace)){if(this.isPartUnpitched=U,typeof m=="number")this.voicesIndexes=this.scoreData.getPartStaffVoicesIndexes(p,m);else if(typeof v=="number")this.voicesIndexes=[v];else throw new d.default("Unexpected");this.partIdx=p;for(let x=this.opts.startMeasureIdx;x<=this.opts.stopMeasureIdx;x++)this.searchMeasure(x)}}searchMeasure(p){this.measureIdx=p,this.startTimePos=this.getStartTimePos(p),this.stopTimePos=this.getStopTimePos(p);const m=this.getMeasureData(this.partIdx,p),v=this.voicesIndexes.filter(m.hasVoice,m);this.measureData=m,v.some(this.searchVoice,this)}getStartTimePos(p){if(p>this.opts.startMeasureIdx)return 0;{const m=this.scoreData.getMeasure(this.partIdx,p),v=I.default.getDpq(m);return this.opts.startTimePos*v/this.opts.startDpq}}getStopTimePos(p){const m=this.scoreData.getMeasure(this.partIdx,p);if(p<this.opts.stopMeasureIdx)return I.default.getNbDivisions(m);{const v=I.default.getDpq(m);return this.opts.stopTimePos*v/this.opts.stopDpq}}getMeasureData(p,m){if(typeof this.measuresData[p]=="undefined"){const v=this.scoreData.getPartContent(p),U=h.A.getMeasures(v);this.measuresData[p]=new u.A(U,p,this.scoreData)}return this.measuresData[p].getMeasureData(m)}searchVoice(p){this.voiceIdx=p;const m=this.measureData.getVoice(p);let v=0;const U=m.getNbNotes();for(let x=0;x<U;x++){if(v>=this.stopTimePos)return;const S=m.getNote(x),K=P.default.getDuration(S);if(v<this.startTimePos){v+=K;continue}if(m.isRest(x)){if(this.opts.checkRest&&(this.status=this.opts.checkRest(m,x),this.status!==null))return!0}else if(this.isPartUnpitched){if(this.opts.checkGracePercu){const H=m.getNbGraces(x);for(let Y=0;Y<H;Y++)if(this.status=this.opts.checkGracePercu(m,x,Y),this.status!==null)return!0}if(this.opts.checkNotePercu&&(this.status=this.opts.checkNotePercu(m,x),this.status!==null))return!0}else{if(this.opts.checkGrace){const H=m.getNbGraces(x);for(let Y=0;Y<H;Y++)if(this.status=this.opts.checkGrace(m,x,Y),this.status!==null)return!0}if(this.opts.checkNote&&(this.status=this.opts.checkNote(m,x),this.status!==null))return!0}v+=K}}}function g(M){const p=this,m=M.partIdx;p[m]=p[m]||{};const v=M.staffIdx;if(typeof p[m][v]=="undefined")p[m][v]=!0;else throw new s.A(s.A.STAFF,v)}function E(M,p,m){const v=I.default.getDpq(M);let U=I.default.getNbDivisions(M);const x=l.default.lcm(v,p);if(U*=x/v,m*=x/p,!l.default.isInteger(m)||m<0||m>=U)throw new c.A(m,x)}function D(M,p,m){const v=I.default.getDpq(M);let U=I.default.getNbDivisions(M);const x=l.default.lcm(v,p);if(U*=x/v,m*=x/p,!l.default.isInteger(m)||m<=0||m>U)throw new c.A(m,x)}},914734:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(952818),s=t(717434);const c=function(o){let r=f.default.getRawDirections(o);r.forEach(d),r=r.filter(e.A.hasContent),f.default.setDirections(o,r)},d=function(o){let r=e.A.getEntries(o);r=r.filter(i),e.A.setEntries(o,r)},i=function(o){return!s.A.isRehearsal(o)},a=c},915913:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(210888),e=t(701387),s=t(788220);function c(i){const a=e.default.getNbStaves(i);for(let o=0;o<a;o++)e.default.getWords(i,o).forEach(d)}function d(i){const a=f.default.generate();s.A.setWordUuid(i,a)}},917530:(O,A,t)=>{t.d(A,{A:()=>e});var f=t(607682);class e extends f.default{constructor(){super("There is no octave shift at this location."),this.name="NoOctaveShiftError"}}},917799:(O,A,t)=>{t.d(A,{A:()=>T});var f=t(446921),e=t(701387),s=t(35802),c=t(123491),d=t(843678);function i(_){const g={},E={};return _.forEach(a,{voicesSet:g,collidingVoicesStaves:E}),{voicesSet:g,collidingVoicesStaves:E}}function a(_){const g=this;g.localVoices={},e.default.getNotes(_).forEach(o,g)}function o(_){const{voicesSet:g,collidingVoicesStaves:E,localVoices:D}=this;if(c.default.getTimePos(_)===0&&!c.default.isChord(_)&&c.default.hasDuration(_)){const p=c.default.getVoiceIdx(_);g[p]=!0;const m=c.default.getStaffIdx(_);typeof D[p]=="undefined"&&(D[p]={}),D[p][m]=!0}d.default.forEach(D,r,E)}function r(_,g){const E=this,D=Object.keys(g);D.length>1&&D.forEach(M=>{typeof E[_]=="undefined"&&(E[_]={}),E[_][M]=!0})}function n(_){return Object.keys(_.collidingVoicesStaves).length>0}var u=t(275844);function l({collidingVoicesStaves:_,voicesSet:g}){let E=0;const D={},M={};for(const p in _){const m=_[p];let v=Object.keys(m);v.length>1&&(v=v.slice(1),v.forEach(U=>{const x=(0,u.A)(g,D,E);M[`${p}-${U}`]=x,E=x}))}return M}function h(_,g){_.forEach(I,g)}function I(_){const g=this;e.default.getNotes(_).forEach(P,g)}function P(_){const g=this,E=c.default.getVoiceIdx(_),D=c.default.getStaffIdx(_),M=`${E}-${D}`,p=g[M];typeof p!="undefined"&&c.default.setVoiceIdx(_,p)}function T(_){const g=f.A.getFirstMeasure(_),E=e.default.getOwnAttributes(g);if(s.default.getNbStaves(E)===1)return;const M=f.A.getMeasures(_),p=i(M);if(n(p)){const m=l(p);h(M,m)}}},919713:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(210888),e=t(601770),s=t(346797);function c(a,o){const r=a.getNbMeasures(a),n={commonContent:a,measuresHeaders:o,lastTempoChangeUuid:null};for(let u=0;u<r;u++)d(u,n)}function d(a,o){o.measureUuid=e.A.getUuid(o.measuresHeaders[a]);let r=o.commonContent.getTempoChanges(a);if(r=r.filter(s.A.isStart),r.forEach(i,o),o.commonContent.hasRightTempoChange(a)){const n=o.lastTempoChangeUuid,u=o.commonContent.getRightTempoChange(a);s.A.setTempoChangeUuid(u,n);const l=o.commonContent.getLeftTempoChange(a+1);s.A.setTempoChangeUuid(l,n)}}function i(a){const o=this,r=f.default.generate(),n={tempoChangeUuid:r,measureUuid:o.measureUuid};o.commonContent.setTempoChangeAtUuid(n),s.A.setTempoChangeUuid(a,r),o.lastTempoChangeUuid=r}},919973:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(726042);const e={};e.create=function(c,d){return{numerator:c,denominator:d}},e.add=function(c,d){e.makeSameDenominatorIfNeeded(c,d);const i=e.getNumerator(c),a=e.getNumerator(d),o=e.getDenominator(c),r=i+a;return e.create(r,o)},e.sub=function(c,d){e.makeSameDenominatorIfNeeded(c,d);const i=e.getNumerator(c),a=e.getNumerator(d),o=e.getDenominator(c),r=i-a;return e.create(r,o)},e.isGreaterOrEqualThan=function(c,d){e.makeSameDenominatorIfNeeded(c,d);const i=e.getNumerator(c),a=e.getNumerator(d);return i>=a},e.isGreater=function(c,d){e.makeSameDenominatorIfNeeded(c,d);const i=e.getNumerator(c),a=e.getNumerator(d);return i>a},e.isEquivalent=function(c,d){return e.makeSameDenominatorIfNeeded(c,d),e.isSame(c,d)},e.makeSameDenominatorIfNeeded=function(c,d){e.isSameDenominator(c,d)||e.makeSameDenominator(c,d)},e.isSameDenominator=function(c,d){const i=e.getDenominator(c),a=e.getDenominator(d);return i===a},e.makeSameDenominator=function(c,d){const i=e.getDenominator(c),a=e.getDenominator(d),o=f.default.lcm(i,a);let r=e.getNumerator(c);r*=o/i,e.setNumerator(c,r),e.setDenominator(c,o);let n=e.getNumerator(d);n*=o/a,e.setNumerator(d,n),e.setDenominator(d,o)},e.copy=function(c){const d=e.getNumerator(c),i=e.getDenominator(c);return e.copy(d,i)},e.getDenominator=function(c){return c.denominator},e.setDenominator=function(c,d){c.denominator=d},e.getNumerator=function(c){return c.numerator},e.setNumerator=function(c,d){c.numerator=d},e.isSame=function(c,d){const i=e.getNumerator(c),a=e.getNumerator(d),o=e.getDenominator(c),r=e.getDenominator(d);return i===a&&o===r},e.reverseNumerator=function(c){const d=e.getNumerator(c);e.setNumerator(c,-d)};const s=e},920053:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(518558),e=t(701387),s=t(35802);function c(i){const a=e.default.getOwnAttributes(i);let o=s.default.getTime(a);o=o.map(d),s.default.setTime(a,o);let r=s.default.getPersistedTime(a);r=r.map(d),s.default.setPersistedTime(a,r)}function d(i){try{return f.default.check(i),i}catch(a){const o=f.default.getBeatType(i),r=f.default.getBeats(i);return i=f.default.create(r,o),i}}},921492:(O,A,t)=>{t.d(A,{A:()=>u});var f=t(365340);const s={COMPOSER:"composer",LYRICIST:"lyricist",ARRANGER:"arranger"},c={};c.getString=function(l){return typeof l.content=="string"?l.content:""},c.setString=function(l,h){l.content=h},c.getType=function(l){return l.$type},c.create=function(l,h){return{$type:l,content:h}};const d=c,i={};i.hasComposer=function(l){return i.hasCreatorType(l,s.COMPOSER)},i.getComposerStr=function(l){const h=i.getComposer(l);return d.getString(h)},i.setComposerStr=function(l,h){let I;a(h)?i.removeEntry(l,s.COMPOSER):i.hasComposer(l)?(I=i.getComposer(l),d.setString(I,h)):(I=d.create(s.COMPOSER,h),l.push(I))},i.getComposer=function(l){return i.getCreator(l,s.COMPOSER)},i.hasLyricist=function(l){return i.hasCreatorType(l,s.LYRICIST)},i.getLyricistStr=function(l){const h=i.getLyricist(l);return d.getString(h)},i.setLyricistStr=function(l,h){let I;a(h)?i.removeEntry(l,s.LYRICIST):i.hasLyricist(l)?(I=i.getLyricist(l),d.setString(I,h)):(I=d.create(s.LYRICIST,h),l.push(I))},i.getLyricist=function(l){return i.getCreator(l,s.LYRICIST)},i.hasArranger=function(l){return i.hasCreatorType(l,s.ARRANGER)},i.getArrangerStr=function(l){const h=i.getArranger(l);return d.getString(h)},i.setArrangerStr=function(l,h){let I;a(h)?i.removeEntry(l,s.ARRANGER):i.hasArranger(l)?(I=i.getArranger(l),d.setString(I,h)):(I=d.create(s.ARRANGER,h),l.push(I))},i.getArranger=function(l){return i.getCreator(l,s.ARRANGER)},i.hasCreatorType=function(l,h){return l.some(o,h)},i.getCreator=function(l,h){return l.find(o,h)};const a=function(l){return l.trim()===""};i.removeEntry=function(l,h){const I=l.findIndex(o,h);I!==-1&&l.splice(I,1)};const o=function(l){const h=this.valueOf();return d.getType(l)===h},r=i,n={};n.hasComposer=function(l){const h=n.getCreators(l);return r.hasComposer(h)},n.getComposerStr=function(l){const h=n.getCreators(l);return r.getComposerStr(h)},n.setComposerStr=function(l,h){const I=n.getCreators(l);r.setComposerStr(I,h),n.setCreators(l,I)},n.hasLyricist=function(l){const h=n.getCreators(l);return r.hasLyricist(h)},n.getLyricistStr=function(l){const h=n.getCreators(l);return r.getLyricistStr(h)},n.setLyricistStr=function(l,h){const I=n.getCreators(l);r.setLyricistStr(I,h),n.setCreators(l,I)},n.hasArranger=function(l){const h=n.getCreators(l);return r.hasArranger(h)},n.getArrangerStr=function(l){const h=n.getCreators(l);return r.getArrangerStr(h)},n.setArrangerStr=function(l,h){const I=n.getCreators(l);r.setArrangerStr(I,h),n.setCreators(l,I)},n.getCreators=function(l){return f.default.getArray(l,"creator")},n.setCreators=function(l,h){f.default.setArray(l,"creator",h)},n.hasRights=function(l){if(typeof l.rights=="undefined")return!1;const h=n.getRights(l);return f.default.hasStringOrContent(h)},n.getRightsStr=function(l){const h=n.getRights(l);return f.default.stringOrContent(h)},n.getRightsEntries=function(l){let h=f.default.getArray(l,"rights");return h=h.filter(f.default.hasStringOrContent),h=h.map(f.default.stringOrContent),h},n.getRights=function(l){return f.default.getSingle(l,"rights")},n.setRightsEntries=function(l,h){f.default.setArray(l,"rights",h)};const u=n},924906:(O,A,t)=>{t.d(A,{A:()=>M});var f=t(364842),e=t(446921),s=t(123491),c=t(351277),d=t(292681),i=t(476943),a=t(799855),o=t(832560),r=t(673817),n=t(908300),u=t(603966),l=t(13800),h=t(560015),I=t(44229);const P={REST:"rest",PITCHED:"pitched",UNPITCHED:"unpitched"},T=function(p){const m=new _(p);m.analyze(),m.removeNullDurations()},_=function(p){this.init(p)},g=_.prototype;g.init=function(p){this.scoreData=p,this.partIdx=null,this.measureIdx=null,this.voiceIdx=null,this.noteIdx=null,this.list=[]},g.analyze=function(){this.scoreData.getPartsContents().forEach(this.analyzePart,this)},g.analyzePart=function(p,m){this.partIdx=m,e.A.getMeasures(p).forEach(this.analyzeMeasure,this)},g.analyzeMeasure=function(p,m){this.measureIdx=m,new o.A(p).forEachVoice(this.analyzeVoice,this)},g.analyzeVoice=function(p,m){this.voiceIdx=m;const v=p.size();for(let U=0;U<v;U++){this.noteIdx=U;const x=p.getNote(U);if(s.default.getDuration(x)===0){const K=s.default.isRest(x);this.addNote(K)}}},g.addNote=function(p){let m;p?m=P.REST:this.scoreData.isPartUnpitched(this.partIdx)?m=P.UNPITCHED:m=P.PITCHED;const v={partIdx:this.partIdx,measureIdx:this.measureIdx,voiceIdx:this.voiceIdx,noteIdx:this.noteIdx,type:m};this.list.unshift(v)},g.removeNullDurations=function(){this.list.forEach(this.removeEntry,this)},g.removeEntry=function(p){if(p.type===P.REST)this.removeRest(p);else if(p.type===P.PITCHED)this.removePitched(p);else if(p.type===P.UNPITCHED)this.removeUnpitched(p);else throw new f.default("Unexpected")},g.removeRest=function(p){const m={partIdx:p.partIdx,measureIdx:p.measureIdx,voiceIdx:p.voiceIdx,noteIdx:p.noteIdx},v=new r.A;new n.A(this.scoreData,m,v).perform()},g.removePitched=function(p){const m=this.scoreData.getMeasure(p.partIdx,p.measureIdx);let x=new o.A(m).getVoice(p.voiceIdx).getChord(p.noteIdx);x=i.default.makeArray(x);const S=x.length;x.forEach(function(K,H){const Y=s.default.getPitch(K),C={partIdx:p.partIdx,measureIdx:p.measureIdx,voiceIdx:p.voiceIdx,noteIdx:p.noteIdx,pitch:c.default.copyWithoutAlter(Y),insertMode:a.default.REPLACE},y=new r.A,F=E(H,S),N=new F(this.scoreData,C,y);N.checkPreconditions(),N.perform()},this)};const E=function(p,m){return m<m-1?u.A:l.A};g.removeUnpitched=function(p){const m=this.scoreData.getMeasure(p.partIdx,p.measureIdx);let x=new o.A(m).getVoice(p.voiceIdx).getChord(p.noteIdx);x=i.default.makeArray(x);const S=x.length;x.forEach(function(K,H){const Y=s.default.getUnpitched(K),C={partIdx:p.partIdx,measureIdx:p.measureIdx,voiceIdx:p.voiceIdx,noteIdx:p.noteIdx,unpitched:d.default.copy(Y),insertMode:a.default.REPLACE},y=new r.A,F=D(H,S),N=new F(this.scoreData,C,y);N.checkPreconditions(),N.perform()},this)};const D=function(p,m){return m<m-1?h.A:I.A},M=T},931506:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(364842),e=t(701387),s=t(518558);const c=function(a,o){const r={previousTime:null,commonContent:o};a.forEach(d,r)},d=function(a,o){if(e.default.hasOwnTime(a)){const n=e.default.getAnyOwnTime(a);this.previousTime=s.default.copy(n)}else if(this.previousTime===null){const n="Previous time is expected.";throw new f.default("NoPreviousTime",n)}const r=s.default.copy(this.previousTime);this.commonContent.setDisplayedTime(o,r)},i=c},932778:(O,A,t)=>{t.d(A,{A:()=>T});var f=t(411993),e=t(123491),s=t(701387),c=t(562628),d=t(364842);const i=function(){this.init()},a=i.prototype;a.init=function(){this.leftNotes={}},a.addChord=function(_){this.matchHammerOnPullOffs(_),this.dropStartedHammerOnPullOffs(),this.storeStartingHammerOnPullOffs(_)},a.matchHammerOnPullOffs=function(_){_.forEach(o),_=_.filter(e.default.hasHammerOnPullOffStop),_=r(_);let g;for(g in this.leftNotes)typeof _[g]!="undefined"&&(delete this.leftNotes[g],delete _[g]);for(g in _){const E=_[g];e.default.removeHammerOnPullOffStop(E)}};const o=function(_){if(!e.default.hasFretData(_)||e.default.isGraceNote(_)){e.default.removeHammerOnPullOff(_);return}e.default.hasHammerOnStop(_)&&e.default.hasPullOffStop(_)&&e.default.removeHammerOnPullOffStop(_),e.default.hasHammerOnStart(_)&&e.default.hasPullOffStart(_)&&e.default.removeHammerOnPullOffStart(_)},r=function(_){const g={};return _.forEach(function(E){let M=`${e.default.getFretData(E).string}-`;if(e.default.hasPullOffStop(E))M+="p";else if(e.default.hasHammerOnStop(E))M+="h";else throw new d.default("Unexpected");typeof g[M]!="undefined"?e.default.removeHammerOnPullOffStop(E):g[M]=E}),g};a.dropStartedHammerOnPullOffs=function(){for(const _ in this.leftNotes){const g=this.leftNotes[_];e.default.removeHammerOnPullOffStart(g)}this.leftNotes={}},a.storeStartingHammerOnPullOffs=function(_){_=_.filter(e.default.hasHammerOnPullOffStart),this.leftNotes=n(_)};const n=function(_){const g={};return _.forEach(function(E){let M=`${e.default.getFretData(E).string}-`;if(e.default.hasPullOffStart(E))M+="p";else if(e.default.hasHammerOnStart(E))M+="h";else throw new d.default("Unexpected");typeof g[M]!="undefined"?e.default.removeHammerOnPullOffStart(E):g[M]=E}),g};a.endReached=function(){this.dropStartedHammerOnPullOffs()};const u=i,l=function(_){new h(_).filter()},h=function(_){this.init(_)},I=h.prototype;I.init=function(_){this.measures=_,this.buffers={}},I.filter=function(){this.measures.forEach(this.filterMeasure,this),this.flushBuffers()},I.filterMeasure=function(_){const g=s.default.getNotes(_),E=f.A.groupVoices(g);for(const D in E){const M=E[D];this.filterNotes(M)}},I.filterNotes=function(_){const g=P(_),E=this.getVoiceBuffer(g);(0,c.A)(_).forEach(E.addChord,E)};const P=function(_){const g=_[0];return e.default.getVoiceIdx(g)};I.getVoiceBuffer=function(_){return this.hasBuffer(_)||this.createBuffer(_),this.buffers[_]},I.hasBuffer=function(_){return typeof this.buffers[_]!="undefined"},I.createBuffer=function(_){this.buffers[_]=new u},I.flushBuffers=function(){for(const _ in this.buffers)this.buffers[_].endReached()};const T=l},937543:(O,A,t)=>{t.d(A,{A:()=>d});var f=t(701387),e=t(952818);const s=function(i){if(f.default.hasDirections(i)){let a=f.default.getRawDirections(i);const o=f.default.getNbDivisions(i);a=a.filter(c,o),f.default.setDirections(i,a)}},c=function(i){const a=this.valueOf(),o=e.A.getTimePos(i);return o>=0&&o<=a},d=s},938601:(O,A,t)=>{t.d(A,{A:()=>e});const f="Finale ";function e(s){const{identification:c}=s;if(typeof c=="undefined")return!1;const{encoding:d}=c;if(typeof d=="undefined")return!1;const{software:i}=d;return typeof i!="string"?!1:i.startsWith(f)}},942644:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(955154),e=t(353922),s=t(446921),c=t(860716),d=t(701387),i=t(123491),a=t(297805);function o(g){const E=s.A.getFirstMeasure(g);if(!(0,a.A)(E))return;s.A.getMeasures(g).forEach(r)}function r(g){n(g),l(g),P(g)}function n(g){let E=d.default.getNotes(g);E=E.filter(u),d.default.setNotes(g,E)}function u(g){if(!i.default.hasHarmonic(g))return!0;const E=i.default.getHarmonic(g);return!c.default.isArtificialSounding(E)}function l(g){const E=d.default.getNotes(g);new h().processNotes(E)}class h{constructor(){this.basePitch=null}processNotes(E){E.forEach(this.processNote,this)}processNote(E){if(this.basePitch===null)I(E)&&(this.basePitch=E);else{if(T(E)){const D=i.default.getVoiceIdx(this.basePitch),M=i.default.getStaffIdx(this.basePitch);i.default.setVoiceIdx(E,D),i.default.setStaffIdx(E,M)}this.basePitch=null}}}function I(g){if(i.default.getStaffIdx(g)!==1||!i.default.hasHarmonic(g))return!1;const D=i.default.getHarmonic(g);return c.default.getType(D)===f.default.ARTIFICIAL_BASE}function P(g){let E=d.default.getNotes(g);E=E.filter(T),E.forEach(_)}function T(g){if(!i.default.hasHarmonic(g))return!1;const E=i.default.getHarmonic(g);return c.default.getType(E)===f.default.ARTIFICIAL_TOUCHING}function _(g){i.default.getHead(g)===e.A.DIAMOND&&i.default.setHead(g,e.A.NORMAL)}},943545:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(951066);function e(c){return`the staffUuid value [${c}] is invalid.`}class s extends f.A{constructor(d){const i=e(d);super(i),Object.defineProperty(this,"staffUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="InvalidStaffUuidError",this.staffUuid=d}}},946846:(O,A,t)=>{t.d(A,{A:()=>M});var f=t(883782),e=t(607682);class s extends e.default{constructor(m){const v=`The octaveShift uuid ${m} is invalid.`;super(v),Object.defineProperty(this,"octaveShiftUuid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadOctaveShiftUuidError",this.octaveShiftUuid=m}}var c=t(443749),d=t(21738),i=t(409200),a=t(665280),o=t(799851),r=t(756042),n=t(189247),u=t(446921),l=t(701387),h=t(345912),I=t(737903),P=t(726042);const T=function(p,m){(0,d.default)(p,m),(0,i.default)(p,m),(0,a.default)(p,m),p.checkPartIdx(m.partIdx);const v=p.getPartContent(m.partIdx);if(!u.A.hasOctaveShift(v,m.octaveShiftUuid))throw new s(m.octaveShiftUuid);const U=u.A.getOctaveShift(v,m.octaveShiftUuid),x=p.getMeasureIdxFromUuid(U.measureUuid);if(p.checkMeasureIdx(x),!p.hasPartVoiceIdx(m.partIdx,m.voiceIdx))throw new f.default(m.voiceIdx);const S=p.getPartNbStaves(m.partIdx),K=m.staffIdx;if(!P.default.isInteger(K)||K<0||K>=S)throw new c.default(m.staffIdx);const H=p.getMeasure(m.partIdx,x);let Y=l.default.getOctaveShifts(H,m.staffIdx);Y=Y.filter(h.A.isStart);const C=g(Y,U.octaveShiftUuid),y=h.A.getTimePos(C),F=p.getPartMeasures(m.partIdx),N=(0,r.A)(F,x,m.staffIdx,y);N.startDpq=l.default.getDpq(H);const G=p.getMeasure(m.partIdx,N.stopMeasureIdx);N.stopDpq=l.default.getDpq(G),N.partIdx=m.partIdx,N.staffIdx=m.staffIdx;const nt=_(p,m,N);return Object.assign(N,nt),D(N,p),N},_=function(p,m,v){const U=(0,I.default)(v);U.searchedVoiceIdx=m.voiceIdx,U.staffVoicesIndexes=p.getPartStaffVoicesIndexes(m.partIdx,m.staffIdx);const x=p.getPartMeasures(m.partIdx),S=new n.A(x,m.partIdx,p);return(0,o.A)(S,U)},g=function(p,m){return p.find(E,m)},E=function(p){const m=this.valueOf();return h.A.getOctaveShiftUuid(p)===m},D=function(p,m){p.startMeasureUuid=m.getMeasureUuid(p.startMeasureIdx),p.startVoiceUuid=m.getPartVoiceUuid(p.partIdx,p.startVoiceIdx),p.stopMeasureUuid=m.getMeasureUuid(p.stopMeasureIdx),p.stopVoiceUuid=m.getPartVoiceUuid(p.partIdx,p.stopVoiceIdx),p.partUuid=m.getPartUuid(p.partIdx),p.staffUuid=m.getPartStaffUuid(p.partIdx,p.staffIdx)},M=T},951100:(O,A,t)=>{t.d(A,{A:()=>n});var f=t(383279),e=t(446921),s=t(701387),c=t(123491),d=t(351277),i=t(292681);function a(u){const l=e.A.getMeasures(u),h={hasDataChanged:!1};return l.forEach(o,h),h.hasDataChanged}function o(u){s.default.getNotes(u).forEach(r,this)}function r(u){if(!c.default.isRest(u)&&c.default.hasPitch(u)){const l=this,h=c.default.getPitch(u),I=d.default.getOctave(h),P=d.default.getStep(h),T=i.default.create(I,P);c.default.setUnpitched(u,T),delete u.pitch,l.hasDataChanged=!0}}function n(u,l){u.forEach(function(h,I){if(!f.default.hasUnpitched(h))return;const P=l[I];a(P)&&(f.default.dropUnpitchedMapping(h),f.default.removeLegacyPitchMapping(h))})}},954410:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(701387),e=t(123491);function s(d){const i=f.default.getNotes(d);if(i.some(e.default.hasForward))return;const a={realTimePos:0,invalidTimePos:0};i.some(c,a)}function c(d){const i=this;if(e.default.hasBackup(d)){const a=e.default.getBackupDuration(d);if(a!==i.realTimePos)if(a===i.invalidTimePos)e.default.addBackup(d,i.realTimePos);else return!0;i.realTimePos=0,i.invalidTimePos=0}if(e.default.hasDuration(d)){const a=e.default.getDuration(d);i.invalidTimePos+=a,e.default.isChord(d)||(i.realTimePos+=a)}}},956722:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(364842),e=t(612040),s=t(701387),c=t(558280);const d=function(n,u,l,h){const I=new i(n,u,l,h);return I.search(),I.getResult()},i=function(n,u,l,h){this.init(n,u,l,h)},a=i.prototype;a.init=function(n,u,l,h){this.measures=n,this.entryMeasureIdx=u,this.entryTimePos=h,this.entryStaffIdx=l,this.candidateMeasureIdx=null,this.directionsByMeasures={},this.startTimePos=null,this.startMeasureIdx=null,this.stopTimePos=null,this.stopMeasureIdx=null,this.type=null,this.placement=null},a.search=function(){this.searchStart(),this.isStartAtEntry()&&this.shiftEntryTimePos(),this.searchStop()},a.searchStart=function(){for(this.candidateMeasureIdx=this.entryMeasureIdx;this.candidateMeasureIdx>=0&&!this.hasFoundStart();this.candidateMeasureIdx--)this.searchStartMeasure();if(!this.hasFoundStart()){const n="We were not able to find the wedge left side.";throw new f.default("WedgeStartNotFound",n)}},a.searchStartMeasure=function(){let n=this.getWedgeDirectionsAtCandidateMeasure();this.isEntryMeasure()&&(n=this.filterLowerOrEqual(n)),this.searchStartTimePos(n)},a.filterLowerOrEqual=function(n){const u=[],l=n.length;for(let h=0;h<l;h++){const I=n[h];if(c.A.getTimePos(I)>this.entryTimePos)return u;u.push(I)}return u},a.searchStartTimePos=function(n){const u=n.length;for(let l=u-1;l>=0&&!this.hasFoundStart();l--){const h=n[l];c.A.getLocation(h)===e.A.LEFT&&this.startFound(h)}},a.hasFoundStart=function(){return this.startMeasureIdx!==null},a.startFound=function(n){const u=c.A.getTimePos(n);this.startTimePos=u,this.startMeasureIdx=this.candidateMeasureIdx,this.type=c.A.getType(n),this.placement=c.A.getPlacement(n)},a.isStartAtEntry=function(){return this.startMeasureIdx===this.entryMeasureIdx&&this.startTimePos===this.entryTimePos},a.shiftEntryTimePos=function(){this.entryTimePos++},a.searchStop=function(){const n=this.measures.length;for(this.candidateMeasureIdx=this.entryMeasureIdx;this.candidateMeasureIdx<n&&!this.hasFoundStop();this.candidateMeasureIdx++)this.searchStopMeasure();if(!this.hasFoundStop()){const u="We were not able to find the wedge right side.";throw new f.default("WedgeStopNotFound",u)}},a.searchStopMeasure=function(){let n=this.getWedgeDirectionsAtCandidateMeasure();this.isEntryMeasure()&&(n=this.filterGreaterOrEqual(n)),this.searchStopTimePos(n)},a.getWedgeDirectionsAtCandidateMeasure=function(){if(typeof this.directionsByMeasures[this.candidateMeasureIdx]=="undefined"){const n=this.measures[this.candidateMeasureIdx],u=s.default.getWedges(n,this.entryStaffIdx);u.sort(o),this.directionsByMeasures[this.candidateMeasureIdx]=u}return this.directionsByMeasures[this.candidateMeasureIdx]};const o=function(n,u){const l=c.A.getTimePos(n),h=c.A.getTimePos(u);return l-h};a.isEntryMeasure=function(){return this.candidateMeasureIdx===this.entryMeasureIdx},a.filterGreaterOrEqual=function(n){const u=[],l=n.length;for(let h=l-1;h>=0;h--){const I=n[h];if(c.A.getTimePos(I)<this.entryTimePos)return u;u.unshift(I)}return u},a.searchStopTimePos=function(n){const u=n.length;for(let l=0;l<u&&!this.hasFoundStop();l++){const h=n[l];c.A.getLocation(h)===e.A.RIGHT&&this.stopFound(h)}},a.hasFoundStop=function(){return this.stopMeasureIdx!==null},a.stopFound=function(n){const u=c.A.getTimePos(n);this.stopTimePos=u,this.stopMeasureIdx=this.candidateMeasureIdx},a.getResult=function(){return{startMeasureIdx:this.startMeasureIdx,startTimePos:this.startTimePos,stopMeasureIdx:this.stopMeasureIdx,stopTimePos:this.stopTimePos,placement:this.placement,type:this.type}};const r=d},958537:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(882934);const c=function(d){let i=f.default.getSounds(d);i.forEach(e.A.removeSwing),i=i.filter(e.A.isNotEmpty),f.default.setSounds(d,i)}},960096:(O,A,t)=>{t.d(A,{A:()=>e});const e=61},960452:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(701387),e=t(123491);function s(c){f.default.getNotes(c).forEach(i=>e.default.setBeams(i,[]))}},963062:(O,A,t)=>{t.d(A,{A:()=>a});var f=t(701387),e=t(952818),s=t(919973),c=t(364842);const d=function(o,r,n){this.init(o,r,n)},i=d.prototype;i.init=function(o,r,n){this.scoreData=o,this.location=r,this.utils=n,this.entities=[],this.ongoingEntry=null},i.get=function(){this.initTimePos(),this.measureIdx=this.location.startMeasureIdx;const o=this.location.stopMeasureIdx;for(;this.measureIdx<=o;this.measureIdx++){let r=this.utils.getEntities.call(this,this.measureIdx);r=r.filter(this.positionPredicate,this),r.forEach(this.addEntity,this),this.moveForward()}return this.entities},i.initTimePos=function(){this.position=s.A.create(-this.location.startTimePos,this.location.startDpq),this.startPosition=s.A.create(this.location.startTimePos,this.location.startDpq),this.stopPosition=s.A.create(this.location.stopTimePos,this.location.stopDpq)},i.getDpq=function(o){const r=this.getMeasure(o);return f.default.getDpq(r)},i.getMeasure=function(o){return this.scoreData.getMeasure(this.location.partIdx,o)},i.positionPredicate=function(o){const r=e.A.getTimePos(o);if(this.measureIdx===this.location.startMeasureIdx){const n=this.utils.getDpq.call(this,o,this.location.startMeasureIdx),u=s.A.create(r,n);if(s.A.isGreater(this.startPosition,u))return!1}if(this.measureIdx===this.location.stopMeasureIdx){const n=this.utils.getDpq.call(this,o,this.location.stopMeasureIdx),u=s.A.create(r,n);if(s.A.isGreater(u,this.stopPosition))return!1}return!0},i.addEntity=function(o){if(this.utils.isStart(o))this.addStart(o);else if(this.utils.isStop(o))this.addStop(o);else throw new c.default("Unexpected")},i.addStart=function(o){if(this.hasStart())throw new c.default("Unexpected");const r=this.getEntityFinalPosition(o),n=s.A.getNumerator(r),u=s.A.getDenominator(r),l={startTimePos:n,startDpq:u};this.utils.fillEntity(o,l),this.ongoingEntry=l},i.addStop=function(o){if(!this.hasStart())return;const r=this.getEntityFinalPosition(o),n=s.A.getNumerator(r),u=s.A.getDenominator(r),l=this.ongoingEntry;this.ongoingEntry=null,l.stopTimePos=n,l.stopDpq=u,this.entities.push(l)},i.getEntityFinalPosition=function(o){const r=e.A.getTimePos(o),n=this.utils.getDpq.call(this,o,this.measureIdx),u=s.A.create(r,n);return s.A.add(this.position,u)},i.hasStart=function(){return this.ongoingEntry!==null},i.getMeasureDpq=function(o){const r=this.getMeasure(o);return f.default.getDpq(r)},i.moveForward=function(){const o=this.getMeasure(this.measureIdx),r=f.default.getDpq(o),n=f.default.getNbDivisions(o),u=s.A.create(n,r);this.position=s.A.add(this.position,u)};const a=d},963407:(O,A,t)=>{t.d(A,{A:()=>M});var f=t(383279),e=t(446921),s=t(701387),c=t(123491);const d=function(p,m){const v=i(p),U=m.length;return o(v,U).map(r,m)},i=function(p){const m={};return p.forEach(a,m),m},a=function(p){const m=this,v=c.default.getStaffIdx(p);m[v]=!0},o=function(p,m){const v=[];for(let U=0;U<m;U++)typeof p[U]=="undefined"&&v.push(U);return v},r=function(p){const v=this[p].mainVoiceIdx;return{staffIdx:p,voiceIdx:v}},n=d;var u=t(832560),l=t(657032);const h=function(p,m){const v=new u.A(p);m.forEach(I,v)},I=function(p){const m=this;m.getVoicesList().insertVoice(p.voiceIdx);const U={staffIdx:p.staffIdx,voiceIdx:p.voiceIdx};new l.A(m,U).perform()},P=h,_=function(p,m){const v=s.default.getNotes(p),U=n(v,m);P(p,U)},g=function(p,m){p.forEach(E,m)},E=function(p,m){const U=this[m],x=f.default.getStaffMapping(p);e.A.getMeasures(U).forEach(D,x)},D=function(p){_(p,this)},M=g},967636:(O,A,t)=>{t.d(A,{A:()=>g});var f=t(411993),e=t(123491),s=t(701387),c=t(562628),d=t(511890),i=t(12597),a=t(364842);const o=function(){this.init()},r=o.prototype;r.init=function(){this.leftNotes={}},r.addChord=function(E){this.matchSlides(E),this.dropStartedSlides(),this.storeStartingSlides(E)},r.matchSlides=function(E){E=E.filter(e.default.hasSlideStop),E=n(E,i.A.STOP);let D;for(D in this.leftNotes)typeof E[D]!="undefined"&&(delete this.leftNotes[D],delete E[D]);for(D in E){D=parseInt(D,10);const M=E[D];e.default.removeSlideStop(M,D)}},r.dropStartedSlides=function(){for(let E in this.leftNotes){E=parseInt(E,10);const D=this.leftNotes[E];e.default.removeSlideStart(D,E)}this.leftNotes={}},r.storeStartingSlides=function(E){E=E.filter(e.default.hasSlideStart),this.leftNotes=n(E,i.A.START)};const n=function(E,D){const M={};return E.forEach(function(p){u(p,D).slice().forEach(function(v){const U=d.default.getNumber(v);typeof M[U]!="undefined"?e.default.removeSlide(p,v):M[U]=p})}),M};function u(E,D){if(D===i.A.START)return e.default.getSlideStarts(E);if(D===i.A.STOP)return e.default.getSlideStops(E);throw new a.default("Unexpected")}r.endReached=function(){this.dropStartedSlides()};const l=o,h=function(E){new I(E).filter()},I=function(E){this.init(E)},P=I.prototype;P.init=function(E){this.measures=E,this.buffers={}},P.filter=function(){this.measures.forEach(this.filterMeasure,this),this.flushBuffers()},P.filterMeasure=function(E){const D=s.default.getNotes(E);D.forEach(T);const M=f.A.groupVoices(D);for(const p in M){const m=M[p];this.filterNotes(m)}};function T(E){e.default.isGraceNote(E)&&e.default.removeSlides(E)}P.filterNotes=function(E){const D=_(E),M=this.getVoiceBuffer(D);(0,c.A)(E).forEach(M.addChord,M)};const _=function(E){const D=E[0];return e.default.getVoiceIdx(D)};P.getVoiceBuffer=function(E){return this.hasBuffer(E)||this.createBuffer(E),this.buffers[E]},P.hasBuffer=function(E){return typeof this.buffers[E]!="undefined"},P.createBuffer=function(E){this.buffers[E]=new l},P.flushBuffers=function(){for(const E in this.buffers)this.buffers[E].endReached()};const g=h},974868:(O,A,t)=>{t.d(A,{A:()=>s});var f=t(373758);const s=function(c,d){c.forEach(function(i,a){const o=d[a];f.A.updateIdFromIdx(i,o,a),f.A.checkOrGenerateUuid(i,o)})}},978821:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(123491),e=t(701387),s=t(353922),c=t(348742);const d="BAD_NOTEHEAD";function i(n){e.default.getNotes(n).forEach(a)}function a(n){const u=f.default.getHead(n);s.A.isValid(u)||o(u)}function o(n){const u=r(n),l=new c.A(d,u);throw l.notehead=n,l}function r(n){return`The notehead "${n}" is not supported yet.`}},980529:(O,A,t)=>{t.d(A,{A:()=>o});var f=t(383279),e=t(856219);const s=function(r){let n=f.default.getMIDIInstruments(r);const u=f.default.getScoreInstruments(r);if(c(u,n))return;const l=f.default.getScoreInstrumentsMap(r);n=n.filter(d,l),f.default.setMIDIInstruments(r,n)};function c(r,n){return r.length===0&&n.length===1&&!e.default.hasUnpitched(n[0])}const d=function(r){const n=this,u=e.default.getId(r);return typeof n[u]!="undefined"},i=s,o=function(r){r.forEach(i)}},980641:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(123491),e=t(707165);const c=function(d,i){const a=f.default.getDuration(d),o=f.default.getTimeModif(d);return(0,e.A)(a,i,o)}},981060:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(701387),e=t(123491),s=t(259563);function c(i){f.default.getNotes(i).forEach(d)}function d(i){e.default.isGraceNote(i)&&(e.default.removeDuration(i),e.default.hasDurationType(i)||e.default.setDurationType(i,s.default.EIGHT))}},982488:(O,A,t)=>{t.d(A,{A:()=>i});var f=t(701387),e=t(35802),s=t(377180),c=t(104907),d=t(627300);function i(u){if(!f.default.hasOwnAttributes(u))return;const l=f.default.getOwnAttributes(u);if(!e.default.hasStaffDetails(l)||e.default.hasTranspose(l))return;const h=e.default.getStaffDetails(l);if(h.some(a)){e.default.setStaffDetails(l,[]);return}const I=s.default.createComplete(0,0,-1);e.default.setTranspose(l,[I]),h.forEach(r)}function a(u){return c.default.getStaffTunings(u).some(o)}function o(u){return d.default.getOctave(u)===0}function r(u){c.default.getStaffTunings(u).forEach(n)}function n(u){let l=d.default.getOctave(u);l--,d.default.setOctave(u,l)}},984223:(O,A,t)=>{t.d(A,{A:()=>r});var f=t(701387),e=t(584416),s=t(963062);const c=function(n,u){u.placement=e.A.getPlacement(n)},d=function(n){const u=this.getMeasure(n);return f.default.getPedals(u,this.location.staffIdx)},i=function(n,u){return this.getMeasureDpq(u)},a={getEntities:d,isStart:e.A.isStart,isStop:e.A.isStop,fillEntity:c,getDpq:i},r=function(n,u){return new s.A(n,u,a).get()}},984671:(O,A,t)=>{t.d(A,{A:()=>T});var f=t(952818),e=t(501696),s=t(909748);const c=function(_){return _=new d(_).group(),_},d=function(_){this.init(_)},i=d.prototype;i.init=function(_){this.wrappedDirections=_,this.ongoingTempoChange=null,this.previousLocation=null,this.grouppedDirections=[]},i.group=function(){return this.wrappedDirections.forEach(this.analyzeTempoChange,this),this.grouppedDirections},i.analyzeTempoChange=function(_){const g=_.direction,E=f.A.getTempoChange(g),D=e.A.getType(E);s.A.assert(D),D===s.A.CONTINUE||(s.A.isStart(D)?this.startTempoChange(_):D===s.A.STOP&&this.stopTempoChange(_))},i.startTempoChange=function(_){const g=_.direction,E=f.A.getTimePos(g);(!this.previousLocation||!a(this.previousLocation,_.measureIdx,E))&&this.addTempoChangeStart(_)};const a=function(_,g,E){return _.measureIdx===g&&_.timePos===E};i.addTempoChangeStart=function(_){this.ongoingTempoChange=_},i.stopTempoChange=function(_){const g=_.direction;if(this.hasTempoChangeStart()){const E=this.getWrappedStart();if(!o(E,_)){this.addCompleteTempoChange(E,_);const D=f.A.getTimePos(g);this.previousLocation={timePos:D,measureIdx:E.measureIdx}}this.discardDirection()}},i.hasTempoChangeStart=function(){return this.ongoingTempoChange!==null},i.getWrappedStart=function(){return this.ongoingTempoChange},i.discardDirection=function(){this.ongoingTempoChange=null};const o=function(_,g){return _.timePos===g.timePos&&_.measureIdx===g.measureIdx};i.addCompleteTempoChange=function(_,g){this.grouppedDirections.push(_),this.grouppedDirections.push(g)};const r=c;var n=t(817066),u=t(537920),l=t(364842);const h=function(_){let g=I(_),E=(0,n.A)(g);E=r(E),g=(0,u.A)(E,_.getNbMeasures()),P(g,_)},I=function(_){const g=[],E=_.getNbMeasures();for(let D=0;D<E;D++){const M=_.getTempoChanges(D);g.push(M)}return g},P=function(_,g){if(g.getNbMeasures()!==_.length){const E="Array size should be the same.";throw new l.default("NotSameSize",E)}_.forEach(function(E,D){g.setTempoChanges(D,E)})},T=h},985046:(O,A,t)=>{t.d(A,{A:()=>k});var f=t(702544),e=t(153271),s=t(857552),c=t(476943),d=t(123491),i=t(351277),a=t(209175),o=t(515819),r=t(292681),n=t(50060),u=t(712947),l=t(377180),h=t(104907),I=t(890439),P=t(870437),T=t(701387),_=t(35802),g=t(518558),E=t(316197),D=t(860716),M=t(383279),p=t(856219),m=t(511890),v=t(414787),U=t(129283),x=t(832560),S=t(539203),K=t(189247),H=t(673817),Y=t(485037),C=t(24724),y=t(261586),F=t(353922),N=t(364842);const G={AUTO:"auto",UP:"up",DOWN:"down"},nt=[G.AUTO,G.UP,G.DOWN];G.assert=function(L){G.isValid(L)||G.raiseError(L)},G.isValid=function(L){return nt.includes(L)},G.raiseError=function(L){const $=`The start/stop value [${L}] is invalid.`;throw new N.default("BadArpeggiateType",$)};const J=G;var V=t(748049),W=t(724095),Z=t(760367);const dt=function(L,$,ut){const w=lt(),st=w.get(L,$,ut);return w.cleanUp(),st},at=function(){},B=at.prototype;B.get=function(L,$,ut){this.reset(L,$),this.checkLocation(ut),this.searchTupletStart(),this.searchTupletStop(),this.extractAttributes(),this.isUnpitched=this.scoreData.isPartUnpitched(this.location.partIdx),this.hasQuarterTone=this.scoreData.hasPartQuarterTone(this.location.partIdx),this.extractNotes(),this.extractSlurs();let w;this.slides.length>0&&(w=this.slides);let st;this.tremolos.length>0&&(st=this.tremolos);let tt;this.hammerOnPullOffs.length>0&&(tt=this.hammerOnPullOffs);const it={isUnpitched:this.isUnpitched,hasQuarterTone:this.hasQuarterTone,notes:this.notes,ties:this.ties,slurs:this.slurs,glissandos:this.glissandos,slides:w,tremolos:st,hammerOnPullOffs:tt,attributes:this.attributes};return it.isUnpitched&&(this.addInstrumentsDataToUnpitchedMapping(),this.convertUnpitchedMappingToLines(),it.unpitchedMapping=this.unpitchedMapping),it},B.reset=function(L,$){this.scoreData=L,this.location=$,this.measuresScroller=null,this.fakeMeasuresScroller=null,this.voice=null,this.dpq=null,this.attributes={},this.notes=[],this.ties=[],this.slurs=[],this.glissandos=[],this.slides=[],this.tremolos=[],this.hammerOnPullOffs=[],this.noteIdx=null,this.noteData=null,this.headData=null,this.fakeMeasureDataMap={},this.unpitchedMapping={}},B.checkLocation=function(L){if(typeof L!="undefined"){this.measuresScroller=L;return}const $=this.location.partIdx,ut=this.scoreData.getNbParts();if($<0||$>=ut)throw new f.default($,f.default.GET);this.measuresScroller=(0,S.A)(this.scoreData,this.location);const w=this.location.startMeasureIdx,st=this.location.stopMeasureIdx,tt=this.location.startNoteIdx,it=this.location.stopNoteIdx,It=st-w;if(It<0)throw new s.default(s.default.MEASURE,w,st);if(It===0&&tt>it)throw new s.default(s.default.NOTE,tt,it);const xt=this.scoreData.getNbMeasures();let Ot;if(Ot=w,Ot<0||Ot>=xt)throw new e.default(Ot,e.default.GET);if(Ot=st,Ot<0||Ot>=xt)throw new e.default(Ot,e.default.GET);let St,Nt,j;Ot=w,j=tt,St=this.measuresScroller.getMeasureData(Ot),St.checkVoiceIdx(this.location.voiceIdx),Nt=St.getVoice(this.location.voiceIdx),Nt.checkNoteIdx(j),Ot=st,j=it,St=this.measuresScroller.getMeasureData(Ot),Nt=St.getVoice(this.location.voiceIdx),Nt.checkNoteIdx(j)},B.searchTupletStart=function(){let L=this.location.startNoteIdx;const ut=this.measuresScroller.getMeasureData(this.location.startMeasureIdx).getVoice(this.location.voiceIdx);let w=ut.getNote(L);if(!d.default.hasNormalTimeModif(w)){for(;!d.default.hasTupletStart(w);)L--,w=ut.getNote(L);this.location.startNoteIdx=L}},B.searchTupletStop=function(){let L=this.location.stopNoteIdx;const ut=this.measuresScroller.getMeasureData(this.location.stopMeasureIdx).getVoice(this.location.voiceIdx);let w=ut.getNote(L);if(!d.default.hasNormalTimeModif(w)){for(;!d.default.hasTupletStop(w);)L++,w=ut.getNote(L);this.location.stopNoteIdx=L}},B.extractAttributes=function(){const L=this.scoreData.getPartVoiceMainStaffIdx(this.location.partIdx,this.location.voiceIdx),$=this.measuresScroller.getMeasureData(this.location.startMeasureIdx);this.attributes.transpose=l.default.copy($.getTranspose(L)),this.attributes.staffDetails=h.default.copy($.getStaffDetails(L))},B.extractNotes=function(){this.forEachNote(this.extractNote)},B.extractNote=function(L,$,ut){this.noteIdx=$,this.relativeNoteIdx=ut,this.measureIdx=L,this.voice.isRest($)?this.extractRest():this.extractChord()},B.extractRest=function(){this.noteData={isRest:!0};const L=this.voice.getNote(this.noteIdx);this.extractDuration(L,this.noteData),this.extractNoteLyrics(L),this.extractArticulations(L),d.default.hasColor(L)&&(this.noteData.color=d.default.getColor(L)),this.notes.push(this.noteData)},B.extractChord=function(){const L=this.voice.getNote(this.noteIdx);this.noteData={},this.extractDuration(L,this.noteData),this.extractGraces(),this.extractGraceSlur(),this.extractNoteLyrics(L),this.extractArticulations(L),this.extractArpeggiate(L),this.extractBeamStatus(L),d.default.hasOrnaments(L)&&(this.noteData.ornaments=d.default.getOrnamentsWithOpts(L),this.noteData.ornaments[W.A.TREMOLO]&&this.noteData.ornaments[W.A.TREMOLO].type&&delete this.noteData.ornaments[W.A.TREMOLO]),d.default.hasTechnicals(L)&&(this.noteData.technicals=I.Ay.fromList(d.default.getTechnicalList(L))),this.isUnpitched?this.noteData.instruments=[]:this.noteData.heads=[],c.default.makeArray(this.voice.getChord(this.noteIdx)).forEach(this.extractNoteHead,this),this.notes.push(this.noteData)},B.extractArticulations=function(L){(d.default.hasNotations(L)||d.default.hasArticulations(L))&&(this.noteData.articulations=I.Ay.fromList(d.default.getFullArticulationsList(L))),this.noteData.articulations=I.Ay.fromList(d.default.getFullArticulationsList(L))},B.extractArpeggiate=function(L){d.default.hasArpeggiate(L)&&(this.noteData.arpeggiate=J.AUTO)},B.extractBeamStatus=function(L){const $=d.default.getBeamStatus(L);$!==V.A.AUTO&&(this.noteData.beamStatus=$)},B.extractNoteLyrics=function(L){const $=d.default.getLyrics(L).slice();$.sort(n.default.compare);const ut=$.map(gt);this.noteData.lyrics=ut};const gt=function(L){const $=n.default.getLevel(L);if(n.default.hasLeftMelisma(L))return{isMelisma:!0,level:$};const ut=n.default.getText(L),w=n.default.hasRightConnection(L);return{text:ut,hasRightConnection:w,level:$}};B.extractDuration=function(L,$){const ut=d.default.getNormalQuarterDuration(L,this.dpq),w=o.default.quarterToDurationOpts(ut);if($.nbDots=w.nbDots,$.durationType=w.durationType,d.default.hasTupletStart(L)){const tt=d.default.getTupletStart(L,1),it=d.default.getTimeModif(L),It=P.A.getDurationType(tt);$.tuplet={durationType:It,timeModif:a.default.copy(it)}}},B.extractGraces=function(){this.noteData.graces=[];for(let L=0;L<this.voice.getNbGraces(this.noteIdx);L++){let $=this.voice.getGraceChord(this.noteIdx,L);$=c.default.makeArray($),this.extractGraceChord($),this.noteData.graces.push(this.graceData)}},B.extractGraceSlur=function(){const L=this.voice.getNote(this.noteIdx);d.default.hasGraceSlur(L)&&(this.noteData.hasGraceSlur=!0)},B.extractGraceChord=function(L){this.graceData={},this.graceData.heads=[],L.forEach(function($,ut){if(ut===0){const w=d.default.getDurationType($);this.graceData.durationType=w,d.default.isSlashedGrace($)&&(this.graceData.isSlashed=!0)}this.isUnpitched?this.extractUnpitchedGraceHead($):this.extractPitchedGraceHead($),d.default.hasColor($)&&(this.graceHeadData.color=d.default.getColor($)),this.graceData.heads.push(this.graceHeadData)},this)},B.extractUnpitchedGraceHead=function(L){const $=d.default.getUnpitched(L),ut=d.default.getHead(L),w=h.default.getNbStaffLines(this.attributes.staffDetails),st=v.A.pitchToLine($,w);this.graceHeadData={unpitched:r.default.copy($),notehead:ut,line:st},this.recordUnpitched(L)},B.extractPitchedGraceHead=function(L){const $=d.default.getPitch(L);this.graceHeadData={pitch:i.default.copy($)},d.default.hasTabData(L)&&(this.graceHeadData.fretData=d.default.getTabData(L))},B.extractNoteHead=function(L){this.headData={},this.isUnpitched?(this.extractUnpitchedHead(L),this.noteData.instruments.push(this.headData)):(this.extractPitchedHead(L),this.noteData.heads.push(this.headData))},B.extractUnpitchedHead=function(L){const $=d.default.getUnpitched(L),ut=h.default.getNbStaffLines(this.attributes.staffDetails);if(this.headData.line=v.A.pitchToLine($,ut),this.headData.unpitched=r.default.copy($),this.headData.notehead=d.default.getHead(L),!this.isLastNote()&&d.default.hasTieStart(L)){const st=r.default.copy($);st.noteIdx=this.relativeNoteIdx,st.line=this.headData.line,st.notehead=this.headData.notehead;const tt=d.default.getTieDirection(L);tt===Z.A.FLIPPED&&(st.tieDirection=tt),this.ties.push(st)}d.default.hasHeadParentheses(L)&&(this.headData.isGhost=!0),d.default.hasColor(L)&&(this.headData.color=d.default.getColor(L));const w=d.default.getInstrumentId(L);this.headData.MIDIUnpitched=this.scoreData.searchInstrumentMIDIUnpitched(this.location.partIdx,w),this.recordUnpitched(L)},B.extractPitchedHead=function(L){const $=d.default.getPitch(L);if(this.headData.pitch=i.default.copy($),!this.isLastNote()&&d.default.hasTieStart(L)){const w=i.default.copy($);w.noteIdx=this.relativeNoteIdx;const st=d.default.getTieDirection(L);st===Z.A.FLIPPED&&(w.tieDirection=st),this.ties.push(w)}if(!this.isLastNote()&&d.default.hasSlideStart(L)&&this.addSlide(L),!this.isLastNote()&&d.default.hasHammerOnPullOffStart(L)&&this.addHammerOnPullOff(L),!this.isLastNote()&&d.default.hasTremoloStart(L)&&this.addTremolo(L),d.default.hasHeadParentheses(L)&&(this.headData.isGhost=!0),d.default.hasColor(L)&&(this.headData.color=d.default.getColor(L)),d.default.hasFingering(L)&&(this.headData.fingering=d.default.getFingering(L)),d.default.hasHarmonic(L)){const w=d.default.getHarmonic(L),st=D.default.getType(w);this.headData.harmonic=st}d.default.hasCourtesyAccidental(L)&&(this.headData.hasCourtesyAccidental=!0);const ut=d.default.getHead(L);ut!==F.A.NORMAL&&(this.headData.notehead=ut),d.default.hasGlissandos(L)&&d.default.getGlissandos(L).forEach(function(st){const tt=i.default.copy($),it=E.default.getType(st);(U.default.isStop(it)&&!this.isFirstNote()||U.default.isStart(it)&&!this.isLastNote())&&(tt.noteIdx=this.relativeNoteIdx,tt.glissandoType=it,tt.number=E.default.getNumber(st),this.glissandos.push(tt))},this),d.default.hasTabData(L)&&(this.headData.fretData=d.default.getTabData(L))},B.addSlide=function(L){const $=d.default.getPitch(L),ut=d.default.getSlideStarts(L),w=new y.A(this.measureData,this.location.voiceIdx,this.noteIdx);ut.forEach(st=>{const tt=m.default.getNumber(st),it=(0,C.A)(w,tt),It={leftPitch:i.default.copy($),rightPitch:i.default.copy(it),noteIdx:this.relativeNoteIdx};this.slides.push(It)})},B.addHammerOnPullOff=function(L){const $=d.default.getPitch(L),ut={leftPitch:i.default.copy($),noteIdx:this.relativeNoteIdx};this.hammerOnPullOffs.push(ut)},B.addTremolo=function(L){const{nbBeam:$}=d.default.getOrnamentOpts(L,W.A.TREMOLO),ut={nbBeams:$,noteIdx:this.relativeNoteIdx};this.tremolos.push(ut)},B.isLastNote=function(){return this.noteIdx===this.location.stopNoteIdx&&this.measureIdx===this.location.stopMeasureIdx},B.isFirstNote=function(){return this.noteIdx===this.location.startNoteIdx&&this.measureIdx===this.location.startMeasureIdx},B.extractSlurs=function(){this.slurData=null,this.forEachNote(this.extractSlur)},B.extractSlur=function(L,$,ut){const st=this.voice.getNote($);if(d.default.hasSlurStart(st)){const tt=d.default.getSlur(st),it=u.default.getPlacement(tt);this.slurData={startNoteIdx:ut,placement:it}}else d.default.hasSlurStop(st)&&this.slurData!==null&&(this.slurData.stopNoteIdx=ut,this.slurs.push(this.slurData),this.slurData=null)},B.forEachNote=function(L){const $=this.location.startMeasureIdx,ut=this.location.stopMeasureIdx;let w=0;for(let st=$;st<=ut;st++){const tt=this.measuresScroller.getMeasureData(st);this.measureData=tt;let it;tt.hasVoice(this.location.voiceIdx)?(it=tt.getVoice(this.location.voiceIdx),this.dpq=tt.getDpqValue()):(it=this.getHiddenVoice(st),this.dpq=this.getHiddenVoiceDpq(st)),this.voice=it;let It=0;st===$&&(It=this.location.startNoteIdx);let xt;st===ut?xt=this.location.stopNoteIdx:xt=it.getNbNotes()-1;for(let Ot=It;Ot<=xt;Ot++)L.call(this,st,Ot,w),w++}},B.getHiddenVoice=function(L){return this.getFakeMeasureData(L).getVoice(this.location.voiceIdx)},B.getHiddenVoiceDpq=function(L){return this.getFakeMeasureData(L).getDpqValue()},B.getFakeMeasureData=function(L){return typeof this.fakeMeasureDataMap[L]=="undefined"&&this.createFakeMeasureData(L),this.fakeMeasureDataMap[L]},B.createFakeMeasureData=function(L){let ut=this.measuresScroller.getMeasureData(L).getAnyTime();ut=g.default.copy(ut);const w={};T.default.setNotes(w,[]);const st={};_.default.setTime(st,[ut]),T.default.setAttributes(w,st);const tt=this.getFakeMeasuresScroller(),it=new x.A(w,L,tt,this.scoreData),It=new H.A,xt={partIdx:this.location.partIdx,measureIdx:L,voiceIdx:this.location.voiceIdx};new Y.A(it,xt,It).perform(),this.fakeMeasureDataMap[L]=it},B.getFakeMeasuresScroller=function(){if(this.fakeMeasuresScroller===null){const L=this.createFakeMeasures();this.fakeMeasuresScroller=new K.A(L,this.location.partIdx,this.scoreData)}return this.fakeMeasuresScroller},B.createFakeMeasures=function(){const L=this.scoreData.getNbMeasures(),$=[];for(let ut=0;ut<L;ut++)$.push(null);return $},B.cleanUp=function(){this.scoreData=null,this.location=null,this.measuresScroller=null,this.fakeMeasuresScroller=null,this.voice=null,this.dpq=null,this.attributes=null,this.notes=null,this.ties=null,this.slurs=null,this.noteIdx=null,this.noteData=null,this.headData=null,this.fakeMeasureDataMap=null,this.unpitchedMapping=null},B.recordUnpitched=function(L){const $=d.default.getUnpitched(L),ut=r.default.stringify($),w=d.default.getHead(L),st=d.default.getInstrumentId(L);typeof this.unpitchedMapping[ut]=="undefined"&&(this.unpitchedMapping[ut]={}),typeof this.unpitchedMapping[ut][w]=="undefined"&&(this.unpitchedMapping[ut][w]=st)},B.addInstrumentsDataToUnpitchedMapping=function(){const L=this.scoreData.getPartHeader(this.location.partIdx),$=M.default.getUnpitchedMapping(L),ut=M.default.getMIDIInstrumentsMap(L);for(const[w,st]of Object.entries(this.unpitchedMapping))Object.keys(st).forEach(tt=>{const it=st[tt],It=ut[it],xt=p.default.getMIDIProgram(It),Ot=p.default.getUnpitched(It),St={"midi-program":xt,"midi-unpitched":Ot};$[w].default===tt&&(St.isDefault=!0),st[tt]=St})},B.convertUnpitchedMappingToLines=function(){const L=h.default.getNbStaffLines(this.attributes.staffDetails),$={};for(const[ut,w]of Object.entries(this.unpitchedMapping)){const st=r.default.parse(ut),tt=v.A.pitchToLine(st,L);$[tt]=w}this.unpitchedMapping=$};const lt=function(){return X===null&&(X=new at),X};let X=null;const k=dt},987901:(O,A,t)=>{t.d(A,{A:()=>e});const f={};f.MAX_NB_VOICES_PER_STAFF=2;const e=f},989236:(O,A,t)=>{t.d(A,{A:()=>v});var f=t(701387),e=t(952818),s=t(882934);const d=function(U){if(!e.A.hasSound(U))return!1;const x=e.A.getSound(U);return s.A.hasPizzicato(x)?s.A.hasValidPizzicato(x):!1};var i=t(536949);const a=function(U){const x=e.A.getStaffIdx(U),S=e.A.getTimePos(U),K=e.A.getPlacement(U),H=o(U);return i.A.create(x,K,S,H)},o=function(U){const x=e.A.getSound(U);return s.A.getPizzicato(x)},r=a,n=function(U){return T().extract(U)},u=function(){this.pizzicatosByStaff=null},l=u.prototype;l.extract=function(U){this.reset(),U.forEach(this.processDirection,this);const x=this.pizzicatosByStaff;return this.pizzicatosByStaff=null,x},l.reset=function(){this.pizzicatosByStaff={}},l.processDirection=function(U){if(d(U)){const x=r(U);this.addPizzicato(x)}},l.addPizzicato=function(U){const x=e.A.getStaffIdx(U),S=this.getStaffPizzicatos(x),K=e.A.getTimePos(U);h(S,K),S.push(U)},l.getStaffPizzicatos=function(U){return typeof this.pizzicatosByStaff[U]=="undefined"&&(this.pizzicatosByStaff[U]=[]),this.pizzicatosByStaff[U]};const h=function(U,x){I(U,x)&&U.pop()},I=function(U,x){if(U.length===0)return!1;{const S=U.length-1,K=U[S];return e.A.getTimePos(K)===x}};let P=null;const T=function(){return P===null&&(P=new u),P},_=n;var g=t(843678),E=t(726042);const D=function(U,x){g.default.forEach(x,M,U)},M=function(U,x){U=E.default.intPart(U);const S=this;f.default.setPizzicatos(S,U,x)},p=D,v=function(U){const x=f.default.getRawDirections(U),S=_(x);p(U,S)}},990937:(O,A,t)=>{t.d(A,{A:()=>c});var f=t(607682);function e(d,i,a){return`${a.msgPrefix} entity at the time position [${d}/${i}] (quarter duration).`}class s extends f.default{constructor(i,a,o){const r=a!=null?a:1,n=o||s.GET,u=e(i,r,n);super(u),Object.defineProperty(this,"timePos",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dpq",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"action",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="BadTimePosError",this.timePos=i,this.dpq=r,this.action=n}}Object.defineProperty(s,"GET",{enumerable:!0,configurable:!0,writable:!0,value:{msgPrefix:"There is no"}}),Object.defineProperty(s,"INSERT",{enumerable:!0,configurable:!0,writable:!0,value:{msgPrefix:"Cannot insert"}});const c=s},996694:(O,A,t)=>{t.d(A,{A:()=>D});var f=t(348742),e=t(364842),s=t(701387),c=t(123491),d=t(870437),i=t(209175),a=t(515819),o=t(35802),r=t(230378),n=t(726042),u=t(259563),l=t(832560);const h=function(M){const p=new l.A(M),m=s.default.getAttributes(M);p.forEachVoice(I,m)},I=function(M){P(M,this)},P=function(M,p){let m=0;const v=M.size();let U;do if(U=T(M,m),U!==-1){const x=_(M,U);g(x,p),m=U+x.length}while(m<v&&U!==-1)},T=function(M,p){const m=M.size();for(let v=p;v<m;v++){const U=M.getNote(v);if(c.default.hasTupletStart(U))return v}return-1},_=function(M,p){const m=[],v=M.size();for(let x=p;x<v;x++){const S=M.getNote(x);if(m.push(S),c.default.hasTupletStop(S))return m}const U="cannot find a tuplet stop.";throw new e.default("Unexpected",U)},g=function(M,p){const m=M[0],U=c.default.getTupletStart(m,1),x=c.default.getTimeModif(m),S=i.default.getActual(x),K=i.default.getNormal(x),H=E(M,p),Y=r.A.createActual(S,H),C=r.A.createNormal(K);d.A.setTupletActual(U,Y),d.A.setTupletNormal(U,C)},E=function(M,p){const m=o.default.getDivisions(p),v=M[0],U=c.default.getTimeModif(v),x=i.default.getActual(U),H=M.map(c.default.getDuration).reduce(n.default.add)/x,Y=a.default.actualToNormal(H,U),C=a.default.divisionsToQuarter(Y,m);if(!a.default.isBaseDuration(C)){const F="dotted durations are not allowed for tuplet ratio.";throw new f.A("TupletDot",F)}return u.default.quarterToDurationType(C)},D=h},999970:(O,A,t)=>{t.d(A,{A:()=>D});var f=t(614653),e=t(74957),s=t(381216),c=t(464173),d=t(865349),i=t(369049),a=Object.defineProperty,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,u=(M,p,m)=>p in M?a(M,p,{enumerable:!0,configurable:!0,writable:!0,value:m}):M[p]=m,l=(M,p)=>{for(var m in p||(p={}))r.call(p,m)&&u(M,m,p[m]);if(o)for(var m of o(p))n.call(p,m)&&u(M,m,p[m]);return M};const h=[{chordKind:c.A.MINOR_7,allDegrees:[e.A.create(3,s.A.ADD,-1),e.A.create(5,s.A.ADD,-1),e.A.create(7,s.A.ADD,0)]},{chordKind:c.A.DOMINANT_7,allDegrees:[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,0),e.A.create(7,s.A.ADD,0),e.A.create(9,s.A.ADD,0)]},{chordKind:c.A.MAJOR_7,allDegrees:[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1),e.A.create(7,s.A.ADD,1)]},{chordKind:c.A.MAJOR_9,allDegrees:[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1),e.A.create(7,s.A.ADD,1),e.A.create(9,s.A.ADD,0)]},{chordKind:c.A.MAJOR_11,allDegrees:[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1),e.A.create(7,s.A.ADD,1),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0)]},{chordKind:c.A.MAJOR_13,allDegrees:[e.A.create(3,s.A.ADD,0),e.A.create(5,s.A.ADD,1),e.A.create(7,s.A.ADD,1),e.A.create(9,s.A.ADD,0),e.A.create(11,s.A.ADD,0),e.A.create(13,s.A.ADD,0)]}],I=[...c.A.jazzValues.map(M=>({chordKind:M,allDegrees:(0,d.A)(M)})),...h];function P(M){const p=I.map(m=>{const v=(0,i.A)(M,m);return l({distanceData:v},m)});return p.sort(T),p[0].chordKind}function T(M,p){return M=M.distanceData,p=p.distanceData,M.total!==p.total?M.total-p.total:!M.isSameBase&&p.isSameBase?1:M.isSameBase&&!p.isSameBase?-1:0}var _=t(244240),g=t(184469),E=t(601202);function D(M){let p=f.default.getAdagioKind(M),m=null,v=(0,_.A)(M);({chordKind:p,allDegrees:v,suspension:m}=(0,E.A)({chordKind:p,allDegrees:v})),p=P({chordKind:p,allDegrees:v});const U=(0,g.A)(p,v);return{chordKind:p,suspension:m,degreeModifications:U}}}}]);})();


//# debugId=1d418c5f-c98d-59c0-83f4-84cb583c00dc
