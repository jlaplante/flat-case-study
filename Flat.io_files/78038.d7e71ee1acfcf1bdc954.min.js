
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="d88d0ad5-9532-566d-ac73-839fb8b4d4f4")}catch(e){}}();
(()=>{/*! Copyright (c) 2025 Tutteo Ltd. */(self.webpackChunk_flat_flat=self.webpackChunk_flat_flat||[]).push([[78038],{110448:(f,g,t)=>{var e=t(636889);e.__esModule&&(e=e.default),typeof e=="string"&&(e=[[f.id,e,""]]),e.locals&&(f.exports=e.locals);var n=t(929234).A,y=n("036031b2",e,!0,{})},175002:(f,g,t)=>{"use strict";t.r(g),t.d(g,{default:()=>I});var e=t(814779),n=t.n(e),y=t(927860),k=t.n(y),b=k()(n());b.push([f.id,`.group_pqv90{padding:12px 24px;justify-content:space-between;cursor:pointer}.group_pqv90,.group-info_HP2eq{display:flex;align-items:center}.group-info-icon_NQ9Jj{margin-right:8px;width:24px;height:24px}.group-info-icon_NQ9Jj svg{width:24px;height:24px}.group-info-name_HfZNp{font-weight:600;font-size:14px;line-height:20px;color:var(--f-ink)}.toggle-group_drKmW{display:flex;align-items:center}.new-badge_LjLbF{margin-right:8px}.toggle-icon_gR7Im{transform:rotate(180deg)}.powerIcon_GnHVS{width:16px;height:16px;margin-left:4px}
`,""]),b.locals={group:"group_pqv90","group-info":"group-info_HP2eq","group-info-icon":"group-info-icon_NQ9Jj","group-info-name":"group-info-name_HfZNp","toggle-group":"toggle-group_drKmW","new-badge":"new-badge_LjLbF","toggle-icon":"toggle-icon_gR7Im",powerIcon:"powerIcon_GnHVS"};const I=b},218439:(f,g,t)=>{"use strict";t.d(g,{A:()=>G});var e=t(361744),n=t(538065);const y=t.p+"img/fb91825eb6197dbb8102.svg";var k=t(914068);const b={class:"global-mob-title"},I=["href"],H={key:2,class:"stub"},R={class:"t"},G=(0,e.pM)({__name:"MobileTitle",props:{title:{type:String,required:!0},routeBack:{type:String,default:null},urlBack:{type:String,default:null}},setup(P){return(X,w)=>{const M=(0,e.g2)("router-link");return(0,e.uX)(),(0,e.CE)("div",b,[P.routeBack?((0,e.uX)(),(0,e.Wv)(M,{key:0,to:{name:P.routeBack},class:"back"},{default:(0,e.k6)(()=>w[0]||(w[0]=[(0,e.Lk)("img",{src:y,inline:""},null,-1)])),_:1,__:[0]},8,["to"])):P.urlBack?((0,e.uX)(),(0,e.CE)("a",{key:1,href:P.urlBack,class:"back"},w[1]||(w[1]=[(0,e.Lk)("img",{src:y,inline:""},null,-1)]),8,I)):((0,e.uX)(),(0,e.CE)("div",H," \xA0 ")),(0,e.Lk)("div",R,(0,n.v_)(X.$t(P.title)),1),w[2]||(w[2]=(0,e.Lk)("div",{class:"stub"},"\xA0",-1))])}}})},414792:(f,g,t)=>{"use strict";t.r(g),t.d(g,{default:()=>I});var e=t(814779),n=t.n(e),y=t(927860),k=t.n(y),b=k()(n());b.push([f.id,`.instrument-group-active_vcEdV{background-color:var(--f-bg-1)}.instrument-item_oQ_N9{display:flex;flex-direction:column;padding:4px 20px 4px 24px;transition:all .3s ease-in-out;color:var(--f-subdue)}.instrument-selection_OyWhM{display:flex;align-items:center;justify-content:space-between}.custom-create_oJC55{display:flex;align-items:center}.custom-create_oJC55 svg{fill:var(--f-subdue);margin-right:8px}.custom-create_oJC55 p{font-size:14px;line-height:20px;text-align:left}[data-brand=indiv] .item_Ff7rg.is-premium_CgRsF{background-color:var(--f-flat-blue-10)}.item_Ff7rg{border-bottom:1px solid var(--f-subdue-20)}.item_Ff7rg:last-child{border-bottom:none}.item_Ff7rg.is-premium_CgRsF~.item_Ff7rg.is-premium_CgRsF .premium-header_sPmB6{display:none}.premium-header_sPmB6{display:flex;align-items:center;justify-content:space-between;padding:12px 20px 12px 24px}.premium-header_sPmB6 h6,.premium-header_sPmB6 p{font-weight:600}.premium-header_sPmB6 h6{font-size:14px;line-height:20px;color:var(--f-subdue)}.premium-header_sPmB6 p{color:var(--f-primary);font-size:12px;line-height:20px;cursor:pointer;text-align:right}.instrumentSearchNotfound_FxBFA{margin:30px}.instrumentSearchNotfound_FxBFA button{margin-top:16px}
`,""]),b.locals={"instrument-group-active":"instrument-group-active_vcEdV","instrument-item":"instrument-item_oQ_N9","instrument-selection":"instrument-selection_OyWhM","custom-create":"custom-create_oJC55",item:"item_Ff7rg","is-premium":"is-premium_CgRsF","premium-header":"premium-header_sPmB6",instrumentSearchNotfound:"instrumentSearchNotfound_FxBFA"};const I=b},514676:(f,g,t)=>{"use strict";var e=t(537553),n=t.n(e)},537553:(f,g,t)=>{var e=t(565288);e.__esModule&&(e=e.default),typeof e=="string"&&(e=[[f.id,e,""]]),e.locals&&(f.exports=e.locals);var n=t(929234).A,y=n("62ab428e",e,!0,{})},549937:(f,g,t)=>{"use strict";t.d(g,{default:()=>n.a});var e=t(110448),n=t.n(e)},565288:(f,g,t)=>{"use strict";t.r(g),t.d(g,{default:()=>I});var e=t(814779),n=t.n(e),y=t(927860),k=t.n(y),b=k()(n());b.push([f.id,`.settings-card-cinstruments-edit{background:var(--f-bg-0);padding:32px;border-radius:4px}@media (max-width: 767px){.settings-card-cinstruments-edit{border-radius:0;box-shadow:none;min-height:100%}}.cinstruments-ed{margin:-16px 0}.cinstruments-ed .step{border-bottom:1px solid var(--f-ink-10)}.cinstruments-ed .step:last-child{border-bottom:0}.cinstruments-ed .step-header{display:flex;align-items:center;justify-content:space-between;padding:16px 0}.cinstruments-ed .step-header.clickable{cursor:pointer}.cinstruments-ed .step-header h4{color:var(--f-subdue);font-family:var(--f-font-common);font-size:16px;font-weight:700;line-height:19px;margin:0}.cinstruments-ed .step-header .value{display:flex;align-items:center;height:16px;font-size:14px;margin-left:10px}.cinstruments-ed .step-header .staves-count span{display:flex;align-items:center;justify-content:center;height:16px;width:16px;right:-7px;position:relative;background:#fff;border-radius:16px}.cinstruments-ed .step-content{padding:0 0 15px}.cinstruments-ed .step-cta{display:flex;justify-content:flex-end;flex-wrap:wrap;margin:0 0 0 15px}.cinstruments-ed .step-cta button{margin:15px 0 0}.cinstruments-ed .step-cta button:not(:first-child){margin-left:15px}.cinstruments-ed .step.active .step-header h4{color:var(--f-ink)}.cinstruments-ed .step.active .fill{fill:var(--f-ink)}.cinstruments-ed .step.done .step-header{cursor:pointer}.cinstruments-ed .step.done .step-header h4,.cinstruments-ed .step.done .step-header .value{color:var(--f-happy-green)}.cinstruments-ed .step.done .step-header .fill{fill:var(--f-happy-green)}.cinstruments-ed p,.cinstruments-ed .p{color:var(--f-ink);font-weight:500;line-height:20px}.cinstruments-ed .instrument-group-list{max-height:50vh;overflow:hidden;overflow:auto;border-radius:3px;border:1px solid var(--f-ink-10);background:var(--f-bg-1);color:var(--f-ink)}.cinstruments-ed .instrument-properties-list{display:flex;justify-content:flex-start;align-items:center;flex-wrap:wrap;position:relative;left:-3px}.cinstruments-ed .instrument-properties-list .instrument-properties-item{height:65px;width:44px;position:relative;border-radius:4px;border:1px solid var(--f-grey-2);margin:0 2px 16px 3px}.cinstruments-ed .instrument-properties-list .instrument-properties-item .text{display:flex;align-items:center;justify-content:center;width:100%;height:100%;padding:0;color:var(--f-subdue);font-size:14px;line-height:16px}.cinstruments-ed .instrument-properties-list .instrument-properties-item.active{background:var(--f-primary);border-color:var(--f-primary-dark)}.cinstruments-ed .instrument-properties-list .instrument-properties-item.active .text{color:#fff}.cinstruments-ed .stave{display:flex;align-items:center;margin-bottom:15px}.cinstruments-ed .stave-info{flex:0 1 250px;display:flex;align-items:center}.cinstruments-ed .stave-icon{margin-right:10px}.cinstruments-ed .stave-rm{margin-left:10px;flex:0 0 16px}.cinstruments-ed .stave-text.new{font-style:italic}.cinstruments-ed .ddn-clefs-sel{padding:0}.cinstruments-ed .ddn-clefs-sel svg{width:60px}.cinstruments-ed .ddn-clefs-sel-inner{display:flex;flex-wrap:wrap;align-items:center;max-width:360px;padding-bottom:22px}.cinstruments-ed .ddn-clefs-sel-inner a{display:flex;margin:0 0 -22px}.cinstruments-ed .ddn-clefs-sel-inner .stroke{stroke:var(--f-ink)}.cinstruments-ed .ddn-clefs-sel-inner .fill{fill:var(--f-ink)}.cinstruments-ed .transpo p{margin-bottom:10px}.cinstruments-ed .tab-enabled{display:flex;align-items:center;color:var(--f-ink);font-weight:500;height:40px;line-height:40px}.cinstruments-ed .tab-enabled .wrap-switch{margin-right:12px}.cinstruments-ed .tab-enabled .nb-strings{white-space:nowrap;display:flex;margin-left:16px}.cinstruments-ed .tab-enabled .nb-strings .input{margin:0 5px;padding:5px;width:48px}.cinstruments-ed .tuning-editor,.cinstruments-ed .unpitched-ins{margin:15px 0 0}.cinstruments-ed .unpitched-staves{display:flex;align-items:center}.cinstruments-ed .unpitched-staves .ustave{border:1px solid var(--f-ink-10);margin:0 15px 15px 0;border-radius:6px;transition:all .3s ease-in-out;display:flex;flex-direction:column;padding:20px;align-items:center}.cinstruments-ed .unpitched-staves .ustave:hover{border:1px solid var(--f-ink)}.cinstruments-ed .unpitched-staves .ustave.active{border:1px solid var(--f-happy-green)}.cinstruments-ed .unpitched-staves .ustave span{margin-top:10px;color:var(--f-ink)}.cinstruments-ed .unpitched-staves svg{height:29px;width:114px}.cinstruments-ed .ins-name{display:flex}.cinstruments-ed .ins-name .wrap-form{display:flex;flex-direction:column;margin-right:15px;margin-bottom:0}.cinstruments-ed .ins-name .label-ext-small{text-align:center}
`,""]);const I=b},636889:(f,g,t)=>{"use strict";t.r(g),t.d(g,{default:()=>I});var e=t(814779),n=t.n(e),y=t(927860),k=t.n(y),b=k()(n());b.push([f.id,`.page-title_tUhX8 svg{cursor:pointer;vertical-align:middle}.page-title_tUhX8 span{vertical-align:middle}.page-title-score_X4WPl{font:600 16px/24px var(--f-font-common)}.page-title-score_X4WPl span{margin-left:10px}
`,""]),b.locals={"page-title":"page-title_tUhX8","page-title-score":"page-title-score_X4WPl"};const I=b},663278:(f,g,t)=>{var e=t(679163);e.__esModule&&(e=e.default),typeof e=="string"&&(e=[[f.id,e,""]]),e.locals&&(f.exports=e.locals);var n=t(929234).A,y=n("126f4b4f",e,!0,{})},679163:(f,g,t)=>{"use strict";t.r(g),t.d(g,{default:()=>I});var e=t(814779),n=t.n(e),y=t(927860),k=t.n(y),b=k()(n());b.push([f.id,`.instrument-item_LqFtg{display:flex;flex-direction:column;padding:4px 20px 4px 24px;transition:all .3s ease-in-out;color:var(--f-subdue)}.instrument-selection_l2sYw button{padding:0;background-color:transparent;border:none;cursor:pointer}.instrument-selection_l2sYw{display:flex;align-items:center;justify-content:space-between}.instrument-info_FSeYL{display:flex;align-items:center}.audio-player_U1Uv1{margin-right:8px;display:inline-flex}.beta-tag_pgrms{margin-right:8px;white-space:nowrap;font-weight:600;font-size:12px;line-height:16px;background:var(--f-ink);border-radius:4px;padding:4px;text-transform:uppercase;color:#fff}.instrument-name_vOcuF{font-size:14px;line-height:20px;text-align:left;color:var(--f-subdue)}.new-badge_DkydQ{margin-left:8px}.hq_PdpEQ{margin-right:8px}.action-btn_VicvF{display:flex;align-items:center}.action-btn-item_keSVo{display:flex;align-items:center;justify-content:center;width:24px;height:24px;margin-left:8px;border-radius:24px}.action-btn-icon_pIkn7{color:var(--f-subdue);cursor:pointer}.action-btn-count_p9aAX{font-weight:var(--f-font-bold);color:var(--f-white);background-color:var(--f-subdue);font-size:12px;line-height:16px}.single-selected_zpDRu{fill:var(--f-happy-green)}.active-search_ahEOc{color:var(--f-primary);background-color:var(--f-ink-10)}
`,""]),b.locals={"instrument-item":"instrument-item_LqFtg","instrument-selection":"instrument-selection_l2sYw","instrument-info":"instrument-info_FSeYL","audio-player":"audio-player_U1Uv1","beta-tag":"beta-tag_pgrms","instrument-name":"instrument-name_vOcuF","new-badge":"new-badge_DkydQ",hq:"hq_PdpEQ","action-btn":"action-btn_VicvF","action-btn-item":"action-btn-item_keSVo","action-btn-icon":"action-btn-icon_pIkn7","action-btn-count":"action-btn-count_p9aAX","single-selected":"single-selected_zpDRu","active-search":"active-search_ahEOc"};const I=b},764444:(f,g,t)=>{"use strict";t.d(g,{X:()=>h});var e=t(361744),n=t(538065),y=t(555381);const k=t.p+"img/bccda8b2f17071a3ee6c.svg",b=t.p+"img/1d66571a6c0cad96a3fb.svg",I={class:"cinstruments-ed"},H={key:0,class:"value"},R={key:0,class:"step-content"},$={class:"name"},V={class:"description"},G={class:"name"},P={class:"description"},X={key:0,class:"value"},w={key:0,class:"step-content"},M={class:"step-cta"},ee={key:0,class:"value"},te={key:0,class:"step-content"},z={class:"step-cta"},ie={key:0,class:"value staves-count value-font-alt"},oe={key:0,class:"step-content"},N={class:"stave-info"},re={key:0,class:"stave-text"},J={key:1,class:"stave-text"},le=["onClick"],ae={class:"stave new ddn-trigger"},se={class:"stave-info"},W={class:"stave-text ddn-align new"},Y={class:"ddn-content ddn-clefs-sel"},j={class:"ddn-clefs-sel-inner"},ue=["onClick"],U={class:"step-cta"},de={key:0,class:"value value-font-alt"},K={key:0,class:"step-content transpo"},_e={class:"instrument-properties-list transposition-note"},T=["onClick"],O={class:"text"},ne={class:"instrument-properties-list transposition-octave"},ce=["onClick"],l={class:"text"},_={class:"step-cta"},p={key:0,class:"value"},v={key:1,class:"value"},L={key:0,class:"step-content"},x={key:0,class:"p"},Z={key:1,class:"p tab-enabled"},q={key:0,class:"nb-strings"},D={key:2,class:"tab-strings"},Q={class:"step-cta"},ge={key:0,class:"value"},ye={key:0,class:"step-content"},pe={class:"step-cta"},me={key:0,class:"value staves-count value-font-alt"},he={key:0,class:"step-content"},be={class:"unpitched-staves"},Ee={class:"step-cta"},Ce={key:0,class:"step-content"},ke={class:"step-cta"},fe={class:"step-header"},Se={class:"ins-name"},Ie={class:"wrap-form instrument-longname"},s={class:"label-ext-small"},a={class:"wrap-form instrument-shortname"},i={class:"label-ext-small"},m={class:"step-cta"};function h(u,o,E,C,r,d){const S=(0,e.g2)("mobile-title"),A=(0,e.g2)("arrowBackIcon"),xe=(0,e.g2)("instruments-list"),B=(0,e.g2)("f-button"),Le=(0,e.g2)("toggle"),Pe=(0,e.g2)("f-number-input"),we=(0,e.g2)("tuning-editor"),Oe=(0,e.g2)("UnpitchedKitEditor"),ve=(0,e.gN)("dompurify-html"),Ae=(0,e.gN)("dropdown");return(0,e.uX)(),(0,e.CE)("div",null,[d.isComsumerMobile&&!r.i.id?((0,e.uX)(),(0,e.Wv)(S,{key:0,title:"flat:custom-instru.title-new","route-back":"accountSettingsInstruments"})):d.isComsumerMobile&&r.i.id?((0,e.uX)(),(0,e.Wv)(S,{key:1,title:"flat:custom-instru.title-edit","route-back":"accountSettingsInstruments"})):r.i.id?((0,e.uX)(),(0,e.CE)("h2",{key:3,class:(0,n.C4)(["page-title",{[u.$style["page-title"]]:!0,[u.$style["page-title-score"]]:E.editContext===r.EditContext.SCORE}])},[(0,e.Lk)("a",{onClick:o[1]||(o[1]=c=>E.editContext===r.EditContext.SETTINGS?E.goBack(u.$router):E.goBack())},[(0,e.bF)(A)]),(0,e.Lk)("span",null,(0,n.v_)(u.$t("flat:custom-instru.title-edit")),1)],2)):((0,e.uX)(),(0,e.CE)("h2",{key:2,class:(0,n.C4)(["page-title",{[u.$style["page-title"]]:!0,[u.$style["page-title-score"]]:E.editContext===r.EditContext.SCORE}])},[(0,e.Lk)("a",{onClick:o[0]||(o[0]=c=>E.editContext===r.EditContext.SETTINGS?E.goBack(u.$router):E.goBack())},[(0,e.bF)(A)]),(0,e.Lk)("span",null,(0,n.v_)(u.$t("flat:custom-instru.title-new")),1)],2)),(0,e.Lk)("div",{class:(0,n.C4)(["no-select",{"global-mob-view":d.isComsumerMobile,"settings-card-cinstruments-edit felev-static":E.editContext===r.EditContext.SETTINGS}])},[(0,e.Lk)("div",I,[r.i.id?(0,e.Q3)("",!0):((0,e.uX)(),(0,e.CE)("div",{key:0,class:(0,n.C4)(["step no-select",{active:r.step==="type",done:d.stepDone.type}])},[(0,e.Lk)("div",{class:"step-header",onClick:o[2]||(o[2]=c=>d.clickStep("type"))},[(0,e.Lk)("h4",null,(0,n.v_)(u.$t("flat:custom-instru.type.title")),1),d.stepDone.type?((0,e.uX)(),(0,e.CE)("div",H,(0,n.v_)(u.$t(d.typeTitleI18n)),1)):(0,e.Q3)("",!0)]),r.step==="type"?((0,e.uX)(),(0,e.CE)("div",R,[(0,e.Lk)("a",{class:(0,n.C4)(["choice-method",{active:r.i.type==="pitched"}]),onClick:o[3]||(o[3]=c=>d.chooseType("pitched"))},[(0,e.Lk)("div",$,(0,n.v_)(u.$t("flat:custom-instru.type.pitched.title")),1),(0,e.Lk)("div",V,(0,n.v_)(u.$t("flat:custom-instru.type.pitched.description")),1)],2),(0,e.Lk)("a",{class:(0,n.C4)(["choice-method",{active:r.i.type==="unpitched"}]),onClick:o[4]||(o[4]=c=>d.chooseType("unpitched"))},[(0,e.Lk)("div",G,(0,n.v_)(u.$t("flat:custom-instru.type.unpitched.title")),1),(0,e.Lk)("div",P,(0,n.v_)(u.$t("flat:custom-instru.type.unpitched.description")),1)],2)])):(0,e.Q3)("",!0)],2)),!r.i.id&&r.i.type==="pitched"?((0,e.uX)(),(0,e.CE)("div",{key:1,class:(0,n.C4)(["step",{active:r.step==="base",done:d.stepDone.base}])},[(0,e.Lk)("div",{class:"step-header",onClick:o[5]||(o[5]=c=>d.clickStep("base"))},[(0,e.Lk)("h4",null,(0,n.v_)(u.$t("flat:custom-instru.base.title")),1),r.base?(0,e.bo)(((0,e.uX)(),(0,e.CE)("div",X,null,512)),[[ve,d.baseIcon,"svg"]]):(0,e.Q3)("",!0)]),r.step==="base"?((0,e.uX)(),(0,e.CE)("div",w,[(0,e.bF)(xe,{"selection-mode":"single","display-custom":!1,"display-unpitched":!1,"display-pitched":!0,"selected-instruments":r.baseSelected,onAddinstrument:o[6]||(o[6]=c=>d.chooseBase(c)),onRemoveinstrument:o[7]||(o[7]=c=>d.chooseBase("pitched"))},null,8,["selected-instruments"]),(0,e.Lk)("div",M,[(0,e.bF)(B,{theme:"outline",onClick:o[8]||(o[8]=c=>{d.chooseBase("pitched"),d.goStep("stavesClefs")}),"default-text":"flat:custom-instru.base.cta-scratch"}),(0,e.bF)(B,{disabled:!r.base,onClick:o[9]||(o[9]=c=>d.goStep("stavesClefs")),"default-text":"flat:continue"},null,8,["disabled"])])])):(0,e.Q3)("",!0)],2)):(0,e.Q3)("",!0),!r.i.id&&r.i.type==="unpitched"?((0,e.uX)(),(0,e.CE)("div",{key:2,class:(0,n.C4)(["step",{active:r.step==="base",done:d.stepDone.base}])},[(0,e.Lk)("div",{class:"step-header",onClick:o[10]||(o[10]=c=>d.clickStep("base"))},[(0,e.Lk)("h4",null,(0,n.v_)(u.$t("flat:custom-instru.base.title")),1),r.base?(0,e.bo)(((0,e.uX)(),(0,e.CE)("div",ee,null,512)),[[ve,d.baseIcon,"svg"]]):(0,e.Q3)("",!0)]),r.step==="base"?((0,e.uX)(),(0,e.CE)("div",te,[(0,e.bF)(xe,{"selection-mode":"single","display-custom":!1,"display-unpitched":!0,"display-pitched":!1,"selected-instruments":r.baseSelected,onAddinstrument:o[11]||(o[11]=c=>d.chooseBase(c)),onRemoveinstrument:o[12]||(o[12]=c=>d.chooseBase("unpitched"))},null,8,["selected-instruments"]),(0,e.Lk)("div",z,[(0,e.bF)(B,{theme:"outline",onClick:o[13]||(o[13]=c=>{d.chooseBase("unpitched"),d.goStep("unpitchedStaff")}),"default-text":"flat:custom-instru.base.cta-scratch"}),(0,e.bF)(B,{disabled:!r.base,onClick:o[14]||(o[14]=c=>d.goStep("unpitchedStaff")),"default-text":"flat:continue"},null,8,["disabled"])])])):(0,e.Q3)("",!0)],2)):(0,e.Q3)("",!0),r.i.type==="pitched"?((0,e.uX)(),(0,e.CE)("div",{key:3,class:(0,n.C4)(["step",{active:r.step==="stavesClefs",done:d.stepDone.stavesClefs}])},[(0,e.Lk)("div",{class:"step-header",onClick:o[15]||(o[15]=c=>d.clickStep("stavesClefs"))},[(0,e.Lk)("h4",null,(0,n.v_)(u.$t("flat:custom-instru.staves-clefs.title")),1),d.stepDone.stavesClefs?((0,e.uX)(),(0,e.CE)("div",ie,[(0,e.Lk)("span",null,(0,n.v_)(r.i.clefs.length),1),o[38]||(o[38]=(0,e.Lk)("svg",{inline:"",width:"13",height:"13",viewBox:"0 0 13 13",xmlns:"http://www.w3.org/2000/svg"},[(0,e.Lk)("path",{d:"M12.235 12H.765c-.422 0-.765.22-.765.5s.343.5.764.5h11.47c.422 0 .766-.22.766-.5s-.344-.5-.765-.5zm.3-3H.466C.207 9 0 9.22 0 9.5s.208.5.464.5h12.072c.256 0 .464-.22.464-.5s-.208-.5-.464-.5zM.65 6C.29 6 0 6.22 0 6.5s.29.5.65.5h11.7c.36 0 .65-.22.65-.5s-.29-.5-.65-.5H.65zm11.886-2c.256 0 .464-.22.464-.5s-.208-.5-.464-.5H.464C.208 3 0 3.22 0 3.5s.208.5.464.5h12.072zM.464 1h12.072C12.792 1 13 .78 13 .5s-.208-.5-.464-.5H.464C.208 0 0 .22 0 .5s.208.5.464.5z",fill:"#363C50","fill-rule":"evenodd",class:"fill"})],-1))])):(0,e.Q3)("",!0)]),r.step==="stavesClefs"?((0,e.uX)(),(0,e.CE)("div",oe,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(r.i.clefs,(c,F)=>((0,e.uX)(),(0,e.CE)("div",{class:"stave",key:F},[(0,e.Lk)("div",N,[o[39]||(o[39]=(0,e.Lk)("img",{class:"stave-icon",src:k},null,-1)),c.clefDetails?((0,e.uX)(),(0,e.CE)("span",J,(0,n.v_)(u.$t("flat:score.stave-info-extended",{clef:c.displayedSign||c.sign,extention:c.clefDetails})),1)):((0,e.uX)(),(0,e.CE)("span",re,(0,n.v_)(u.$t("flat:score.stave-info",{clef:c.displayedSign||c.sign})),1))]),(0,e.Lk)("a",{onClick:Me=>d.removeStave(F),class:"stave-rm"},o[40]||(o[40]=[(0,e.Lk)("img",{class:"icon",src:b},null,-1)]),8,le)]))),128)),(0,e.bo)(((0,e.uX)(),(0,e.CE)("div",null,[(0,e.Lk)("a",ae,[(0,e.Lk)("div",se,[o[41]||(o[41]=(0,e.Lk)("img",{class:"stave-icon",src:k},null,-1)),(0,e.Lk)("span",W,(0,n.v_)(u.$t("flat:custom-instru.staves-clefs.add")),1)])]),(0,e.Lk)("div",Y,[o[42]||(o[42]=(0,e.Lk)("div",{"x-arrow":""},null,-1)),(0,e.Lk)("div",j,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(r.CLEFS,c=>(0,e.bo)(((0,e.uX)(),(0,e.CE)("a",{key:c.icon,onClick:F=>d.addStave(c)},null,8,ue)),[[ve,c.icon,"svg"]])),128))])])])),[[Ae]]),(0,e.Lk)("div",U,[(0,e.bF)(B,{disabled:r.i.clefs.length===0,onClick:o[16]||(o[16]=c=>d.goStep("transposition")),"default-text":"flat:continue"},null,8,["disabled"])])])):(0,e.Q3)("",!0)],2)):(0,e.Q3)("",!0),r.i.type==="pitched"?((0,e.uX)(),(0,e.CE)("div",{key:4,class:(0,n.C4)(["step",{active:r.step==="transposition",done:d.stepDone.transposition}])},[(0,e.Lk)("div",{class:"step-header",onClick:o[17]||(o[17]=c=>d.clickStep("transposition"))},[(0,e.Lk)("h4",null,(0,n.v_)(u.$t("flat:custom-instru.transpo.title")),1),d.stepDone.transposition?((0,e.uX)(),(0,e.CE)("div",de,(0,n.v_)(r.transposition.note)+" / "+(0,n.v_)(r.transposition.octave),1)):(0,e.Q3)("",!0)]),r.step==="transposition"?((0,e.uX)(),(0,e.CE)("div",K,[(0,e.Lk)("p",null,(0,n.v_)(u.$t("flat:custom-instru.transpo.note"))+":",1),(0,e.Lk)("div",_e,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(r.TRANSPOSITION_NOTES,(c,F)=>((0,e.uX)(),(0,e.CE)("a",{key:F,onClick:Me=>d.setTranspositionNote(F),class:(0,n.C4)(["instrument-properties-item",{active:r.transposition.note===F}])},[(0,e.Lk)("span",O,(0,n.v_)(F),1)],10,T))),128))]),(0,e.Lk)("p",null,(0,n.v_)(u.$t("flat:custom-instru.transpo.octave"))+":",1),(0,e.Lk)("div",ne,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(r.TRANSPOSITION_OCTAVES,c=>((0,e.uX)(),(0,e.CE)("a",{key:c,onClick:F=>d.setTranspositionOctave(c),class:(0,n.C4)(["instrument-properties-item",{active:r.transposition.octave===c}])},[(0,e.Lk)("span",l,(0,n.v_)(c),1)],10,ce))),128))]),(0,e.Lk)("div",_,[(0,e.bF)(B,{onClick:o[18]||(o[18]=c=>d.goStep("tab")),"default-text":"flat:continue"})])])):(0,e.Q3)("",!0)],2)):(0,e.Q3)("",!0),r.i.type==="pitched"?((0,e.uX)(),(0,e.CE)("div",{key:5,class:(0,n.C4)(["step",{active:r.step==="tab",done:d.stepDone.tab}])},[(0,e.Lk)("div",{class:"step-header",onClick:o[19]||(o[19]=c=>d.clickStep("tab"))},[(0,e.Lk)("h4",null,(0,n.v_)(u.$t("flat:custom-instru.tab.title")),1),d.stepDone.tab&&r.tabEnabled?((0,e.uX)(),(0,e.CE)("div",p,(0,n.v_)(r.i.tab.lines)+" "+(0,n.v_)(u.$t("flat:custom-instru.tab.n-strings")),1)):d.stepDone.tab&&!r.tabEnabled?((0,e.uX)(),(0,e.CE)("div",v,(0,n.v_)(u.$t("flat:custom-instru.tab.no-tab")),1)):(0,e.Q3)("",!0)]),r.step==="tab"?((0,e.uX)(),(0,e.CE)("div",L,[r.i.clefs.length>1?((0,e.uX)(),(0,e.CE)("div",x,(0,n.v_)(u.$t("flat:custom-instru.tab.err-more-1-staff")),1)):((0,e.uX)(),(0,e.CE)("div",Z,[(0,e.bF)(Le,{id:"tabEnabled",modelValue:r.tabEnabled,"onUpdate:modelValue":o[20]||(o[20]=c=>r.tabEnabled=c)},{default:(0,e.k6)(()=>[(0,e.eW)((0,n.v_)(u.$t("flat:custom-instru.tab.use")),1)]),_:1},8,["modelValue"]),r.tabEnabled?((0,e.uX)(),(0,e.CE)("span",q,[(0,e.eW)((0,n.v_)(u.$t("flat:custom-instru.tab.with-n-strings-with"))+" ",1),(0,e.bF)(Pe,{class:"input",modelValue:r.tabLines,"onUpdate:modelValue":o[21]||(o[21]=c=>r.tabLines=c),modelModifiers:{number:!0},min:3,max:14},null,8,["modelValue"]),(0,e.eW)(" "+(0,n.v_)(u.$t("flat:custom-instru.tab.n-strings"))+".",1)])):(0,e.Q3)("",!0)])),r.tabEnabled?((0,e.uX)(),(0,e.CE)("div",D,[(0,e.bF)(we,{lines:r.tabLines,tuning:r.i.tab.tuning,capo:r.i.tab.capo,onUpdateCapo:o[22]||(o[22]=c=>r.i.tab.capo=c)},null,8,["lines","tuning","capo"])])):(0,e.Q3)("",!0),(0,e.Lk)("div",Q,[(0,e.bF)(B,{onClick:o[23]||(o[23]=c=>d.goStep("sound")),"default-text":"flat:continue"})])])):(0,e.Q3)("",!0)],2)):(0,e.Q3)("",!0),r.i.type==="pitched"?((0,e.uX)(),(0,e.CE)("div",{key:6,class:(0,n.C4)(["step",{active:r.step==="sound",done:d.stepDone.sound}])},[(0,e.Lk)("div",{class:"step-header",onClick:o[24]||(o[24]=c=>d.clickStep("sound"))},[(0,e.Lk)("h4",null,(0,n.v_)(u.$t("flat:custom-instru.sound.title")),1),d.stepDone.sound?(0,e.bo)(((0,e.uX)(),(0,e.CE)("div",ge,null,512)),[[ve,d.soundIcon,"svg"]]):(0,e.Q3)("",!0)]),r.step==="sound"?((0,e.uX)(),(0,e.CE)("div",ye,[(0,e.bF)(xe,{"selection-mode":"single","display-custom":!1,"display-unpitched":!1,"selected-instruments":r.soundSelected,onAddinstrument:o[25]||(o[25]=c=>d.chooseSound(c)),onRemoveinstrument:o[26]||(o[26]=c=>d.chooseSound(null))},null,8,["selected-instruments"]),(0,e.Lk)("div",pe,[(0,e.bF)(B,{disabled:!r.sound,onClick:o[27]||(o[27]=c=>d.goStep("name")),"default-text":"flat:continue"},null,8,["disabled"])])])):(0,e.Q3)("",!0)],2)):(0,e.Q3)("",!0),r.i.type==="unpitched"?((0,e.uX)(),(0,e.CE)("div",{key:7,class:(0,n.C4)(["step",{active:r.step==="unpitchedStaff",done:d.stepDone.unpitchedStaff}])},[(0,e.Lk)("div",{class:"step-header",onClick:o[28]||(o[28]=c=>d.clickStep("unpitchedStaff"))},[(0,e.Lk)("h4",null,(0,n.v_)(u.$t("flat:custom-instru.unpitched-staff.title")),1),d.stepDone.unpitchedStaff?((0,e.uX)(),(0,e.CE)("div",me,[(0,e.Lk)("span",null,(0,n.v_)(r.i.staffLines),1),o[43]||(o[43]=(0,e.Lk)("svg",{inline:"",width:"13",height:"13",viewBox:"0 0 13 13",xmlns:"http://www.w3.org/2000/svg"},[(0,e.Lk)("path",{d:"M12.235 12H.765c-.422 0-.765.22-.765.5s.343.5.764.5h11.47c.422 0 .766-.22.766-.5s-.344-.5-.765-.5zm.3-3H.466C.207 9 0 9.22 0 9.5s.208.5.464.5h12.072c.256 0 .464-.22.464-.5s-.208-.5-.464-.5zM.65 6C.29 6 0 6.22 0 6.5s.29.5.65.5h11.7c.36 0 .65-.22.65-.5s-.29-.5-.65-.5H.65zm11.886-2c.256 0 .464-.22.464-.5s-.208-.5-.464-.5H.464C.208 3 0 3.22 0 3.5s.208.5.464.5h12.072zM.464 1h12.072C12.792 1 13 .78 13 .5s-.208-.5-.464-.5H.464C.208 0 0 .22 0 .5s.208.5.464.5z",fill:"#363C50","fill-rule":"evenodd",class:"fill"})],-1))])):(0,e.Q3)("",!0)]),r.step==="unpitchedStaff"?((0,e.uX)(),(0,e.CE)("div",he,[(0,e.Lk)("div",be,[(0,e.Lk)("a",{class:(0,n.C4)(["ustave",{active:r.i.staffLines===1}]),onClick:o[29]||(o[29]=c=>d.setNumberLines(1))},[o[44]||(o[44]=(0,e.Lk)("svg",{inline:"",xmlns:"http://www.w3.org/2000/svg",width:"353",height:"90",viewBox:"0 0 353 90"},[(0,e.Lk)("path",{class:"stroke",stroke:"#000","stroke-width":"2.925",d:"M0 45h352.53"}),(0,e.Lk)("path",{class:"fill",d:"M45.615 23.862v42.276c0 .908-.41 1.362-1.23 1.362h-11.91c-.849 0-1.26-.454-1.23-1.362V23.862c0-.908.41-1.362 1.23-1.362h11.91c.82 0 1.23.454 1.23 1.362zm-19.95 42.276c0 .908-.426 1.362-1.275 1.362H12.524c-.85 0-1.274-.454-1.274-1.362V23.862c0-.908.425-1.362 1.274-1.362H24.39c.85 0 1.274.454 1.274 1.362v42.276z"}),(0,e.Lk)("g",{class:"stroke",stroke:"#000"},[(0,e.Lk)("path",{"stroke-width":"3.6",d:"M330.48 0v90"}),(0,e.Lk)("path",{"stroke-width":"11.25",d:"M346.905 0v90"})])],-1)),(0,e.Lk)("span",null,(0,n.v_)(u.$t("flat:custom-instru.unpitched-staff.line1")),1)],2),(0,e.Lk)("a",{class:(0,n.C4)(["ustave",{active:r.i.staffLines===5}]),onClick:o[30]||(o[30]=c=>d.setNumberLines(5))},[o[45]||(o[45]=(0,e.Lk)("svg",{inline:"",xmlns:"http://www.w3.org/2000/svg",width:"353",height:"94",viewBox:"0 0 353 94"},[(0,e.Lk)("path",{class:"stroke",stroke:"#000","stroke-width":"2.925",d:"M0 2h352.53M0 24.5h352.53M0 47h352.53M0 69.5h352.53M0 92h352.53"}),(0,e.Lk)("path",{class:"fill",d:"M45.615 25.862v42.276c0 .908-.41 1.362-1.23 1.362h-11.91c-.849 0-1.26-.454-1.23-1.362V25.862c0-.908.41-1.362 1.23-1.362h11.91c.82 0 1.23.454 1.23 1.362zm-19.95 42.276c0 .908-.426 1.362-1.275 1.362H12.524c-.85 0-1.274-.454-1.274-1.362V25.862c0-.908.425-1.362 1.274-1.362H24.39c.85 0 1.274.454 1.274 1.362v42.276z"}),(0,e.Lk)("g",{class:"stroke",stroke:"#000"},[(0,e.Lk)("path",{"stroke-width":"3.6",d:"M330.48 2v90"}),(0,e.Lk)("path",{"stroke-width":"11.25",d:"M346.905 2v90.818"})])],-1)),(0,e.Lk)("span",null,(0,n.v_)(u.$t("flat:custom-instru.unpitched-staff.line5")),1)],2)]),(0,e.Lk)("div",Ee,[(0,e.bF)(B,{disabled:!r.i.staffLines,onClick:o[31]||(o[31]=c=>d.goStep("unpitchedInstruments")),"default-text":"flat:continue"},null,8,["disabled"])])])):(0,e.Q3)("",!0)],2)):(0,e.Q3)("",!0),r.i.type==="unpitched"?((0,e.uX)(),(0,e.CE)("div",{key:8,class:(0,n.C4)(["step",{active:r.step==="unpitchedInstruments",done:d.stepDone.unpitchedInstruments}])},[(0,e.Lk)("div",{class:"step-header",onClick:o[32]||(o[32]=c=>d.clickStep("unpitchedInstruments"))},[(0,e.Lk)("h4",null,(0,n.v_)(u.$t("flat:custom-instru.unpitched-instruments.title")),1)]),r.step==="unpitchedInstruments"?((0,e.uX)(),(0,e.CE)("div",Ce,[(0,e.Lk)("p",null,(0,n.v_)(u.$t("flat:custom-instru.unpitched-instruments.description")),1),r.i.staffLines?((0,e.uX)(),(0,e.Wv)(Oe,{key:0,class:"unpitched-ins",isConfiguredInstrumentValid:d.isMappingValid(),mapping:r.i.mapping,lines:r.i.staffLines,onUpdateInstrument:o[33]||(o[33]=c=>r.i.mapping=c)},null,8,["isConfiguredInstrumentValid","mapping","lines"])):(0,e.Q3)("",!0),(0,e.Lk)("div",ke,[(0,e.bF)(B,{disabled:!d.isMappingValid(),onClick:o[34]||(o[34]=c=>d.goStep("name")),"default-text":"flat:continue"},null,8,["disabled"])])])):(0,e.Q3)("",!0)],2)):(0,e.Q3)("",!0),r.i.type?((0,e.uX)(),(0,e.CE)("div",{key:9,class:(0,n.C4)(["step",{active:r.step==="name",done:d.stepDone.name}])},[(0,e.Lk)("div",fe,[(0,e.Lk)("h4",null,(0,n.v_)(u.$t("flat:custom-instru.name.title")),1)]),r.step==="name"?((0,e.uX)(),(0,e.CE)("form",{key:0,class:"step-content",onSubmit:o[37]||(o[37]=(0,y.D$)(c=>d.save(),["prevent"]))},[(0,e.Lk)("div",Se,[(0,e.Lk)("div",Ie,[(0,e.Lk)("label",s,(0,n.v_)(u.$t("flat:custom-instru.name.longname.label")),1),(0,e.bo)((0,e.Lk)("input",{type:"text",class:"form-control medium","onUpdate:modelValue":o[35]||(o[35]=c=>r.i.longname=c),placeholder:"",required:"","data-focus":""},null,512),[[y.Jo,r.i.longname]])]),(0,e.Lk)("div",a,[(0,e.Lk)("label",i,(0,n.v_)(u.$t("flat:custom-instru.name.shortname.label")),1),(0,e.bo)((0,e.Lk)("input",{type:"text",class:"form-control medium","onUpdate:modelValue":o[36]||(o[36]=c=>r.i.shortname=c),placeholder:"",required:""},null,512),[[y.Jo,r.i.shortname]])])]),(0,e.Lk)("div",m,[(0,e.bF)(B,{type:"submit",disabled:!d.hasValidLongname||r.processing,loading:r.processing,"default-text":"flat:custom-instru.cta.save"},null,8,["disabled","loading"])])],32)):(0,e.Q3)("",!0)],2)):(0,e.Q3)("",!0)])],2)])}},769201:(f,g,t)=>{var e=t(414792);e.__esModule&&(e=e.default),typeof e=="string"&&(e=[[f.id,e,""]]),e.locals&&(f.exports=e.locals);var n=t(929234).A,y=n("6e014320",e,!0,{})},813723:(f,g,t)=>{"use strict";t.r(g),t.d(g,{default:()=>I});var e=t(814779),n=t.n(e),y=t(927860),k=t.n(y),b=k()(n());b.push([f.id,`.global-mob-title{flex:0 0 36px;height:36px;border-bottom:1px solid var(--f-ink-10);display:flex;align-items:center;justify-content:space-between}.global-mob-title .t{font-weight:700;font-size:14px;line-height:20px;color:var(--f-ink);text-align:center}.global-mob-title .back{border:0;background:0;padding:0 16px;height:100%;display:flex;align-items:center}.global-mob-title .back path{fill:var(--f-subdue)}.global-mob-title .stub{width:48px}.global-mob-view{padding:16px}
`,""]);const I=b},914068:(f,g,t)=>{var e=t(813723);e.__esModule&&(e=e.default),typeof e=="string"&&(e=[[f.id,e,""]]),e.locals&&(f.exports=e.locals);var n=t(929234).A,y=n("7e5db61f",e,!0,{})},939712:(f,g,t)=>{"use strict";t.d(g,{A:()=>Ie});var e=t(361744),n=t(538065),y=t(555381);const k=["data-brand"];function b(s,a,i,m,h,u){const o=(0,e.g2)("InstrumentHeader"),E=(0,e.g2)("InstrumentItem"),C=(0,e.g2)("settingsIcon"),r=(0,e.g2)("FButton");return(0,e.uX)(),(0,e.CE)("div",{"data-brand":m.isEdu?"edu":"indiv",class:"instrument-group-list no-select"},[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(u.displayedGroups,d=>((0,e.uX)(),(0,e.CE)("div",{key:d.name,class:(0,n.C4)(["instrument-group",{[s.$style["instrument-group-active"]]:u.isSearching||h.selectedGroup===d.name}])},[(0,e.bF)(o,{icon:h.icons[`group-${d.name}`],name:h.instruments[d.name].$name,open:u.isSearching||h.selectedGroup===d.name,"has-new-instruments":d.hasNewInstruments,onToggle:S=>u.selectGroup(d.name)},null,8,["icon","name","open","has-new-instruments","onToggle"]),u.isSearching||h.selectedGroup===d.name?((0,e.uX)(),(0,e.CE)(e.FK,{key:0},[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(u.sortInstruments(d.name,d.instruments),S=>((0,e.uX)(),(0,e.CE)("div",{class:(0,n.C4)({[s.$style.item]:!0,[s.$style["is-premium"]]:!u.hasPremium&&h.instruments[d.name][S].premium}),key:S},[!u.hasPremium&&h.instruments[d.name][S].premium?((0,e.uX)(),(0,e.CE)("div",{key:0,class:(0,n.C4)(s.$style["premium-header"])},[(0,e.Lk)("h6",null,(0,n.v_)(s.$t("flat:score.create-modal.instruments.premium")),1),u.monthlyPremiumPrice?((0,e.uX)(),(0,e.CE)("p",{key:0,class:"price",onClick:a[0]||(a[0]=(...A)=>u.openUpgradeModal&&u.openUpgradeModal(...A))},(0,n.v_)(s.$t("flat:score.create-modal.instruments.upgrade-for",{price:u.monthlyPremiumPrice})),1)):(0,e.Q3)("",!0)],2)):(0,e.Q3)("",!0),h.instruments[d.name][S]?((0,e.uX)(),(0,e.Wv)(E,{key:1,name:S,group:d,instrument:h.instruments[d.name][S],"allow-audio-preview":i.audioPreview,"selection-count":u.selectedInstrumentsByKey[`${d.name}.${S}`],"has-premium":u.hasPremium,"monthly-premium-price":u.monthlyPremiumPrice,"active-search":h.searchActiveInstru===S,"selection-mode":i.selectionMode,onAddInstrument:A=>u.addInstrument(d.name,S),onRemoveInstrument:A=>u.removeInstrument(d.name,S),onOpenUpgradeModal:u.openUpgradeModal,"audio-preview":m.instrumentAudioPreview,onAudioPreview:m.setInstrumentAudioPreview},null,8,["name","group","instrument","allow-audio-preview","selection-count","has-premium","monthly-premium-price","active-search","selection-mode","onAddInstrument","onRemoveInstrument","onOpenUpgradeModal","audio-preview","onAudioPreview"])):(0,e.Q3)("",!0)],2))),128)),!u.isSearching&&d.name==="custom"&&!m.hasAccessToken&&i.showEditCustomInstruments&&!i.isInIframe?((0,e.uX)(),(0,e.CE)("div",{key:0,class:(0,n.C4)(s.$style["instrument-item"])},[(0,e.Lk)("a",{class:(0,n.C4)(s.$style["instrument-selection"]),href:"/settings/account/instruments",target:"_self"},[(0,e.Lk)("div",{class:(0,n.C4)(s.$style["custom-create"])},[(0,e.bF)(C,{class:"icon"}),(0,e.Lk)("p",null,(0,n.v_)(s.$t("flat:custom-instru.link-manage")),1)],2)],2)],2)):(0,e.Q3)("",!0)],64)):(0,e.Q3)("",!0)],2))),128)),u.isSearching&&u.allDisplayedInstrumentsKeys.length===0?((0,e.uX)(),(0,e.CE)("div",{key:0,class:(0,n.C4)(s.$style.instrumentSearchNotfound)},[(0,e.Lk)("p",null,(0,n.v_)(s.$t("flat:score.instrument-search-notfound")),1),(0,e.bF)(r,{onClick:a[1]||(a[1]=(0,y.D$)(d=>s.$emit("resetsearch"),["prevent","stop"])),"default-text":"flat:back-to-list"})],2)):(0,e.Q3)("",!0)],8,k)}var I=t(198141),H=t(931720),R=t(971570),$=t(763939),V=t(604969),G=t(941271),P=t(916504),X=t(6645),w=t(744056),M=t(432367),ee=t(766311),te=t(218014);const z=["aria-label","aria-expanded"],ie=["src","alt"];function oe(s,a,i,m,h,u){const o=(0,e.g2)("PowerBadgeIcon"),E=(0,e.g2)("new-badge"),C=(0,e.g2)("down-icon"),r=(0,e.gN)("dompurify-html");return(0,e.uX)(),(0,e.CE)("header",{class:(0,n.C4)(s.$style.group),onClick:a[0]||(a[0]=d=>s.$emit("toggle")),"aria-label":`Instrument group ${i.name}`,"aria-expanded":i.open},[(0,e.Lk)("div",{class:(0,n.C4)(s.$style["group-info"])},[i.icon&&u.isIconURI?((0,e.uX)(),(0,e.CE)("img",{key:0,class:(0,n.C4)(s.$style["group-info-icon"]),src:i.icon,alt:i.name},null,10,ie)):i.icon?(0,e.bo)(((0,e.uX)(),(0,e.CE)("div",{key:1,class:(0,n.C4)(s.$style["group-info-icon"])},null,2)),[[r,i.icon,"svg"]]):(0,e.Q3)("",!0),(0,e.Lk)("h6",{class:(0,n.C4)(s.$style["group-info-name"])},(0,n.v_)(i.name),3),i.showPower?((0,e.uX)(),(0,e.Wv)(o,{key:2,class:(0,n.C4)(s.$style.powerIcon)},null,8,["class"])):(0,e.Q3)("",!0)],2),(0,e.Lk)("div",{class:(0,n.C4)(s.$style["toggle-group"])},[i.hasNewInstruments&&!i.open?((0,e.uX)(),(0,e.Wv)(E,{key:0,class:(0,n.C4)(s.$style["new-badge"])},null,8,["class"])):(0,e.Q3)("",!0),(0,e.bF)(C,{class:(0,n.C4)({[s.$style["toggle-icon"]]:i.open})},null,8,["class"])],2)],10,z)}var N=t(250242),re=t(797727),J=t(687915);const le={name:"InstrumentHeader",props:{open:{type:Boolean,default:!1},icon:{type:String,default:""},name:{type:String,required:!0},hasNewInstruments:{type:Boolean,required:!1},showPower:{type:Boolean,required:!1}},components:{downIcon:N.A,NewBadge:J.A,PowerBadgeIcon:re.default},emits:["toggle"],computed:{isIconURI(){return this.icon.startsWith("https://")}}};var ae=t(995359),se=t.n(ae),W=t(938793);const Y={};Y.$style=se();const ue=(0,W.A)(le,[["render",oe],["__cssModules",Y]]),U=["aria-label","aria-selected"];function de(s,a,i,m,h,u){const o=(0,e.g2)("player-minimal"),E=(0,e.g2)("hq-badge"),C=(0,e.g2)("new-badge"),r=(0,e.g2)("minus-icon"),d=(0,e.g2)("add-icon"),S=(0,e.g2)("checkIcon");return(0,e.uX)(),(0,e.CE)("div",{class:(0,n.C4)({[s.$style["instrument-item"]]:!0,[s.$style.premium]:!i.hasPremium&&i.instrument.premium,[s.$style["active-search"]]:i.activeSearch}),"aria-label":`${i.instrument.hq?"HQ: ":""}Instrument ${u.displayName}`,"aria-selected":i.activeSearch},[(0,e.Lk)("div",{class:(0,n.C4)(s.$style["instrument-selection"])},[(0,e.Lk)("div",{class:(0,n.C4)(s.$style["instrument-info"])},[i.instrument.mp3PreviewUrl&&i.group.name!=="custom"&&i.allowAudioPreview?((0,e.uX)(),(0,e.CE)("button",{key:0,class:(0,n.C4)(s.$style["audio-player"]),onClick:a[0]||(a[0]=(0,y.D$)(A=>u.previewInstrument(i.name),["stop"]))},[(0,e.bF)(o,{src:i.instrument.mp3PreviewUrl,playing:h.playing===i.name,onEnd:u.pauseAudioPlayer},null,8,["src","playing","onEnd"])],2)):(0,e.Q3)("",!0),i.instrument.hq?((0,e.uX)(),(0,e.Wv)(E,{key:1,class:(0,n.C4)(s.$style.hq)},null,8,["class"])):(0,e.Q3)("",!0),i.instrument.beta?((0,e.uX)(),(0,e.CE)("span",{key:2,class:(0,n.C4)(s.$style["beta-tag"])}," Beta ",2)):(0,e.Q3)("",!0),(0,e.Lk)("button",{class:(0,n.C4)(s.$style["instrument-name"]),onClick:a[1]||(a[1]=(...A)=>u.addInstrument&&u.addInstrument(...A))},(0,n.v_)(u.displayName),3)],2),i.isMarketingUse?(0,e.Q3)("",!0):((0,e.uX)(),(0,e.CE)("div",{key:0,class:(0,n.C4)(s.$style["action-btn"])},[i.instrument.new&&i.selectionCount===0?((0,e.uX)(),(0,e.Wv)(C,{key:0,class:(0,n.C4)(s.$style["new-badge"])},null,8,["class"])):(0,e.Q3)("",!0),i.selectionMode==="multiple"&&i.selectionCount>0?((0,e.uX)(),(0,e.CE)("button",{key:1,class:(0,n.C4)({[s.$style["action-btn-item"]]:!0,[s.$style["action-btn-icon"]]:!0}),onClick:a[2]||(a[2]=(...A)=>u.removeInstrument&&u.removeInstrument(...A))},[(0,e.bF)(r)],2)):(0,e.Q3)("",!0),i.selectionMode==="multiple"&&i.selectionCount>0?((0,e.uX)(),(0,e.CE)("div",{key:2,class:(0,n.C4)({[s.$style["action-btn-item"]]:!0,[s.$style["action-btn-count"]]:!0})},(0,n.v_)(i.selectionCount),3)):(0,e.Q3)("",!0),(i.hasPremium||!i.instrument.premium)&&(i.selectionMode==="single"&&!i.selectionCount||i.selectionMode==="multiple")?((0,e.uX)(),(0,e.CE)("button",{key:3,class:(0,n.C4)({[s.$style["action-btn-item"]]:!0,[s.$style["action-btn-icon"]]:!0}),onClick:a[3]||(a[3]=A=>u.addInstrument(i.instrument.name,i.name))},[(0,e.bF)(d)],2)):(0,e.Q3)("",!0),i.selectionMode==="single"&&i.selectionCount?((0,e.uX)(),(0,e.Wv)(S,{key:4,class:(0,n.C4)(s.$style["single-selected"])},null,8,["class"])):(0,e.Q3)("",!0)],2))],2)],10,U)}var K=t(585368),_e=t(628521),T=t(47197),O=t(119640),ne=t(557854),ce=(s,a,i)=>new Promise((m,h)=>{var u=C=>{try{E(i.next(C))}catch(r){h(r)}},o=C=>{try{E(i.throw(C))}catch(r){h(r)}},E=C=>C.done?m(C.value):Promise.resolve(C.value).then(u,o);E((i=i.apply(s,a)).next())});const l={name:"InstrumentItem",data(){return{playing:null}},components:{PlayerMinimal:O.A,HqBadge:ne.A,NewBadge:J.A,addIcon:K.A,minusIcon:_e.A,checkIcon:T.A},props:{allowAudioPreview:{type:Boolean,default:!0},hasPremium:{type:Boolean,default:!1},name:{type:String,default:""},instrument:{type:Object,required:!0},group:{type:Object,required:!0},monthlyPremiumPrice:{type:String,default:null},selectionMode:{type:String,default:"multiple"},selectionCount:{type:Number,default:0},activeSearch:{type:Boolean,default:!1},audioPreview:{type:String,default:null},isMarketingUse:{type:Boolean,default:!1}},emits:["open-upgrade-modal","add-instrument","remove-instrument","audio-preview"],computed:{displayName(){return(this.instrument.title||this.instrument.longname||this.instrument.name).replace(/\s?HQ\s?/g,"")}},watch:{audioPreview(s){this.pauseNonCurrentAudioPlayer(s)}},methods:{openUpgradeModal(s){this.$emit("open-upgrade-modal",s)},addInstrument(){this.$emit("add-instrument",this.instrument.name,this.name)},removeInstrument(){this.$emit("remove-instrument",this.instrument.name,this.name)},pauseAudioPlayer(){this.playing=null},pauseNonCurrentAudioPlayer(){this.audioPreview!==this.name&&this.pauseAudioPlayer()},previewInstrument(s=this.name){this.playing===s?this.pauseAudioPlayer():(this.playing=s,this.$emit("audio-preview",s),this.previewAnalytics())},previewAnalytics(){return ce(this,null,function*(){const s="instrus.previewed",a=P.A.get(s)||[],i=`${this.instrument.mainGroup}.${this.name}`;a.includes(i)||(yield R.A.push({event:{type:"action",category:"instruments",name:"preview",properties:{instrumentId:i,instrumentIsHq:this.instrument.hq,instrumentIsPremium:this.instrument.premium,previousPreviews:a,previousPreviewsCount:a.length}}}),P.A.set(s,a.concat([i])))})}},mounted(){this.pauseNonCurrentAudioPlayer()}};var _=t(663278),p=t.n(_);const v={};v.$style=p();const x=(0,W.A)(l,[["render",de],["__cssModules",v]]);var Z=Object.defineProperty,q=Object.defineProperties,D=Object.getOwnPropertyDescriptors,Q=Object.getOwnPropertySymbols,ge=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable,pe=(s,a,i)=>a in s?Z(s,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[a]=i,me=(s,a)=>{for(var i in a||(a={}))ge.call(a,i)&&pe(s,i,a[i]);if(Q)for(var i of Q(a))ye.call(a,i)&&pe(s,i,a[i]);return s},he=(s,a)=>q(s,D(a)),be=(s,a,i)=>new Promise((m,h)=>{var u=C=>{try{E(i.next(C))}catch(r){h(r)}},o=C=>{try{E(i.throw(C))}catch(r){h(r)}},E=C=>C.done?m(C.value):Promise.resolve(C.value).then(u,o);E((i=i.apply(s,a)).next())});const Ee={name:"InstrumentsList",props:{selectedInstruments:{type:Array,default:()=>[]},selectionMode:{type:String,default:"multiple"},audioPreview:{type:Boolean,default:!0},displayCustom:{type:Boolean,default:!0},displayPitched:{type:Boolean,default:!0},displayUnpitched:{type:Boolean,default:!0},showEditCustomInstruments:{type:Boolean,default:!0},isInIframe:{type:Boolean,default:!1}},data(){return{icons:M.A,selectedGroup:null,instruments:{},groups:[],searched:"",lastSearched:"",searchActiveInstru:null,playing:null}},components:{InstrumentHeader:ue,InstrumentItem:x,settingsIcon:I.A},setup(){const s=(0,w.KR)(null);function a(u){s.value=u}const i=(0,te.F)(),m=(0,$.F)(),h=(0,G.B)();return{account:(0,e.EW)(()=>m.account),experience:(0,e.EW)(()=>m.experience),locale:(0,e.EW)(()=>m.locale),isEdu:(0,e.EW)(()=>m.isEdu),accountFeatures:(0,e.EW)(()=>m.accountFeatures),hasAccessToken:(0,e.EW)(()=>m.hasAccessToken),instrumentAudioPreview:s,setInstrumentAudioPreview:a,customInstrumentsListFormat:(0,e.EW)(()=>i.customInstrumentsListFormat),hasCustomInstruments:(0,e.EW)(()=>i.hasCustomInstruments),addExperience:h.addExperience}},emits:["addinstrument","removeinstrument","done","resetsearch","hqInstrumentsClickWhenFreeUser"],computed:he(me({},(0,X.aH)(V.w,["offers","bestIndivOffer"])),{hasPremium(){return this.accountFeatures.premiumInstruments},experienceCount(){return this.experience.length},selectedInstrumentsByKey(){const s={};return this.selectedInstruments.forEach(a=>{s[`${a.group}.${a.instrument}`]===void 0?s[`${a.group}.${a.instrument}`]=1:s[`${a.group}.${a.instrument}`]++}),s},isSearching(){return this.searched&&this.searched.length>0},displayedGroups(){if(!this.isSearching)return this.groups.filter(a=>this.instruments[a.name]&&(this.displayCustom||a.name!=="custom"));const s=this.searched.toLowerCase();return this.groups.map(({name:a,instruments:i})=>(i=i.filter(m=>{if(m.includes(s))return m;const{longname:h}=this.instruments[a][m];return h.toLowerCase().includes(s)?m:m.includes(s)}),{name:a,instruments:i})).filter(a=>a.instruments.length>0).filter(a=>this.instruments[a.name]&&(this.displayCustom||a.name!=="custom"))},allDisplayedInstrumentsKeys(){return[].concat(...this.displayedGroups.map(s=>s.instruments))},mappingInstrumentsToGroup(){const s={};return this.groups.forEach(({name:a,instruments:i})=>{i.forEach(m=>{s[m]=a})}),s},monthlyPremiumPrice(){var s,a,i;const m=this.bestIndivOffer;return((a=(s=m==null?void 0:m.discountedOffer)==null?void 0:s.pricePerMonthWithVAT)==null?void 0:a.text)||((i=m==null?void 0:m.pricePerMonthWithVAT)==null?void 0:i.text)||null}}),methods:he(me(me({},(0,X.i0)(H.B,["showUpgradeDialog"])),(0,X.i0)(V.w,["fetchAllOffers"])),{openUpgradeModal(){this.showUpgradeDialog({feature:"instruments"})},filterInstruments(){const s=JSON.parse(JSON.stringify(this.instruments)),a=JSON.parse(JSON.stringify(this.groups));Object.keys(s).forEach(i=>{i.startsWith("$")||Object.keys(s[i]).forEach(m=>{if(m.startsWith("$"))return;const h=s[i][m];if(!this.displayUnpitched&&h.mapping||!this.displayPitched&&!h.mapping){delete s[i][m];const u=a.find(o=>o.name===i);if(u){const o=u.instruments.indexOf(m);o>=0&&u.instruments.splice(o,1)}}})});for(let i=a.length;i--;i>=0)a[i].instruments.length===0&&(delete s[a[i].name],a.splice(i,1));this.instruments=s,this.groups=a},sortInstruments(s,a){return this.hasPremium?[...a.filter(i=>this.instruments[s][i].hq),...a.filter(i=>!this.instruments[s][i].hq)]:a},selectGroup(s){this.selectedGroup===s?this.selectedGroup=null:this.selectedGroup=s,this.previewInstrument(null)},addInstrument(s,a){if(this.instruments[s][a].premium){if(!this.hasPremium){this.showUpgradeDialog({feature:"instruments"});const i=P.A.get("instrus.previewed")||[];R.A.push({event:{type:"action",category:"instruments",name:"paywall",properties:{instrumentId:`${s}.${a}`,instrumentIsHq:this.instruments[s][a].hq,instrumentIsPremium:!0,previousPreviews:i,previousPreviewsCount:i.length}}}),this.$emit("hqInstrumentsClickWhenFreeUser");return}this.addExperience("editor.instruments.premium")}this.$emit("addinstrument",{group:s,instrument:a}),this.previewInstrument(null)},removeInstrument(s,a){this.$emit("removeinstrument",{group:s,instrument:a}),this.previewInstrument(null)},previewInstrument(s){this.playing===s?this.playing=null:this.playing=s},onSearchKeyboard({event:s,value:a}){a!==this.searched&&(this.searched=a);const i=this.allDisplayedInstrumentsKeys;let m=i.indexOf(this.searchActiveInstru);if(m<0&&(this.searchActiveInstru=i[0],m=0),s)if(s.code==="ArrowDown"&&m<i.length-1)this.searchActiveInstru=i[m+1];else if(s.code==="ArrowUp"&&m>0)this.searchActiveInstru=i[m-1];else if(s.code==="Enter"&&(s.metaKey||s.ctrlKey))this.$emit("done");else if(s.code==="Enter"&&s.target.name==="instrumentSerchInput"){if(i.length>0){const h=this.searchActiveInstru,u=this.mappingInstrumentsToGroup[h];this.addInstrument(u,h)}}else this.isSearching||(this.searchActiveInstru=null)},onSearchKeyboardGlobal(s){this.isSearching&&this.onSearchKeyboard({event:s,value:this.searched})}}),created(){return be(this,null,function*(){this.instruments=(yield ee.A.get({locale:this.locale})).instruments,this.groups=this.instruments.$sort,this.hasPremium||(yield this.fetchAllOffers()),this.hasPremium||this.groups.forEach(s=>{const a=s.name;this.account&&new Date(this.account.registrationDate)>new Date("2020-05-01T17:00:00Z")&&s.instruments.forEach(m=>{const h=this.instruments[a][m];h.free||(h.premium=!0)});const i=[...s.instruments];s.instruments=s.instruments.sort((m,h)=>{const u=this.instruments[a][m].premium,o=this.instruments[a][h].premium;return u&&!o?1:!u&&o?-1:i.indexOf(m)-i.indexOf(h)})}),this.groups.forEach(s=>{const a=s.name,i=Object.values(this.instruments[a]);s.hasNewInstruments=i.findIndex(m=>m.new)!==-1}),this.displayCustom&&this.hasCustomInstruments&&(ee.A.constructor.initCustomGroup(this.instruments),Object.assign(this.instruments.custom,this.customInstrumentsListFormat.custom),this.instruments.$sort[0].instruments=this.customInstrumentsListFormat.$sort),(!this.displayPitched||!this.displayUnpitched)&&this.filterInstruments(),this.onSearchKeyboardGlobalBound=this.onSearchKeyboardGlobal.bind(this),document.addEventListener("keydown",this.onSearchKeyboardGlobalBound)})},beforeUnmount(){document.removeEventListener("keydown",this.onSearchKeyboardGlobalBound)}};var Ce=t(769201),ke=t.n(Ce);const fe={};fe.$style=ke();const Ie=(0,W.A)(Ee,[["render",b],["__cssModules",fe]])},955091:(f,g,t)=>{"use strict";t.d(g,{i:()=>O,A:()=>ce});var e=t(721247),n=t(584527),y=t(597626),k=t(653154),b=t(674548),I=t(763939),H=t(941271),R=t(612732),$=t(218439),V=t(939712),G=t(833395),P=t(471407),X=t(486841),w=t(8848),M=t(307131),ee=t(740094),te=t(432367),z=t(766311),ie=t(218014),oe=t(146122),N=t(361744),re=Object.defineProperty,J=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,se=(l,_,p)=>_ in l?re(l,_,{enumerable:!0,configurable:!0,writable:!0,value:p}):l[_]=p,W=(l,_)=>{for(var p in _||(_={}))le.call(_,p)&&se(l,p,_[p]);if(J)for(var p of J(_))ae.call(_,p)&&se(l,p,_[p]);return l},Y=(l,_,p)=>new Promise((v,L)=>{var x=D=>{try{q(p.next(D))}catch(Q){L(Q)}},Z=D=>{try{q(p.throw(D))}catch(Q){L(Q)}},q=D=>D.done?v(D.value):Promise.resolve(D.value).then(x,Z);q((p=p.apply(l,_)).next())});const j=["base","stavesClefs","transposition","tab","sound","name"],ue="stavesClefs",U=["base","unpitchedStaff","unpitchedInstruments","name"],de="unpitchedStaff",K=z.A.getData(),_e=[-2,-1,0,1,2],T={midichannel:{default:{}},clefs:[],transposechromatic:0,transposediatonic:0,tab:{capo:0,lines:6,tuning:[]},mapping:[],staffLines:0,longname:"",shortname:""},O={SETTINGS:"settings",SCORE:"score,"},ne=l=>JSON.parse(JSON.stringify(l)),ce={name:"SettingsInstrumentsEdit",props:{editContext:{type:String,required:!1,default:O.SETTINGS},id:{type:[String,null],required:!1,default:null},goBack:{type:Function,required:!1,default:l=>{l.push("/settings/account/instruments")}}},setup(l){const _=(0,R.k)(),p=(0,ie.F)(),v=(0,I.F)(),L=(0,H.B)();return l.editContext===O.SETTINGS&&(0,oe.u)({title:b.MR.t("flat:custom-instru.placeholder.title")}),{customInstrumentsAvailable:(0,N.EW)(()=>p.customInstrumentsAvailable),createOrUpdateUnpitched:p.createOrUpdateUnpitched,createOrUpdatePitched:p.createOrUpdatePitched,fetchInstruments:p.fetchInstruments,fetchById:p.fetchById,isSmallScreen:(0,N.EW)(()=>_.isSmallScreen),isEdu:(0,N.EW)(()=>v.isEdu),account:(0,N.EW)(()=>v.account),addExperience:L.addExperience}},data(){return{i:Object.assign({},T,{type:null}),step:"type",base:null,baseSelected:[],transposition:{note:"C",octave:0},tabEnabled:!1,tabLines:6,sound:null,soundSelected:[],processing:!1,CLEFS:w.A,TRANSPOSITION_OCTAVES:_e,TRANSPOSITION_NOTES:M.A,INSTRUMENTS_METAS:K,EditContext:O}},components:{MobileTitle:$.A,InstrumentsList:V.A,TuningEditor:P.A,UnpitchedKitEditor:X.A,FNumberInput:y.A,arrowBackIcon:n.A},computed:{isComsumerMobile(){return this.isSmallScreen&&!this.isEdu},steps(){return this.i.type?this.i.type==="pitched"?j:U:[]},typeTitleI18n(){return`flat:custom-instru.type.${this.i.type}.title`},baseIcon(){return te.A[`group-${this.i.icon}`]},soundIcon(){return this.sound?te.A[`group-${this.sound.group}`]:null},stepDone(){return this.i.type==="pitched"?this.stepPitchedDone:this.i.type==="unpitched"?this.stepUnpitchedDone:{}},stepUnpitchedDone(){const l=U.indexOf(this.step);return l<0?{}:{type:!0,base:l>U.indexOf("base"),unpitchedStaff:l>U.indexOf("unpitchedStaff"),unpitchedInstruments:l>U.indexOf("unpitchedInstruments")}},stepPitchedDone(){const l=j.indexOf(this.step);return l<0?{}:{type:!0,base:l>j.indexOf("base"),stavesClefs:l>j.indexOf("stavesClefs"),transposition:l>j.indexOf("transposition"),tab:l>j.indexOf("tab"),sound:l>j.indexOf("sound")}},hasValidLongname(){return this.i.longname&&this.i.longname.length>0}},watch:{customInstrumentsAvailable(l){l||this.goBack(this.$router)},tabEnabled(){Number.isInteger(this.tabLines)||(this.tabLines=6)},tabLines(l){Number.isInteger(l)&&(this.tabLines<3?this.tabLines=3:this.tabLines>14&&(this.tabLines=14),this.i.tab.lines=l)}},methods:{chooseType(l){this.i.type!==l&&(this.i=Object.assign({},T,{type:l})),this.step=this.steps[0]},chooseBase(l){if(l==="pitched")this.base={},this.baseSelected=[],this.i=Object.assign({},T,{type:"pitched",icon:"custom-keyboards"});else if(l==="unpitched")this.base={},this.baseSelected=[],this.i=Object.assign({},T,{type:"unpitched",icon:"custom-unpitched-percussion"});else{const _=K[l.group][l.instrument];this.base=l,this.baseSelected=[W({},l)],this.setBaseInstrument(l.group,_),this.i.type==="pitched"&&this.chooseSound(l)}},setBaseInstrument(l,_){var p;if(this.i=Object.assign({},T,{type:_.instruments?"unpitched":"pitched"}),this.i.icon=`custom-${_.mainGroup||l}`,this.i.longname=_.longname,this.i.shortname=_.shortname,this.i.transposechromatic=_.transposechromatic||0,this.i.transposediatonic=_.transposediatonic||0,this.i.type==="pitched"?(this.i.midichannel.default.program=_.midichannel.default.program,this.i.clefs=[],_.clefs.forEach(v=>{v.sign!=="TAB"&&this.i.clefs.push({sign:v.sign,"clef-octave-change":Number.parseInt(v["clef-octave-change"]||0,10)})})):(this.i.staffLines=_.lines,this.i.mapping=z.A.musicXmlUnpitchedMappingToLinesV2({lines:_.lines,mapping:_.mapping,defaultMidiProgram:_.midiprogram}),this.i.mapping.forEach(v=>{v.selected=!1,v.noteDefault=!1,v.keyboardShortcut=[]})),this.tabEnabled=!1,(p=_.details)!=null&&p["staff-tuning"]){const v=Number.parseInt(_.details["staff-lines"],10),L=_.details["staff-tuning"].sort((x,Z)=>x.$line<Z.$line);if(v===L.length)this.tabEnabled=!0,this.tabLines=v,this.i.tab={capo:0,lines:v,tuning:L},L.forEach(x=>{delete x.$line,x["tuning-alter"]||(x["tuning-alter"]=0)});else{const x=new Error("StaffLine != StaffTuning");x.instrument=_,(0,k.vV)(x)}}},addStave(l){const _=e.default.create(l.l,l.n);typeof l.o!="undefined"&&e.default.setOctaveChange(_,l.o);const p={sign:_.sign,displayedSign:_.sign,"clef-octave-change":Number.parseInt(_["clef-octave-change"]||0,10)};if((_.sign==="C"||_.sign==="F"&&_.line!=="4")&&(p.displayedSign=_.sign+_.line),p["clef-octave-change"]!==0){const v=p["clef-octave-change"]<0?-1:1;p.clefDetails=p["clef-octave-change"]*8,Math.abs(l["clef-octave-change"])>1&&(p.clefDetails-=v*1)}this.i.clefs.push(p),this.tabEnabled=!1},removeStave(l){this.i.clefs.length<l||this.i.clefs.splice(l,1)},setTranspositionNote(l){this.transposition.note=l,this.updateTranspositionValue()},setTranspositionOctave(l){this.transposition.octave=l,this.updateTranspositionValue()},updateTranspositionValue(){if(!this.transposition.note||this.transposition.note==="C"){this.i.transposediatonic=7*this.transposition.octave,this.i.transposechromatic=12*this.transposition.octave;return}this.i.transposediatonic=M.A[this.transposition.note].diatonic+7*this.transposition.octave,this.i.transposechromatic=M.A[this.transposition.note].chromatic+12*this.transposition.octave},updateTranspositionFromValue(){this.transposition.octave=Math.floor(this.i.transposediatonic/7);const l=this.i.transposediatonic-7*this.transposition.octave,_=this.i.transposechromatic-12*this.transposition.octave,p=Object.keys(M.A);for(let v=0;v<p.length;v++){const L=p[v],x=M.A[L];if(x.diatonic===l&&x.chromatic===_){this.transposition.note=L;break}}},chooseSound(l){if(!l)this.sound=null,this.soundSelected=[];else{const _=K[l.group][l.instrument];this.sound=l,this.soundSelected=[W({},l)],this.i.midichannel.default.program=_.midichannel.default.program,(!this.base||!this.base.group)&&(this.i.icon=`custom-${_.mainGroup||l.group}`)}},setNumberLines(l){this.i.staffLines=l},isMappingValid(){return(0,G.Zy)(this.i.mapping)},save(){const l=ne(this.i);if(l.shortname||(l.shortname=l.longname),this.tabEnabled&&l.tab&&l.tab.tuning){l.tab.tuning=l.tab.tuning.slice(0,l.tab.lines);for(let p=0;p<l.tab.tuning.length;p++){const v=l.tab.tuning[p];l.tab.tuning[p]={step:v["tuning-step"],octave:v["tuning-octave"],alter:v["tuning-alter"]}}}else l.tab={};this.processing=!0;let _;l.type==="pitched"?_=this.createOrUpdatePitched({id:l.id,instrument:l}):_=this.createOrUpdateUnpitched({id:l.id,instrument:l}),_.then(()=>{this.trackCreation(),this.goBack(this.$router)}).catch(()=>{this.processing=!1})},trackCreation(){this.addExperience("score.edit-custom-instrument"),this.editContext===O.SETTINGS&&this.addExperience("score.edit-custom-instrument.from-settings"),this.editContext===O.SCORE&&this.addExperience("score.edit-custom-instrument.from-score")},clickStep(l){this.stepDone[l]&&this.goStep(l)},goStep(l){this.step=l},loadEditedInstrument(l){return Y(this,null,function*(){try{let _=yield this.fetchById(l);if(_=ne(_),_.type==="pitched"){if(this.chooseSound(K.$midi[_.midichannel.default.program]),this.goStep(ue),_.tab&&_.tab.lines>0){this.tabEnabled=!0,this.tabLines=_.tab.tuning.length;for(let p=0;p<_.tab.tuning.length;p++){const v=_.tab.tuning[p];_.tab.tuning[p]={"tuning-step":v.step,"tuning-octave":v.octave,"tuning-alter":v.alter}}}else this.tabEnabled=!1,Object.assign(_.tab,T.tab);this.updateTranspositionFromValue()}else this.goStep(de);this.i=Object.assign({},T,_)}catch(_){(0,k.vV)(_),this.goBack(this.$router)}})}},created(){return Y(this,null,function*(){yield this.fetchInstruments(),this.editContext===O.SETTINGS&&this.$route.params.id&&(yield this.loadEditedInstrument(this.$route.params.id)),this.editContext===O.SCORE&&this.id&&(yield this.loadEditedInstrument(this.id)),w.A.forEach(_=>{_.icon=ee.A[`keysel-${_.l.toLowerCase()}${_.n}${_.o||0}`]});const l=yield z.A.get({locale:this.account.locale});this.INSTRUMENTS_METAS=l.instruments})}}},995359:(f,g,t)=>{var e=t(175002);e.__esModule&&(e=e.default),typeof e=="string"&&(e=[[f.id,e,""]]),e.locals&&(f.exports=e.locals);var n=t(929234).A,y=n("3c7d15d2",e,!0,{})}}]);})();


//# debugId=d88d0ad5-9532-566d-ac73-839fb8b4d4f4
