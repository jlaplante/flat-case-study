(function(o,d){typeof exports=="object"&&typeof module!="undefined"?d(exports):typeof define=="function"&&define.amd?define(["exports"],d):(o=typeof globalThis!="undefined"?globalThis:o||self,d(o.flatDeviceId={}))})(this,function(o){"use strict";var m=(o,d,s)=>new Promise((h,w)=>{var g=a=>{try{f(s.next(a))}catch(i){w(i)}},y=a=>{try{f(s.throw(a))}catch(i){w(i)}},f=a=>a.done?h(a.value):Promise.resolve(a.value).then(g,y);f((s=s.apply(o,d)).next())});var T;function d(t){const e=t.split(".").reverse();return e.length>=2?`${e[1]}.${e[0]}`:t}function s(){return{apiBaseUrl:d(window.location.hostname)==="flat.io"?"https://flat.io/api/v2":"/api/v2",headers:{"Content-Type":"application/json"}}}function h(){return m(this,null,function*(){try{const t=yield fetch("https://prod.flat-cdn.com/fixtures/version.json");if(t.ok){const e=yield t.json();return(e==null?void 0:e.version)||null}return null}catch(t){return console.debug("Could not fetch version from CDN:",t),null}})}function w(){return m(this,arguments,function*(t={}){const e=window.location.search,n=new URLSearchParams(e).get("irclickid")||void 0;if(!n&&!t.always)return;const{apiBaseUrl:c,headers:r}=s(),l=`${c}/me/devices/current`,p=yield fetch(l,{method:"GET",headers:r,credentials:"include"}).then(v=>v.json());n&&(yield fetch(l,{method:"PUT",headers:r,credentials:"include",body:JSON.stringify({id:p.id,os:"web",irclickid:n})}))})}function g(){return m(this,arguments,function*(t={}){const{apiBaseUrl:e,headers:u}=s(),n=`${e}/me/_events`,c=yield h(),r={event:{type:"page",name:"pageview",properties:Object.assign({url:window.location.href,title:document.title,referrer:document.referrer||void 0,screenHeight:window.screen.height,screenWidth:window.screen.width,platform:"web",version:c},t)}};return(yield fetch(n,{method:"POST",headers:u,credentials:"include",body:JSON.stringify(r)})).json()})}function y(u){return m(this,arguments,function*(t,e={}){const{apiBaseUrl:n,headers:c}=s(),r=`${n}/me/_events`,l=yield h(),p={event:{type:"click",name:t,properties:Object.assign({page_url:window.location.href,version:l,platform:"web"},e)}};yield fetch(r,{method:"POST",headers:c,credentials:"include",body:JSON.stringify(p)})})}function f(u){return m(this,arguments,function*(t,e={}){const{apiBaseUrl:n,headers:c}=s(),r=`${n}/me/_events`,l=yield h(),p={event:{id:t,type:"page",name:"pageview",properties:Object.assign({version:l},e)}};yield fetch(r,{method:"POST",headers:c,credentials:"include",body:JSON.stringify(p)})})}function a(t){let e,u=0,n=new Date().toISOString();const c=()=>{const r=window.scrollY||document.documentElement.scrollTop,l=document.documentElement.scrollHeight-document.documentElement.clientHeight,p=Math.round(r/l*100),v=Math.min(Math.max(p,0),100);n=new Date().toISOString(),clearTimeout(e),e=setTimeout(()=>{v>u?(u=v,f(t,{scrolled_to:u,last_scrolled_to_time:n})):f(t,{last_scrolled_to_time:n})},200)};return window.addEventListener("scroll",c,{passive:!0}),()=>{window.removeEventListener("scroll",c),clearTimeout(e)}}const i=(T=document.currentScript)==null?void 0:T.dataset,S=!!(i!=null&&i.pageview);i!=null&&i.standalone&&w({always:S}).then(()=>{S&&g()}),o.flatDeviceId=w,o.flatPageview=g,o.setupScrollTracking=a,o.trackEvent=y,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="812ad33e-51eb-5d40-8791-323649b0182f")}catch(e){}}();
//# sourceMappingURL=device-id.umd.js.map
//# debugId=812ad33e-51eb-5d40-8791-323649b0182f
