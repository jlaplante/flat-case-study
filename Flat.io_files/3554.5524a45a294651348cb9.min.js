"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="262e613a-5c44-54ce-a7e5-dd129c457681")}catch(e){}}();
(()=>{/*! Copyright (c) 2025 Tutteo Ltd. */(self.webpackChunk_flat_flat=self.webpackChunk_flat_flat||[]).push([[3554],{68926:(N,B,e)=>{e.d(B,{h:()=>n});var P=e(916504),f=e(6645),M=e(744056);const p="(prefers-color-scheme: dark)",n=(0,f.nY)("globalUITheme",()=>{const v=(0,M.KR)("light");function S(l){document.documentElement.dataset.colorMode=l}function C(){window.matchMedia&&(window.matchMedia(p).addEventListener("change",l=>{S(l.matches?"dark":"light")}),window.matchMedia(p).matches&&S("dark"))}function R(){P.A.set("beta.ui.dark",!0),C()}return{changeTheme:S,useBeta:R,theme:v}})},104210:(N,B,e)=>{e.d(B,{e:()=>A});var P=e(303953),f=e(916504),M=e(645369),p=e.n(M),n=e(124872),v=e.n(n),S=e(6645),C=e(98261),R=e(744056),l=e(328010),d=e(309033),w=e(763939),h=e(777549),U=e(973876),g=e(28408),m=e(705890),L=e(953654),T=e(679808),x=e(88247),i=e(706305),o=e(633356),t=e(621297);const a=p()("flat:push"),W=["ScoreComment"],s={Update:{UserPartial:r=>(0,w.F)().setAccountPartialData(r),User:r=>(0,w.F)().setAccountPartialData(r),Collection:r=>(0,m.k)().CACHE(r),ScoreComment:r=>(0,x.O)().cache(r),ClassroomAssignment:r=>(0,h.Z)().CACHE(r),Notification:r=>(0,T.E)().pushHandleNotification(r),ClassroomStreamPost:r=>(0,g.C)().CACHE(r),Classroom:r=>(0,U.V)().CACHE(r),GroupMember:r=>(0,L.n)().CACHE_GROUP_MEMBER(r),ClassroomSubmission:r=>(0,t.m)().CACHE_PARTIAL(r),ClassroomSubmissionComment:r=>(0,o.i)().cache(r),Score:r=>(0,i.j)().pushHandle(r)}};let O;const A=(0,S.nY)("push",()=>{const r=(0,R.KR)(!1),F=(0,R.KR)(null);function D(_){const K=_.payload.type,I=_.payload.object;if(!(I!=null&&I.id)||!K)return!1;a("update of object %s (id = %s, object = %o)",K,I.id,I);const $=F.value||null;if($&&I.score&&$!==I.score&&W.includes(K))return a("skip update (diff scoreId): %o",I),!1;if(_.type==="ObjectUpdate"){const b=s.Update[K];b?b(I):a("[update] type %s is not support yet",K)}else a("type %s is not support yet",K);return(0,d.mk)({action:_.type,type:K,object:I}),!0}function c(){if(typeof URL!="function")return a("disabled, no URL"),!1;const _=new URL(P.A.pushapibaseurl),K=l.A.getAccessToken()||v().get("flat.sid");let I=`${_.protocol}//${_.host}?access_token=${encodeURIComponent(K)}`;const $=f.A.get("reqas");$&&(I+=`&requestAs=${encodeURIComponent($)}`);let b="/socket.io";_.pathname!=="/"&&(b=`${_.pathname}${b}`),O=(0,C.io)(I,{path:b}),O.on("connect",()=>{r.value=!1});const z=()=>{r.value=!0};return O.on("disconnect",z),O.on("connect_error",z),O.on("push",y=>D(y)),!0}function E(_){F.value=_}return{pushInit:c,pushSetScore:E}})},115548:(N,B,e)=>{e.d(B,{A:()=>M});function P(p){p&&(this.$ssrContext.title=`${p} - Flat`)}function f(p){p&&(document.title=`${p} - Flat`)}const M=f},130179:(N,B,e)=>{e.d(B,{I1:()=>P.I});var P=e(15247),f=e(390907)},254872:(N,B,e)=>{e.d(B,{Sz:()=>A,jp:()=>O});var P=e(324074),f=e.n(P),M=e(645369),p=e.n(M),n=e(303953),v=e(916504),S=e(477810),C=e(328010),R=e(775),l=e(390907),d=e(653154),w=e(130179),h=e(724246),U=e(763939),g=e(849123),m=e(796425),L=e(68926),T=e(324724),x=e(703359),i=e(346579),o=e(973697),t=e(104210),a=e(941271),W=(c,E,_)=>new Promise((K,I)=>{var $=y=>{try{z(_.next(y))}catch(H){I(H)}},b=y=>{try{z(_.throw(y))}catch(H){I(H)}},z=y=>y.done?K(y.value):Promise.resolve(y.value).then($,b);z((_=_.apply(c,E)).next())});const s=p()("flat:account");function O(){return W(this,arguments,function*(c={}){var E,_;const K=(0,U.F)(),I=(0,o.B)();try{s("getMe %o",c);const $=yield C.A.get(c);return K.setAccountData($),$.organization&&c.fetchOrganization!==!1&&(yield I.getOrganization()),$}catch($){return!((E=K.account)!=null&&E.id)&&f().isAxiosError($)&&($.status||(_=$.response)!=null&&_.status)&&(0,U.F)().clearAccount(),Promise.reject()}})}function A(){return W(this,arguments,function*({push:c=!0,onlineStatus:E=!0,licensePoolsSummary:_=!1,cio:K=!1}={}){var I,$;const b=(0,U.F)(),z=typeof URLSearchParams!="undefined"&&!0&&new URLSearchParams(window.location.search).get("reqas")||v.A.get("reqas");z?(s("reqas %s",z),C.A.setRequestAs(z),v.A.set("reqas",z)):((!n.A.loggeduser||n.A.loggeduser.type!=="user")&&l.A.get("account")&&l.A.get("account").type!=="guest"&&(n.A.loggeduser=l.A.get("account"),s("use account from local storage: %o",n.A.loggeduser)),!n.A.csrf&&l.A.get("csrf")&&(n.A.csrf=l.A.get("csrf"),s("use csrf from local storage: %o",n.A.csrf)),n.A.loggeduser&&(s("use flatSettings.loggeduser"),b.setAccountData(n.A.loggeduser),typeof n.A.csrf=="string"&&C.A.setCsrfToken(n.A.csrf))),typeof navigator!="undefined"&&"serviceWorker"in navigator&&typeof navigator.serviceWorker.addEventListener=="function"&&navigator.serviceWorker.addEventListener("message",y=>{if(s("[sw] received message from sw"),y.data==="user-logout"&&window.location.reload(!0),y.data==="leave-student-view"||y.data==="reset-student"){const H=v.A.get("URL-before-student-view");typeof H=="string"?(v.A.remove("URL-before-student-view"),window.location.href=H):window.location.reload()}});{E&&(0,i.n)().initOnlineStatus();let y=null;const H=()=>!!(window.location.href.includes("billing-guest")&&window.location.href.includes("billing-guest-key")),X=()=>W(null,null,function*(){try{const V=new URL(window.location.toString()).searchParams,G=V.get("billing-guest"),Q=V.get("billing-guest-key");G&&Q&&(yield S.A.signinGuest({email:G,key:Q}),y=yield O())}catch(V){window.location.href="/auth/logout"}});try{y=yield O(),y.organizationRole!=="admin"&&H()&&(yield X())}catch(V){if(H())yield X();else{if(V)throw(0,d.vV)(V),V;y=b.account||{}}}if(!window.location.href.includes("chromeless=true")&&(y==null?void 0:y.type)!=="guest"){const{init:V}=(0,a.B)();if(V(),c){const{pushInit:G}=(0,t.e)();G()}yield r(),F()}if((I=y==null?void 0:y.experience)!=null&&I.includes("ui.dark")&&(0,L.h)().useBeta(),y!=null&&y.organization){if(document.documentElement.dataset.product="flatEdu",b.isTeacher){const{loadOnboarding:V}=(0,x.z)();yield V({track:"eduBasics"})}b.isAdmin&&_&&(0,T.t)().getSummary(),($=y.plan)!=null&&$.upgradable&&(yield(0,g.k)().refreshLicense()),K&&(y.organizationRole==="admin"||y.organizationRole==="teacher")&&(0,m.i)().init()}return y!=null&&y.id&&h.I.setUserId(y==null?void 0:y.id),y}})}function r(){return W(this,null,function*(){const c=v.A.get("score.jointokens")||{},E=Object.keys(c),_=E.map(K=>{const I=c[K];return s("redeem token for score  %s (t = %s)",K,I),(0,R.OZ)(K,{user:"me",userToken:I})});try{yield Promise.all(_)}catch(K){s(K)}v.A.remove("score.jointokens"),E.length>0&&(window.location.href=`/score/${E[0]}/edit`)})}function F(){let c;if(v.A.get("redirect.next")&&(c=v.A.get("redirect.next"),v.A.remove("redirect.next")),v.A.get("redirect.next-logged")&&(c=v.A.get("redirect.next-logged"),v.A.remove("redirect.next-logged")),c)if(typeof c=="string")c[0]==="/"&&(window.location.href=c);else{let E=c.path||c.ext||"/";if(E[0]==="/"){let _="";c.search&&(_=new URLSearchParams(c.search).toString()),_.length>0&&(E+=`?${_}`),window.location.href=E}}}function D(){return W(this,null,function*(){const c=getUserOfflineStorage();try{yield apiAuth.logout(),yield c.deleteStorage()}catch(E){logError(E)}useAccount().clearAccount(),"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage("user-logout"),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(E=>{E.forEach(_=>{s("unregistering service worker %s",_.scope),_.unregister()})}),window.localStorage&&window.localStorage.clear();try{useCioStore().logout()}catch(E){logError(E)}})}},324724:(N,B,e)=>{e.d(B,{t:()=>S});var P=e(6645),f=e(744056),M=e(361744),p=e(373142),n=e(540888),v=(C,R,l)=>new Promise((d,w)=>{var h=m=>{try{g(l.next(m))}catch(L){w(L)}},U=m=>{try{g(l.throw(m))}catch(L){w(L)}},g=m=>m.done?d(m.value):Promise.resolve(m.value).then(h,U);g((l=l.apply(C,R)).next())});const S=(0,P.nY)("licensePools",()=>{const C=(0,f.KR)([]),R=(0,f.KR)({issues:{blockedForUnpaid:!1,hasNoRemainingSeats:!1,isExpired:!1,neverHadLicense:!1}}),l=(0,f.KR)([]),d=(0,M.EW)(()=>{const o={};return C.value.forEach(t=>{o[t.id]=t}),o}),w=(0,M.EW)(()=>{const t=C.value.filter(a=>a.creationDate<new Date&&a.expirationDate>new Date)[0];return t.creationDateFormated=(0,n.KS)(t.creationDate),t.expirationDateFormated=(0,n.KS)(t.expirationDate),t}),h=(0,M.EW)(()=>l.value.filter(t=>t.creationDate>new Date));function U(o){const t=o;t.creationDate=new Date(t.creationDate),t.creationDateFormated=(0,n.KS)(t.creationDate),t.expirationDate=new Date(t.expirationDate),t.expirationDateFormated=(0,n.KS)(t.expirationDate),t.startsInFuture=t.creationDate>new Date,t.addUserUrl=`/settings/school/checkout?ref=poolslist-addusers&action=addUsers&licensePool=${t.id}`,t.renewLicenseUrl=`/settings/school/checkout?ref=poolslist-renew&action=renew&licensePool=${t.id}`,C.value.push(t)}function g(o){C.value=[],o.forEach(t=>{U(t)})}function m(o){const t=o;t.startingDate&&(t.startingDate=new Date(t.startingDate),t.startingDateFormatted=(0,n.KS)(t.startingDate),t.startingDateRelative=(0,n.eB)(t.startingDate)),t.renewalDate&&(t.renewalDate=new Date(t.renewalDate),t.renewalDateFormatted=(0,n.KS)(t.renewalDate),t.renewalDateRelative=(0,n.eB)(t.renewalDate)),R.value=t}function L(o){const t=[...o];(t==null?void 0:t.length)>0&&t.forEach(a=>{a.creationDate&&(a.startingDateFormatted=(0,n.KS)(a.creationDate)),a.expirationDate&&(a.renewalDateFormatted=(0,n.KS)(a.expirationDate)),a.seats={unlimited:a.unlimitedLicenses,total:a.totalLicenses},a.creationDate=new Date(a.creationDate),delete a.unlimitedLicenses,delete a.totalLicenses}),l.value=t}function T(){return v(this,null,function*(){const o=yield p.A.get();return g(o),o})}function x(){return v(this,null,function*(){const o=yield p.A.getSummary();return m(o),o})}function i(){return v(this,null,function*(){const o=yield p.A.getAggregatedLicenses();L(o)})}return{siteLicenses:C,summary:R,aggregatedSiteLicenses:l,siteLicensesById:d,currentSiteLicense:w,aggregatedSiteLicensesWithoutCurrentLicense:h,CACHE_SITE_LICENSE:U,LICENSES_FETCHED:g,SUMMARY_FETCHED:m,getSiteLicenses:T,getSummary:x,getAggregatedLicensesPools:i}})},329047:(N,B,e)=>{e.d(B,{O:()=>S});var P=e(303953),f=e(6645),M=e(361744),p=e(744056),n=e(229384),v=e(763939);const S=(0,f.nY)("accountsLTI",()=>{const C=(0,v.F)(),R=(0,M.EW)(()=>C.hasAccessToken),l=(0,p.KR)(P.A.ltiRequest||null),d=(0,M.EW)(()=>R.value||window.location.search.includes("ltiFocusMode")?!0:!!(n.GZ&&l.value&&l.value.resource_link_id));function w(){var h;return d.value&&(h=l.value)!=null&&h.launch_presentation_return_url?(window.location=l.value.launch_presentation_return_url,!0):!1}return{ltiRequest:l,isLtiFocusMode:d,goBackLti:w}})},346579:(N,B,e)=>{e.d(B,{n:()=>l});var P=e(303953),f=e(324074),M=e.n(f),p=e(6645),n=e(744056),v=e(361744),S=e(53779),C=e(674548),R=e(459356);const l=(0,p.nY)("onlineStatus",()=>{const d=(0,n.KR)(!0),w=(0,n.KR)(!0),h=(0,v.EW)(()=>d.value===!1);function U(){w.value&&(0,R.O)().displayMessage({type:"default",text:C.MR.t("flat:offline.now-offline")})}function g(T){d.value=T}function m(T){w.value=T}function L(){function T(){const i=navigator.onLine;!i&&d.value&&U(),g(i)}T(),window.addEventListener("online",T),window.addEventListener("offline",T);function x(){if(!navigator.onLine)return;const i=`${P.A.assetsurl}/on.gif?${Math.round(new Date().getTime()/1e4)}`;M().get(i,{transformRequest:S.o}).then(()=>{navigator.onLine&&g(!0)}).catch(()=>{d.value&&U(),g(!1)})}setInterval(x,2e4),x()}return(0,v.wB)(d,(T,x)=>{x===!1&&T===!0&&window.location.reload()}),{isOnline:d,displayOfflineMessage:w,isOffline:h,initOnlineStatus:L,setDisplayOfflineMessage:m}})},477810:(N,B,e)=>{e.d(B,{A:()=>R});var P=e(324074),f=e.n(P),M=e(645369),p=e.n(M),n=e(550594),v=e(328010);const S=p()("flat:api"),R={setCsrfToken(l){S("deprecated auth.setCsrfToken, use me.setCsrfToken"),v.A.setCsrfToken(l)},signin(l){return n.A.postResponse(`${n.A.apiv2baseurl}/auth/signin`,l).then(d=>(v.A.setCsrfToken(d.headers["x-csrf-token"]),Promise.resolve(d.data)))},signinGuest(l){return n.A.postResponse(`${n.A.apiv2baseurl}/auth/guest`,l).then(d=>(v.A.setCsrfToken(d.headers["x-csrf-token"]),Promise.resolve(d.data)))},signup(l){return n.A.postResponse(`${n.A.apiv2baseurl}/auth/signup`,l).then(d=>(v.A.setCsrfToken(d.headers["x-csrf-token"]),Promise.resolve(d.data)))},signupAndSetAccessToken(l){return n.A.postResponse(`${n.A.apiv2baseurl}/auth/signup`,l).then(d=>(f().defaults.headers.common.authorization=`Bearer ${d.headers["x-flat-access-token"]}`,Promise.resolve(d.data)))},ssoCompleteSignup(l){return n.A.postResponse(`${n.A.apiv2baseurl}/auth/sso/complete-signup`,l).then(d=>(v.A.setCsrfToken(d.headers["x-csrf-token"]),Promise.resolve(d.data)))},ssoCheckPendingSignup(){return n.A.getResponse(`${n.A.apiv2baseurl}/auth/sso/complete-signup`)},logout(){return n.A.post(`${n.A.apiv2baseurl}/auth/logout`)},requestSigninLink(l){return n.A.post(`${n.A.apiv2baseurl}/auth/signinLink`,l)},useSigninLink(l){return n.A.post(`${n.A.apiv2baseurl}/auth/signinLink/${l}`)}}},676170:(N,B,e)=>{e.d(B,{G7:()=>t,gV:()=>a});var P=e(303953),f=e(645369),M=e.n(f),p=e(301927),n=e(653154),v=Object.defineProperty,S=Object.defineProperties,C=Object.getOwnPropertyDescriptors,R=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,w=(s,O,A)=>O in s?v(s,O,{enumerable:!0,configurable:!0,writable:!0,value:A}):s[O]=A,h=(s,O)=>{for(var A in O||(O={}))l.call(O,A)&&w(s,A,O[A]);if(R)for(var A of R(O))d.call(O,A)&&w(s,A,O[A]);return s},U=(s,O)=>S(s,C(O));const g=M()("flat:feature-flags"),m=P.A.unleash||{},{url:L,clientKey:T,appName:x}=m;let i=null;L&&T&&x?i=new p.cn({url:L,clientKey:T,appName:x,refreshInterval:60,metricsInterval:60}):P.A.env&&(0,n.vV)(new Error("Unleash settings are missing"));let o=[];try{const s=P.A.loggeduser;s!=null&&s.id&&(s==null?void 0:s.type)==="user"?a(s):W()}catch(s){(0,n.vV)(s)}i==null||i.start();function t(s){try{if(o.includes(s))return g("[%s] enabled for user",s),!0;const O=i==null?void 0:i.isEnabled(s);return g("[%s] unleash: %s",s,O),O||!1}catch(O){return(0,n.vV)(O),!1}}function a(s){var O;if(!i)return;if(!s||(s==null?void 0:s.type)==="guest"||(s==null?void 0:s.id)==="000000000000000000000000"){W();return}const A=U(h({},m.commonProperties||{}),{locale:s.locale||"en",country:s.country||"unknown",plan:((O=s.plan)==null?void 0:O.name)||"unknown",product:s.product,emailDomain:s.emailDomain||"unknown"});s.organization&&(A.organization=s.organization,A.organizationRole=s.organizationRole||"unknown"),i.updateContext({userId:s.id,properties:A}),s.experience&&(o=[...s.experience])}function W(){i==null||i.updateContext({properties:h({},m.commonProperties||{})}),o=[]}},703359:(N,B,e)=>{e.d(B,{z:()=>w});var P=e(6645),f=e(744056),M=e(361744),p=e(328010),n=e(653154),v=e(763939),S=e(849123),C=e(973876),R=e(459356),l=(h,U,g)=>new Promise((m,L)=>{var T=o=>{try{i(g.next(o))}catch(t){L(t)}},x=o=>{try{i(g.throw(o))}catch(t){L(t)}},i=o=>o.done?m(o.value):Promise.resolve(o.value).then(T,x);i((g=g.apply(h,U)).next())});const d={"score.new":{link:"/my-library?m=newscore"},"edu.class.new":{link:"/class?eduSetup=createClass"},"edu.class.invite-students":{link:"/class"},"edu.assignment.new":{link:"/class"},"edu.resource-library.explore":{link:"/resources"},"edu.lms.integration.viewed":{link:"/settings/apps"},"google.classroom-sync":{link:"/class?eduSetup=googleClassroom"},"ms.teams.sync":{link:"/class?eduSetup=microsoftTeams"},"lti.credentials.canvas":{link:"/class?eduSetup=canvas"},"lti.credentials.schoology":{link:"/class?eduSetup=schoology"},"lti.credentials.moodle":{link:"/class?eduSetup=moodle"},"lti.credentials.custom":{link:"/settings/apps"}};d["lti.signin.canvas"]=d["lti.credentials.canvas"],d["lti.signin.schoology"]=d["lti.credentials.schoology"],d["lti.signin.moodle"]=d["lti.credentials.moodle"],d["lti.signin.custom"]=d["lti.credentials.custom"];const w=(0,P.nY)("onboarding",()=>{const h=(0,f.KR)(!0),U=(0,f.Kh)({steps:[],declinaison:null}),g=(0,v.F)(),m=(0,M.EW)(()=>g.experience),L=(0,M.EW)(()=>{const r=(0,C.V)().activeClasses;let F;return r.length===1&&(F=r[0]),U.steps.map(D=>{D=Object.assign({},D),D.done=D.done||m.value.includes(D.name);const c=d[D.name];return D.link=c.link,F&&(D.name==="edu.assignment.new"?D.link=`${F.link}/assignment`:D.name==="edu.class.invite-students"&&(D.link=`${F.link}/people`)),D})}),T=(0,M.EW)(()=>{const A=L.value.filter(r=>r.done===!0);return Math.floor(A.length/L.value.length*100)}),x=(0,M.EW)(()=>L.value.filter(r=>r.done===!1).length),i=(0,M.EW)(()=>L.value.filter(r=>r.done).length),o=(0,M.EW)(()=>g.isTeacher),t=(0,M.EW)(()=>(0,S.k)().hasEduLicense),a=(0,M.EW)(()=>x.value&&o.value&&t.value&&!m.value.includes("edu.onboarding.skip"));function W({track:A="eduBasics",onboarding:r}){r.steps.forEach(F=>{const D=F.name.replace("edu.","").replace(/\./g,"-");F.i18nTitle=`edu:sguide.${D}.title`,F.i18nDescription=`edu:sguide.${D}.description`}),Object.assign(U,r)}function s(A){return l(this,arguments,function*({track:r}){try{h.value=!0;const F=yield p.A.getOnboardingTrack(r);W({track:r,onboarding:F}),h.value=!1}catch(F){const D=F.response;(!D||D.status!==404)&&(0,n.vV)(F),h.value=!1}})}function O(A){return l(this,arguments,function*({track:r,declinaison:F}){try{const D=yield p.A.updateOnboardingTrack(r,{declinaison:F});W({track:r,onboarding:D})}catch(D){throw(0,R.O)().displayError({error:D}),(0,n.vV)(D),D}})}return{loadingOnboarding:h,eduBasics:U,eduBasicsSteps:L,percentage:T,unfinishedSteps:x,finishedSteps:i,displayOnboardingWidget:a,loadOnboarding:s,updateOnboardingTrack:O}})},724246:(N,B,e)=>{e.d(B,{I:()=>p});var P=e(303953),f=e(635171),M=e(500782);let p={logEvent:()=>{},setUserId:()=>{}};if(P.A.firebaseApiKey&&P.A.firebaseProjectId&&P.A.firebaseAppId){const v={apiKey:P.A.firebaseApiKey,projectId:P.A.firebaseProjectId,appId:P.A.firebaseAppId},S=(0,M.Wp)(v),C=(0,f.P5)(S);p={logEvent:(R,l)=>{(0,f.$s)(C,R,l)},setUserId:R=>{(0,f.do)(C,R)}}}else console.warn("[Firebase] Not initialized: missing config or not in browser");var n=null},796425:(N,B,e)=>{e.d(B,{i:()=>h});var P=e(324074),f=e.n(P),M=e(645369),p=e.n(M),n=e(124872),v=e.n(n),S=e(6645),C=e(744056),R=e(290175),l=e(653154),d=(U,g,m)=>new Promise((L,T)=>{var x=t=>{try{o(m.next(t))}catch(a){T(a)}},i=t=>{try{o(m.throw(t))}catch(a){T(a)}},o=t=>t.done?L(t.value):Promise.resolve(t.value).then(x,i);o((m=m.apply(U,g)).next())});const w=p()("flat:cio"),h=(0,S.nY)("cio",()=>{const U=(0,C.KR)(null),g=(0,C.KR)(null);(()=>{window._cio=window._cio||[];const t=function(W){return function(){window._cio.push([W].concat(Array.prototype.slice.call(arguments,0)))}},a=["load","identify","sidentify","track","page","on","off"];for(let W=0;W<a.length;W++)window._cio[a[W]]=t(a[W])})();function m(){if(!U.value){w("no siteId");return}const t=document.createElement("script"),a=document.getElementsByTagName("script")[0];t.async=!0,t.id="cio-tracker",t.setAttribute("data-site-id",U.value),t.setAttribute("data-use-in-app","true"),t.setAttribute("data-auto-track-page","false"),t.src="https://assets.customer.io/assets/track-eu.js",a.parentNode.insertBefore(t,a)}function L(){return d(this,null,function*(){var t;try{const a=yield R.A.getCioConfig();return a.journeysApi?(U.value=a.journeysApi.siteId,g.value=a.identifier,a):null}catch(a){return f().isAxiosError(a)&&((t=a.response)==null?void 0:t.status)===404||(0,l.vV)(a),null}})}function T(){g.value&&window._cio.identify({id:g.value})}function x(t){return d(this,null,function*(){t.afterEach(a=>{var W;a.meta.useAnalytics!==!1&&((W=window._cio)==null||W.page(`${window.location.protocol}//${window.location.host}${a.path}`,Object.assign({route_name:a.name},a.params,a.query)))})})}function i(){return d(this,null,function*(){try{if(!(yield L())){w("no config");return}m(),T()}catch(t){(0,l.vV)(t)}})}function o(){var t;(t=window._cio)!=null&&t.reset?window._cio.reset():(v().remove("_cioanonid"),v().remove("_cioid")),w("logout")}return{init:i,logout:o,setupRouter:x}})},820759:(N,B,e)=>{e.d(B,{A:()=>x});var P=e(361744),f=e(744056),M=e(744026),p=e(727824),n=e(993122),v=e(536208),S=Object.defineProperty,C=Object.defineProperties,R=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,h=(i,o,t)=>o in i?S(i,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[o]=t,U=(i,o)=>{for(var t in o||(o={}))d.call(o,t)&&h(i,t,o[t]);if(l)for(var t of l(o))w.call(o,t)&&h(i,t,o[t]);return i},g=(i,o)=>C(i,R(o));const m=(0,P.pM)({__name:"FPowerButton",props:g(U(U({},p.A.props),n.A.props),{showIcon:{type:Boolean,default:!0}}),emits:["click"],setup(i){return(o,t)=>((0,P.uX)(),(0,P.Wv)(v.A,(0,P.v6)(o.$props,{onClick:t[0]||(t[0]=a=>o.$emit("click",a)),theme:"fill-power"}),(0,P.eX)({_:2},[i.showIcon?{name:"icon",fn:(0,P.k6)(()=>[(0,P.bF)((0,f.R1)(M.default),{class:"power-icon"})]),key:"0"}:void 0,o.$slots.default?{name:"default",fn:(0,P.k6)(()=>[(0,P.RG)(o.$slots,"default")]),key:"1"}:void 0]),1040))}});var L=e(469733);const x=m},849123:(N,B,e)=>{e.d(B,{k:()=>T});var P=e(433249),f=e(645369),M=e.n(f),p=e(6645),n=e(361744),v=e(744056),S=e(967409),C=e(653154),R=e(254872),l=e(763939),d=e(398734),w=e(604969),h=e(21750),U=e(459356),g=(x,i,o)=>new Promise((t,a)=>{var W=A=>{try{O(o.next(A))}catch(r){a(r)}},s=A=>{try{O(o.throw(A))}catch(r){a(r)}},O=A=>A.done?t(A.value):Promise.resolve(A.value).then(W,s);O((o=o.apply(x,i)).next())});const m=30,L=M()("flat:account"),T=(0,p.nY)("accountsBilling",()=>{const x=(0,l.F)(),i=(0,n.EW)(()=>x.account),o=(0,v.Kh)({preferredPaymentMean:void 0,billingCompany:void 0,address:{},vatNumber:void 0}),t=(0,n.EW)(()=>o.address||{}),a=(0,n.EW)(()=>{var u,j,Y,k,q,ee;if(o.billingCompany)return o.billingCompany;if((u=i.value)!=null&&u.billingCompany)return(j=i.value)==null?void 0:j.billingCompany;const te=(0,w.w)().offers;return(((k=(Y=te.indivYearly)==null?void 0:Y.priceWithVAT)==null?void 0:k.currencyCode)||((ee=(q=te.embedPro)==null?void 0:q.priceWithVAT)==null?void 0:ee.currencyCode))==="USD"?"US":"GB"}),W=(0,n.EW)(()=>{const u=t.value;return!!(u.name&&u.line1&&u.city&&u.zip&&u.countryCode)}),s=(0,n.EW)(()=>{var u,j;return((j=(u=i.value)==null?void 0:u.plan)==null?void 0:j.name)||"indiv-free"}),O=(0,n.EW)(()=>o.vatNumber||{}),A=(0,n.EW)(()=>{var u;const j=t.value.countryCode||"US";return!!((u=(0,d.f)().countries[j])!=null&&u.vatPrefix)}),r=(0,n.EW)(()=>o.preferredPaymentMean),F=(0,n.EW)(()=>{const u=(0,h.E)(),j=(0,n.EW)(()=>u.pms);return j.value?j.value.find(Y=>Y.id===r.value):null}),D=(0,n.EW)(()=>{var u;return((u=i.value)==null?void 0:u.subscription)||{}}),c=(0,n.EW)(()=>{var u;return((u=i.value)==null?void 0:u.license)||{}}),E=(0,n.EW)(()=>c.value.source==="trial"),_=(0,n.EW)(()=>{var u;return((u=D.value)==null?void 0:u.provider)==="appStore"}),K=(0,n.EW)(()=>{var u;return((u=D.value)==null?void 0:u.provider)==="playStore"}),I=(0,n.EW)(()=>s.value==="indiv-power"),$=(0,n.EW)(()=>{var u;return((u=D.value.offerReference)==null?void 0:u.startsWith("emb"))||s.value.startsWith("emb")}),b=(0,n.EW)(()=>{var u;return((u=D.value.offerReference)==null?void 0:u.startsWith("emb_v0"))||s.value.startsWith("emb_v0")}),z=(0,n.EW)(()=>{var u;return I.value&&((u=i.value)==null?void 0:u.license)&&(!i.value.license.expirationDate||new Date(c.value.expirationDate)>new Date("2040-01-01"))}),y=(0,n.EW)(()=>D.value.status==="past_due"),H=(0,n.EW)(()=>D.value.status==="canceled"||D.value.cancelAtPeriodEnd),X=(0,n.EW)(()=>D.value.status==="active"&&!D.value.cancelAtPeriodEnd),V=(0,n.EW)(()=>D.value.stripePaymentIntentStatus==="requires_action"),G=(0,n.EW)(()=>s.value==="edu-standard"),Q=(0,n.EW)(()=>!!D.value.status||z.value||I.value||$.value||G.value),Z=(0,n.EW)(()=>c.value.expirationDate?(0,P.A)(new Date(c.value.expirationDate),new Date):null),ne=(0,n.EW)(()=>{if(!Z.value)return 0;let u=Math.round(Z.value*100/m);return u>100&&(u=100),u}),oe=(0,n.EW)(()=>{var u;return((u=D.value)==null?void 0:u.managePlanUrl)||""}),se=(0,n.EW)(()=>{var u;return((u=D.value)==null?void 0:u.managePaymentMeanUrl)||""}),ae=(0,n.EW)(()=>{var u;return((u=D.value)==null?void 0:u.cancelSubscriptionUrl)||""});function J(u){Object.assign(o,u),o.address&&!o.address.countryCode&&i.value&&(o.address.countryCode=(i.value.country||"US").toUpperCase())}function re(){return g(this,null,function*(){const u=yield S.A.getInfo();return J(u),o})}function ie(u){return g(this,null,function*(){try{const j=yield S.A.updateInfo(u);return J(j),o}catch(j){throw(0,U.O)().displayError({error:j}),(0,C.vV)(j),j}})}function le(){return g(this,null,function*(){try{(0,R.jp)({refreshlicense:!0,fetchOrganization:!1})}catch(u){L(u)}})}return{billing:o,billingAddress:t,billingCompany:a,hasValidBillingAddress:W,vatNumber:O,preferredPaymentMean:r,preferredPaymentMeanObject:F,subscription:D,license:c,isInFreeTrial:E,isAppStoreCustomer:_,isPlayStoreCustomer:K,isPowerUser:I,isEmbedPlan:$,isEmbedLegacyPlan:b,isFlatPowerLife:z,canHaveVatNumber:A,isSubscriptionPastDue:y,isSubscriptionCanceled:H,isSubscriptionActive:X,isSubscriptionRequiresSCA:V,hasEduLicense:G,hasUpgradedLicense:Q,licenseDaysLeft:Z,licenseTrialPercent:ne,managePaymentMeanUrl:se,managePlanUrl:oe,cancelSubscriptionUrl:ae,getBillingInfo:re,updateBillingInfo:ie,refreshLicense:le}})},941271:(N,B,e)=>{e.d(B,{B:()=>x});var P=e(303953),f=e(916504),M=e(645369),p=e.n(M),n=e(6645),v=e(616877),S=e.n(v),C=e(744056),R=e(328010),l=e(266761),d=e(763939),w=(i,o,t)=>new Promise((a,W)=>{var s=r=>{try{A(t.next(r))}catch(F){W(F)}},O=r=>{try{A(t.throw(r))}catch(F){W(F)}},A=r=>r.done?a(r.value):Promise.resolve(r.value).then(s,O);A((t=t.apply(i,o)).next())});let h;const U=p()("flat:stores:sessionUpdater"),g="analytics.entry-page",m="analytics.referrer",L=1,T=Number.POSITIVE_INFINITY,x=(0,n.nY)("sessionUpdater",()=>{const i=(0,C.KR)(null),o=(0,C.KR)([]),t=new(S())(L,T);function a(c){c.forEach(E=>{((E==null?void 0:E.version)||"").includes("ALSA")||o.value.find(_=>_.name===E.name)||o.value.push({manufacturer:E.manufacturer,name:E.name,version:E.version})})}function W(c){return R.A.updateSession(c).then(E=>{i.value&&(!E.user||E.user&&E.user.id!==i.value.id)&&(window.location="/auth/logout"),i.value=i.value||E.user}).catch(E=>{E.status===401&&h&&(window.clearInterval(h),h=null)})}function s(){return t.add(()=>{var c,E;const _={frontendVersion:P.A.version,screenHeight:(c=window==null?void 0:window.screen)==null?void 0:c.height,screenWidth:(E=window==null?void 0:window.screen)==null?void 0:E.width};f.A.get(g)&&(_.url=f.A.get(g),_.url||delete _.url,_.referrer=f.A.get(m),_.referrer||delete _.referrer);const K=f.A.get("session.xps");return Array.isArray(K)&&K.length>0&&(_.xps=K),o.value&&o.value.length>0&&(_.midiDevices=o.value),f.A.remove("session.xps"),f.A.remove(g),f.A.remove(m),W(_)})}function O(){if(typeof URLSearchParams=="undefined"||f.A.get(g))return;const c=new URLSearchParams(window.location.search),E=c.get("ref");if(E!=null&&E.match(/[a-zA-Z0-9-_]+$/)){c.set("utm_source","referral"),c.set("utm_campaign",E),c.delete("ref");const _=`${window.location.href.split("?")[0]}?${c.toString()}`;f.A.set(g,_)}}function A(){f.A.get(g)||(f.A.set(m,document.referrer),f.A.set(g,document.location.href)),h||(h=setInterval(()=>s(),6e4*5),setTimeout(()=>s(),1e4))}function r(){h&&(window.clearInterval(h),h=null)}function F(c){return w(this,null,function*(){U("addExperience(%s)",c);const E=(0,d.F)(),_=E.account;let K=!1;Array.isArray(_==null?void 0:_.experience)&&!_.experience.includes(c)&&(K=!0,E.appendExperience(c));let I=f.A.get("session.xps");Array.isArray(I)||(I=[]);let $=I.find(b=>b.name===c);$||($={date:new Date,name:c,count:0},I.push($)),$.count++,f.A.set("session.xps",I),l.mk(c),K&&(_==null?void 0:_.type)!=="guest"&&(_==null?void 0:_.id)!=="000000000000000000000000"&&(window==null?void 0:window.flatappname)!=="iosEditor"&&(yield s())})}function D(c){return w(this,null,function*(){yield Promise.all(c.map(E=>F(E)))})}return{user:i,midiDevices:o,setMidiDevices:a,init:A,update:s,remove:r,loadRefFromUrl:O,addExperience:F,addExperiences:D}})}}]);})();


//# debugId=262e613a-5c44-54ce-a7e5-dd129c457681
